162
--dataset mnist --model CNN --gpu_devices 0 1 --max_iter 50 --batch_size 256 --ckpt_dir checkpoints_CNN --ckpt_dir_scores checkpoint_scores_CNN --use_scheduler True --GMP True --lr 1e-3 --z_struct_size 20 --add_classification_layer True --classif_layer_size 30 --is_default_model False --is_custom_model False --is_custom_model_BK True --big_kernel_size 8 --two_conv_layer True --three_conv_layer False --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 32 --hidden_filters_layer2 32 --hidden_filters_layer3 32 --ratio_reg True --lambda_ratio_reg 0.01 --lambda_class 1 --other_ratio False --loss_min_distance_cl True --lambda_var_distance 0.0001 --intra_class_variance_loss False --lambda_intra_class_var 1 --contrastive_loss False --lambda_contrastive_loss 1 --alpha 32 --loss Proxy_Anchor --optimizer adamw --mrg 0.1 --IPC False --warm 1 --sz_embedding 32 --dataset_balanced False --loss_distance_mean True --lambda_distance_mean 0.001 --exp_name mnist_classif_ratio_distance_intra_class_max_mean_2_5_6
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, GMP=True, IPC=False, L1_norm_act=False, L1_norm_weights=False, L3_without_random=False, LOG_DIR='logs', adapt_lr=False, add_classification_layer=True, add_linear_after_GMP=True, add_z_struct_bottleneck=False, alpha=32.0, batch_size=256, beta=1, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=[8], binary_z=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, contrastive_loss=False, cuda=True, dataset='mnist', dataset_balanced=False, display_step=10000, dset_dir='data', exp_name='mnist_classif_ratio_distance_intra_class_max_mean_2_5_6', gamma=1000, gpu_devices=[0, 1], hidden_filters_layer1=32, hidden_filters_layer2=32, hidden_filters_layer3=32, image_size=64, intra_class_variance_loss=False, is_C=True, is_E1=False, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=True, is_default_model=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_VAE=1, lambda_class=1.0, lambda_contrastive_loss=1.0, lambda_distance_mean=0.001, lambda_intra_class_var=1.0, lambda_partial_class=1, lambda_ratio_reg=0.01, lambda_recon_wt_rand=1, lambda_recons=1, lambda_var_distance=0.0001, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', loss='Proxy_Anchor', loss_distance_mean=True, loss_min_distance_cl=True, lr=0.001, max_iter=50.0, model='CNN', mrg=0.1, num_workers=2, old_weighted=False, optimizer='adamw', other_ratio=False, random_percentage=0.2, ratio_reg=True, remark='', save_step=10000, second_layer_C=False, seed=1, stride_size=1, sz_embedding=32, three_conv_layer=False, train=True, two_conv_layer=True, two_encoder=False, use_early_stopping=True, use_scheduler=True, warm=1, without_acc=False, z_struct_size=20, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
Custom_CNN_BK(
  (net): Sequential(
    (0): Conv2d(1, 32, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(32, 32, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): AdaptiveMaxPool2d(output_size=(1, 1))
    (7): View()
    (8): Linear(in_features=32, out_features=20, bias=True)
    (9): BatchNorm1d(20, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (10): ReLU(inplace=True)
    (11): Dropout(p=0.4, inplace=False)
    (12): Linear(in_features=20, out_features=30, bias=True)
    (13): BatchNorm1d(30, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU(inplace=True)
    (15): Dropout(p=0.4, inplace=False)
    (16): Linear(in_features=30, out_features=10, bias=True)
    (17): Softmax(dim=None)
  )
)
The number of parameters of model is 20324
use 1 gpu who named: GeForce RTX 2080 Ti
=> loaded sample_scores and losses
=> no checkpoint found at 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last'
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 235, epoch 1.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 235, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train score:82.30167, Test score:82.51000, train loss:-0.72705, test loss:-0.73136, ratio_train_loss:0.83578,ratio_test_loss:0.79412, total_loss_train:0.10872,total_loss_test:0.06276, var distance inter class train:3.77835,var distance inter class test:3.89850
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 470, epoch 2.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 470, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train score:94.49833, Test score:94.37000, train loss:-0.89292, test loss:-0.89420, ratio_train_loss:0.67298,ratio_test_loss:0.63532, total_loss_train:-0.21994,total_loss_test:-0.25888, var distance inter class train:3.03945,var distance inter class test:3.16443
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 705, epoch 3.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 705, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train score:96.76333, Test score:96.81000, train loss:-0.95474, test loss:-0.95675, ratio_train_loss:0.61545,ratio_test_loss:0.58643, total_loss_train:-0.33929,total_loss_test:-0.37032, var distance inter class train:2.60643,var distance inter class test:2.69437
Ratio: In this batch for class 4, they are less images than 10. Don't use it to compute ratio!!!!
Variance: In this batch for class 4, they are less images than 10. Don't use it to compute ratio!!!!
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 940, epoch 4.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 940, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train score:96.94167, Test score:96.99000, train loss:-0.96204, test loss:-0.96302, ratio_train_loss:0.58877,ratio_test_loss:0.55904, total_loss_train:-0.37326,total_loss_test:-0.40398, var distance inter class train:2.52856,var distance inter class test:2.63320
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 1175, epoch 5.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 1175, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train score:97.53333, Test score:97.50000, train loss:-0.97036, test loss:-0.97186, ratio_train_loss:0.57297,ratio_test_loss:0.54343, total_loss_train:-0.39739,total_loss_test:-0.42842, var distance inter class train:2.61097,var distance inter class test:2.72312
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 1410, epoch 6.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 1410, epoch 6.0)
[Save Checkpoint] epoch: [6.0], Train score:97.55500, Test score:97.38000, train loss:-0.97233, test loss:-0.97187, ratio_train_loss:0.52924,ratio_test_loss:0.50251, total_loss_train:-0.44309,total_loss_test:-0.46936, var distance inter class train:2.39128,var distance inter class test:2.49375
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 1645, epoch 7.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 1645, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train score:97.15333, Test score:97.11000, train loss:-0.96831, test loss:-0.96856, ratio_train_loss:0.51644,ratio_test_loss:0.49283, total_loss_train:-0.45188,total_loss_test:-0.47573, var distance inter class train:2.61091,var distance inter class test:2.71364
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 1880, epoch 8.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 1880, epoch 8.0)
[Save Checkpoint] epoch: [8.0], Train score:97.87167, Test score:97.68000, train loss:-0.97664, test loss:-0.97584, ratio_train_loss:0.50713,ratio_test_loss:0.48299, total_loss_train:-0.46951,total_loss_test:-0.49286, var distance inter class train:2.52066,var distance inter class test:2.61993
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 2115, epoch 9.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 2115, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train score:97.73000, Test score:97.59000, train loss:-0.97537, test loss:-0.97468, ratio_train_loss:0.50443,ratio_test_loss:0.48113, total_loss_train:-0.47094,total_loss_test:-0.49355, var distance inter class train:2.33431,var distance inter class test:2.44318
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 2350, epoch 10.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 2350, epoch 10.0)
[Save Checkpoint] epoch: [10.0], Train score:97.95667, Test score:97.79000, train loss:-0.97795, test loss:-0.97704, ratio_train_loss:0.48708,ratio_test_loss:0.46583, total_loss_train:-0.49087,total_loss_test:-0.51121, var distance inter class train:2.14099,var distance inter class test:2.21485
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 2585, epoch 11.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 2585, epoch 11.0)
[Save Checkpoint] epoch: [11.0], Train score:97.98833, Test score:97.93000, train loss:-0.97862, test loss:-0.97834, ratio_train_loss:0.48835,ratio_test_loss:0.46431, total_loss_train:-0.49027,total_loss_test:-0.51403, var distance inter class train:2.32780,var distance inter class test:2.43026
Ratio: In this batch for class 5, they are less images than 10. Don't use it to compute ratio!!!!
Variance: In this batch for class 5, they are less images than 10. Don't use it to compute ratio!!!!
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 2820, epoch 12.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 2820, epoch 12.0)
[Save Checkpoint] epoch: [12.0], Train score:97.98333, Test score:98.07000, train loss:-0.97869, test loss:-0.97929, ratio_train_loss:0.47753,ratio_test_loss:0.45387, total_loss_train:-0.50116,total_loss_test:-0.52542, var distance inter class train:2.41693,var distance inter class test:2.50463
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 3055, epoch 13.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 3055, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train score:98.16000, Test score:98.04000, train loss:-0.98077, test loss:-0.97982, ratio_train_loss:0.46435,ratio_test_loss:0.44400, total_loss_train:-0.51642,total_loss_test:-0.53581, var distance inter class train:2.53131,var distance inter class test:2.62615
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 3290, epoch 14.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 3290, epoch 14.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [14.0], Train score:98.13167, Test score:97.97000, train loss:-0.98014, test loss:-0.97919, ratio_train_loss:0.47364,ratio_test_loss:0.44953, total_loss_train:-0.50651,total_loss_test:-0.52967, var distance inter class train:2.34982,var distance inter class test:2.43258
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 3525, epoch 15.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 3525, epoch 15.0)
[Save Checkpoint] epoch: [15.0], Train score:97.96667, Test score:97.83000, train loss:-0.97842, test loss:-0.97729, ratio_train_loss:0.46010,ratio_test_loss:0.43805, total_loss_train:-0.51832,total_loss_test:-0.53925, var distance inter class train:2.45937,var distance inter class test:2.53867
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 3760, epoch 16.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 3760, epoch 16.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [16.0], Train score:98.37667, Test score:98.21000, train loss:-0.98297, test loss:-0.98170, ratio_train_loss:0.49263,ratio_test_loss:0.46877, total_loss_train:-0.49034,total_loss_test:-0.51293, var distance inter class train:2.08081,var distance inter class test:2.14581
Ratio: In this batch for class 5, they are less images than 10. Don't use it to compute ratio!!!!
Variance: In this batch for class 5, they are less images than 10. Don't use it to compute ratio!!!!
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 3995, epoch 17.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 3995, epoch 17.0)
EarlyStopping counter: 2 out of 10
[Save Checkpoint] epoch: [17.0], Train score:98.34333, Test score:98.02000, train loss:-0.98275, test loss:-0.97970, ratio_train_loss:0.47233,ratio_test_loss:0.45352, total_loss_train:-0.51042,total_loss_test:-0.52618, var distance inter class train:2.12204,var distance inter class test:2.19958
Ratio: In this batch for class 4, they are less images than 10. Don't use it to compute ratio!!!!
Variance: In this batch for class 4, they are less images than 10. Don't use it to compute ratio!!!!
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 4230, epoch 18.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 4230, epoch 18.0)
EarlyStopping counter: 3 out of 10
[Save Checkpoint] epoch: [18.0], Train score:98.39000, Test score:98.09000, train loss:-0.98317, test loss:-0.98026, ratio_train_loss:0.48340,ratio_test_loss:0.46440, total_loss_train:-0.49977,total_loss_test:-0.51587, var distance inter class train:1.81776,var distance inter class test:1.88406
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 4465, epoch 19.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 4465, epoch 19.0)
EarlyStopping counter: 4 out of 10
[Save Checkpoint] epoch: [19.0], Train score:98.34167, Test score:98.11000, train loss:-0.98280, test loss:-0.98132, ratio_train_loss:0.48123,ratio_test_loss:0.46117, total_loss_train:-0.50157,total_loss_test:-0.52015, var distance inter class train:2.06999,var distance inter class test:2.12816
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 4700, epoch 20.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 4700, epoch 20.0)
[Save Checkpoint] epoch: [20.0], Train score:98.41667, Test score:98.19000, train loss:-0.98339, test loss:-0.98167, ratio_train_loss:0.45774,ratio_test_loss:0.43725, total_loss_train:-0.52565,total_loss_test:-0.54441, var distance inter class train:2.36501,var distance inter class test:2.45127
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 4935, epoch 21.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 4935, epoch 21.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [21.0], Train score:98.51000, Test score:98.31000, train loss:-0.98446, test loss:-0.98251, ratio_train_loss:0.47480,ratio_test_loss:0.45409, total_loss_train:-0.50966,total_loss_test:-0.52842, var distance inter class train:1.89339,var distance inter class test:1.94566
Ratio: In this batch for class 0, they are less images than 10. Don't use it to compute ratio!!!!
Variance: In this batch for class 0, they are less images than 10. Don't use it to compute ratio!!!!
Ratio: In this batch for class 4, they are less images than 10. Don't use it to compute ratio!!!!
Variance: In this batch for class 4, they are less images than 10. Don't use it to compute ratio!!!!
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 5170, epoch 22.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 5170, epoch 22.0)
EarlyStopping counter: 2 out of 10
[Save Checkpoint] epoch: [22.0], Train score:98.46000, Test score:98.23000, train loss:-0.98389, test loss:-0.98207, ratio_train_loss:0.48855,ratio_test_loss:0.46532, total_loss_train:-0.49534,total_loss_test:-0.51675, var distance inter class train:2.06126,var distance inter class test:2.13771
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 5405, epoch 23.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 5405, epoch 23.0)
EarlyStopping counter: 3 out of 10
[Save Checkpoint] epoch: [23.0], Train score:98.42833, Test score:98.10000, train loss:-0.98363, test loss:-0.98070, ratio_train_loss:0.46201,ratio_test_loss:0.44268, total_loss_train:-0.52163,total_loss_test:-0.53801, var distance inter class train:1.95330,var distance inter class test:2.02962
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 5640, epoch 24.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 5640, epoch 24.0)
EarlyStopping counter: 4 out of 10
[Save Checkpoint] epoch: [24.0], Train score:98.50667, Test score:98.23000, train loss:-0.98463, test loss:-0.98151, ratio_train_loss:0.45764,ratio_test_loss:0.43943, total_loss_train:-0.52698,total_loss_test:-0.54208, var distance inter class train:2.18267,var distance inter class test:2.26604
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 5875, epoch 25.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 5875, epoch 25.0)
[Save Checkpoint] epoch: [25.0], Train score:98.46667, Test score:98.19000, train loss:-0.98388, test loss:-0.98142, ratio_train_loss:0.44715,ratio_test_loss:0.42990, total_loss_train:-0.53673,total_loss_test:-0.55151, var distance inter class train:2.19591,var distance inter class test:2.28482
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 6110, epoch 26.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 6110, epoch 26.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [26.0], Train score:98.57667, Test score:98.17000, train loss:-0.98502, test loss:-0.98172, ratio_train_loss:0.45921,ratio_test_loss:0.43807, total_loss_train:-0.52581,total_loss_test:-0.54365, var distance inter class train:2.10579,var distance inter class test:2.18496
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 6345, epoch 27.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 6345, epoch 27.0)
[Save Checkpoint] epoch: [27.0], Train score:98.61833, Test score:98.22000, train loss:-0.98579, test loss:-0.98207, ratio_train_loss:0.44158,ratio_test_loss:0.42289, total_loss_train:-0.54421,total_loss_test:-0.55918, var distance inter class train:2.03485,var distance inter class test:2.10361
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 6580, epoch 28.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 6580, epoch 28.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [28.0], Train score:98.55333, Test score:98.18000, train loss:-0.98498, test loss:-0.98157, ratio_train_loss:0.45788,ratio_test_loss:0.43713, total_loss_train:-0.52710,total_loss_test:-0.54444, var distance inter class train:1.94190,var distance inter class test:2.00440
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 6815, epoch 29.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 6815, epoch 29.0)
EarlyStopping counter: 2 out of 10
[Save Checkpoint] epoch: [29.0], Train score:98.63000, Test score:98.27000, train loss:-0.98589, test loss:-0.98225, ratio_train_loss:0.45316,ratio_test_loss:0.43628, total_loss_train:-0.53273,total_loss_test:-0.54597, var distance inter class train:1.93195,var distance inter class test:1.99662
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 7050, epoch 30.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 7050, epoch 30.0)
EarlyStopping counter: 3 out of 10
[Save Checkpoint] epoch: [30.0], Train score:98.67667, Test score:98.27000, train loss:-0.98635, test loss:-0.98256, ratio_train_loss:0.45078,ratio_test_loss:0.43308, total_loss_train:-0.53556,total_loss_test:-0.54948, var distance inter class train:2.05628,var distance inter class test:2.12994
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 7285, epoch 31.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 7285, epoch 31.0)
[Save Checkpoint] epoch: [31.0], Train score:98.56000, Test score:98.19000, train loss:-0.98523, test loss:-0.98220, ratio_train_loss:0.43203,ratio_test_loss:0.41354, total_loss_train:-0.55320,total_loss_test:-0.56866, var distance inter class train:2.12936,var distance inter class test:2.19418
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 7520, epoch 32.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 7520, epoch 32.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [32.0], Train score:98.58667, Test score:98.07000, train loss:-0.98543, test loss:-0.98099, ratio_train_loss:0.43483,ratio_test_loss:0.41638, total_loss_train:-0.55060,total_loss_test:-0.56461, var distance inter class train:2.03124,var distance inter class test:2.09719
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 7755, epoch 33.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 7755, epoch 33.0)
[Save Checkpoint] epoch: [33.0], Train score:98.67667, Test score:98.41000, train loss:-0.98643, test loss:-0.98374, ratio_train_loss:0.42848,ratio_test_loss:0.40977, total_loss_train:-0.55794,total_loss_test:-0.57398, var distance inter class train:2.28323,var distance inter class test:2.35190
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 7990, epoch 34.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 7990, epoch 34.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [34.0], Train score:98.61333, Test score:98.35000, train loss:-0.98568, test loss:-0.98323, ratio_train_loss:0.43038,ratio_test_loss:0.41351, total_loss_train:-0.55531,total_loss_test:-0.56972, var distance inter class train:2.11825,var distance inter class test:2.18127
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 8225, epoch 35.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 8225, epoch 35.0)
[Save Checkpoint] epoch: [35.0], Train score:98.54833, Test score:98.39000, train loss:-0.98513, test loss:-0.98358, ratio_train_loss:0.42301,ratio_test_loss:0.40569, total_loss_train:-0.56212,total_loss_test:-0.57789, var distance inter class train:2.20237,var distance inter class test:2.27644
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 8460, epoch 36.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 8460, epoch 36.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [36.0], Train score:98.60333, Test score:98.18000, train loss:-0.98590, test loss:-0.98233, ratio_train_loss:0.42658,ratio_test_loss:0.40665, total_loss_train:-0.55932,total_loss_test:-0.57568, var distance inter class train:2.08443,var distance inter class test:2.15074
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 8695, epoch 37.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 8695, epoch 37.0)
EarlyStopping counter: 2 out of 10
[Save Checkpoint] epoch: [37.0], Train score:98.71833, Test score:98.21000, train loss:-0.98689, test loss:-0.98255, ratio_train_loss:0.43092,ratio_test_loss:0.41229, total_loss_train:-0.55598,total_loss_test:-0.57026, var distance inter class train:2.06688,var distance inter class test:2.13304
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 8930, epoch 38.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 8930, epoch 38.0)
EarlyStopping counter: 3 out of 10
[Save Checkpoint] epoch: [38.0], Train score:98.54833, Test score:98.16000, train loss:-0.98511, test loss:-0.98135, ratio_train_loss:0.44862,ratio_test_loss:0.43016, total_loss_train:-0.53649,total_loss_test:-0.55119, var distance inter class train:1.93539,var distance inter class test:2.00084
Ratio: In this batch for class 8, they are less images than 10. Don't use it to compute ratio!!!!
Variance: In this batch for class 8, they are less images than 10. Don't use it to compute ratio!!!!
Ratio: In this batch for class 5, they are less images than 10. Don't use it to compute ratio!!!!
Variance: In this batch for class 5, they are less images than 10. Don't use it to compute ratio!!!!
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 9165, epoch 39.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 9165, epoch 39.0)
EarlyStopping counter: 4 out of 10
[Save Checkpoint] epoch: [39.0], Train score:98.67167, Test score:98.32000, train loss:-0.98648, test loss:-0.98321, ratio_train_loss:0.44763,ratio_test_loss:0.42484, total_loss_train:-0.53885,total_loss_test:-0.55837, var distance inter class train:2.03409,var distance inter class test:2.09611
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 9400, epoch 40.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 9400, epoch 40.0)
EarlyStopping counter: 5 out of 10
[Save Checkpoint] epoch: [40.0], Train score:98.72000, Test score:98.38000, train loss:-0.98691, test loss:-0.98356, ratio_train_loss:0.43547,ratio_test_loss:0.41650, total_loss_train:-0.55145,total_loss_test:-0.56705, var distance inter class train:1.97003,var distance inter class test:2.03802
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 9635, epoch 41.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 9635, epoch 41.0)
EarlyStopping counter: 6 out of 10
[Save Checkpoint] epoch: [41.0], Train score:98.71333, Test score:98.29000, train loss:-0.98686, test loss:-0.98352, ratio_train_loss:0.44298,ratio_test_loss:0.42315, total_loss_train:-0.54388,total_loss_test:-0.56036, var distance inter class train:1.81047,var distance inter class test:1.87176
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 9870, epoch 42.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 9870, epoch 42.0)
EarlyStopping counter: 7 out of 10
[Save Checkpoint] epoch: [42.0], Train score:98.70500, Test score:98.33000, train loss:-0.98683, test loss:-0.98348, ratio_train_loss:0.45063,ratio_test_loss:0.43163, total_loss_train:-0.53620,total_loss_test:-0.55185, var distance inter class train:1.84892,var distance inter class test:1.90914
Ratio: In this batch for class 5, they are less images than 10. Don't use it to compute ratio!!!!
Variance: In this batch for class 5, they are less images than 10. Don't use it to compute ratio!!!!
=> saved checkpoint 'checkpoints_CNN/mnist_classif_ratio_distance_intra_class_max_mean_2_5_6/last' (iter 10105, epoch 43.0)
