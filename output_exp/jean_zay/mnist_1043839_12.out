12
--gpu_devices 0 --max_iter 100 --batch_size 250 --use_scheduler True --lr 1e-3 --GMP True --z_struct_size 15 --z_var_size 6 --is_VAE True --is_encoder_struct False --lambda_BCE 1 --beta 1 --lambda_recons 1 --lambda_EV_class 1 --big_kernel_size 8 --two_conv_layer True --three_conv_layer True --kernel_size_1 4 --kernel_size_2 4 --kernel_size_3 4 --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 64 --hidden_filters_layer2 64 --hidden_filters_layer3 64 --dataset_balanced True --binary_z True --binary_first_conv False --binary_second_conv False --binary_third_conv True --use_small_lr_encoder_var False --encoder_var_name None --encoder_struct_name mnist_ES_binary_15_Hmg_dst_4_2nd_test --freeze_Encoder True --EV_classifier True --freeze_Encoder True --grad_inv True --size_average False --exp_name mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, ES_reconstruction=False, EV_classifier=True, GMP=True, Hmg_dst_loss=False, IPC=False, L1_norm_act=False, L1_norm_weights=False, L2_dst_loss=False, L3_without_random=False, LOG_DIR='logs', PT_model=False, PT_model_EV_classifier=False, adapt_lr=False, add_classification_layer=True, add_dl_class=False, add_linear_after_GMP=True, add_z_struct_bottleneck=False, alpha=32, batch_size=250, beta=1.0, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=8, bin_after_GMP=False, binary_chain=False, binary_first_conv=False, binary_second_conv=False, binary_third_conv=True, binary_z=True, both_decoders_freeze=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, contrastive_loss=False, cuda=True, dataset='mnist', dataset_balanced=True, decoder_first_dense=36, decoder_kernel_size_1=4, decoder_kernel_size_2=3, decoder_kernel_size_3=4, decoder_n_filter_1=64, decoder_n_filter_2=64, decoder_n_filter_3=64, decoder_name='None', decoder_stride_1=2, decoder_stride_2=2, decoder_stride_3=1, diff_var=False, display_step=10000, dset_dir='data', encoder_struct_name='mnist_ES_binary_15_Hmg_dst_4_2nd_test', encoder_var_name='None', exp_name='mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2', fine_tune_decoder=False, freeze_Encoder=True, gamma=1000, gpu_devices=[0], grad_inv=True, hidden_dim=20, hidden_filters_layer1=64, hidden_filters_layer2=64, hidden_filters_layer3=64, image_size=64, intra_class_variance_loss=False, is_C=True, is_E1=False, is_VAE=True, is_VAE_var=False, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=False, is_default_model=False, is_encoder_struct=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, kernel_size_1=4, kernel_size_2=4, kernel_size_3=4, lambda_BCE=1.0, lambda_EV_class=1.0, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_L2_dst=1, lambda_VAE=1, lambda_class=1, lambda_contrastive_loss=1, lambda_distance_mean=1, lambda_hmg_dst=1, lambda_intra_class_var=1, lambda_partial_class=1, lambda_ratio_reg=1, lambda_recon_wt_rand=1, lambda_recons=1.0, lambda_struct_recons_class=1, lambda_uniq_code_dst=1, lambda_var_distance=1, lambda_var_inter=1, lambda_var_intra=1, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', loss='Proxy_Anchor', loss_ES_reconstruction=False, loss_distance_mean=False, loss_min_distance_cl=False, loss_struct_recons_class=False, lr=0.001, max_epoch_use_uniq_code_target=5, max_iter=100.0, model='CNN', mrg=0.1, nb_epochs_train_only_zvar=0, num_workers=2, old_weighted=False, optimizer='adamw', other_architecture=False, other_ratio=False, random_percentage=0.2, random_seed=10, randomness=True, ratio_reg=False, remark='', save_step=10000, second_layer_C=False, seed=1, size_average=False, stride_size=1, sz_embedding=5, three_conv_layer=True, train=True, train_var_struct_alternatively=False, two_conv_layer=True, two_encoder=False, uniq_code_dst_loss=False, use_VAE=False, use_decoder=False, use_early_stopping=True, use_scheduler=True, use_small_lr_encoder_var=False, use_structural_encoder=False, value_target_distance_mean=1, var_hidden_dim=256, var_hidden_filters_1=32, var_hidden_filters_2=32, var_hidden_filters_3=32, var_kernel_size_1=3, var_kernel_size_2=3, var_kernel_size_3=3, var_second_cnn_block=True, var_stride_size_1=1, var_stride_size_2=1, var_stride_size_3=1, var_third_cnn_block=False, var_three_conv_layer=False, warm=1, without_acc=False, z_struct_size=15, z_var_size=6, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
[Using Seed: 10]
Balanced dataset loaded
VAE doesn't exist but encoder struct yes ! load struct encoder weighs !
=> loaded checkpoint 'checkpoints_CNN/mnist_ES_binary_15_Hmg_dst_4_2nd_test/last (iter 7020)'
Weighs loaded for struct encoder !
use 1 gpu who named: Tesla V100-SXM2-32GB
VAE(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
  )
  (decoder): Sequential(
    (0): Linear(in_features=21, out_features=1600, bias=True)
    (1): ReLU(inplace=True)
    (2): View()
    (3): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (4): ReLU(inplace=True)
    (5): ConvTranspose2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (6): ReLU(inplace=True)
    (7): ConvTranspose2d(64, 32, kernel_size=(3, 3), stride=(1, 1))
    (8): ReLU(inplace=True)
    (9): ConvTranspose2d(32, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (10): ReLU(inplace=True)
    (11): ConvTranspose2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (12): ReLU(inplace=True)
    (13): ConvTranspose2d(32, 1, kernel_size=(3, 3), stride=(1, 1))
    (14): Sigmoid()
  )
  (encoder_var): Sequential(
    (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (4): ReLU(inplace=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Conv2d(32, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (7): ReLU(inplace=True)
    (8): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): Dropout(p=0.4, inplace=False)
    (10): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
    (11): ReLU(inplace=True)
    (12): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (13): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (14): ReLU(inplace=True)
    (15): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Conv2d(64, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (17): ReLU(inplace=True)
    (18): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (19): Dropout(p=0.4, inplace=False)
    (20): View()
    (21): Linear(in_features=1600, out_features=12, bias=True)
  )
  (var_classifier): Sequential(
    (0): RevGrad()
    (1): Linear(in_features=6, out_features=10, bias=True)
  )
)
The number of parameters of model is 480512
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 270, epoch 1.0)
score:  12.608333333333333
score:  10.98
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 270, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train: total:148181.09375, BCE:-10.34970, KLD:148191.35938,Test: total:598349.25000, BCE:-10.42141, KLD:598359.75000
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 540, epoch 2.0)
score:  16.726666666666667
score:  14.27
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 540, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train: total:138806.37500, BCE:-10.44695, KLD:138816.81250,Test: total:559531.93750, BCE:-10.52961, KLD:559542.43750
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 810, epoch 3.0)
score:  24.651666666666667
score:  21.37
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 810, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train: total:107958.57031, BCE:-10.31267, KLD:107968.89062,Test: total:435166.21875, BCE:-10.39078, KLD:435176.65625
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 1080, epoch 4.0)
score:  29.506666666666668
score:  25.43
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 1080, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train: total:85011.10156, BCE:-10.32697, KLD:85021.46094,Test: total:342487.84375, BCE:-10.40691, KLD:342498.21875
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 1350, epoch 5.0)
score:  35.77166666666667
score:  31.14
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 1350, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train: total:70896.10156, BCE:-10.89425, KLD:70907.02344,Test: total:284842.00000, BCE:-10.97062, KLD:284852.96875
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 1620, epoch 6.0)
score:  39.345
score:  34.11
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 1620, epoch 6.0)
[Save Checkpoint] epoch: [6.0], Train: total:60013.32031, BCE:-11.04236, KLD:60024.38672,Test: total:240990.45312, BCE:-11.12787, KLD:241001.57812
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 1890, epoch 7.0)
score:  40.123333333333335
score:  34.9
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 1890, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train: total:51690.37500, BCE:-10.55776, KLD:51700.91406,Test: total:206649.20312, BCE:-10.61962, KLD:206659.79688
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 2160, epoch 8.0)
score:  48.53
score:  41.97
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 2160, epoch 8.0)
[Save Checkpoint] epoch: [8.0], Train: total:45470.08203, BCE:-10.73877, KLD:45480.82031,Test: total:181657.65625, BCE:-10.80861, KLD:181668.43750
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 2430, epoch 9.0)
score:  51.955
score:  45.4
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 2430, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train: total:42661.12109, BCE:-11.56966, KLD:42672.68750,Test: total:169983.34375, BCE:-11.64436, KLD:169995.00000
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 2700, epoch 10.0)
score:  62.87833333333333
score:  55.86
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 2700, epoch 10.0)
[Save Checkpoint] epoch: [10.0], Train: total:37999.88672, BCE:-11.50828, KLD:38011.39453,Test: total:151151.93750, BCE:-11.57988, KLD:151163.53125
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 2970, epoch 11.0)
score:  69.04666666666667
score:  61.42
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 2970, epoch 11.0)
[Save Checkpoint] epoch: [11.0], Train: total:36054.32031, BCE:-11.60440, KLD:36065.93359,Test: total:142960.06250, BCE:-11.67692, KLD:142971.73438
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 3240, epoch 12.0)
score:  69.385
score:  61.85
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 3240, epoch 12.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [12.0], Train: total:34445.50000, BCE:-12.19383, KLD:34457.68359,Test: total:136423.70312, BCE:-12.26655, KLD:136435.96875
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 3510, epoch 13.0)
score:  69.19
score:  61.79
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 3510, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train: total:32352.74023, BCE:-12.24035, KLD:32364.98047,Test: total:127839.02344, BCE:-12.32542, KLD:127851.35156
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 3780, epoch 14.0)
score:  69.09333333333333
score:  61.47
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 3780, epoch 14.0)
[Save Checkpoint] epoch: [14.0], Train: total:31068.40625, BCE:-12.83705, KLD:31081.24414,Test: total:122761.27344, BCE:-12.94450, KLD:122774.20312
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 4050, epoch 15.0)
score:  69.11
score:  61.66
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 4050, epoch 15.0)
[Save Checkpoint] epoch: [15.0], Train: total:29678.24414, BCE:-13.04140, KLD:29691.28711,Test: total:117009.08594, BCE:-13.16548, KLD:117022.26562
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 4320, epoch 16.0)
score:  68.96
score:  61.56
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 4320, epoch 16.0)
[Save Checkpoint] epoch: [16.0], Train: total:29037.25586, BCE:-13.17835, KLD:29050.44141,Test: total:114499.74219, BCE:-13.31385, KLD:114513.05469
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 4590, epoch 17.0)
score:  68.83166666666666
score:  61.51
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 4590, epoch 17.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [17.0], Train: total:27595.06250, BCE:-13.74158, KLD:27608.80469,Test: total:108569.55469, BCE:-13.90639, KLD:108583.46094
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 4860, epoch 18.0)
score:  68.77166666666666
score:  61.28
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 4860, epoch 18.0)
[Save Checkpoint] epoch: [18.0], Train: total:26804.41602, BCE:-14.43740, KLD:26818.84180,Test: total:105629.17969, BCE:-14.62703, KLD:105643.80469
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 5130, epoch 19.0)
score:  68.605
score:  61.29
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 5130, epoch 19.0)
[Save Checkpoint] epoch: [19.0], Train: total:26689.47070, BCE:-14.51339, KLD:26703.97266,Test: total:104990.28906, BCE:-14.70444, KLD:105005.00000
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 5400, epoch 20.0)
score:  68.28833333333333
score:  61.01
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 5400, epoch 20.0)
[Save Checkpoint] epoch: [20.0], Train: total:25898.60547, BCE:-14.94715, KLD:25913.54102,Test: total:101860.33594, BCE:-15.15229, KLD:101875.48438
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 5670, epoch 21.0)
score:  68.40666666666667
score:  61.17
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 5670, epoch 21.0)
[Save Checkpoint] epoch: [21.0], Train: total:25248.89844, BCE:-14.96868, KLD:25263.86523,Test: total:99354.21094, BCE:-15.18890, KLD:99369.41406
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 5940, epoch 22.0)
score:  68.095
score:  60.84
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 5940, epoch 22.0)
[Save Checkpoint] epoch: [22.0], Train: total:24793.21289, BCE:-15.89237, KLD:24809.10352,Test: total:97400.08594, BCE:-16.12271, KLD:97416.21094
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 6210, epoch 23.0)
score:  67.88333333333334
score:  60.76
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 6210, epoch 23.0)
[Save Checkpoint] epoch: [23.0], Train: total:24177.49023, BCE:-16.49972, KLD:24193.97852,Test: total:94986.64062, BCE:-16.72831, KLD:95003.36719
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 6480, epoch 24.0)
score:  67.99666666666667
score:  60.7
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 6480, epoch 24.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [24.0], Train: total:24544.31445, BCE:-16.47079, KLD:24560.79102,Test: total:96474.13281, BCE:-16.70485, KLD:96490.83594
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 6750, epoch 25.0)
score:  67.86833333333334
score:  60.63
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 6750, epoch 25.0)
[Save Checkpoint] epoch: [25.0], Train: total:23462.68164, BCE:-16.70215, KLD:23479.38867,Test: total:92268.68750, BCE:-16.94816, KLD:92285.64062
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 7020, epoch 26.0)
score:  69.53833333333333
score:  62.31
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 7020, epoch 26.0)
[Save Checkpoint] epoch: [26.0], Train: total:23211.90234, BCE:-17.19666, KLD:23229.10742,Test: total:91168.84375, BCE:-17.41964, KLD:91186.26562
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 7290, epoch 27.0)
score:  69.95833333333333
score:  63.01
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 7290, epoch 27.0)
[Save Checkpoint] epoch: [27.0], Train: total:23110.15625, BCE:-17.67280, KLD:23127.83398,Test: total:90767.14062, BCE:-17.89180, KLD:90785.03906
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 7560, epoch 28.0)
score:  69.67666666666666
score:  62.81
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 7560, epoch 28.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [28.0], Train: total:22659.76562, BCE:-18.45360, KLD:22678.23242,Test: total:89153.67969, BCE:-18.66436, KLD:89172.35938
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 7830, epoch 29.0)
score:  69.675
score:  62.84
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 7830, epoch 29.0)
[Save Checkpoint] epoch: [29.0], Train: total:22416.50000, BCE:-18.67118, KLD:22435.17383,Test: total:88016.64062, BCE:-18.86730, KLD:88035.50781
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 8100, epoch 30.0)
score:  69.505
score:  62.55
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 8100, epoch 30.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [30.0], Train: total:21826.78125, BCE:-19.40397, KLD:21846.16992,Test: total:85688.12500, BCE:-19.61226, KLD:85707.72656
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 8370, epoch 31.0)
score:  70.54166666666667
score:  64.15
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 8370, epoch 31.0)
[Save Checkpoint] epoch: [31.0], Train: total:21368.14648, BCE:-19.41787, KLD:21387.56055,Test: total:83793.33594, BCE:-19.60857, KLD:83812.95312
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 8640, epoch 32.0)
score:  73.505
score:  66.39
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 8640, epoch 32.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [32.0], Train: total:21451.97656, BCE:-19.93883, KLD:21471.93750,Test: total:84172.07031, BCE:-20.10928, KLD:84192.17969
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 8910, epoch 33.0)
score:  75.96
score:  68.4
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 8910, epoch 33.0)
[Save Checkpoint] epoch: [33.0], Train: total:20987.57227, BCE:-20.30571, KLD:21007.86719,Test: total:82318.16406, BCE:-20.48151, KLD:82338.64062
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 9180, epoch 34.0)
score:  76.515
score:  69.16
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 9180, epoch 34.0)
[Save Checkpoint] epoch: [34.0], Train: total:20640.88281, BCE:-20.40184, KLD:20661.29102,Test: total:80988.28906, BCE:-20.56415, KLD:81008.85938
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 9450, epoch 35.0)
score:  76.85666666666667
score:  69.34
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 9450, epoch 35.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [35.0], Train: total:21093.50195, BCE:-20.39491, KLD:21113.88086,Test: total:82802.67969, BCE:-20.56011, KLD:82823.24219
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 9720, epoch 36.0)
score:  76.76
score:  69.09
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 9720, epoch 36.0)
[Save Checkpoint] epoch: [36.0], Train: total:21193.37305, BCE:-21.13389, KLD:21214.50195,Test: total:83126.86719, BCE:-21.27659, KLD:83148.14844
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 9990, epoch 37.0)
score:  76.69833333333334
score:  69.4
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 9990, epoch 37.0)
[Save Checkpoint] epoch: [37.0], Train: total:20453.47461, BCE:-21.43789, KLD:20474.90625,Test: total:80225.30469, BCE:-21.57903, KLD:80246.89062
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 10260, epoch 38.0)
score:  76.51166666666667
score:  68.99
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 10260, epoch 38.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [38.0], Train: total:19902.52734, BCE:-21.37815, KLD:19923.91406,Test: total:78140.34375, BCE:-21.49713, KLD:78161.85938
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 10530, epoch 39.0)
score:  79.48666666666666
score:  71.53
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 10530, epoch 39.0)
[Save Checkpoint] epoch: [39.0], Train: total:19786.46680, BCE:-21.75399, KLD:19808.21289,Test: total:77727.19531, BCE:-21.87164, KLD:77749.05469
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 10800, epoch 40.0)
score:  83.89
score:  74.86
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 10800, epoch 40.0)
[Save Checkpoint] epoch: [40.0], Train: total:20224.99805, BCE:-21.64536, KLD:20246.64258,Test: total:79313.85156, BCE:-21.74867, KLD:79335.58594
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 11070, epoch 41.0)
score:  84.52166666666666
score:  75.71
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 11070, epoch 41.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [41.0], Train: total:19722.61133, BCE:-22.21932, KLD:19744.81641,Test: total:77360.64844, BCE:-22.31726, KLD:77382.96094
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 11340, epoch 42.0)
score:  84.65166666666667
score:  75.82
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 11340, epoch 42.0)
[Save Checkpoint] epoch: [42.0], Train: total:19303.84570, BCE:-22.58091, KLD:19326.43359,Test: total:75728.98438, BCE:-22.68310, KLD:75751.66406
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 11610, epoch 43.0)
score:  84.72333333333333
score:  75.9
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 11610, epoch 43.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [43.0], Train: total:19068.56836, BCE:-22.43475, KLD:19091.01172,Test: total:74730.62500, BCE:-22.52367, KLD:74753.14844
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 11880, epoch 44.0)
score:  84.60166666666667
score:  75.85
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 11880, epoch 44.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [44.0], Train: total:19172.70508, BCE:-22.40580, KLD:19195.10938,Test: total:75238.30469, BCE:-22.49889, KLD:75260.80469
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 12150, epoch 45.0)
score:  84.60333333333334
score:  76.14
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 12150, epoch 45.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [45.0], Train: total:18778.93164, BCE:-22.85576, KLD:18801.78516,Test: total:73713.53906, BCE:-22.93428, KLD:73736.47656
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 12420, epoch 46.0)
score:  84.27666666666667
score:  75.62
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 12420, epoch 46.0)
[Save Checkpoint] epoch: [46.0], Train: total:18585.93945, BCE:-23.04839, KLD:18608.98633,Test: total:73025.60938, BCE:-23.11860, KLD:73048.71875
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 12690, epoch 47.0)
score:  84.43333333333334
score:  75.88
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 12690, epoch 47.0)
[Save Checkpoint] epoch: [47.0], Train: total:18476.32031, BCE:-22.97080, KLD:18499.29102,Test: total:72598.92188, BCE:-23.04252, KLD:72621.96094
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 12960, epoch 48.0)
score:  84.36833333333334
score:  75.82
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 12960, epoch 48.0)
[Save Checkpoint] epoch: [48.0], Train: total:18390.90820, BCE:-22.81100, KLD:18413.71484,Test: total:72186.58594, BCE:-22.87897, KLD:72209.46094
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 13230, epoch 49.0)
score:  84.40333333333334
score:  75.82
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 13230, epoch 49.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [49.0], Train: total:18177.46289, BCE:-23.37617, KLD:18200.83789,Test: total:71421.35938, BCE:-23.43125, KLD:71444.78906
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 13500, epoch 50.0)
score:  84.32166666666667
score:  75.73
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 13500, epoch 50.0)
[Save Checkpoint] epoch: [50.0], Train: total:18320.51953, BCE:-23.26246, KLD:18343.77734,Test: total:71936.17969, BCE:-23.31158, KLD:71959.49219
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 13770, epoch 51.0)
score:  83.99833333333333
score:  75.48
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 13770, epoch 51.0)
[Save Checkpoint] epoch: [51.0], Train: total:18088.91992, BCE:-23.57981, KLD:18112.49805,Test: total:71021.89844, BCE:-23.62109, KLD:71045.51562
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 14040, epoch 52.0)
score:  84.00833333333334
score:  75.42
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 14040, epoch 52.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [52.0], Train: total:17925.92969, BCE:-23.35660, KLD:17949.29102,Test: total:70364.71875, BCE:-23.37271, KLD:70388.09375
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 14310, epoch 53.0)
score:  84.00666666666666
score:  75.51
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 14310, epoch 53.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [53.0], Train: total:18055.06445, BCE:-23.38607, KLD:18078.44922,Test: total:70895.46094, BCE:-23.41752, KLD:70918.88281
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 14580, epoch 54.0)
score:  83.88166666666666
score:  75.53
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 14580, epoch 54.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [54.0], Train: total:17558.60547, BCE:-23.88233, KLD:17582.49414,Test: total:68885.72656, BCE:-23.90178, KLD:68909.63281
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 14850, epoch 55.0)
score:  83.86166666666666
score:  75.42
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 14850, epoch 55.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [55.0], Train: total:17636.74023, BCE:-23.85610, KLD:17660.59961,Test: total:69258.97656, BCE:-23.86546, KLD:69282.85156
Epoch    56: reducing learning rate of group 0 to 2.0000e-04.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 15120, epoch 56.0)
score:  83.87166666666667
score:  75.54
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 15120, epoch 56.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [56.0], Train: total:17493.56250, BCE:-23.97369, KLD:17517.54688,Test: total:68608.03125, BCE:-23.97050, KLD:68631.99219
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 15390, epoch 57.0)
score:  83.84166666666667
score:  75.56
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 15390, epoch 57.0)
[Save Checkpoint] epoch: [57.0], Train: total:17740.31836, BCE:-23.97290, KLD:17764.28516,Test: total:69637.42969, BCE:-23.97840, KLD:69661.39844
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 15660, epoch 58.0)
score:  83.74166666666666
score:  75.47
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 15660, epoch 58.0)
[Save Checkpoint] epoch: [58.0], Train: total:17716.06641, BCE:-24.26503, KLD:17740.32812,Test: total:69553.61719, BCE:-24.26593, KLD:69577.87500
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 15930, epoch 59.0)
score:  83.73166666666667
score:  75.39
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 15930, epoch 59.0)
[Save Checkpoint] epoch: [59.0], Train: total:17731.23828, BCE:-24.11841, KLD:17755.34570,Test: total:69621.86719, BCE:-24.11979, KLD:69645.99219
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 16200, epoch 60.0)
score:  83.69833333333334
score:  75.32
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 16200, epoch 60.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [60.0], Train: total:17745.36133, BCE:-24.11814, KLD:17769.48047,Test: total:69664.21094, BCE:-24.11332, KLD:69688.32812
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 16470, epoch 61.0)
score:  83.94833333333334
score:  75.59
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 16470, epoch 61.0)
[Save Checkpoint] epoch: [61.0], Train: total:17699.16992, BCE:-24.25033, KLD:17723.41211,Test: total:69513.95312, BCE:-24.24243, KLD:69538.19531
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 16740, epoch 62.0)
score:  83.83833333333334
score:  75.41
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 16740, epoch 62.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [62.0], Train: total:17600.87695, BCE:-24.13751, KLD:17625.01562,Test: total:69130.99219, BCE:-24.13246, KLD:69155.11719
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 17010, epoch 63.0)
score:  83.86333333333333
score:  75.42
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 17010, epoch 63.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [63.0], Train: total:17746.07617, BCE:-24.25804, KLD:17770.33594,Test: total:69704.49219, BCE:-24.24253, KLD:69728.74219
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 17280, epoch 64.0)
score:  83.805
score:  75.38
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 17280, epoch 64.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [64.0], Train: total:17593.31836, BCE:-24.10455, KLD:17617.42188,Test: total:69091.25781, BCE:-24.09179, KLD:69115.35156
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 17550, epoch 65.0)
score:  83.76166666666667
score:  75.37
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 17550, epoch 65.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [65.0], Train: total:17656.16016, BCE:-24.17789, KLD:17680.33398,Test: total:69317.82031, BCE:-24.16334, KLD:69341.98438
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 17820, epoch 66.0)
score:  83.77166666666666
score:  75.41
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 17820, epoch 66.0)
[Save Checkpoint] epoch: [66.0], Train: total:17636.76758, BCE:-24.20328, KLD:17660.96875,Test: total:69267.64844, BCE:-24.18239, KLD:69291.83594
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 18090, epoch 67.0)
score:  83.81166666666667
score:  75.5
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 18090, epoch 67.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [67.0], Train: total:17453.47461, BCE:-24.12637, KLD:17477.60352,Test: total:68536.38281, BCE:-24.11057, KLD:68560.50000
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 18360, epoch 68.0)
score:  83.65
score:  75.37
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 18360, epoch 68.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [68.0], Train: total:17542.25195, BCE:-24.11102, KLD:17566.35938,Test: total:68851.07031, BCE:-24.08895, KLD:68875.16406
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 18630, epoch 69.0)
score:  83.68666666666667
score:  75.42
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 18630, epoch 69.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [69.0], Train: total:17636.49219, BCE:-24.05820, KLD:17660.54688,Test: total:69204.71094, BCE:-24.03831, KLD:69228.74219
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 18900, epoch 70.0)
score:  83.715
score:  75.31
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 18900, epoch 70.0)
[Save Checkpoint] epoch: [70.0], Train: total:17555.12305, BCE:-24.10945, KLD:17579.23828,Test: total:68928.85938, BCE:-24.09027, KLD:68952.94531
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 19170, epoch 71.0)
score:  83.80166666666666
score:  75.48
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 19170, epoch 71.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [71.0], Train: total:17504.41797, BCE:-24.08778, KLD:17528.49219,Test: total:68735.72656, BCE:-24.06736, KLD:68759.78906
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 19440, epoch 72.0)
score:  83.805
score:  75.53
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 19440, epoch 72.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [72.0], Train: total:17643.01172, BCE:-24.14335, KLD:17667.15625,Test: total:69286.27344, BCE:-24.11317, KLD:69310.38281
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 19710, epoch 73.0)
score:  83.63166666666666
score:  75.39
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 19710, epoch 73.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [73.0], Train: total:17560.83008, BCE:-24.13415, KLD:17584.96289,Test: total:68968.56250, BCE:-24.10419, KLD:68992.66406
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 19980, epoch 74.0)
score:  83.765
score:  75.41
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 19980, epoch 74.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [74.0], Train: total:17620.43164, BCE:-24.20212, KLD:17644.62695,Test: total:69151.46875, BCE:-24.16360, KLD:69175.63281
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 20250, epoch 75.0)
score:  83.67333333333333
score:  75.39
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 20250, epoch 75.0)
[Save Checkpoint] epoch: [75.0], Train: total:17556.21289, BCE:-24.08246, KLD:17580.29688,Test: total:68916.35938, BCE:-24.05021, KLD:68940.39844
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 20520, epoch 76.0)
score:  83.78833333333333
score:  75.47
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 20520, epoch 76.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [76.0], Train: total:17540.12695, BCE:-24.20385, KLD:17564.33008,Test: total:68891.57031, BCE:-24.17139, KLD:68915.74219
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 20790, epoch 77.0)
score:  83.66833333333334
score:  75.41
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 20790, epoch 77.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [77.0], Train: total:17460.08203, BCE:-24.23636, KLD:17484.31836,Test: total:68615.11719, BCE:-24.19819, KLD:68639.32812
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 21060, epoch 78.0)
score:  83.61666666666666
score:  75.37
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 21060, epoch 78.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [78.0], Train: total:17404.24609, BCE:-24.15399, KLD:17428.39062,Test: total:68285.63281, BCE:-24.11375, KLD:68309.74219
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 21330, epoch 79.0)
score:  83.68833333333333
score:  75.5
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 21330, epoch 79.0)
[Save Checkpoint] epoch: [79.0], Train: total:17475.57617, BCE:-24.18198, KLD:17499.75977,Test: total:68576.05469, BCE:-24.14083, KLD:68600.20312
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 21600, epoch 80.0)
score:  83.545
score:  75.29
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 21600, epoch 80.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [80.0], Train: total:17464.18750, BCE:-24.25203, KLD:17488.42578,Test: total:68533.61719, BCE:-24.20528, KLD:68557.82031
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 21870, epoch 81.0)
score:  83.70833333333333
score:  75.44
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 21870, epoch 81.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [81.0], Train: total:17433.03711, BCE:-24.24840, KLD:17457.27930,Test: total:68449.15625, BCE:-24.20208, KLD:68473.35938
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 22140, epoch 82.0)
score:  83.64166666666667
score:  75.53
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 22140, epoch 82.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [82.0], Train: total:17390.77148, BCE:-24.19011, KLD:17414.96094,Test: total:68266.39062, BCE:-24.14045, KLD:68290.53125
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 22410, epoch 83.0)
score:  83.67166666666667
score:  75.54
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 22410, epoch 83.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [83.0], Train: total:17468.45508, BCE:-24.16354, KLD:17492.61523,Test: total:68570.01562, BCE:-24.11275, KLD:68594.12500
Epoch    84: reducing learning rate of group 0 to 4.0000e-05.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 22680, epoch 84.0)
score:  83.775
score:  75.58
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 22680, epoch 84.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [84.0], Train: total:17351.66992, BCE:-24.24109, KLD:17375.90625,Test: total:68122.30469, BCE:-24.19084, KLD:68146.49219
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 22950, epoch 85.0)
score:  83.645
score:  75.51
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 22950, epoch 85.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [85.0], Train: total:17361.64453, BCE:-24.09710, KLD:17385.73828,Test: total:68175.04688, BCE:-24.06706, KLD:68199.10938
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 23220, epoch 86.0)
score:  83.62666666666667
score:  75.51
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 23220, epoch 86.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [86.0], Train: total:17352.93750, BCE:-24.17350, KLD:17377.10938,Test: total:68168.53906, BCE:-24.14046, KLD:68192.67969
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 23490, epoch 87.0)
score:  83.7
score:  75.55
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 23490, epoch 87.0)
EarlyStopping counter: 8 out of 25
[Save Checkpoint] epoch: [87.0], Train: total:17391.62109, BCE:-24.10840, KLD:17415.72852,Test: total:68312.48438, BCE:-24.07812, KLD:68336.56250
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 23760, epoch 88.0)
score:  83.69
score:  75.42
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 23760, epoch 88.0)
[Save Checkpoint] epoch: [88.0], Train: total:17360.30078, BCE:-24.11446, KLD:17384.40820,Test: total:68195.42188, BCE:-24.08150, KLD:68219.50000
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 24030, epoch 89.0)
score:  83.665
score:  75.53
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 24030, epoch 89.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [89.0], Train: total:17349.91211, BCE:-24.06074, KLD:17373.96875,Test: total:68132.80469, BCE:-24.02958, KLD:68156.83594
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 24300, epoch 90.0)
score:  83.62833333333333
score:  75.43
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 24300, epoch 90.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [90.0], Train: total:17396.40430, BCE:-24.14962, KLD:17420.54883,Test: total:68332.27344, BCE:-24.11437, KLD:68356.38281
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 24570, epoch 91.0)
score:  83.63333333333334
score:  75.48
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 24570, epoch 91.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [91.0], Train: total:17369.16602, BCE:-24.08905, KLD:17393.25195,Test: total:68222.91406, BCE:-24.05562, KLD:68246.97656
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 24840, epoch 92.0)
score:  83.64166666666667
score:  75.52
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 24840, epoch 92.0)
[Save Checkpoint] epoch: [92.0], Train: total:17368.45508, BCE:-24.10690, KLD:17392.55859,Test: total:68219.56250, BCE:-24.07566, KLD:68243.64844
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 25110, epoch 93.0)
score:  83.64
score:  75.42
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 25110, epoch 93.0)
[Save Checkpoint] epoch: [93.0], Train: total:17384.31250, BCE:-24.16415, KLD:17408.47461,Test: total:68286.60156, BCE:-24.12849, KLD:68310.73438
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 25380, epoch 94.0)
score:  83.675
score:  75.56
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 25380, epoch 94.0)
[Save Checkpoint] epoch: [94.0], Train: total:17320.41602, BCE:-24.13650, KLD:17344.54492,Test: total:68029.09375, BCE:-24.10210, KLD:68053.20312
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 25650, epoch 95.0)
score:  83.72166666666666
score:  75.58
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 25650, epoch 95.0)
[Save Checkpoint] epoch: [95.0], Train: total:17330.07617, BCE:-24.14777, KLD:17354.22266,Test: total:68077.40625, BCE:-24.11139, KLD:68101.51562
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 25920, epoch 96.0)
score:  83.66833333333334
score:  75.56
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 25920, epoch 96.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [96.0], Train: total:17375.79297, BCE:-24.10579, KLD:17399.89844,Test: total:68250.31250, BCE:-24.06931, KLD:68274.39062
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 26190, epoch 97.0)
score:  83.665
score:  75.56
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 26190, epoch 97.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [97.0], Train: total:17368.44727, BCE:-24.16352, KLD:17392.60352,Test: total:68227.75000, BCE:-24.12859, KLD:68251.87500
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 26460, epoch 98.0)
score:  83.65
score:  75.56
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 26460, epoch 98.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [98.0], Train: total:17362.17773, BCE:-24.15311, KLD:17386.32227,Test: total:68185.14844, BCE:-24.11594, KLD:68209.26562
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 26730, epoch 99.0)
score:  83.59
score:  75.5
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 26730, epoch 99.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [99.0], Train: total:17379.11914, BCE:-24.15716, KLD:17403.28320,Test: total:68261.66406, BCE:-24.12123, KLD:68285.78125
Epoch   100: reducing learning rate of group 0 to 8.0000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 27000, epoch 100.0)
score:  83.615
score:  75.49
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_2_2/last' (iter 27000, epoch 100.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [100.0], Train: total:17325.14844, BCE:-24.13603, KLD:17349.28711,Test: total:68042.80469, BCE:-24.09844, KLD:68066.90625
[Training Finished]
All done !
