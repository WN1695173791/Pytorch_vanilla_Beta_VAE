6
--gpu_devices 0 --max_iter 100 --batch_size 250 --use_scheduler True --lr 1e-3 --GMP True --z_struct_size 15 --z_var_size 10 --is_VAE True --is_encoder_struct False --lambda_BCE 1 --beta 1 --lambda_recons 0.1 --lambda_EV_class 1 --big_kernel_size 8 --two_conv_layer True --three_conv_layer True --kernel_size_1 4 --kernel_size_2 4 --kernel_size_3 4 --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 64 --hidden_filters_layer2 64 --hidden_filters_layer3 64 --dataset_balanced True --binary_z True --binary_first_conv False --binary_second_conv False --binary_third_conv True --use_small_lr_encoder_var False --encoder_var_name None --encoder_struct_name mnist_ES_binary_15 --freeze_Encoder True --EV_classifier True --freeze_Encoder True --grad_inv True --exp_name mnist_VAE_s15_v10_class_inv_grad_4
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, ES_reconstruction=False, EV_classifier=True, GMP=True, Hmg_dst_loss=False, IPC=False, L1_norm_act=False, L1_norm_weights=False, L2_dst_loss=False, L3_without_random=False, LOG_DIR='logs', PT_model=False, PT_model_EV_classifier=False, adapt_lr=False, add_classification_layer=True, add_dl_class=False, add_linear_after_GMP=True, add_z_struct_bottleneck=False, alpha=32, batch_size=250, beta=1.0, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=8, bin_after_GMP=False, binary_chain=False, binary_first_conv=False, binary_second_conv=False, binary_third_conv=True, binary_z=True, both_decoders_freeze=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, contrastive_loss=False, cuda=True, dataset='mnist', dataset_balanced=True, decoder_first_dense=36, decoder_kernel_size_1=4, decoder_kernel_size_2=3, decoder_kernel_size_3=4, decoder_n_filter_1=64, decoder_n_filter_2=64, decoder_n_filter_3=64, decoder_stride_1=2, decoder_stride_2=2, decoder_stride_3=1, diff_var=False, display_step=10000, dset_dir='data', encoder_struct_name='mnist_ES_binary_15', encoder_var_name='None', exp_name='mnist_VAE_s15_v10_class_inv_grad_4', freeze_Encoder=True, gamma=1000, gpu_devices=[0], grad_inv=True, hidden_dim=20, hidden_filters_layer1=64, hidden_filters_layer2=64, hidden_filters_layer3=64, image_size=64, intra_class_variance_loss=False, is_C=True, is_E1=False, is_VAE=True, is_VAE_var=False, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=False, is_default_model=False, is_encoder_struct=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, kernel_size_1=4, kernel_size_2=4, kernel_size_3=4, lambda_BCE=1.0, lambda_EV_class=1.0, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_L2_dst=1, lambda_VAE=1, lambda_class=1, lambda_contrastive_loss=1, lambda_distance_mean=1, lambda_hmg_dst=1, lambda_intra_class_var=1, lambda_partial_class=1, lambda_ratio_reg=1, lambda_recon_wt_rand=1, lambda_recons=0.1, lambda_uniq_code_dst=1, lambda_var_distance=1, lambda_var_inter=1, lambda_var_intra=1, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', loss='Proxy_Anchor', loss_distance_mean=False, loss_min_distance_cl=False, lr=0.001, max_epoch_use_uniq_code_target=5, max_iter=100.0, model='CNN', mrg=0.1, nb_epochs_train_only_zvar=0, num_workers=2, old_weighted=False, optimizer='adamw', other_architecture=False, other_ratio=False, random_percentage=0.2, random_seed=10, randomness=True, ratio_reg=False, remark='', save_step=10000, second_layer_C=False, seed=1, stride_size=1, sz_embedding=5, three_conv_layer=True, train=True, train_var_struct_alternatively=False, two_conv_layer=True, two_encoder=False, uniq_code_dst_loss=False, use_VAE=False, use_decoder=False, use_early_stopping=True, use_scheduler=True, use_small_lr_encoder_var=False, use_structural_encoder=False, value_target_distance_mean=1, var_hidden_dim=256, var_hidden_filters_1=32, var_hidden_filters_2=32, var_hidden_filters_3=32, var_kernel_size_1=3, var_kernel_size_2=3, var_kernel_size_3=3, var_second_cnn_block=True, var_stride_size_1=1, var_stride_size_2=1, var_stride_size_3=1, var_third_cnn_block=False, var_three_conv_layer=False, warm=1, without_acc=False, z_struct_size=15, z_var_size=10, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
[Using Seed: 10]
Balanced dataset loaded
VAE doesn't exist but encoder struct yes ! load struct encoder weighs !
=> loaded checkpoint 'checkpoints_CNN/mnist_ES_binary_15/last (iter 22410)'
Weighs loaded for struct encoder !
use 1 gpu who named: Tesla V100-SXM2-32GB
VAE(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
  )
  (decoder): Sequential(
    (0): Linear(in_features=25, out_features=1600, bias=True)
    (1): ReLU(inplace=True)
    (2): View()
    (3): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (4): ReLU(inplace=True)
    (5): ConvTranspose2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (6): ReLU(inplace=True)
    (7): ConvTranspose2d(64, 32, kernel_size=(3, 3), stride=(1, 1))
    (8): ReLU(inplace=True)
    (9): ConvTranspose2d(32, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (10): ReLU(inplace=True)
    (11): ConvTranspose2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (12): ReLU(inplace=True)
    (13): ConvTranspose2d(32, 1, kernel_size=(3, 3), stride=(1, 1))
    (14): Sigmoid()
  )
  (encoder_var): Sequential(
    (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (4): ReLU(inplace=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Conv2d(32, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (7): ReLU(inplace=True)
    (8): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): Dropout(p=0.4, inplace=False)
    (10): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
    (11): ReLU(inplace=True)
    (12): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (13): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (14): ReLU(inplace=True)
    (15): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Conv2d(64, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (17): ReLU(inplace=True)
    (18): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (19): Dropout(p=0.4, inplace=False)
    (20): View()
    (21): Linear(in_features=1600, out_features=20, bias=True)
  )
  (var_classifier): Sequential(
    (0): RevGrad()
    (1): Linear(in_features=10, out_features=10, bias=True)
  )
)
The number of parameters of model is 499760
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 270, epoch 1.0)
score:  38.17
score:  35.93
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 270, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train: total:5072.15088, BCE:-17.37022, KLD:5089.51807,Test: total:20332.24805, BCE:-17.45291, KLD:20349.70312
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 540, epoch 2.0)
score:  53.72833333333333
score:  49.07
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 540, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train: total:4780.05469, BCE:-18.30708, KLD:4798.36182,Test: total:19159.29883, BCE:-18.36851, KLD:19177.66992
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 810, epoch 3.0)
score:  64.59
score:  58.12
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 810, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train: total:4869.80420, BCE:-14.74793, KLD:4884.55127,Test: total:19501.25977, BCE:-14.79508, KLD:19516.05273
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 1080, epoch 4.0)
score:  71.43333333333334
score:  64.36
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 1080, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train: total:4921.55664, BCE:-16.28817, KLD:4937.84570,Test: total:19683.82617, BCE:-16.32240, KLD:19700.15039
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 1350, epoch 5.0)
score:  74.41833333333334
score:  67.26
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 1350, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train: total:4969.37061, BCE:-16.55857, KLD:4985.93066,Test: total:19826.77148, BCE:-16.60437, KLD:19843.37695
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 1620, epoch 6.0)
score:  75.56833333333333
score:  68.34
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 1620, epoch 6.0)
[Save Checkpoint] epoch: [6.0], Train: total:4976.94775, BCE:-15.95179, KLD:4992.90088,Test: total:19861.25586, BCE:-15.99030, KLD:19877.24805
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 1890, epoch 7.0)
score:  76.52666666666667
score:  69.22
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 1890, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train: total:4981.38623, BCE:-15.13811, KLD:4996.52393,Test: total:19891.33398, BCE:-15.22333, KLD:19906.56055
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 2160, epoch 8.0)
score:  78.17666666666666
score:  70.58
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 2160, epoch 8.0)
[Save Checkpoint] epoch: [8.0], Train: total:4985.63770, BCE:-12.71026, KLD:4998.35010,Test: total:19888.02734, BCE:-12.81141, KLD:19900.83789
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 2430, epoch 9.0)
score:  78.76333333333334
score:  71.22
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 2430, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train: total:5086.22266, BCE:-14.11460, KLD:5100.34033,Test: total:20286.01367, BCE:-14.24698, KLD:20300.26367
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 2700, epoch 10.0)
score:  79.015
score:  71.31
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 2700, epoch 10.0)
[Save Checkpoint] epoch: [10.0], Train: total:5084.41455, BCE:-14.25337, KLD:5098.67090,Test: total:20270.85547, BCE:-14.39691, KLD:20285.25195
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 2970, epoch 11.0)
score:  79.47166666666666
score:  71.62
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 2970, epoch 11.0)
[Save Checkpoint] epoch: [11.0], Train: total:5094.45215, BCE:-14.86442, KLD:5109.31494,Test: total:20311.44727, BCE:-15.04855, KLD:20326.49805
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 3240, epoch 12.0)
score:  79.64166666666667
score:  72.09
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 3240, epoch 12.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [12.0], Train: total:5108.31299, BCE:-14.92768, KLD:5123.23926,Test: total:20361.01758, BCE:-15.15563, KLD:20376.17578
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 3510, epoch 13.0)
score:  79.61666666666666
score:  72.05
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 3510, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train: total:5091.93164, BCE:-15.07841, KLD:5107.01172,Test: total:20284.15820, BCE:-15.31252, KLD:20299.47266
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 3780, epoch 14.0)
score:  79.75333333333333
score:  72.21
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 3780, epoch 14.0)
[Save Checkpoint] epoch: [14.0], Train: total:5073.71924, BCE:-15.76451, KLD:5089.48682,Test: total:20222.92969, BCE:-16.01354, KLD:20238.94336
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 4050, epoch 15.0)
score:  79.80166666666666
score:  72.06
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 4050, epoch 15.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [15.0], Train: total:5065.83984, BCE:-16.42156, KLD:5082.26074,Test: total:20191.59180, BCE:-16.69004, KLD:20208.28320
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 4320, epoch 16.0)
score:  79.67833333333333
score:  72.08
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 4320, epoch 16.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [16.0], Train: total:5044.37842, BCE:-17.10124, KLD:5061.47998,Test: total:20094.97070, BCE:-17.41369, KLD:20112.38477
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 4590, epoch 17.0)
score:  79.46833333333333
score:  72.57
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 4590, epoch 17.0)
[Save Checkpoint] epoch: [17.0], Train: total:5031.74268, BCE:-17.11479, KLD:5048.85938,Test: total:20037.22070, BCE:-17.41566, KLD:20054.63672
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 4860, epoch 18.0)
score:  79.44
score:  71.79
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 4860, epoch 18.0)
[Save Checkpoint] epoch: [18.0], Train: total:5002.06738, BCE:-18.27302, KLD:5020.34375,Test: total:19929.44531, BCE:-18.60365, KLD:19948.05078
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 5130, epoch 19.0)
score:  79.46666666666667
score:  71.53
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 5130, epoch 19.0)
[Save Checkpoint] epoch: [19.0], Train: total:5015.62695, BCE:-18.10559, KLD:5033.73438,Test: total:19982.09375, BCE:-18.43648, KLD:20000.53320
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 5400, epoch 20.0)
score:  78.98166666666667
score:  71.55
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 5400, epoch 20.0)
[Save Checkpoint] epoch: [20.0], Train: total:5064.02783, BCE:-18.88022, KLD:5082.90967,Test: total:20165.92969, BCE:-19.18404, KLD:20185.11328
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 5670, epoch 21.0)
score:  79.055
score:  71.02
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 5670, epoch 21.0)
[Save Checkpoint] epoch: [21.0], Train: total:5082.43262, BCE:-19.54511, KLD:5101.97607,Test: total:20235.91406, BCE:-19.86778, KLD:20255.78125
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 5940, epoch 22.0)
score:  78.72666666666667
score:  70.91
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 5940, epoch 22.0)
[Save Checkpoint] epoch: [22.0], Train: total:5029.32812, BCE:-19.74750, KLD:5049.07617,Test: total:20031.90820, BCE:-20.06435, KLD:20051.97266
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 6210, epoch 23.0)
score:  78.91333333333333
score:  71.43
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 6210, epoch 23.0)
[Save Checkpoint] epoch: [23.0], Train: total:5004.26855, BCE:-20.69409, KLD:5024.96191,Test: total:19930.13867, BCE:-21.02282, KLD:19951.16211
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 6480, epoch 24.0)
score:  78.69666666666667
score:  70.89
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 6480, epoch 24.0)
[Save Checkpoint] epoch: [24.0], Train: total:5023.24316, BCE:-21.29491, KLD:5044.53809,Test: total:19997.91992, BCE:-21.60080, KLD:20019.52344
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 6750, epoch 25.0)
score:  78.18333333333334
score:  70.62
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 6750, epoch 25.0)
[Save Checkpoint] epoch: [25.0], Train: total:5049.86768, BCE:-21.79106, KLD:5071.66260,Test: total:20113.09180, BCE:-22.06762, KLD:20135.16016
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 7020, epoch 26.0)
score:  78.605
score:  70.75
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 7020, epoch 26.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [26.0], Train: total:4996.34326, BCE:-21.81512, KLD:5018.16016,Test: total:19911.95117, BCE:-22.11526, KLD:19934.06836
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 7290, epoch 27.0)
score:  78.29666666666667
score:  70.58
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 7290, epoch 27.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [27.0], Train: total:5072.05811, BCE:-22.00321, KLD:5094.06104,Test: total:20168.04492, BCE:-22.28592, KLD:20190.32812
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 7560, epoch 28.0)
score:  77.85
score:  70.41
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 7560, epoch 28.0)
[Save Checkpoint] epoch: [28.0], Train: total:5033.38135, BCE:-22.82470, KLD:5056.20654,Test: total:20041.28516, BCE:-23.11110, KLD:20064.39453
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 7830, epoch 29.0)
score:  77.7
score:  69.83
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 7830, epoch 29.0)
[Save Checkpoint] epoch: [29.0], Train: total:5004.16602, BCE:-22.88152, KLD:5027.05176,Test: total:19904.87500, BCE:-23.15418, KLD:19928.02930
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 8100, epoch 30.0)
score:  77.64833333333333
score:  70.0
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 8100, epoch 30.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [30.0], Train: total:5022.63184, BCE:-22.91793, KLD:5045.55176,Test: total:19995.76953, BCE:-23.18544, KLD:20018.95312
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 8370, epoch 31.0)
score:  77.16
score:  69.97
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 8370, epoch 31.0)
[Save Checkpoint] epoch: [31.0], Train: total:4975.33398, BCE:-23.19566, KLD:4998.53125,Test: total:19797.57617, BCE:-23.44413, KLD:19821.01758
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 8640, epoch 32.0)
score:  77.07666666666667
score:  69.59
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 8640, epoch 32.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [32.0], Train: total:4945.82910, BCE:-23.25431, KLD:4969.08252,Test: total:19673.10352, BCE:-23.49531, KLD:19696.59766
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 8910, epoch 33.0)
score:  76.82833333333333
score:  69.11
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 8910, epoch 33.0)
[Save Checkpoint] epoch: [33.0], Train: total:4923.26025, BCE:-23.64421, KLD:4946.90381,Test: total:19591.95703, BCE:-23.87887, KLD:19615.83398
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 9180, epoch 34.0)
score:  77.295
score:  69.79
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 9180, epoch 34.0)
[Save Checkpoint] epoch: [34.0], Train: total:4970.78809, BCE:-23.61158, KLD:4994.39990,Test: total:19785.22461, BCE:-23.82228, KLD:19809.04492
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 9450, epoch 35.0)
score:  76.81833333333333
score:  68.84
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 9450, epoch 35.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [35.0], Train: total:4964.06787, BCE:-23.67580, KLD:4987.74414,Test: total:19760.82227, BCE:-23.91233, KLD:19784.73633
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 9720, epoch 36.0)
score:  76.55
score:  68.93
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 9720, epoch 36.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [36.0], Train: total:4911.32910, BCE:-23.74568, KLD:4935.07373,Test: total:19529.96289, BCE:-23.95648, KLD:19553.91992
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 9990, epoch 37.0)
score:  76.25666666666666
score:  68.99
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 9990, epoch 37.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [37.0], Train: total:4956.17432, BCE:-23.99805, KLD:4980.17285,Test: total:19723.38672, BCE:-24.19258, KLD:19747.57812
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 10260, epoch 38.0)
score:  76.12833333333333
score:  68.7
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 10260, epoch 38.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [38.0], Train: total:4888.44727, BCE:-23.71074, KLD:4912.15967,Test: total:19441.74805, BCE:-23.91112, KLD:19465.65820
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 10530, epoch 39.0)
score:  76.26666666666667
score:  69.0
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 10530, epoch 39.0)
[Save Checkpoint] epoch: [39.0], Train: total:4888.62158, BCE:-24.42326, KLD:4913.04395,Test: total:19447.34961, BCE:-24.61932, KLD:19471.96680
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 10800, epoch 40.0)
score:  76.105
score:  68.94
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 10800, epoch 40.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [40.0], Train: total:4965.98193, BCE:-24.55575, KLD:4990.54102,Test: total:19741.73242, BCE:-24.73293, KLD:19766.46680
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 11070, epoch 41.0)
score:  75.845
score:  68.54
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 11070, epoch 41.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [41.0], Train: total:4957.84473, BCE:-24.37661, KLD:4982.22168,Test: total:19708.91211, BCE:-24.54654, KLD:19733.45898
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 11340, epoch 42.0)
score:  75.42166666666667
score:  67.88
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 11340, epoch 42.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [42.0], Train: total:4924.11377, BCE:-24.45120, KLD:4948.56836,Test: total:19577.27344, BCE:-24.63155, KLD:19601.90430
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 11610, epoch 43.0)
score:  75.685
score:  68.19
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 11610, epoch 43.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [43.0], Train: total:4982.05615, BCE:-24.48693, KLD:5006.53906,Test: total:19820.89648, BCE:-24.67215, KLD:19845.57031
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 11880, epoch 44.0)
score:  75.21166666666667
score:  68.05
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 11880, epoch 44.0)
[Save Checkpoint] epoch: [44.0], Train: total:4919.03662, BCE:-24.22883, KLD:4943.26660,Test: total:19564.40234, BCE:-24.38686, KLD:19588.78711
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 12150, epoch 45.0)
score:  74.915
score:  67.79
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 12150, epoch 45.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [45.0], Train: total:4926.44775, BCE:-24.18196, KLD:4950.62939,Test: total:19574.68555, BCE:-24.34579, KLD:19599.03125
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 12420, epoch 46.0)
score:  74.80333333333333
score:  67.56
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 12420, epoch 46.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [46.0], Train: total:4907.34863, BCE:-24.59635, KLD:4931.94580,Test: total:19518.14648, BCE:-24.74801, KLD:19542.89258
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 12690, epoch 47.0)
score:  74.70833333333333
score:  67.44
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 12690, epoch 47.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [47.0], Train: total:4922.41357, BCE:-24.66525, KLD:4947.08008,Test: total:19552.26953, BCE:-24.82632, KLD:19577.09766
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 12960, epoch 48.0)
score:  74.32
score:  67.09
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 12960, epoch 48.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [48.0], Train: total:4898.28613, BCE:-24.83751, KLD:4923.12451,Test: total:19477.37500, BCE:-24.99449, KLD:19502.37109
Epoch    49: reducing learning rate of group 0 to 2.0000e-04.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 13230, epoch 49.0)
score:  74.605
score:  67.17
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 13230, epoch 49.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [49.0], Train: total:4908.97998, BCE:-24.50775, KLD:4933.48730,Test: total:19510.81055, BCE:-24.65728, KLD:19535.46680
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 13500, epoch 50.0)
score:  74.405
score:  66.8
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 13500, epoch 50.0)
[Save Checkpoint] epoch: [50.0], Train: total:4898.60205, BCE:-24.43626, KLD:4923.03906,Test: total:19465.19922, BCE:-24.61252, KLD:19489.81250
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 13770, epoch 51.0)
score:  74.30666666666667
score:  67.29
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 13770, epoch 51.0)
[Save Checkpoint] epoch: [51.0], Train: total:4905.74707, BCE:-24.54351, KLD:4930.29004,Test: total:19494.99414, BCE:-24.71049, KLD:19519.70312
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 14040, epoch 52.0)
score:  74.215
score:  67.06
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 14040, epoch 52.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [52.0], Train: total:4896.11328, BCE:-24.55071, KLD:4920.66602,Test: total:19461.94141, BCE:-24.69720, KLD:19486.64062
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 14310, epoch 53.0)
score:  74.30333333333333
score:  66.97
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 14310, epoch 53.0)
[Save Checkpoint] epoch: [53.0], Train: total:4912.32471, BCE:-24.47155, KLD:4936.79346,Test: total:19522.20312, BCE:-24.61992, KLD:19546.82422
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 14580, epoch 54.0)
score:  74.03833333333333
score:  66.87
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 14580, epoch 54.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [54.0], Train: total:4913.75049, BCE:-24.67545, KLD:4938.42578,Test: total:19528.68945, BCE:-24.83869, KLD:19553.52539
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 14850, epoch 55.0)
score:  74.03333333333333
score:  66.95
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 14850, epoch 55.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [55.0], Train: total:4908.10938, BCE:-24.51795, KLD:4932.62695,Test: total:19506.37109, BCE:-24.64847, KLD:19531.01953
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 15120, epoch 56.0)
score:  74.00666666666666
score:  67.19
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 15120, epoch 56.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [56.0], Train: total:4916.44971, BCE:-24.66690, KLD:4941.11377,Test: total:19540.00000, BCE:-24.80671, KLD:19564.80664
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 15390, epoch 57.0)
score:  74.185
score:  67.41
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 15390, epoch 57.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [57.0], Train: total:4920.99658, BCE:-24.65792, KLD:4945.65283,Test: total:19558.08203, BCE:-24.81180, KLD:19582.89453
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 15660, epoch 58.0)
score:  73.89666666666666
score:  66.84
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 15660, epoch 58.0)
[Save Checkpoint] epoch: [58.0], Train: total:4910.27832, BCE:-24.71700, KLD:4934.99805,Test: total:19523.40430, BCE:-24.85711, KLD:19548.26367
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 15930, epoch 59.0)
score:  73.85166666666667
score:  66.82
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 15930, epoch 59.0)
[Save Checkpoint] epoch: [59.0], Train: total:4929.45801, BCE:-24.59264, KLD:4954.05273,Test: total:19586.76953, BCE:-24.73487, KLD:19611.50586
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 16200, epoch 60.0)
score:  73.89833333333333
score:  66.93
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 16200, epoch 60.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [60.0], Train: total:4921.18213, BCE:-24.72241, KLD:4945.90527,Test: total:19550.82422, BCE:-24.83601, KLD:19575.66016
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 16470, epoch 61.0)
score:  73.62333333333333
score:  66.53
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 16470, epoch 61.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [61.0], Train: total:4920.68457, BCE:-24.78222, KLD:4945.46436,Test: total:19556.77539, BCE:-24.90928, KLD:19581.68555
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 16740, epoch 62.0)
score:  73.615
score:  66.43
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 16740, epoch 62.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [62.0], Train: total:4886.72217, BCE:-24.85117, KLD:4911.57422,Test: total:19416.81055, BCE:-24.99401, KLD:19441.80469
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 17010, epoch 63.0)
score:  73.56833333333333
score:  65.98
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 17010, epoch 63.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [63.0], Train: total:4904.01611, BCE:-24.63096, KLD:4928.64648,Test: total:19483.85547, BCE:-24.76206, KLD:19508.61914
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 17280, epoch 64.0)
score:  73.59
score:  66.25
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 17280, epoch 64.0)
[Save Checkpoint] epoch: [64.0], Train: total:4920.51855, BCE:-24.73232, KLD:4945.25098,Test: total:19546.32812, BCE:-24.85208, KLD:19571.17773
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 17550, epoch 65.0)
score:  73.64333333333333
score:  66.57
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 17550, epoch 65.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [65.0], Train: total:4912.11377, BCE:-24.70816, KLD:4936.82080,Test: total:19516.21680, BCE:-24.83777, KLD:19541.05273
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 17820, epoch 66.0)
score:  73.64333333333333
score:  66.66
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 17820, epoch 66.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [66.0], Train: total:4904.82227, BCE:-24.66197, KLD:4929.48096,Test: total:19489.21289, BCE:-24.79262, KLD:19514.00586
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 18090, epoch 67.0)
score:  73.555
score:  66.67
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 18090, epoch 67.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [67.0], Train: total:4924.04541, BCE:-24.84346, KLD:4948.89014,Test: total:19560.84961, BCE:-24.96654, KLD:19585.81641
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 18360, epoch 68.0)
score:  73.28833333333333
score:  66.35
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 18360, epoch 68.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [68.0], Train: total:4915.58447, BCE:-24.79432, KLD:4940.37744,Test: total:19528.85742, BCE:-24.91491, KLD:19553.77148
Epoch    69: reducing learning rate of group 0 to 4.0000e-05.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 18630, epoch 69.0)
score:  73.20333333333333
score:  66.65
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 18630, epoch 69.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [69.0], Train: total:4889.14844, BCE:-24.89403, KLD:4914.04053,Test: total:19420.73633, BCE:-25.02805, KLD:19445.76367
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 18900, epoch 70.0)
score:  73.3
score:  65.98
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 18900, epoch 70.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [70.0], Train: total:4903.48096, BCE:-24.81740, KLD:4928.30127,Test: total:19482.67188, BCE:-24.95338, KLD:19507.62695
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 19170, epoch 71.0)
score:  73.33666666666667
score:  66.56
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 19170, epoch 71.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [71.0], Train: total:4903.83301, BCE:-24.83015, KLD:4928.66016,Test: total:19486.28711, BCE:-24.97676, KLD:19511.26367
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 19440, epoch 72.0)
score:  73.175
score:  66.35
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 19440, epoch 72.0)
[Save Checkpoint] epoch: [72.0], Train: total:4897.34912, BCE:-24.74551, KLD:4922.09229,Test: total:19456.69141, BCE:-24.89715, KLD:19481.58789
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 19710, epoch 73.0)
score:  73.19
score:  65.87
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 19710, epoch 73.0)
[Save Checkpoint] epoch: [73.0], Train: total:4902.01904, BCE:-24.77377, KLD:4926.79346,Test: total:19478.22461, BCE:-24.93231, KLD:19503.15430
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 19980, epoch 74.0)
score:  73.18666666666667
score:  66.28
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 19980, epoch 74.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [74.0], Train: total:4908.84082, BCE:-24.85985, KLD:4933.69971,Test: total:19507.17578, BCE:-24.98008, KLD:19532.15430
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 20250, epoch 75.0)
score:  73.21166666666667
score:  66.24
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 20250, epoch 75.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [75.0], Train: total:4900.15186, BCE:-24.89060, KLD:4925.03955,Test: total:19471.03125, BCE:-25.02522, KLD:19496.05859
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 20520, epoch 76.0)
score:  73.14833333333333
score:  66.24
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 20520, epoch 76.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [76.0], Train: total:4909.43506, BCE:-24.86217, KLD:4934.29834,Test: total:19510.17578, BCE:-25.00725, KLD:19535.18555
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 20790, epoch 77.0)
score:  73.17833333333333
score:  65.9
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 20790, epoch 77.0)
[Save Checkpoint] epoch: [77.0], Train: total:4901.11426, BCE:-24.85951, KLD:4925.97559,Test: total:19474.96875, BCE:-25.00524, KLD:19499.97461
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 21060, epoch 78.0)
score:  73.17666666666666
score:  65.99
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 21060, epoch 78.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [78.0], Train: total:4900.62793, BCE:-24.86567, KLD:4925.49365,Test: total:19473.59180, BCE:-25.00319, KLD:19498.59570
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 21330, epoch 79.0)
score:  73.16166666666666
score:  66.07
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 21330, epoch 79.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [79.0], Train: total:4897.26025, BCE:-24.80758, KLD:4922.06787,Test: total:19459.14844, BCE:-24.95978, KLD:19484.10938
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 21600, epoch 80.0)
score:  73.10666666666667
score:  65.81
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 21600, epoch 80.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [80.0], Train: total:4905.09229, BCE:-24.89287, KLD:4929.98535,Test: total:19493.54102, BCE:-25.02350, KLD:19518.56445
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 21870, epoch 81.0)
score:  72.95
score:  65.83
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 21870, epoch 81.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [81.0], Train: total:4894.35400, BCE:-24.94007, KLD:4919.29639,Test: total:19450.02148, BCE:-25.06581, KLD:19475.08594
Epoch    82: reducing learning rate of group 0 to 8.0000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 22140, epoch 82.0)
score:  73.35333333333334
score:  65.99
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 22140, epoch 82.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [82.0], Train: total:4899.39502, BCE:-24.92490, KLD:4924.31689,Test: total:19470.75781, BCE:-25.05633, KLD:19495.81836
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 22410, epoch 83.0)
score:  73.135
score:  66.02
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 22410, epoch 83.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [83.0], Train: total:4895.51074, BCE:-24.85052, KLD:4920.36328,Test: total:19455.10742, BCE:-24.97850, KLD:19480.08398
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 22680, epoch 84.0)
score:  73.10166666666667
score:  66.3
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 22680, epoch 84.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [84.0], Train: total:4895.45947, BCE:-24.84523, KLD:4920.30957,Test: total:19455.64062, BCE:-24.96358, KLD:19480.60547
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 22950, epoch 85.0)
score:  73.08333333333333
score:  66.14
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 22950, epoch 85.0)
EarlyStopping counter: 8 out of 25
[Save Checkpoint] epoch: [85.0], Train: total:4894.77100, BCE:-24.84253, KLD:4919.61279,Test: total:19451.76758, BCE:-24.98969, KLD:19476.75781
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 23220, epoch 86.0)
score:  73.13333333333334
score:  65.89
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 23220, epoch 86.0)
EarlyStopping counter: 9 out of 25
[Save Checkpoint] epoch: [86.0], Train: total:4894.76807, BCE:-24.83058, KLD:4919.59717,Test: total:19452.66992, BCE:-24.96227, KLD:19477.62891
Epoch    87: reducing learning rate of group 0 to 1.6000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 23490, epoch 87.0)
score:  73.25333333333333
score:  66.06
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 23490, epoch 87.0)
EarlyStopping counter: 10 out of 25
[Save Checkpoint] epoch: [87.0], Train: total:4897.45020, BCE:-24.83855, KLD:4922.28516,Test: total:19462.83398, BCE:-24.97145, KLD:19487.80664
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 23760, epoch 88.0)
score:  73.17
score:  65.97
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 23760, epoch 88.0)
EarlyStopping counter: 11 out of 25
[Save Checkpoint] epoch: [88.0], Train: total:4899.20605, BCE:-24.87498, KLD:4924.08057,Test: total:19470.00586, BCE:-25.00647, KLD:19495.01367
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 24030, epoch 89.0)
score:  73.02
score:  65.72
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 24030, epoch 89.0)
EarlyStopping counter: 12 out of 25
[Save Checkpoint] epoch: [89.0], Train: total:4898.14844, BCE:-24.88023, KLD:4923.02637,Test: total:19465.81641, BCE:-25.01488, KLD:19490.83203
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 24300, epoch 90.0)
score:  73.11833333333334
score:  66.25
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 24300, epoch 90.0)
EarlyStopping counter: 13 out of 25
[Save Checkpoint] epoch: [90.0], Train: total:4897.50146, BCE:-24.89014, KLD:4922.39062,Test: total:19463.26172, BCE:-25.01871, KLD:19488.28125
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 24570, epoch 91.0)
score:  73.13166666666666
score:  65.95
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 24570, epoch 91.0)
EarlyStopping counter: 14 out of 25
[Save Checkpoint] epoch: [91.0], Train: total:4898.11426, BCE:-24.89178, KLD:4923.00928,Test: total:19465.84180, BCE:-25.01752, KLD:19490.85742
Epoch    92: reducing learning rate of group 0 to 1.0000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 24840, epoch 92.0)
score:  73.14
score:  66.0
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 24840, epoch 92.0)
EarlyStopping counter: 15 out of 25
[Save Checkpoint] epoch: [92.0], Train: total:4895.74707, BCE:-24.87556, KLD:4920.62695,Test: total:19456.29688, BCE:-25.01381, KLD:19481.31250
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 25110, epoch 93.0)
score:  73.12
score:  66.75
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 25110, epoch 93.0)
EarlyStopping counter: 16 out of 25
[Save Checkpoint] epoch: [93.0], Train: total:4899.24756, BCE:-24.89089, KLD:4924.13818,Test: total:19469.95117, BCE:-25.01889, KLD:19494.97070
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 25380, epoch 94.0)
score:  73.00333333333333
score:  65.8
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 25380, epoch 94.0)
EarlyStopping counter: 17 out of 25
[Save Checkpoint] epoch: [94.0], Train: total:4898.05029, BCE:-24.89117, KLD:4922.94043,Test: total:19465.31641, BCE:-25.01696, KLD:19490.33398
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 25650, epoch 95.0)
score:  73.04166666666667
score:  65.61
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 25650, epoch 95.0)
EarlyStopping counter: 18 out of 25
[Save Checkpoint] epoch: [95.0], Train: total:4898.04297, BCE:-24.88944, KLD:4922.93213,Test: total:19465.27734, BCE:-25.00880, KLD:19490.28711
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 25920, epoch 96.0)
score:  73.22333333333333
score:  65.92
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 25920, epoch 96.0)
[Save Checkpoint] epoch: [96.0], Train: total:4898.93164, BCE:-24.89398, KLD:4923.82422,Test: total:19468.70898, BCE:-25.02818, KLD:19493.73828
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 26190, epoch 97.0)
score:  73.04166666666667
score:  66.13
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 26190, epoch 97.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [97.0], Train: total:4896.74902, BCE:-24.90264, KLD:4921.65088,Test: total:19460.31836, BCE:-25.03699, KLD:19485.35742
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 26460, epoch 98.0)
score:  72.93666666666667
score:  65.81
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 26460, epoch 98.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [98.0], Train: total:4897.54053, BCE:-24.89585, KLD:4922.43652,Test: total:19463.30664, BCE:-25.03765, KLD:19488.34375
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 26730, epoch 99.0)
score:  73.13833333333334
score:  65.99
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 26730, epoch 99.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [99.0], Train: total:4896.32471, BCE:-24.88555, KLD:4921.21045,Test: total:19458.46875, BCE:-25.01470, KLD:19483.48438
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 27000, epoch 100.0)
score:  73.235
score:  65.79
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4/last' (iter 27000, epoch 100.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [100.0], Train: total:4895.27197, BCE:-24.88945, KLD:4920.16162,Test: total:19454.35938, BCE:-25.03314, KLD:19479.39258
[Training Finished]
All done !
