use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_ES_binary_10-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 10, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(10, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=10, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 39/980. In percent: 0.03979591836734694
class 1: unique code: 20/1135. In percent: 0.01762114537444934
class 2: unique code: 55/1032. In percent: 0.05329457364341085
class 3: unique code: 66/1010. In percent: 0.06534653465346535
class 4: unique code: 57/982. In percent: 0.05804480651731161
class 5: unique code: 57/892. In percent: 0.06390134529147982
class 6: unique code: 37/958. In percent: 0.038622129436325675
class 7: unique code: 41/1028. In percent: 0.03988326848249027
class 8: unique code: 76/974. In percent: 0.07802874743326489
class 9: unique code: 42/1009. In percent: 0.04162537165510406
class 0: Average distance Hamming: tensor([0.9759])
class 1: Average distance Hamming: tensor([0.5785])
class 2: Average distance Hamming: tensor([1.4535])
class 3: Average distance Hamming: tensor([1.5606])
class 4: Average distance Hamming: tensor([1.3914])
class 5: Average distance Hamming: tensor([1.0243])
class 6: Average distance Hamming: tensor([0.7197])
class 7: Average distance Hamming: tensor([0.7712])
class 8: Average distance Hamming: tensor([1.8208])
class 9: Average distance Hamming: tensor([0.9731])
average distance: 1.1268980503082275
save z_struct representation for model mnist_ES_binary_10
save label list
save prediction
load z_struct representation, shape: (10000, 10)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_ES_binary_10
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_ES_binary_10, shape: (10, 10)
save std z_struct representation for model mnist_ES_binary_10, shaape: (10, 10)
load z_struct representation, shape: (10000, 10)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 10) (10,)
Var inter class shape:  (10,)
ratio Var intra / Var inter:  (10,) 0.43420854
Computing scores...
load average z_struct representation, shape: (10, 10)
load std z_struct representation, shape: (10, 10)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 39/980. In percent: 0.03979591836734694
class 1: unique code: 20/1135. In percent: 0.01762114537444934
class 2: unique code: 55/1032. In percent: 0.05329457364341085
class 3: unique code: 66/1010. In percent: 0.06534653465346535
class 4: unique code: 57/982. In percent: 0.05804480651731161
class 5: unique code: 57/892. In percent: 0.06390134529147982
class 6: unique code: 37/958. In percent: 0.038622129436325675
class 7: unique code: 41/1028. In percent: 0.03988326848249027
class 8: unique code: 76/974. In percent: 0.07802874743326489
class 9: unique code: 42/1009. In percent: 0.04162537165510406
__________------Hamming distance:------__________
class 0: Average distance Hamming: 0.97593754529953
class 1: Average distance Hamming: 0.5784552693367004
class 2: Average distance Hamming: 1.453477144241333
class 3: Average distance Hamming: 1.5606119632720947
class 4: Average distance Hamming: 1.3913605213165283
class 5: Average distance Hamming: 1.0242887735366821
class 6: Average distance Hamming: 0.719731330871582
class 7: Average distance Hamming: 0.7711592316627502
class 8: Average distance Hamming: 1.8208192586898804
class 9: Average distance Hamming: 0.9731385707855225
average distance: 1.1268980503082275
for class 0, we have 468 z_struct with code [1. 0. 0. 0. 1. 0. 0. 0. 0. 0.]. It represent 47.755% of total z_struct class
for class 1, we have 759 z_struct with code [0. 0. 0. 0. 0. 0. 1. 0. 1. 0.]. It represent 66.872% of total z_struct class
for class 2, we have 305 z_struct with code [1. 1. 0. 0. 0. 0. 0. 0. 0. 1.]. It represent 29.554% of total z_struct class
for class 3, we have 351 z_struct with code [0. 0. 0. 1. 0. 1. 1. 0. 0. 1.]. It represent 34.752% of total z_struct class
for class 4, we have 445 z_struct with code [0. 0. 1. 1. 0. 1. 0. 0. 1. 0.]. It represent 45.316% of total z_struct class
for class 5, we have 545 z_struct with code [0. 0. 0. 1. 1. 0. 0. 0. 1. 0.]. It represent 61.099% of total z_struct class
for class 6, we have 685 z_struct with code [0. 1. 0. 0. 0. 1. 0. 0. 1. 0.]. It represent 71.503% of total z_struct class
for class 7, we have 609 z_struct with code [0. 0. 1. 0. 0. 0. 0. 0. 0. 1.]. It represent 59.241% of total z_struct class
for class 8, we have 228 z_struct with code [0. 1. 0. 0. 1. 0. 1. 1. 0. 0.]. It represent 23.409% of total z_struct class
for class 9, we have 554 z_struct with code [0. 0. 1. 1. 1. 0. 0. 0. 0. 0.]. It represent 54.906% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 100.0 %
All done !
