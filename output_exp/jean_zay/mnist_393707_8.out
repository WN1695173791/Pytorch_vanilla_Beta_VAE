8
--dataset mnist --model CNN --gpu_devices 0 1 --max_iter 50 --batch_size 250 --ckpt_dir checkpoints_CNN --ckpt_dir_scores checkpoint_scores_CNN --use_scheduler True --GMP True --lr 1e-3 --z_struct_size 32 --add_classification_layer True --classif_layer_size 30 --is_default_model False --is_custom_model False --is_custom_model_BK True --big_kernel_size 8 --two_conv_layer True --three_conv_layer False --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 32 --hidden_filters_layer2 32 --hidden_filters_layer3 32 --ratio_reg True --lambda_ratio_reg 1 --lambda_class 1 --other_ratio False --loss_min_distance_cl True --lambda_var_distance 1 --intra_class_variance_loss False --lambda_intra_class_var 1 --contrastive_loss False --lambda_contrastive_loss 1 --alpha 32 --loss Proxy_Anchor --optimizer adamw --mrg 0.1 --IPC False --warm 1 --sz_embedding 32 --dataset_balanced True --loss_distance_mean False --lambda_distance_mean 1 --value_target_distance_mean 10 --diff_var False --lambda_var_intra 1 --lambda_var_inter 1 --exp_name mnist_balanced_dataset_encoder_ratio_min_1_1
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, GMP=True, IPC=False, L1_norm_act=False, L1_norm_weights=False, L3_without_random=False, LOG_DIR='logs', adapt_lr=False, add_classification_layer=True, add_linear_after_GMP=True, add_z_struct_bottleneck=False, alpha=32.0, batch_size=250, beta=1, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=[8], binary_chain=False, binary_z=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, contrastive_loss=False, cuda=True, dataset='mnist', dataset_balanced=True, diff_var=False, display_step=10000, dset_dir='data', exp_name='mnist_balanced_dataset_encoder_ratio_min_1_1', freeze_Encoder=True, gamma=1000, gpu_devices=[0, 1], hidden_filters_layer1=32, hidden_filters_layer2=32, hidden_filters_layer3=32, image_size=64, intra_class_variance_loss=False, is_C=True, is_E1=False, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=True, is_default_model=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_VAE=1, lambda_class=1.0, lambda_contrastive_loss=1.0, lambda_distance_mean=1.0, lambda_intra_class_var=1.0, lambda_partial_class=1, lambda_ratio_reg=1.0, lambda_recon_wt_rand=1, lambda_recons=1, lambda_var_distance=1.0, lambda_var_inter=1.0, lambda_var_intra=1.0, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', loss='Proxy_Anchor', loss_distance_mean=False, loss_min_distance_cl=True, lr=0.001, max_iter=50.0, model='CNN', mrg=0.1, num_workers=2, old_weighted=False, optimizer='adamw', other_ratio=False, random_percentage=0.2, random_seed=10, randomness=True, ratio_reg=True, remark='', save_step=10000, second_layer_C=False, seed=1, stride_size=1, sz_embedding=32, three_conv_layer=False, train=True, two_conv_layer=True, two_encoder=False, use_decoder=False, use_early_stopping=True, use_scheduler=True, value_target_distance_mean=10.0, warm=1, without_acc=False, z_struct_size=32, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
[Using Seed: 10]
Balanced dataset loaded
use 1 gpu who named: Tesla V100-SXM2-32GB
=> loaded sample_scores and losses
=> no checkpoint found at 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last'
Custom_CNN_BK(
  (net): Sequential(
    (0): Conv2d(1, 32, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(32, 32, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): AdaptiveMaxPool2d(output_size=(1, 1))
    (7): View()
    (8): Linear(in_features=32, out_features=32, bias=True)
    (9): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (10): ReLU(inplace=True)
    (11): Dropout(p=0.4, inplace=False)
    (12): Linear(in_features=32, out_features=30, bias=True)
    (13): BatchNorm1d(30, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU(inplace=True)
    (15): Dropout(p=0.4, inplace=False)
    (16): Linear(in_features=30, out_features=10, bias=True)
    (17): Softmax(dim=None)
  )
)
The number of parameters of model is 21104
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 270, epoch 1.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 270, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train score:93.85333, Test score:83.20000, train loss:-0.39483, test loss:-0.40893, ratio_train_loss:0.43721,ratio_test_loss:0.42783, var distance inter class train:0.05188,var distance inter class test:0.04899
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 540, epoch 2.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 540, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train score:107.44667, Test score:95.97000, train loss:-0.70236, test loss:-0.71555, ratio_train_loss:0.31963,ratio_test_loss:0.31148, var distance inter class train:0.03240,var distance inter class test:0.03113
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 810, epoch 3.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 810, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train score:108.47667, Test score:96.57000, train loss:-0.77441, test loss:-0.78290, ratio_train_loss:0.27223,ratio_test_loss:0.26539, var distance inter class train:0.02452,var distance inter class test:0.02416
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 1080, epoch 4.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 1080, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train score:108.93500, Test score:97.09000, train loss:-0.80598, test loss:-0.81336, ratio_train_loss:0.25046,ratio_test_loss:0.24398, var distance inter class train:0.01983,var distance inter class test:0.01959
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 1350, epoch 5.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 1350, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train score:108.99333, Test score:96.89000, train loss:-0.83006, test loss:-0.83656, ratio_train_loss:0.22900,ratio_test_loss:0.22218, var distance inter class train:0.01784,var distance inter class test:0.01778
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 1620, epoch 6.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 1620, epoch 6.0)
[Save Checkpoint] epoch: [6.0], Train score:109.12167, Test score:97.25000, train loss:-0.84793, test loss:-0.85529, ratio_train_loss:0.21436,ratio_test_loss:0.20768, var distance inter class train:0.01505,var distance inter class test:0.01494
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 1890, epoch 7.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 1890, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train score:109.29667, Test score:97.34000, train loss:-0.86779, test loss:-0.87562, ratio_train_loss:0.19685,ratio_test_loss:0.19023, var distance inter class train:0.01412,var distance inter class test:0.01407
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 2160, epoch 8.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 2160, epoch 8.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [8.0], Train score:109.43833, Test score:97.36000, train loss:-0.88301, test loss:-0.88891, ratio_train_loss:0.18460,ratio_test_loss:0.17876, var distance inter class train:0.01208,var distance inter class test:0.01200
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 2430, epoch 9.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 2430, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train score:109.53500, Test score:97.42000, train loss:-0.89436, test loss:-0.90019, ratio_train_loss:0.17521,ratio_test_loss:0.16864, var distance inter class train:0.01095,var distance inter class test:0.01086
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 2700, epoch 10.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 2700, epoch 10.0)
[Save Checkpoint] epoch: [10.0], Train score:109.50167, Test score:97.26000, train loss:-0.89868, test loss:-0.90301, ratio_train_loss:0.17079,ratio_test_loss:0.16524, var distance inter class train:0.01030,var distance inter class test:0.01021
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 2970, epoch 11.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 2970, epoch 11.0)
[Save Checkpoint] epoch: [11.0], Train score:109.54667, Test score:97.49000, train loss:-0.90525, test loss:-0.91111, ratio_train_loss:0.16499,ratio_test_loss:0.15902, var distance inter class train:0.01010,var distance inter class test:0.01004
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 3240, epoch 12.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 3240, epoch 12.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [12.0], Train score:109.66667, Test score:97.55000, train loss:-0.91099, test loss:-0.91579, ratio_train_loss:0.16184,ratio_test_loss:0.15642, var distance inter class train:0.00832,var distance inter class test:0.00826
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 3510, epoch 13.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 3510, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train score:109.69167, Test score:97.35000, train loss:-0.91604, test loss:-0.91970, ratio_train_loss:0.15655,ratio_test_loss:0.15030, var distance inter class train:0.00883,var distance inter class test:0.00872
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 3780, epoch 14.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 3780, epoch 14.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [14.0], Train score:109.76833, Test score:97.47000, train loss:-0.91844, test loss:-0.92112, ratio_train_loss:0.15564,ratio_test_loss:0.15071, var distance inter class train:0.00812,var distance inter class test:0.00808
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 4050, epoch 15.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 4050, epoch 15.0)
EarlyStopping counter: 2 out of 10
[Save Checkpoint] epoch: [15.0], Train score:109.47167, Test score:97.28000, train loss:-0.91839, test loss:-0.92299, ratio_train_loss:0.15299,ratio_test_loss:0.14684, var distance inter class train:0.00771,var distance inter class test:0.00758
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 4320, epoch 16.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 4320, epoch 16.0)
EarlyStopping counter: 3 out of 10
[Save Checkpoint] epoch: [16.0], Train score:109.79667, Test score:97.66000, train loss:-0.92237, test loss:-0.92714, ratio_train_loss:0.15205,ratio_test_loss:0.14650, var distance inter class train:0.00789,var distance inter class test:0.00786
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 4590, epoch 17.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 4590, epoch 17.0)
EarlyStopping counter: 4 out of 10
[Save Checkpoint] epoch: [17.0], Train score:109.84333, Test score:97.51000, train loss:-0.92871, test loss:-0.93130, ratio_train_loss:0.14661,ratio_test_loss:0.14159, var distance inter class train:0.00719,var distance inter class test:0.00717
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 4860, epoch 18.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 4860, epoch 18.0)
[Save Checkpoint] epoch: [18.0], Train score:109.73667, Test score:97.30000, train loss:-0.92798, test loss:-0.92941, ratio_train_loss:0.14657,ratio_test_loss:0.14194, var distance inter class train:0.00684,var distance inter class test:0.00683
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 5130, epoch 19.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 5130, epoch 19.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [19.0], Train score:110.00000, Test score:97.65000, train loss:-0.93307, test loss:-0.93680, ratio_train_loss:0.14399,ratio_test_loss:0.13853, var distance inter class train:0.00679,var distance inter class test:0.00671
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 5400, epoch 20.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 5400, epoch 20.0)
[Save Checkpoint] epoch: [20.0], Train score:109.63500, Test score:97.43000, train loss:-0.92806, test loss:-0.93166, ratio_train_loss:0.14602,ratio_test_loss:0.14129, var distance inter class train:0.00635,var distance inter class test:0.00633
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 5670, epoch 21.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 5670, epoch 21.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [21.0], Train score:109.82667, Test score:97.56000, train loss:-0.93023, test loss:-0.93386, ratio_train_loss:0.14600,ratio_test_loss:0.14082, var distance inter class train:0.00600,var distance inter class test:0.00593
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 5940, epoch 22.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 5940, epoch 22.0)
[Save Checkpoint] epoch: [22.0], Train score:109.99000, Test score:97.51000, train loss:-0.93707, test loss:-0.93856, ratio_train_loss:0.14042,ratio_test_loss:0.13570, var distance inter class train:0.00602,var distance inter class test:0.00597
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 6210, epoch 23.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 6210, epoch 23.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [23.0], Train score:109.88667, Test score:97.79000, train loss:-0.93719, test loss:-0.94284, ratio_train_loss:0.13918,ratio_test_loss:0.13327, var distance inter class train:0.00636,var distance inter class test:0.00627
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 6480, epoch 24.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 6480, epoch 24.0)
EarlyStopping counter: 2 out of 10
[Save Checkpoint] epoch: [24.0], Train score:109.84667, Test score:97.43000, train loss:-0.93696, test loss:-0.93861, ratio_train_loss:0.13900,ratio_test_loss:0.13426, var distance inter class train:0.00605,var distance inter class test:0.00596
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 6750, epoch 25.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 6750, epoch 25.0)
EarlyStopping counter: 3 out of 10
[Save Checkpoint] epoch: [25.0], Train score:109.88833, Test score:97.51000, train loss:-0.94063, test loss:-0.94301, ratio_train_loss:0.13619,ratio_test_loss:0.13094, var distance inter class train:0.00561,var distance inter class test:0.00552
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 7020, epoch 26.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 7020, epoch 26.0)
[Save Checkpoint] epoch: [26.0], Train score:110.09333, Test score:97.71000, train loss:-0.94329, test loss:-0.94586, ratio_train_loss:0.13523,ratio_test_loss:0.12994, var distance inter class train:0.00573,var distance inter class test:0.00574
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 7290, epoch 27.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 7290, epoch 27.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [27.0], Train score:109.63833, Test score:97.50000, train loss:-0.94067, test loss:-0.94507, ratio_train_loss:0.13380,ratio_test_loss:0.12866, var distance inter class train:0.00558,var distance inter class test:0.00559
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 7560, epoch 28.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 7560, epoch 28.0)
EarlyStopping counter: 2 out of 10
[Save Checkpoint] epoch: [28.0], Train score:109.88667, Test score:97.56000, train loss:-0.94456, test loss:-0.94705, ratio_train_loss:0.13240,ratio_test_loss:0.12746, var distance inter class train:0.00550,var distance inter class test:0.00542
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 7830, epoch 29.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 7830, epoch 29.0)
EarlyStopping counter: 3 out of 10
[Save Checkpoint] epoch: [29.0], Train score:110.12833, Test score:97.66000, train loss:-0.94923, test loss:-0.95072, ratio_train_loss:0.12985,ratio_test_loss:0.12463, var distance inter class train:0.00544,var distance inter class test:0.00543
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 8100, epoch 30.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 8100, epoch 30.0)
EarlyStopping counter: 4 out of 10
[Save Checkpoint] epoch: [30.0], Train score:109.83167, Test score:97.51000, train loss:-0.94340, test loss:-0.94639, ratio_train_loss:0.13298,ratio_test_loss:0.12766, var distance inter class train:0.00535,var distance inter class test:0.00530
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 8370, epoch 31.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 8370, epoch 31.0)
EarlyStopping counter: 5 out of 10
[Save Checkpoint] epoch: [31.0], Train score:110.14000, Test score:97.65000, train loss:-0.94935, test loss:-0.95062, ratio_train_loss:0.12985,ratio_test_loss:0.12536, var distance inter class train:0.00525,var distance inter class test:0.00523
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 8640, epoch 32.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 8640, epoch 32.0)
EarlyStopping counter: 6 out of 10
[Save Checkpoint] epoch: [32.0], Train score:110.12833, Test score:97.79000, train loss:-0.94715, test loss:-0.95037, ratio_train_loss:0.13221,ratio_test_loss:0.12682, var distance inter class train:0.00530,var distance inter class test:0.00530
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 8910, epoch 33.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 8910, epoch 33.0)
[Save Checkpoint] epoch: [33.0], Train score:110.14500, Test score:97.66000, train loss:-0.95048, test loss:-0.95125, ratio_train_loss:0.12912,ratio_test_loss:0.12474, var distance inter class train:0.00493,var distance inter class test:0.00491
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 9180, epoch 34.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 9180, epoch 34.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [34.0], Train score:110.16667, Test score:97.66000, train loss:-0.95187, test loss:-0.95292, ratio_train_loss:0.12776,ratio_test_loss:0.12322, var distance inter class train:0.00500,var distance inter class test:0.00498
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 9450, epoch 35.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 9450, epoch 35.0)
EarlyStopping counter: 2 out of 10
[Save Checkpoint] epoch: [35.0], Train score:110.13500, Test score:97.65000, train loss:-0.95298, test loss:-0.95410, ratio_train_loss:0.12644,ratio_test_loss:0.12186, var distance inter class train:0.00477,var distance inter class test:0.00472
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 9720, epoch 36.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 9720, epoch 36.0)
EarlyStopping counter: 3 out of 10
[Save Checkpoint] epoch: [36.0], Train score:109.95500, Test score:97.64000, train loss:-0.95032, test loss:-0.95381, ratio_train_loss:0.12782,ratio_test_loss:0.12231, var distance inter class train:0.00464,var distance inter class test:0.00459
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 9990, epoch 37.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 9990, epoch 37.0)
[Save Checkpoint] epoch: [37.0], Train score:110.09500, Test score:97.76000, train loss:-0.95172, test loss:-0.95514, ratio_train_loss:0.12769,ratio_test_loss:0.12211, var distance inter class train:0.00448,var distance inter class test:0.00445
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 10260, epoch 38.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 10260, epoch 38.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [38.0], Train score:110.07333, Test score:97.87000, train loss:-0.95246, test loss:-0.95697, ratio_train_loss:0.12672,ratio_test_loss:0.12130, var distance inter class train:0.00472,var distance inter class test:0.00471
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 10530, epoch 39.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 10530, epoch 39.0)
EarlyStopping counter: 2 out of 10
[Save Checkpoint] epoch: [39.0], Train score:110.07667, Test score:97.66000, train loss:-0.94851, test loss:-0.95049, ratio_train_loss:0.13077,ratio_test_loss:0.12601, var distance inter class train:0.00459,var distance inter class test:0.00457
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 10800, epoch 40.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 10800, epoch 40.0)
EarlyStopping counter: 3 out of 10
[Save Checkpoint] epoch: [40.0], Train score:110.16000, Test score:97.82000, train loss:-0.95553, test loss:-0.95813, ratio_train_loss:0.12436,ratio_test_loss:0.11954, var distance inter class train:0.00464,var distance inter class test:0.00460
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 11070, epoch 41.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 11070, epoch 41.0)
EarlyStopping counter: 4 out of 10
[Save Checkpoint] epoch: [41.0], Train score:110.27500, Test score:97.89000, train loss:-0.95405, test loss:-0.95583, ratio_train_loss:0.12686,ratio_test_loss:0.12262, var distance inter class train:0.00471,var distance inter class test:0.00466
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 11340, epoch 42.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 11340, epoch 42.0)
EarlyStopping counter: 5 out of 10
[Save Checkpoint] epoch: [42.0], Train score:109.94833, Test score:97.68000, train loss:-0.95383, test loss:-0.95623, ratio_train_loss:0.12455,ratio_test_loss:0.11985, var distance inter class train:0.00438,var distance inter class test:0.00437
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 11610, epoch 43.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 11610, epoch 43.0)
EarlyStopping counter: 6 out of 10
[Save Checkpoint] epoch: [43.0], Train score:110.22667, Test score:97.78000, train loss:-0.95787, test loss:-0.95985, ratio_train_loss:0.12276,ratio_test_loss:0.11800, var distance inter class train:0.00424,var distance inter class test:0.00415
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 11880, epoch 44.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 11880, epoch 44.0)
EarlyStopping counter: 7 out of 10
[Save Checkpoint] epoch: [44.0], Train score:110.36167, Test score:97.86000, train loss:-0.96251, test loss:-0.96310, ratio_train_loss:0.11938,ratio_test_loss:0.11518, var distance inter class train:0.00444,var distance inter class test:0.00439
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 12150, epoch 45.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 12150, epoch 45.0)
EarlyStopping counter: 8 out of 10
[Save Checkpoint] epoch: [45.0], Train score:110.30833, Test score:97.65000, train loss:-0.96046, test loss:-0.96018, ratio_train_loss:0.12100,ratio_test_loss:0.11645, var distance inter class train:0.00439,var distance inter class test:0.00441
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 12420, epoch 46.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 12420, epoch 46.0)
EarlyStopping counter: 9 out of 10
[Save Checkpoint] epoch: [46.0], Train score:109.97000, Test score:97.61000, train loss:-0.95575, test loss:-0.95798, ratio_train_loss:0.12249,ratio_test_loss:0.11786, var distance inter class train:0.00447,var distance inter class test:0.00442
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 12690, epoch 47.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 12690, epoch 47.0)
[Save Checkpoint] epoch: [47.0], Train score:110.41667, Test score:97.88000, train loss:-0.96201, test loss:-0.96341, ratio_train_loss:0.12008,ratio_test_loss:0.11510, var distance inter class train:0.00474,var distance inter class test:0.00465
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 12960, epoch 48.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 12960, epoch 48.0)
EarlyStopping counter: 1 out of 10
[Save Checkpoint] epoch: [48.0], Train score:110.55167, Test score:97.98000, train loss:-0.96361, test loss:-0.96474, ratio_train_loss:0.11993,ratio_test_loss:0.11483, var distance inter class train:0.00428,var distance inter class test:0.00425
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 13230, epoch 49.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 13230, epoch 49.0)
EarlyStopping counter: 2 out of 10
[Save Checkpoint] epoch: [49.0], Train score:110.21667, Test score:97.67000, train loss:-0.95952, test loss:-0.96004, ratio_train_loss:0.12106,ratio_test_loss:0.11588, var distance inter class train:0.00421,var distance inter class test:0.00420
=> saved checkpoint 'checkpoints_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 13500, epoch 50.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_balanced_dataset_encoder_ratio_min_1_1/last' (iter 13500, epoch 50.0)
EarlyStopping counter: 3 out of 10
[Save Checkpoint] epoch: [50.0], Train score:110.41000, Test score:97.71000, train loss:-0.96055, test loss:-0.95960, ratio_train_loss:0.12146,ratio_test_loss:0.11714, var distance inter class train:0.00462,var distance inter class test:0.00457
[Training Finished]
All done !
