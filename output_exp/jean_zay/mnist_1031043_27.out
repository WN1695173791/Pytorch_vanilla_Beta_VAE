27
--gpu_devices 0 --max_iter 100 --batch_size 250 --use_scheduler True --lr 1e-3 --GMP True --z_struct_size 15 --z_var_size 6 --is_VAE True --is_encoder_struct False --lambda_BCE 1 --beta 1 --lambda_recons 1 --lambda_EV_class 1000 --big_kernel_size 8 --two_conv_layer True --three_conv_layer True --kernel_size_1 4 --kernel_size_2 4 --kernel_size_3 4 --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 64 --hidden_filters_layer2 64 --hidden_filters_layer3 64 --dataset_balanced True --binary_z True --binary_first_conv False --binary_second_conv False --binary_third_conv True --use_small_lr_encoder_var False --encoder_var_name None --encoder_struct_name mnist_ES_binary_15_Hmg_dst_4_2nd_test --freeze_Encoder True --EV_classifier True --freeze_Encoder True --grad_inv True --size_average False --exp_name mnist_VAE_s15Hmg4_v6_class_inv_grad_5
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, ES_reconstruction=False, EV_classifier=True, GMP=True, Hmg_dst_loss=False, IPC=False, L1_norm_act=False, L1_norm_weights=False, L2_dst_loss=False, L3_without_random=False, LOG_DIR='logs', PT_model=False, PT_model_EV_classifier=False, adapt_lr=False, add_classification_layer=True, add_dl_class=False, add_linear_after_GMP=True, add_z_struct_bottleneck=False, alpha=32, batch_size=250, beta=1.0, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=8, bin_after_GMP=False, binary_chain=False, binary_first_conv=False, binary_second_conv=False, binary_third_conv=True, binary_z=True, both_decoders_freeze=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, contrastive_loss=False, cuda=True, dataset='mnist', dataset_balanced=True, decoder_first_dense=36, decoder_kernel_size_1=4, decoder_kernel_size_2=3, decoder_kernel_size_3=4, decoder_n_filter_1=64, decoder_n_filter_2=64, decoder_n_filter_3=64, decoder_name='None', decoder_stride_1=2, decoder_stride_2=2, decoder_stride_3=1, diff_var=False, display_step=10000, dset_dir='data', encoder_struct_name='mnist_ES_binary_15_Hmg_dst_4_2nd_test', encoder_var_name='None', exp_name='mnist_VAE_s15Hmg4_v6_class_inv_grad_5', fine_tune_decoder=False, freeze_Encoder=True, gamma=1000, gpu_devices=[0], grad_inv=True, hidden_dim=20, hidden_filters_layer1=64, hidden_filters_layer2=64, hidden_filters_layer3=64, image_size=64, intra_class_variance_loss=False, is_C=True, is_E1=False, is_VAE=True, is_VAE_var=False, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=False, is_default_model=False, is_encoder_struct=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, kernel_size_1=4, kernel_size_2=4, kernel_size_3=4, lambda_BCE=1.0, lambda_EV_class=1000.0, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_L2_dst=1, lambda_VAE=1, lambda_class=1, lambda_contrastive_loss=1, lambda_distance_mean=1, lambda_hmg_dst=1, lambda_intra_class_var=1, lambda_partial_class=1, lambda_ratio_reg=1, lambda_recon_wt_rand=1, lambda_recons=1.0, lambda_struct_recons_class=1, lambda_uniq_code_dst=1, lambda_var_distance=1, lambda_var_inter=1, lambda_var_intra=1, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', loss='Proxy_Anchor', loss_ES_reconstruction=False, loss_distance_mean=False, loss_min_distance_cl=False, loss_struct_recons_class=False, lr=0.001, max_epoch_use_uniq_code_target=5, max_iter=100.0, model='CNN', mrg=0.1, nb_epochs_train_only_zvar=0, num_workers=2, old_weighted=False, optimizer='adamw', other_architecture=False, other_ratio=False, random_percentage=0.2, random_seed=10, randomness=True, ratio_reg=False, remark='', save_step=10000, second_layer_C=False, seed=1, size_average=False, stride_size=1, sz_embedding=5, three_conv_layer=True, train=True, train_var_struct_alternatively=False, two_conv_layer=True, two_encoder=False, uniq_code_dst_loss=False, use_VAE=False, use_decoder=False, use_early_stopping=True, use_scheduler=True, use_small_lr_encoder_var=False, use_structural_encoder=False, value_target_distance_mean=1, var_hidden_dim=256, var_hidden_filters_1=32, var_hidden_filters_2=32, var_hidden_filters_3=32, var_kernel_size_1=3, var_kernel_size_2=3, var_kernel_size_3=3, var_second_cnn_block=True, var_stride_size_1=1, var_stride_size_2=1, var_stride_size_3=1, var_third_cnn_block=False, var_three_conv_layer=False, warm=1, without_acc=False, z_struct_size=15, z_var_size=6, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
[Using Seed: 10]
Balanced dataset loaded
VAE doesn't exist but encoder struct yes ! load struct encoder weighs !
=> loaded checkpoint 'checkpoints_CNN/mnist_ES_binary_15_Hmg_dst_4_2nd_test/last (iter 7020)'
Weighs loaded for struct encoder !
use 1 gpu who named: Tesla V100-SXM2-32GB
VAE(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
  )
  (decoder): Sequential(
    (0): Linear(in_features=21, out_features=1600, bias=True)
    (1): ReLU(inplace=True)
    (2): View()
    (3): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (4): ReLU(inplace=True)
    (5): ConvTranspose2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (6): ReLU(inplace=True)
    (7): ConvTranspose2d(64, 32, kernel_size=(3, 3), stride=(1, 1))
    (8): ReLU(inplace=True)
    (9): ConvTranspose2d(32, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (10): ReLU(inplace=True)
    (11): ConvTranspose2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (12): ReLU(inplace=True)
    (13): ConvTranspose2d(32, 1, kernel_size=(3, 3), stride=(1, 1))
    (14): Sigmoid()
  )
  (encoder_var): Sequential(
    (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (4): ReLU(inplace=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Conv2d(32, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (7): ReLU(inplace=True)
    (8): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): Dropout(p=0.4, inplace=False)
    (10): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
    (11): ReLU(inplace=True)
    (12): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (13): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (14): ReLU(inplace=True)
    (15): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Conv2d(64, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (17): ReLU(inplace=True)
    (18): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (19): Dropout(p=0.4, inplace=False)
    (20): View()
    (21): Linear(in_features=1600, out_features=12, bias=True)
  )
  (var_classifier): Sequential(
    (0): RevGrad()
    (1): Linear(in_features=6, out_features=10, bias=True)
  )
)
The number of parameters of model is 480512
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 270, epoch 1.0)
score:  17.151666666666667
score:  14.3
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 270, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train: total:3642.77783, BCE:-9.82136, KLD:3652.59912,Test: total:14614.00293, BCE:-9.87637, KLD:14623.87988
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 540, epoch 2.0)
score:  31.316666666666666
score:  27.94
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 540, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train: total:3414.73071, BCE:-12.54230, KLD:3427.27295,Test: total:13649.26855, BCE:-12.55781, KLD:13661.82715
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 810, epoch 3.0)
score:  37.803333333333335
score:  34.72
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 810, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train: total:3420.03809, BCE:-12.88248, KLD:3432.92065,Test: total:13674.00977, BCE:-12.84855, KLD:13686.85840
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 1080, epoch 4.0)
score:  48.848333333333336
score:  44.59
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 1080, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train: total:3549.93433, BCE:-12.87580, KLD:3562.80981,Test: total:14170.65527, BCE:-12.81579, KLD:14183.47070
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 1350, epoch 5.0)
score:  55.31166666666667
score:  50.66
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 1350, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train: total:3500.79980, BCE:-12.84090, KLD:3513.63965,Test: total:13976.25684, BCE:-12.75505, KLD:13989.01270
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 1620, epoch 6.0)
score:  57.763333333333335
score:  52.24
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 1620, epoch 6.0)
[Save Checkpoint] epoch: [6.0], Train: total:3433.33032, BCE:-12.26045, KLD:3445.59302,Test: total:13683.29980, BCE:-12.15602, KLD:13695.45605
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 1890, epoch 7.0)
score:  58.406666666666666
score:  52.64
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 1890, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train: total:3526.89185, BCE:-11.78217, KLD:3538.67383,Test: total:14070.29395, BCE:-11.68393, KLD:14081.97852
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 2160, epoch 8.0)
score:  58.468333333333334
score:  53.02
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 2160, epoch 8.0)
[Save Checkpoint] epoch: [8.0], Train: total:3521.15332, BCE:-11.76783, KLD:3532.92163,Test: total:14046.12500, BCE:-11.65829, KLD:14057.78418
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 2430, epoch 9.0)
score:  59.155
score:  53.71
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 2430, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train: total:3612.06323, BCE:-11.76307, KLD:3623.82690,Test: total:14397.41309, BCE:-11.65642, KLD:14409.07031
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 2700, epoch 10.0)
score:  60.67166666666667
score:  54.68
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 2700, epoch 10.0)
[Save Checkpoint] epoch: [10.0], Train: total:3575.57251, BCE:-11.00648, KLD:3586.58032,Test: total:14254.37793, BCE:-10.91041, KLD:14265.28906
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 2970, epoch 11.0)
score:  60.635
score:  54.56
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 2970, epoch 11.0)
[Save Checkpoint] epoch: [11.0], Train: total:3528.97876, BCE:-11.11738, KLD:3540.09644,Test: total:14067.61621, BCE:-11.02695, KLD:14078.64355
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 3240, epoch 12.0)
score:  60.61
score:  54.08
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 3240, epoch 12.0)
[Save Checkpoint] epoch: [12.0], Train: total:3566.66650, BCE:-11.09168, KLD:3577.75977,Test: total:14223.97656, BCE:-11.01265, KLD:14234.98926
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 3510, epoch 13.0)
score:  60.791666666666664
score:  54.8
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 3510, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train: total:3597.61353, BCE:-11.47520, KLD:3609.08838,Test: total:14352.87402, BCE:-11.40773, KLD:14364.28125
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 3780, epoch 14.0)
score:  61.056666666666665
score:  54.44
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 3780, epoch 14.0)
[Save Checkpoint] epoch: [14.0], Train: total:3574.18335, BCE:-11.56014, KLD:3585.74463,Test: total:14261.57227, BCE:-11.50725, KLD:14273.07812
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 4050, epoch 15.0)
score:  60.25333333333333
score:  54.08
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 4050, epoch 15.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [15.0], Train: total:3484.59619, BCE:-11.59101, KLD:3496.18750,Test: total:13881.92871, BCE:-11.56198, KLD:13893.48926
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 4320, epoch 16.0)
score:  60.015
score:  53.92
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 4320, epoch 16.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [16.0], Train: total:3498.17114, BCE:-12.17393, KLD:3510.34399,Test: total:13955.90039, BCE:-12.14283, KLD:13968.04199
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 4590, epoch 17.0)
score:  58.56166666666667
score:  52.99
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 4590, epoch 17.0)
[Save Checkpoint] epoch: [17.0], Train: total:3505.65454, BCE:-11.89996, KLD:3517.55518,Test: total:13976.86719, BCE:-11.87914, KLD:13988.74707
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 4860, epoch 18.0)
score:  58.608333333333334
score:  53.01
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 4860, epoch 18.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [18.0], Train: total:3494.29663, BCE:-12.21979, KLD:3506.51685,Test: total:13940.96777, BCE:-12.21419, KLD:13953.18262
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 5130, epoch 19.0)
score:  58.513333333333335
score:  52.56
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 5130, epoch 19.0)
[Save Checkpoint] epoch: [19.0], Train: total:3543.82104, BCE:-12.25694, KLD:3556.07788,Test: total:14137.05469, BCE:-12.25908, KLD:14149.31250
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 5400, epoch 20.0)
score:  57.81666666666667
score:  51.91
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 5400, epoch 20.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [20.0], Train: total:3528.77783, BCE:-12.87123, KLD:3541.64819,Test: total:14063.30957, BCE:-12.89218, KLD:14076.20215
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 5670, epoch 21.0)
score:  57.3
score:  51.69
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 5670, epoch 21.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [21.0], Train: total:3524.11719, BCE:-12.83974, KLD:3536.95605,Test: total:14048.86133, BCE:-12.87243, KLD:14061.73145
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 5940, epoch 22.0)
score:  56.365
score:  50.9
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 5940, epoch 22.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [22.0], Train: total:3442.65894, BCE:-13.12504, KLD:3455.78418,Test: total:13740.48145, BCE:-13.18584, KLD:13753.66699
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 6210, epoch 23.0)
score:  56.053333333333335
score:  50.35
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 6210, epoch 23.0)
[Save Checkpoint] epoch: [23.0], Train: total:3534.94141, BCE:-13.51636, KLD:3548.45972,Test: total:14095.73633, BCE:-13.58053, KLD:14109.31738
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 6480, epoch 24.0)
score:  56.39833333333333
score:  51.06
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 6480, epoch 24.0)
[Save Checkpoint] epoch: [24.0], Train: total:3517.51685, BCE:-13.80693, KLD:3531.32202,Test: total:14034.95215, BCE:-13.88464, KLD:14048.83594
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 6750, epoch 25.0)
score:  55.75333333333333
score:  50.34
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 6750, epoch 25.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [25.0], Train: total:3539.80713, BCE:-14.65832, KLD:3554.46680,Test: total:14112.48340, BCE:-14.74557, KLD:14127.22852
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 7020, epoch 26.0)
score:  54.53
score:  49.51
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 7020, epoch 26.0)
[Save Checkpoint] epoch: [26.0], Train: total:3543.86523, BCE:-14.84920, KLD:3558.71460,Test: total:14140.71777, BCE:-14.94090, KLD:14155.65918
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 7290, epoch 27.0)
score:  53.925
score:  48.2
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 7290, epoch 27.0)
[Save Checkpoint] epoch: [27.0], Train: total:3475.63647, BCE:-14.74960, KLD:3490.38574,Test: total:13862.61426, BCE:-14.83163, KLD:13877.44434
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 7560, epoch 28.0)
score:  53.86666666666667
score:  48.61
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 7560, epoch 28.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [28.0], Train: total:3458.36255, BCE:-15.42872, KLD:3473.79272,Test: total:13791.58594, BCE:-15.52605, KLD:13807.11230
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 7830, epoch 29.0)
score:  53.516666666666666
score:  48.46
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 7830, epoch 29.0)
[Save Checkpoint] epoch: [29.0], Train: total:3532.80249, BCE:-15.69913, KLD:3548.50269,Test: total:14090.49219, BCE:-15.79889, KLD:14106.28906
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 8100, epoch 30.0)
score:  52.57666666666667
score:  47.35
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 8100, epoch 30.0)
[Save Checkpoint] epoch: [30.0], Train: total:3454.64404, BCE:-15.81552, KLD:3470.45825,Test: total:13783.91699, BCE:-15.90591, KLD:13799.82227
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 8370, epoch 31.0)
score:  52.04666666666667
score:  47.01
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 8370, epoch 31.0)
[Save Checkpoint] epoch: [31.0], Train: total:3511.56738, BCE:-16.37746, KLD:3527.94385,Test: total:14014.04199, BCE:-16.47474, KLD:14030.51758
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 8640, epoch 32.0)
score:  51.843333333333334
score:  46.26
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 8640, epoch 32.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [32.0], Train: total:3437.95630, BCE:-17.33050, KLD:3455.28735,Test: total:13706.19043, BCE:-17.41603, KLD:13723.60840
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 8910, epoch 33.0)
score:  51.285
score:  46.28
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 8910, epoch 33.0)
[Save Checkpoint] epoch: [33.0], Train: total:3477.29224, BCE:-17.14349, KLD:3494.43774,Test: total:13878.12402, BCE:-17.24090, KLD:13895.36426
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 9180, epoch 34.0)
score:  51.35333333333333
score:  46.19
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 9180, epoch 34.0)
[Save Checkpoint] epoch: [34.0], Train: total:3478.64209, BCE:-17.15155, KLD:3495.79346,Test: total:13879.11719, BCE:-17.22898, KLD:13896.34570
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 9450, epoch 35.0)
score:  50.501666666666665
score:  45.51
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 9450, epoch 35.0)
[Save Checkpoint] epoch: [35.0], Train: total:3465.56006, BCE:-17.85594, KLD:3483.41553,Test: total:13832.24414, BCE:-17.93298, KLD:13850.17480
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 9720, epoch 36.0)
score:  50.73833333333334
score:  46.16
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 9720, epoch 36.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [36.0], Train: total:3493.08447, BCE:-17.93581, KLD:3511.01953,Test: total:13937.12695, BCE:-18.02077, KLD:13955.14844
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 9990, epoch 37.0)
score:  49.64
score:  45.05
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 9990, epoch 37.0)
[Save Checkpoint] epoch: [37.0], Train: total:3438.56006, BCE:-18.55672, KLD:3457.11670,Test: total:13709.79883, BCE:-18.63086, KLD:13728.42871
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 10260, epoch 38.0)
score:  49.515
score:  44.53
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 10260, epoch 38.0)
[Save Checkpoint] epoch: [38.0], Train: total:3512.36450, BCE:-18.48466, KLD:3530.84839,Test: total:14018.76465, BCE:-18.55468, KLD:14037.32031
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 10530, epoch 39.0)
score:  49.1
score:  44.32
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 10530, epoch 39.0)
[Save Checkpoint] epoch: [39.0], Train: total:3472.55005, BCE:-18.39851, KLD:3490.94971,Test: total:13853.39551, BCE:-18.45857, KLD:13871.85352
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 10800, epoch 40.0)
score:  47.96333333333333
score:  43.06
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 10800, epoch 40.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [40.0], Train: total:3445.67847, BCE:-19.16562, KLD:3464.84473,Test: total:13744.06445, BCE:-19.20819, KLD:13763.27246
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 11070, epoch 41.0)
score:  48.45
score:  43.36
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 11070, epoch 41.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [41.0], Train: total:3464.88672, BCE:-19.24891, KLD:3484.13550,Test: total:13812.03809, BCE:-19.29098, KLD:13831.32812
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 11340, epoch 42.0)
score:  48.26
score:  43.63
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 11340, epoch 42.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [42.0], Train: total:3467.59009, BCE:-19.21416, KLD:3486.80493,Test: total:13833.33301, BCE:-19.25285, KLD:13852.58594
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 11610, epoch 43.0)
score:  47.525
score:  42.92
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 11610, epoch 43.0)
[Save Checkpoint] epoch: [43.0], Train: total:3478.55811, BCE:-19.25015, KLD:3497.80835,Test: total:13860.44727, BCE:-19.29366, KLD:13879.74121
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 11880, epoch 44.0)
score:  46.663333333333334
score:  41.86
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 11880, epoch 44.0)
[Save Checkpoint] epoch: [44.0], Train: total:3459.46069, BCE:-19.32894, KLD:3478.79053,Test: total:13800.72852, BCE:-19.36577, KLD:13820.09375
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 12150, epoch 45.0)
score:  46.56166666666667
score:  42.35
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 12150, epoch 45.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [45.0], Train: total:3451.27954, BCE:-19.79029, KLD:3471.06714,Test: total:13760.53613, BCE:-19.81308, KLD:13780.34863
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 12420, epoch 46.0)
score:  46.12833333333333
score:  41.23
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 12420, epoch 46.0)
[Save Checkpoint] epoch: [46.0], Train: total:3472.00586, BCE:-19.79860, KLD:3491.80420,Test: total:13847.96094, BCE:-19.81723, KLD:13867.77637
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 12690, epoch 47.0)
score:  46.20166666666667
score:  41.16
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 12690, epoch 47.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [47.0], Train: total:3503.20630, BCE:-20.17399, KLD:3523.38062,Test: total:13970.61719, BCE:-20.16307, KLD:13990.78320
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 12960, epoch 48.0)
score:  45.053333333333335
score:  40.64
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 12960, epoch 48.0)
[Save Checkpoint] epoch: [48.0], Train: total:3473.83594, BCE:-20.02899, KLD:3493.86572,Test: total:13861.70996, BCE:-20.03822, KLD:13881.74902
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 13230, epoch 49.0)
score:  45.61333333333334
score:  41.45
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 13230, epoch 49.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [49.0], Train: total:3482.86035, BCE:-19.81231, KLD:3502.67310,Test: total:13868.08301, BCE:-19.81528, KLD:13887.89844
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 13500, epoch 50.0)
score:  45.013333333333335
score:  40.8
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 13500, epoch 50.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [50.0], Train: total:3431.61011, BCE:-19.89348, KLD:3451.50293,Test: total:13680.19531, BCE:-19.89326, KLD:13700.08887
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 13770, epoch 51.0)
score:  44.605
score:  40.18
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 13770, epoch 51.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [51.0], Train: total:3437.92773, BCE:-20.04392, KLD:3457.96899,Test: total:13707.25488, BCE:-20.02042, KLD:13727.27539
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 14040, epoch 52.0)
score:  44.095
score:  39.66
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 14040, epoch 52.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [52.0], Train: total:3424.91333, BCE:-20.20473, KLD:3445.11719,Test: total:13651.06250, BCE:-20.17933, KLD:13671.24414
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 14310, epoch 53.0)
score:  43.36833333333333
score:  39.67
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 14310, epoch 53.0)
[Save Checkpoint] epoch: [53.0], Train: total:3449.23462, BCE:-20.62458, KLD:3469.86084,Test: total:13742.69238, BCE:-20.58465, KLD:13763.27637
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 14580, epoch 54.0)
score:  43.445
score:  39.13
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 14580, epoch 54.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [54.0], Train: total:3457.64917, BCE:-20.45558, KLD:3478.10645,Test: total:13781.78906, BCE:-20.43428, KLD:13802.22363
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 14850, epoch 55.0)
score:  43.126666666666665
score:  38.83
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 14850, epoch 55.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [55.0], Train: total:3456.19385, BCE:-20.77313, KLD:3476.96704,Test: total:13770.49512, BCE:-20.73577, KLD:13791.22949
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 15120, epoch 56.0)
score:  43.055
score:  39.19
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 15120, epoch 56.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [56.0], Train: total:3419.85059, BCE:-20.18874, KLD:3440.04028,Test: total:13631.33105, BCE:-20.15583, KLD:13651.48730
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 15390, epoch 57.0)
score:  42.733333333333334
score:  38.7
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 15390, epoch 57.0)
[Save Checkpoint] epoch: [57.0], Train: total:3439.70996, BCE:-20.49170, KLD:3460.20020,Test: total:13713.82520, BCE:-20.46873, KLD:13734.29395
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 15660, epoch 58.0)
score:  42.11833333333333
score:  38.09
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 15660, epoch 58.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [58.0], Train: total:3418.81348, BCE:-20.54233, KLD:3439.35620,Test: total:13616.67090, BCE:-20.50027, KLD:13637.17090
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 15930, epoch 59.0)
score:  42.04833333333333
score:  37.98
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 15930, epoch 59.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [59.0], Train: total:3430.72168, BCE:-20.58684, KLD:3451.30981,Test: total:13677.06152, BCE:-20.54691, KLD:13697.60645
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 16200, epoch 60.0)
score:  42.29
score:  38.21
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 16200, epoch 60.0)
[Save Checkpoint] epoch: [60.0], Train: total:3453.94458, BCE:-20.71725, KLD:3474.66089,Test: total:13759.64844, BCE:-20.66520, KLD:13780.31445
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 16470, epoch 61.0)
score:  41.653333333333336
score:  37.49
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 16470, epoch 61.0)
[Save Checkpoint] epoch: [61.0], Train: total:3454.09204, BCE:-20.96848, KLD:3475.05957,Test: total:13761.31445, BCE:-20.90539, KLD:13782.22070
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 16740, epoch 62.0)
score:  40.93833333333333
score:  36.97
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 16740, epoch 62.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [62.0], Train: total:3426.71167, BCE:-21.13075, KLD:3447.84326,Test: total:13659.27051, BCE:-21.06094, KLD:13680.33105
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 17010, epoch 63.0)
score:  40.92666666666667
score:  36.81
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 17010, epoch 63.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [63.0], Train: total:3422.28296, BCE:-21.10335, KLD:3443.38721,Test: total:13638.57715, BCE:-21.01831, KLD:13659.59375
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 17280, epoch 64.0)
score:  40.653333333333336
score:  36.79
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 17280, epoch 64.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [64.0], Train: total:3419.56030, BCE:-21.16791, KLD:3440.72949,Test: total:13614.60840, BCE:-21.08023, KLD:13635.68750
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 17550, epoch 65.0)
score:  40.26
score:  36.16
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 17550, epoch 65.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [65.0], Train: total:3406.84839, BCE:-21.27688, KLD:3428.12720,Test: total:13578.78613, BCE:-21.18008, KLD:13599.96582
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 17820, epoch 66.0)
score:  40.205
score:  36.03
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 17820, epoch 66.0)
[Save Checkpoint] epoch: [66.0], Train: total:3367.66357, BCE:-21.25218, KLD:3388.91626,Test: total:13412.72949, BCE:-21.15931, KLD:13433.88770
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 18090, epoch 67.0)
score:  40.10333333333333
score:  36.11
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 18090, epoch 67.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [67.0], Train: total:3424.59521, BCE:-21.21618, KLD:3445.80981,Test: total:13639.64258, BCE:-21.11974, KLD:13660.76270
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 18360, epoch 68.0)
score:  39.625
score:  35.37
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 18360, epoch 68.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [68.0], Train: total:3419.03931, BCE:-21.35733, KLD:3440.39771,Test: total:13616.44043, BCE:-21.25886, KLD:13637.70020
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 18630, epoch 69.0)
score:  39.305
score:  35.47
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 18630, epoch 69.0)
[Save Checkpoint] epoch: [69.0], Train: total:3404.56006, BCE:-21.11926, KLD:3425.68042,Test: total:13555.48926, BCE:-20.99771, KLD:13576.48730
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 18900, epoch 70.0)
score:  39.56333333333333
score:  35.48
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 18900, epoch 70.0)
[Save Checkpoint] epoch: [70.0], Train: total:3434.59668, BCE:-21.02682, KLD:3455.62354,Test: total:13686.70312, BCE:-20.92165, KLD:13707.62500
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 19170, epoch 71.0)
score:  38.723333333333336
score:  34.93
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 19170, epoch 71.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [71.0], Train: total:3376.65918, BCE:-21.27306, KLD:3397.93408,Test: total:13446.58789, BCE:-21.16078, KLD:13467.74902
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 19440, epoch 72.0)
score:  38.17
score:  33.93
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 19440, epoch 72.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [72.0], Train: total:3413.10229, BCE:-21.09522, KLD:3434.19751,Test: total:13598.44043, BCE:-20.96779, KLD:13619.40820
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 19710, epoch 73.0)
score:  38.36
score:  34.33
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 19710, epoch 73.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [73.0], Train: total:3404.64233, BCE:-21.61241, KLD:3426.25513,Test: total:13566.98438, BCE:-21.47063, KLD:13588.45508
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 19980, epoch 74.0)
score:  37.985
score:  34.34
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 19980, epoch 74.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [74.0], Train: total:3431.32202, BCE:-21.78682, KLD:3453.10913,Test: total:13662.70508, BCE:-21.64562, KLD:13684.35059
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 20250, epoch 75.0)
score:  38.07333333333333
score:  34.1
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 20250, epoch 75.0)
[Save Checkpoint] epoch: [75.0], Train: total:3389.88379, BCE:-22.01617, KLD:3411.89844,Test: total:13499.23926, BCE:-21.86003, KLD:13521.10059
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 20520, epoch 76.0)
score:  37.615
score:  33.55
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 20520, epoch 76.0)
[Save Checkpoint] epoch: [76.0], Train: total:3421.60596, BCE:-21.48749, KLD:3443.09033,Test: total:13628.92969, BCE:-21.34778, KLD:13650.27832
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 20790, epoch 77.0)
score:  37.715
score:  33.73
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 20790, epoch 77.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [77.0], Train: total:3392.24292, BCE:-21.44087, KLD:3413.68359,Test: total:13508.49707, BCE:-21.28869, KLD:13529.78613
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 21060, epoch 78.0)
score:  37.58166666666666
score:  33.71
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 21060, epoch 78.0)
[Save Checkpoint] epoch: [78.0], Train: total:3383.56079, BCE:-21.59246, KLD:3405.15356,Test: total:13477.57031, BCE:-21.44949, KLD:13499.01855
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 21330, epoch 79.0)
score:  37.815
score:  34.02
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 21330, epoch 79.0)
[Save Checkpoint] epoch: [79.0], Train: total:3397.52661, BCE:-21.91816, KLD:3419.44482,Test: total:13521.67188, BCE:-21.75567, KLD:13543.42871
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 21600, epoch 80.0)
score:  36.89333333333333
score:  32.76
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 21600, epoch 80.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [80.0], Train: total:3421.97876, BCE:-21.95025, KLD:3443.92920,Test: total:13623.64551, BCE:-21.78331, KLD:13645.42969
Epoch    81: reducing learning rate of group 0 to 2.0000e-04.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 21870, epoch 81.0)
score:  37.08166666666666
score:  33.35
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 21870, epoch 81.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [81.0], Train: total:3457.52637, BCE:-21.73354, KLD:3479.25854,Test: total:13768.88574, BCE:-21.56707, KLD:13790.45508
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 22140, epoch 82.0)
score:  36.92
score:  33.35
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 22140, epoch 82.0)
[Save Checkpoint] epoch: [82.0], Train: total:3446.84961, BCE:-21.71400, KLD:3468.56616,Test: total:13726.82812, BCE:-21.53750, KLD:13748.36621
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 22410, epoch 83.0)
score:  36.705
score:  33.25
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 22410, epoch 83.0)
[Save Checkpoint] epoch: [83.0], Train: total:3434.25586, BCE:-21.64398, KLD:3455.90112,Test: total:13675.69824, BCE:-21.46507, KLD:13697.16309
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 22680, epoch 84.0)
score:  36.41833333333334
score:  32.65
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 22680, epoch 84.0)
[Save Checkpoint] epoch: [84.0], Train: total:3458.88037, BCE:-21.61598, KLD:3480.49609,Test: total:13767.77539, BCE:-21.44116, KLD:13789.21582
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 22950, epoch 85.0)
score:  36.318333333333335
score:  32.66
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 22950, epoch 85.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [85.0], Train: total:3441.72168, BCE:-21.52761, KLD:3463.24951,Test: total:13700.02246, BCE:-21.35472, KLD:13721.37500
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 23220, epoch 86.0)
score:  36.501666666666665
score:  32.68
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 23220, epoch 86.0)
[Save Checkpoint] epoch: [86.0], Train: total:3443.79688, BCE:-21.49841, KLD:3465.29395,Test: total:13710.06445, BCE:-21.31239, KLD:13731.37695
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 23490, epoch 87.0)
score:  36.435
score:  32.81
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 23490, epoch 87.0)
[Save Checkpoint] epoch: [87.0], Train: total:3446.64941, BCE:-21.56484, KLD:3468.21362,Test: total:13716.28613, BCE:-21.38158, KLD:13737.66602
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 23760, epoch 88.0)
score:  36.388333333333335
score:  32.62
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 23760, epoch 88.0)
[Save Checkpoint] epoch: [88.0], Train: total:3440.67896, BCE:-21.52804, KLD:3462.20630,Test: total:13697.33105, BCE:-21.34966, KLD:13718.68262
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 24030, epoch 89.0)
score:  36.37833333333333
score:  32.65
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 24030, epoch 89.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [89.0], Train: total:3449.89844, BCE:-21.54099, KLD:3471.44019,Test: total:13733.09570, BCE:-21.35367, KLD:13754.44824
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 24300, epoch 90.0)
score:  36.42166666666667
score:  32.84
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 24300, epoch 90.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [90.0], Train: total:3470.88037, BCE:-21.56802, KLD:3492.44800,Test: total:13815.57324, BCE:-21.37513, KLD:13836.95020
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 24570, epoch 91.0)
score:  35.968333333333334
score:  32.39
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 24570, epoch 91.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [91.0], Train: total:3454.49829, BCE:-21.62846, KLD:3476.12598,Test: total:13751.74121, BCE:-21.42981, KLD:13773.17090
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 24840, epoch 92.0)
score:  35.82666666666667
score:  32.25
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 24840, epoch 92.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [92.0], Train: total:3439.31445, BCE:-21.55793, KLD:3460.87109,Test: total:13688.92090, BCE:-21.36904, KLD:13710.29102
Epoch    93: reducing learning rate of group 0 to 4.0000e-05.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 25110, epoch 93.0)
score:  36.291666666666664
score:  32.33
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 25110, epoch 93.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [93.0], Train: total:3457.31592, BCE:-21.56723, KLD:3478.88232,Test: total:13764.88770, BCE:-21.37650, KLD:13786.26465
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 25380, epoch 94.0)
score:  36.141666666666666
score:  32.3
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 25380, epoch 94.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [94.0], Train: total:3434.89502, BCE:-21.50462, KLD:3456.39941,Test: total:13674.94238, BCE:-21.32151, KLD:13696.26465
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 25650, epoch 95.0)
score:  36.13
score:  32.19
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 25650, epoch 95.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [95.0], Train: total:3437.88477, BCE:-21.49663, KLD:3459.38062,Test: total:13686.73730, BCE:-21.31105, KLD:13708.04980
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 25920, epoch 96.0)
score:  36.12833333333333
score:  32.76
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 25920, epoch 96.0)
EarlyStopping counter: 8 out of 25
[Save Checkpoint] epoch: [96.0], Train: total:3433.47437, BCE:-21.62686, KLD:3455.09961,Test: total:13670.25684, BCE:-21.44167, KLD:13691.69824
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 26190, epoch 97.0)
score:  36.108333333333334
score:  32.53
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 26190, epoch 97.0)
[Save Checkpoint] epoch: [97.0], Train: total:3438.32153, BCE:-21.56779, KLD:3459.88940,Test: total:13688.07520, BCE:-21.37791, KLD:13709.45215
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 26460, epoch 98.0)
score:  36.18666666666667
score:  32.67
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 26460, epoch 98.0)
[Save Checkpoint] epoch: [98.0], Train: total:3432.83594, BCE:-21.58437, KLD:3454.42090,Test: total:13666.99902, BCE:-21.39850, KLD:13688.39551
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 26730, epoch 99.0)
score:  36.265
score:  32.84
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 26730, epoch 99.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [99.0], Train: total:3432.62671, BCE:-21.60580, KLD:3454.23096,Test: total:13665.27539, BCE:-21.41743, KLD:13686.69043
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 27000, epoch 100.0)
score:  36.025
score:  32.44
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15Hmg4_v6_class_inv_grad_5/last' (iter 27000, epoch 100.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [100.0], Train: total:3435.67310, BCE:-21.61195, KLD:3457.28394,Test: total:13677.01758, BCE:-21.42712, KLD:13698.44434
[Training Finished]
All done !
