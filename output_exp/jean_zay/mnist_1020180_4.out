4
--gpu_devices 0 --max_iter 100 --batch_size 250 --use_scheduler True --lr 1e-3 --GMP True --z_struct_size 15 --z_var_size 10 --is_VAE True --is_encoder_struct False --lambda_BCE 1 --beta 1 --lambda_recons 1 --lambda_EV_class 0.1 --big_kernel_size 8 --two_conv_layer True --three_conv_layer True --kernel_size_1 4 --kernel_size_2 4 --kernel_size_3 4 --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 64 --hidden_filters_layer2 64 --hidden_filters_layer3 64 --dataset_balanced True --binary_z True --binary_first_conv False --binary_second_conv False --binary_third_conv True --use_small_lr_encoder_var False --encoder_var_name None --encoder_struct_name mnist_ES_binary_15 --freeze_Encoder True --EV_classifier True --freeze_Encoder True --grad_inv True --exp_name mnist_VAE_s15_v10_class_inv_grad_2
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, ES_reconstruction=False, EV_classifier=True, GMP=True, Hmg_dst_loss=False, IPC=False, L1_norm_act=False, L1_norm_weights=False, L2_dst_loss=False, L3_without_random=False, LOG_DIR='logs', PT_model=False, PT_model_EV_classifier=False, adapt_lr=False, add_classification_layer=True, add_dl_class=False, add_linear_after_GMP=True, add_z_struct_bottleneck=False, alpha=32, batch_size=250, beta=1.0, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=8, bin_after_GMP=False, binary_chain=False, binary_first_conv=False, binary_second_conv=False, binary_third_conv=True, binary_z=True, both_decoders_freeze=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, contrastive_loss=False, cuda=True, dataset='mnist', dataset_balanced=True, decoder_first_dense=36, decoder_kernel_size_1=4, decoder_kernel_size_2=3, decoder_kernel_size_3=4, decoder_n_filter_1=64, decoder_n_filter_2=64, decoder_n_filter_3=64, decoder_stride_1=2, decoder_stride_2=2, decoder_stride_3=1, diff_var=False, display_step=10000, dset_dir='data', encoder_struct_name='mnist_ES_binary_15', encoder_var_name='None', exp_name='mnist_VAE_s15_v10_class_inv_grad_2', freeze_Encoder=True, gamma=1000, gpu_devices=[0], grad_inv=True, hidden_dim=20, hidden_filters_layer1=64, hidden_filters_layer2=64, hidden_filters_layer3=64, image_size=64, intra_class_variance_loss=False, is_C=True, is_E1=False, is_VAE=True, is_VAE_var=False, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=False, is_default_model=False, is_encoder_struct=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, kernel_size_1=4, kernel_size_2=4, kernel_size_3=4, lambda_BCE=1.0, lambda_EV_class=0.1, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_L2_dst=1, lambda_VAE=1, lambda_class=1, lambda_contrastive_loss=1, lambda_distance_mean=1, lambda_hmg_dst=1, lambda_intra_class_var=1, lambda_partial_class=1, lambda_ratio_reg=1, lambda_recon_wt_rand=1, lambda_recons=1.0, lambda_uniq_code_dst=1, lambda_var_distance=1, lambda_var_inter=1, lambda_var_intra=1, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', loss='Proxy_Anchor', loss_distance_mean=False, loss_min_distance_cl=False, lr=0.001, max_epoch_use_uniq_code_target=5, max_iter=100.0, model='CNN', mrg=0.1, nb_epochs_train_only_zvar=0, num_workers=2, old_weighted=False, optimizer='adamw', other_architecture=False, other_ratio=False, random_percentage=0.2, random_seed=10, randomness=True, ratio_reg=False, remark='', save_step=10000, second_layer_C=False, seed=1, stride_size=1, sz_embedding=5, three_conv_layer=True, train=True, train_var_struct_alternatively=False, two_conv_layer=True, two_encoder=False, uniq_code_dst_loss=False, use_VAE=False, use_decoder=False, use_early_stopping=True, use_scheduler=True, use_small_lr_encoder_var=False, use_structural_encoder=False, value_target_distance_mean=1, var_hidden_dim=256, var_hidden_filters_1=32, var_hidden_filters_2=32, var_hidden_filters_3=32, var_kernel_size_1=3, var_kernel_size_2=3, var_kernel_size_3=3, var_second_cnn_block=True, var_stride_size_1=1, var_stride_size_2=1, var_stride_size_3=1, var_third_cnn_block=False, var_three_conv_layer=False, warm=1, without_acc=False, z_struct_size=15, z_var_size=10, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
[Using Seed: 10]
Balanced dataset loaded
VAE doesn't exist but encoder struct yes ! load struct encoder weighs !
=> loaded checkpoint 'checkpoints_CNN/mnist_ES_binary_15/last (iter 22410)'
Weighs loaded for struct encoder !
use 1 gpu who named: Tesla V100-SXM2-32GB
VAE(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
  )
  (decoder): Sequential(
    (0): Linear(in_features=25, out_features=1600, bias=True)
    (1): ReLU(inplace=True)
    (2): View()
    (3): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (4): ReLU(inplace=True)
    (5): ConvTranspose2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (6): ReLU(inplace=True)
    (7): ConvTranspose2d(64, 32, kernel_size=(3, 3), stride=(1, 1))
    (8): ReLU(inplace=True)
    (9): ConvTranspose2d(32, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (10): ReLU(inplace=True)
    (11): ConvTranspose2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (12): ReLU(inplace=True)
    (13): ConvTranspose2d(32, 1, kernel_size=(3, 3), stride=(1, 1))
    (14): Sigmoid()
  )
  (encoder_var): Sequential(
    (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (4): ReLU(inplace=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Conv2d(32, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (7): ReLU(inplace=True)
    (8): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): Dropout(p=0.4, inplace=False)
    (10): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
    (11): ReLU(inplace=True)
    (12): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (13): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (14): ReLU(inplace=True)
    (15): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Conv2d(64, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (17): ReLU(inplace=True)
    (18): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (19): Dropout(p=0.4, inplace=False)
    (20): View()
    (21): Linear(in_features=1600, out_features=20, bias=True)
  )
  (var_classifier): Sequential(
    (0): RevGrad()
    (1): Linear(in_features=10, out_features=10, bias=True)
  )
)
The number of parameters of model is 499760
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 270, epoch 1.0)
score:  37.32333333333333
score:  35.51
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 270, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train: total:5126.52979, BCE:-17.79269, KLD:5144.32520,Test: total:20565.37500, BCE:-17.87361, KLD:20583.25000
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 540, epoch 2.0)
score:  50.31666666666667
score:  46.27
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 540, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train: total:4649.95996, BCE:-19.48038, KLD:4669.43945,Test: total:18624.46094, BCE:-19.54325, KLD:18644.00391
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 810, epoch 3.0)
score:  59.348333333333336
score:  53.99
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 810, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train: total:4877.99170, BCE:-15.26124, KLD:4893.25293,Test: total:19524.98242, BCE:-15.31617, KLD:19540.29883
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 1080, epoch 4.0)
score:  67.94666666666667
score:  61.76
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 1080, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train: total:4878.27344, BCE:-15.72793, KLD:4894.00098,Test: total:19485.55078, BCE:-15.75680, KLD:19501.30664
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 1350, epoch 5.0)
score:  71.80166666666666
score:  65.36
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 1350, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train: total:5012.50586, BCE:-16.10364, KLD:5028.61230,Test: total:20004.83203, BCE:-16.17528, KLD:20021.00586
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 1620, epoch 6.0)
score:  74.35666666666667
score:  67.41
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 1620, epoch 6.0)
[Save Checkpoint] epoch: [6.0], Train: total:4998.22607, BCE:-14.73920, KLD:5012.96533,Test: total:19922.60156, BCE:-14.79760, KLD:19937.40039
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 1890, epoch 7.0)
score:  76.69333333333333
score:  69.72
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 1890, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train: total:4933.27979, BCE:-14.82843, KLD:4948.10938,Test: total:19660.04688, BCE:-14.89780, KLD:19674.94336
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 2160, epoch 8.0)
score:  78.35333333333334
score:  71.7
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 2160, epoch 8.0)
[Save Checkpoint] epoch: [8.0], Train: total:5018.09082, BCE:-15.62989, KLD:5033.72168,Test: total:20007.09180, BCE:-15.73328, KLD:20022.82617
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 2430, epoch 9.0)
score:  79.56666666666666
score:  72.64
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 2430, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train: total:5093.19873, BCE:-15.97911, KLD:5109.17334,Test: total:20299.78906, BCE:-16.13243, KLD:20315.92188
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 2700, epoch 10.0)
score:  79.74166666666666
score:  72.26
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 2700, epoch 10.0)
[Save Checkpoint] epoch: [10.0], Train: total:5059.72510, BCE:-16.19170, KLD:5075.91455,Test: total:20172.66992, BCE:-16.32503, KLD:20188.99219
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 2970, epoch 11.0)
score:  79.95166666666667
score:  72.12
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 2970, epoch 11.0)
[Save Checkpoint] epoch: [11.0], Train: total:5012.43213, BCE:-15.89707, KLD:5028.32715,Test: total:19966.50391, BCE:-16.04365, KLD:19982.54492
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 3240, epoch 12.0)
score:  80.23833333333333
score:  72.73
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 3240, epoch 12.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [12.0], Train: total:5084.66992, BCE:-16.55570, KLD:5101.22119,Test: total:20259.77344, BCE:-16.73871, KLD:20276.51172
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 3510, epoch 13.0)
score:  80.23333333333333
score:  72.46
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 3510, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train: total:5091.16162, BCE:-17.29563, KLD:5108.45801,Test: total:20277.12305, BCE:-17.50641, KLD:20294.63086
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 3780, epoch 14.0)
score:  80.03666666666666
score:  72.29
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 3780, epoch 14.0)
[Save Checkpoint] epoch: [14.0], Train: total:5013.20459, BCE:-17.10185, KLD:5030.30615,Test: total:19984.17773, BCE:-17.31392, KLD:20001.49023
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 4050, epoch 15.0)
score:  79.91666666666667
score:  72.54
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 4050, epoch 15.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [15.0], Train: total:5030.96338, BCE:-17.57330, KLD:5048.53760,Test: total:20032.17578, BCE:-17.79259, KLD:20049.96680
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 4320, epoch 16.0)
score:  79.95
score:  72.2
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 4320, epoch 16.0)
[Save Checkpoint] epoch: [16.0], Train: total:5076.47266, BCE:-18.01037, KLD:5094.48633,Test: total:20208.48047, BCE:-18.26813, KLD:20226.74805
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 4590, epoch 17.0)
score:  79.57
score:  72.38
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 4590, epoch 17.0)
[Save Checkpoint] epoch: [17.0], Train: total:5067.27148, BCE:-17.78999, KLD:5085.06299,Test: total:20173.90430, BCE:-18.05936, KLD:20191.96680
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 4860, epoch 18.0)
score:  79.44333333333333
score:  71.71
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 4860, epoch 18.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [18.0], Train: total:5019.56641, BCE:-18.17515, KLD:5037.73779,Test: total:19996.76562, BCE:-18.46502, KLD:20015.23242
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 5130, epoch 19.0)
score:  79.44333333333333
score:  72.01
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 5130, epoch 19.0)
[Save Checkpoint] epoch: [19.0], Train: total:5064.30566, BCE:-18.08103, KLD:5082.38574,Test: total:20162.16016, BCE:-18.38550, KLD:20180.54492
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 5400, epoch 20.0)
score:  79.25166666666667
score:  71.49
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 5400, epoch 20.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [20.0], Train: total:5019.16357, BCE:-18.34840, KLD:5037.51367,Test: total:19984.00586, BCE:-18.63245, KLD:20002.63672
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 5670, epoch 21.0)
score:  79.0
score:  71.75
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 5670, epoch 21.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [21.0], Train: total:5046.56982, BCE:-19.35989, KLD:5065.93115,Test: total:20078.79102, BCE:-19.65084, KLD:20098.44336
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 5940, epoch 22.0)
score:  78.59333333333333
score:  71.05
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 5940, epoch 22.0)
[Save Checkpoint] epoch: [22.0], Train: total:4994.25830, BCE:-19.78362, KLD:5014.04297,Test: total:19882.09180, BCE:-20.06581, KLD:19902.16211
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 6210, epoch 23.0)
score:  78.31666666666666
score:  70.95
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 6210, epoch 23.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [23.0], Train: total:5022.77197, BCE:-20.11166, KLD:5042.88281,Test: total:19986.75000, BCE:-20.40195, KLD:20007.15430
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 6480, epoch 24.0)
score:  78.41166666666666
score:  70.7
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 6480, epoch 24.0)
[Save Checkpoint] epoch: [24.0], Train: total:5021.73242, BCE:-19.76512, KLD:5041.49805,Test: total:19988.25586, BCE:-20.05513, KLD:20008.31250
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 6750, epoch 25.0)
score:  77.93333333333334
score:  70.6
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 6750, epoch 25.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [25.0], Train: total:5010.15381, BCE:-20.26723, KLD:5030.41943,Test: total:19944.36328, BCE:-20.55475, KLD:19964.91406
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 7020, epoch 26.0)
score:  78.10333333333334
score:  70.55
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 7020, epoch 26.0)
[Save Checkpoint] epoch: [26.0], Train: total:4989.84473, BCE:-20.93233, KLD:5010.77441,Test: total:19862.51562, BCE:-21.25394, KLD:19883.77148
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 7290, epoch 27.0)
score:  78.11333333333333
score:  70.3
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 7290, epoch 27.0)
[Save Checkpoint] epoch: [27.0], Train: total:5022.00293, BCE:-21.34812, KLD:5043.35059,Test: total:19971.40234, BCE:-21.64740, KLD:19993.05078
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 7560, epoch 28.0)
score:  77.47
score:  70.44
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 7560, epoch 28.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [28.0], Train: total:4957.13623, BCE:-21.56341, KLD:4978.69873,Test: total:19725.95117, BCE:-21.87932, KLD:19747.83203
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 7830, epoch 29.0)
score:  77.07833333333333
score:  69.76
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 7830, epoch 29.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [29.0], Train: total:5004.41992, BCE:-21.97489, KLD:5026.39209,Test: total:19897.58594, BCE:-22.26175, KLD:19919.84961
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 8100, epoch 30.0)
score:  76.97
score:  69.87
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 8100, epoch 30.0)
[Save Checkpoint] epoch: [30.0], Train: total:4996.33643, BCE:-21.99028, KLD:5018.32666,Test: total:19888.69531, BCE:-22.28136, KLD:19910.97656
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 8370, epoch 31.0)
score:  76.89666666666666
score:  69.68
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 8370, epoch 31.0)
[Save Checkpoint] epoch: [31.0], Train: total:4958.25391, BCE:-22.67389, KLD:4980.92480,Test: total:19733.62305, BCE:-22.95649, KLD:19756.58008
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 8640, epoch 32.0)
score:  76.82166666666667
score:  69.25
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 8640, epoch 32.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [32.0], Train: total:4924.61475, BCE:-22.91936, KLD:4947.53760,Test: total:19601.31641, BCE:-23.19493, KLD:19624.51367
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 8910, epoch 33.0)
score:  76.485
score:  68.98
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 8910, epoch 33.0)
[Save Checkpoint] epoch: [33.0], Train: total:5005.36084, BCE:-22.70536, KLD:5028.06738,Test: total:19915.08789, BCE:-22.97521, KLD:19938.06250
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 9180, epoch 34.0)
score:  76.62166666666667
score:  69.46
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 9180, epoch 34.0)
[Save Checkpoint] epoch: [34.0], Train: total:4964.65723, BCE:-22.78965, KLD:4987.44482,Test: total:19753.33398, BCE:-23.05137, KLD:19776.38477
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 9450, epoch 35.0)
score:  76.26833333333333
score:  68.66
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 9450, epoch 35.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [35.0], Train: total:4960.75977, BCE:-22.71258, KLD:4983.47217,Test: total:19741.93164, BCE:-22.99527, KLD:19764.92578
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 9720, epoch 36.0)
score:  76.335
score:  68.92
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 9720, epoch 36.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [36.0], Train: total:4954.76270, BCE:-23.50770, KLD:4978.27100,Test: total:19704.83398, BCE:-23.76195, KLD:19728.59766
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 9990, epoch 37.0)
score:  75.94666666666667
score:  68.48
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 9990, epoch 37.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [37.0], Train: total:4933.15332, BCE:-23.14943, KLD:4956.30469,Test: total:19626.63086, BCE:-23.37919, KLD:19650.00781
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 10260, epoch 38.0)
score:  75.48833333333333
score:  68.23
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 10260, epoch 38.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [38.0], Train: total:4929.53174, BCE:-23.10052, KLD:4952.63379,Test: total:19610.97461, BCE:-23.35021, KLD:19634.32422
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 10530, epoch 39.0)
score:  75.865
score:  68.97
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 10530, epoch 39.0)
[Save Checkpoint] epoch: [39.0], Train: total:4939.27588, BCE:-23.15911, KLD:4962.43506,Test: total:19648.01562, BCE:-23.40254, KLD:19671.41992
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 10800, epoch 40.0)
score:  75.615
score:  68.06
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 10800, epoch 40.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [40.0], Train: total:4984.50635, BCE:-23.76985, KLD:5008.27686,Test: total:19838.74023, BCE:-24.01282, KLD:19862.75391
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 11070, epoch 41.0)
score:  75.43833333333333
score:  68.07
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 11070, epoch 41.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [41.0], Train: total:5037.25293, BCE:-24.00825, KLD:5061.25684,Test: total:20044.36523, BCE:-24.22548, KLD:20068.59180
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 11340, epoch 42.0)
score:  75.25666666666666
score:  68.15
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 11340, epoch 42.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [42.0], Train: total:4949.96777, BCE:-23.72047, KLD:4973.69043,Test: total:19694.69336, BCE:-23.94173, KLD:19718.63086
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 11610, epoch 43.0)
score:  75.14333333333333
score:  67.53
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 11610, epoch 43.0)
[Save Checkpoint] epoch: [43.0], Train: total:4989.49414, BCE:-24.17312, KLD:5013.66797,Test: total:19858.67969, BCE:-24.42311, KLD:19883.10547
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 11880, epoch 44.0)
score:  74.55166666666666
score:  67.53
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 11880, epoch 44.0)
[Save Checkpoint] epoch: [44.0], Train: total:4916.62939, BCE:-24.23154, KLD:4940.85986,Test: total:19571.54688, BCE:-24.45105, KLD:19596.00000
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 12150, epoch 45.0)
score:  74.55666666666667
score:  67.46
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 12150, epoch 45.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [45.0], Train: total:4905.80811, BCE:-23.94655, KLD:4929.75488,Test: total:19508.48242, BCE:-24.17813, KLD:19532.65625
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 12420, epoch 46.0)
score:  74.36833333333334
score:  67.17
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 12420, epoch 46.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [46.0], Train: total:4960.52881, BCE:-24.27240, KLD:4984.80127,Test: total:19736.75391, BCE:-24.50683, KLD:19761.26367
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 12690, epoch 47.0)
score:  74.15
score:  66.88
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 12690, epoch 47.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [47.0], Train: total:4944.08105, BCE:-24.48520, KLD:4968.56543,Test: total:19654.63086, BCE:-24.70065, KLD:19679.33203
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 12960, epoch 48.0)
score:  74.06
score:  66.93
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 12960, epoch 48.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [48.0], Train: total:4848.04150, BCE:-24.33270, KLD:4872.37500,Test: total:19285.82617, BCE:-24.55380, KLD:19310.37891
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 13230, epoch 49.0)
score:  73.80833333333334
score:  66.59
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 13230, epoch 49.0)
[Save Checkpoint] epoch: [49.0], Train: total:4946.08594, BCE:-24.27271, KLD:4970.35938,Test: total:19682.97656, BCE:-24.48816, KLD:19707.46484
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 13500, epoch 50.0)
score:  73.61666666666666
score:  66.71
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 13500, epoch 50.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [50.0], Train: total:4914.25293, BCE:-24.79159, KLD:4939.04541,Test: total:19562.78516, BCE:-25.02571, KLD:19587.81250
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 13770, epoch 51.0)
score:  73.55833333333334
score:  66.6
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 13770, epoch 51.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [51.0], Train: total:4894.75537, BCE:-24.63507, KLD:4919.39062,Test: total:19467.92969, BCE:-24.86374, KLD:19492.79492
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 14040, epoch 52.0)
score:  73.81
score:  66.71
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 14040, epoch 52.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [52.0], Train: total:4891.99756, BCE:-24.61890, KLD:4916.61426,Test: total:19458.99414, BCE:-24.81634, KLD:19483.81055
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 14310, epoch 53.0)
score:  73.11833333333334
score:  65.9
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 14310, epoch 53.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [53.0], Train: total:4834.68457, BCE:-24.82306, KLD:4859.50977,Test: total:19239.25391, BCE:-25.00973, KLD:19264.26367
Epoch    54: reducing learning rate of group 0 to 2.0000e-04.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 14580, epoch 54.0)
score:  73.13833333333334
score:  66.4
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 14580, epoch 54.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [54.0], Train: total:4931.30273, BCE:-24.68131, KLD:4955.98486,Test: total:19623.67188, BCE:-24.89057, KLD:19648.56055
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 14850, epoch 55.0)
score:  72.81833333333333
score:  65.57
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 14850, epoch 55.0)
[Save Checkpoint] epoch: [55.0], Train: total:4874.92627, BCE:-24.38207, KLD:4899.30908,Test: total:19394.16992, BCE:-24.55978, KLD:19418.73242
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 15120, epoch 56.0)
score:  72.82333333333334
score:  65.57
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 15120, epoch 56.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [56.0], Train: total:4885.57617, BCE:-24.63115, KLD:4910.20752,Test: total:19435.16992, BCE:-24.83184, KLD:19460.00000
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 15390, epoch 57.0)
score:  72.73
score:  66.02
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 15390, epoch 57.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [57.0], Train: total:4886.95215, BCE:-24.57994, KLD:4911.53125,Test: total:19442.82617, BCE:-24.80378, KLD:19467.63086
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 15660, epoch 58.0)
score:  72.605
score:  65.94
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 15660, epoch 58.0)
[Save Checkpoint] epoch: [58.0], Train: total:4888.30713, BCE:-24.78137, KLD:4913.08936,Test: total:19448.83984, BCE:-24.96775, KLD:19473.81055
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 15930, epoch 59.0)
score:  72.66166666666666
score:  65.53
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 15930, epoch 59.0)
[Save Checkpoint] epoch: [59.0], Train: total:4882.89600, BCE:-24.70574, KLD:4907.60010,Test: total:19424.26758, BCE:-24.89836, KLD:19449.16406
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 16200, epoch 60.0)
score:  72.40833333333333
score:  65.44
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 16200, epoch 60.0)
[Save Checkpoint] epoch: [60.0], Train: total:4873.32178, BCE:-24.89610, KLD:4898.22119,Test: total:19378.56836, BCE:-25.05787, KLD:19403.62500
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 16470, epoch 61.0)
score:  72.395
score:  65.55
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 16470, epoch 61.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [61.0], Train: total:4884.01465, BCE:-24.90592, KLD:4908.92334,Test: total:19423.84961, BCE:-25.08964, KLD:19448.93555
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 16740, epoch 62.0)
score:  72.305
score:  65.33
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 16740, epoch 62.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [62.0], Train: total:4851.12305, BCE:-24.90221, KLD:4876.02588,Test: total:19294.39648, BCE:-25.10691, KLD:19319.50391
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 17010, epoch 63.0)
score:  72.26666666666667
score:  65.24
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 17010, epoch 63.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [63.0], Train: total:4877.85156, BCE:-24.86708, KLD:4902.71924,Test: total:19396.60938, BCE:-25.05710, KLD:19421.66406
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 17280, epoch 64.0)
score:  72.38833333333334
score:  65.39
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 17280, epoch 64.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [64.0], Train: total:4880.20801, BCE:-24.68760, KLD:4904.89111,Test: total:19401.62695, BCE:-24.86895, KLD:19426.49609
Epoch    65: reducing learning rate of group 0 to 4.0000e-05.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 17550, epoch 65.0)
score:  72.285
score:  65.4
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 17550, epoch 65.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [65.0], Train: total:4869.62061, BCE:-24.99779, KLD:4894.61914,Test: total:19361.05273, BCE:-25.18468, KLD:19386.24023
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 17820, epoch 66.0)
score:  72.10833333333333
score:  65.5
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 17820, epoch 66.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [66.0], Train: total:4863.31006, BCE:-24.85728, KLD:4888.16943,Test: total:19341.99023, BCE:-25.06166, KLD:19367.05078
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 18090, epoch 67.0)
score:  71.97333333333333
score:  65.38
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 18090, epoch 67.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [67.0], Train: total:4857.18994, BCE:-24.89550, KLD:4882.08643,Test: total:19316.68359, BCE:-25.09799, KLD:19341.78320
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 18360, epoch 68.0)
score:  72.07833333333333
score:  65.38
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 18360, epoch 68.0)
[Save Checkpoint] epoch: [68.0], Train: total:4867.01172, BCE:-24.86711, KLD:4891.87988,Test: total:19353.40039, BCE:-25.05899, KLD:19378.45898
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 18630, epoch 69.0)
score:  72.125
score:  65.39
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 18630, epoch 69.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [69.0], Train: total:4864.36035, BCE:-24.80354, KLD:4889.16406,Test: total:19342.24805, BCE:-25.02151, KLD:19367.26953
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 18900, epoch 70.0)
score:  72.13166666666666
score:  65.25
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 18900, epoch 70.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [70.0], Train: total:4867.60107, BCE:-24.97964, KLD:4892.58203,Test: total:19355.70898, BCE:-25.17442, KLD:19380.88086
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 19170, epoch 71.0)
score:  72.15833333333333
score:  65.67
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 19170, epoch 71.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [71.0], Train: total:4867.79736, BCE:-24.88782, KLD:4892.68457,Test: total:19359.43945, BCE:-25.09818, KLD:19384.53711
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 19440, epoch 72.0)
score:  72.12833333333333
score:  64.98
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 19440, epoch 72.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [72.0], Train: total:4868.89600, BCE:-24.91231, KLD:4893.80811,Test: total:19359.49023, BCE:-25.13098, KLD:19384.62305
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 19710, epoch 73.0)
score:  71.99166666666666
score:  64.93
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 19710, epoch 73.0)
[Save Checkpoint] epoch: [73.0], Train: total:4861.42188, BCE:-24.84551, KLD:4886.26611,Test: total:19332.72461, BCE:-25.07782, KLD:19357.80273
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 19980, epoch 74.0)
score:  72.11666666666666
score:  65.05
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 19980, epoch 74.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [74.0], Train: total:4879.56982, BCE:-24.93152, KLD:4904.49854,Test: total:19405.20898, BCE:-25.12021, KLD:19430.32812
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 20250, epoch 75.0)
score:  72.15666666666667
score:  65.28
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 20250, epoch 75.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [75.0], Train: total:4856.71582, BCE:-25.04646, KLD:4881.76172,Test: total:19315.15820, BCE:-25.24317, KLD:19340.40234
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 20520, epoch 76.0)
score:  71.945
score:  65.25
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 20520, epoch 76.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [76.0], Train: total:4862.95557, BCE:-25.06777, KLD:4888.02148,Test: total:19339.42969, BCE:-25.27093, KLD:19364.70117
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 20790, epoch 77.0)
score:  71.95333333333333
score:  65.37
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 20790, epoch 77.0)
[Save Checkpoint] epoch: [77.0], Train: total:4859.63135, BCE:-24.99179, KLD:4884.62451,Test: total:19324.39453, BCE:-25.21048, KLD:19349.60352
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 21060, epoch 78.0)
score:  72.05666666666667
score:  65.52
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 21060, epoch 78.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [78.0], Train: total:4865.61377, BCE:-24.99427, KLD:4890.60889,Test: total:19349.65430, BCE:-25.19430, KLD:19374.84766
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 21330, epoch 79.0)
score:  72.08333333333333
score:  65.08
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 21330, epoch 79.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [79.0], Train: total:4857.68311, BCE:-24.96645, KLD:4882.65332,Test: total:19317.56836, BCE:-25.18012, KLD:19342.75000
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 21600, epoch 80.0)
score:  72.04166666666667
score:  64.97
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 21600, epoch 80.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [80.0], Train: total:4873.87158, BCE:-25.06295, KLD:4898.93408,Test: total:19384.37305, BCE:-25.25262, KLD:19409.62695
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 21870, epoch 81.0)
score:  72.105
score:  64.84
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 21870, epoch 81.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [81.0], Train: total:4853.83154, BCE:-25.06761, KLD:4878.89795,Test: total:19304.51367, BCE:-25.26144, KLD:19329.77930
Epoch    82: reducing learning rate of group 0 to 8.0000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 22140, epoch 82.0)
score:  72.15166666666667
score:  65.04
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 22140, epoch 82.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [82.0], Train: total:4865.80957, BCE:-25.01788, KLD:4890.82617,Test: total:19350.42969, BCE:-25.21041, KLD:19375.63867
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 22410, epoch 83.0)
score:  72.15166666666667
score:  65.16
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 22410, epoch 83.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [83.0], Train: total:4857.86035, BCE:-25.02101, KLD:4882.88135,Test: total:19318.32031, BCE:-25.21435, KLD:19343.53516
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 22680, epoch 84.0)
score:  71.965
score:  65.15
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 22680, epoch 84.0)
[Save Checkpoint] epoch: [84.0], Train: total:4854.62451, BCE:-25.04144, KLD:4879.66650,Test: total:19306.10938, BCE:-25.22379, KLD:19331.33398
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 22950, epoch 85.0)
score:  72.09833333333333
score:  65.21
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 22950, epoch 85.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [85.0], Train: total:4857.73730, BCE:-25.02941, KLD:4882.76660,Test: total:19318.29688, BCE:-25.23426, KLD:19343.53516
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 23220, epoch 86.0)
score:  71.91333333333333
score:  65.04
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 23220, epoch 86.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [86.0], Train: total:4860.17188, BCE:-25.01699, KLD:4885.18848,Test: total:19328.76953, BCE:-25.19974, KLD:19353.96680
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 23490, epoch 87.0)
score:  72.10166666666667
score:  65.44
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 23490, epoch 87.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [87.0], Train: total:4864.02148, BCE:-25.00914, KLD:4889.03223,Test: total:19344.38477, BCE:-25.20052, KLD:19369.58398
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 23760, epoch 88.0)
score:  72.11
score:  65.38
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 23760, epoch 88.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [88.0], Train: total:4864.52783, BCE:-25.03457, KLD:4889.56055,Test: total:19346.55469, BCE:-25.22662, KLD:19371.77930
Epoch    89: reducing learning rate of group 0 to 1.6000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 24030, epoch 89.0)
score:  72.07833333333333
score:  64.99
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 24030, epoch 89.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [89.0], Train: total:4856.79639, BCE:-25.04728, KLD:4881.84229,Test: total:19315.72461, BCE:-25.22380, KLD:19340.94922
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 24300, epoch 90.0)
score:  71.945
score:  65.26
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 24300, epoch 90.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [90.0], Train: total:4860.18115, BCE:-25.06954, KLD:4885.25000,Test: total:19329.34180, BCE:-25.26180, KLD:19354.60156
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 24570, epoch 91.0)
score:  72.01
score:  65.07
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 24570, epoch 91.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [91.0], Train: total:4861.50342, BCE:-25.08717, KLD:4886.58887,Test: total:19334.51172, BCE:-25.28621, KLD:19359.79883
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 24840, epoch 92.0)
score:  72.13166666666666
score:  65.02
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 24840, epoch 92.0)
EarlyStopping counter: 8 out of 25
[Save Checkpoint] epoch: [92.0], Train: total:4861.42236, BCE:-25.08836, KLD:4886.51221,Test: total:19334.13867, BCE:-25.29750, KLD:19359.43555
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 25110, epoch 93.0)
score:  71.91166666666666
score:  65.26
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 25110, epoch 93.0)
EarlyStopping counter: 9 out of 25
[Save Checkpoint] epoch: [93.0], Train: total:4861.31934, BCE:-25.08551, KLD:4886.40527,Test: total:19333.80273, BCE:-25.27579, KLD:19359.07812
Epoch    94: reducing learning rate of group 0 to 1.0000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 25380, epoch 94.0)
score:  72.07666666666667
score:  65.25
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 25380, epoch 94.0)
EarlyStopping counter: 10 out of 25
[Save Checkpoint] epoch: [94.0], Train: total:4860.86865, BCE:-25.06970, KLD:4885.93701,Test: total:19331.79492, BCE:-25.25408, KLD:19357.04688
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 25650, epoch 95.0)
score:  71.95833333333333
score:  64.98
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 25650, epoch 95.0)
EarlyStopping counter: 11 out of 25
[Save Checkpoint] epoch: [95.0], Train: total:4861.85547, BCE:-25.09024, KLD:4886.94287,Test: total:19336.24414, BCE:-25.27488, KLD:19361.52148
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 25920, epoch 96.0)
score:  72.09333333333333
score:  65.13
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 25920, epoch 96.0)
EarlyStopping counter: 12 out of 25
[Save Checkpoint] epoch: [96.0], Train: total:4862.09424, BCE:-25.09892, KLD:4887.19336,Test: total:19337.09375, BCE:-25.29492, KLD:19362.38867
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 26190, epoch 97.0)
score:  71.88166666666666
score:  65.01
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 26190, epoch 97.0)
EarlyStopping counter: 13 out of 25
[Save Checkpoint] epoch: [97.0], Train: total:4861.78662, BCE:-25.10349, KLD:4886.89062,Test: total:19335.95703, BCE:-25.29770, KLD:19361.25391
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 26460, epoch 98.0)
score:  71.98833333333333
score:  64.72
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 26460, epoch 98.0)
EarlyStopping counter: 14 out of 25
[Save Checkpoint] epoch: [98.0], Train: total:4861.64551, BCE:-25.09748, KLD:4886.74561,Test: total:19335.40039, BCE:-25.31079, KLD:19360.71094
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 26730, epoch 99.0)
score:  72.075
score:  65.26
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 26730, epoch 99.0)
EarlyStopping counter: 15 out of 25
[Save Checkpoint] epoch: [99.0], Train: total:4860.86621, BCE:-25.09592, KLD:4885.96631,Test: total:19332.22656, BCE:-25.29515, KLD:19357.52148
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 27000, epoch 100.0)
score:  71.94666666666667
score:  65.05
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2/last' (iter 27000, epoch 100.0)
EarlyStopping counter: 16 out of 25
[Save Checkpoint] epoch: [100.0], Train: total:4859.93213, BCE:-25.09879, KLD:4885.03223,Test: total:19328.57812, BCE:-25.30013, KLD:19353.87891
[Training Finished]
All done !
