Loading pytorch-gpu/py3/1.6.0
  Loading requirement: gcc/8.3.1 cuda/10.2 nccl/2.6.4-1-cuda
    cudnn/7.6.5.32-cuda-10.2 intel-mkl/2020.1 magma/2.5.3-cuda
    openmpi/4.0.2-cuda
++ sed -n 22p parameters_combinations/mnist_classifier_ratio.txt
+ LINE='--gpu_devices 0 --max_iter 100 --batch_size 250 --use_scheduler True --lr 1e-3 --GMP True --z_struct_size 15 --z_var_size 8 --is_VAE True --is_encoder_struct False --lambda_BCE 1 --beta 1 --lambda_struct_recons_class 10  --loss_struct_recons_class True --big_kernel_size 8 --two_conv_layer True --three_conv_layer True --kernel_size_1 4 --kernel_size_2 4 --kernel_size_3 4 --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 64 --hidden_filters_layer2 64 --hidden_filters_layer3 64 --dataset_balanced True --binary_z True --binary_first_conv False --binary_second_conv False --binary_third_conv True --use_small_lr_encoder_var False --encoder_var_name None --encoder_struct_name mnist_ES_binary_15_Hmg_dst_4_2nd_test --freeze_Encoder True --size_average False --div_loss_per_batch False --exp_name mnist_VAE_s15Hmg4_v8_zstruct_class_4_mon_loss_2'
+ echo --gpu_devices 0 --max_iter 100 --batch_size 250 --use_scheduler True --lr 1e-3 --GMP True --z_struct_size 15 --z_var_size 8 --is_VAE True --is_encoder_struct False --lambda_BCE 1 --beta 1 --lambda_struct_recons_class 10 --loss_struct_recons_class True --big_kernel_size 8 --two_conv_layer True --three_conv_layer True --kernel_size_1 4 --kernel_size_2 4 --kernel_size_3 4 --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 64 --hidden_filters_layer2 64 --hidden_filters_layer3 64 --dataset_balanced True --binary_z True --binary_first_conv False --binary_second_conv False --binary_third_conv True --use_small_lr_encoder_var False --encoder_var_name None --encoder_struct_name mnist_ES_binary_15_Hmg_dst_4_2nd_test --freeze_Encoder True --size_average False --div_loss_per_batch False --exp_name mnist_VAE_s15Hmg4_v8_zstruct_class_4_mon_loss_2
+ python3 -u main.py --gpu_devices 0 --max_iter 100 --batch_size 250 --use_scheduler True --lr 1e-3 --GMP True --z_struct_size 15 --z_var_size 8 --is_VAE True --is_encoder_struct False --lambda_BCE 1 --beta 1 --lambda_struct_recons_class 10 --loss_struct_recons_class True --big_kernel_size 8 --two_conv_layer True --three_conv_layer True --kernel_size_1 4 --kernel_size_2 4 --kernel_size_3 4 --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 64 --hidden_filters_layer2 64 --hidden_filters_layer3 64 --dataset_balanced True --binary_z True --binary_first_conv False --binary_second_conv False --binary_third_conv True --use_small_lr_encoder_var False --encoder_var_name None --encoder_struct_name mnist_ES_binary_15_Hmg_dst_4_2nd_test --freeze_Encoder True --size_average False --div_loss_per_batch False --exp_name mnist_VAE_s15Hmg4_v8_zstruct_class_4_mon_loss_2
--- Logging error ---
Traceback (most recent call last):
  File "/gpfslocalsup/pub/anaconda-py3/2020.02/envs/pytorch-gpu-1.6.0/lib/python3.7/logging/__init__.py", line 1025, in emit
    msg = self.format(record)
  File "/gpfslocalsup/pub/anaconda-py3/2020.02/envs/pytorch-gpu-1.6.0/lib/python3.7/logging/__init__.py", line 869, in format
    return fmt.format(record)
  File "/gpfslocalsup/pub/anaconda-py3/2020.02/envs/pytorch-gpu-1.6.0/lib/python3.7/logging/__init__.py", line 611, in format
    s = self.formatMessage(record)
  File "/gpfslocalsup/pub/anaconda-py3/2020.02/envs/pytorch-gpu-1.6.0/lib/python3.7/logging/__init__.py", line 580, in formatMessage
    return self._style.format(record)
  File "/gpfslocalsup/pub/anaconda-py3/2020.02/envs/pytorch-gpu-1.6.0/lib/python3.7/logging/__init__.py", line 422, in format
    return self._fmt % record.__dict__
KeyError: 'asc_time'
Call stack:
  File "main.py", line 341, in <module>
    main(args)
  File "main.py", line 31, in main
    net = SolverClassifier(arguments)
  File "/gpfsdswork/projects/rech/rjg/uiu23ko/Thesis/Pytorch_vanilla_Beta_VAE/solver_classifier.py", line 422, in __init__
    self.test_loader_size))
Message: 'Dataset mnist: train with 60000 samples and 10000 test samples'
Arguments: ()
  0%|          | 0/100.0 [00:00<?, ?it/s]  2%|▏         | 2/100.0 [00:01<01:20,  1.22it/s]  4%|▍         | 4/100.0 [00:01<00:57,  1.68it/s]  6%|▌         | 6/100.0 [00:01<00:40,  2.30it/s]  8%|▊         | 8/100.0 [00:02<00:29,  3.10it/s] 10%|█         | 10/100.0 [00:02<00:21,  4.10it/s] 12%|█▏        | 12/100.0 [00:02<00:16,  5.29it/s] 14%|█▍        | 14/100.0 [00:02<00:12,  6.65it/s] 16%|█▌        | 16/100.0 [00:02<00:10,  8.10it/s] 18%|█▊        | 18/100.0 [00:02<00:08,  9.57it/s] 20%|██        | 20/100.0 [00:02<00:07, 10.95it/s] 22%|██▏       | 22/100.0 [00:02<00:06, 12.20it/s] 24%|██▍       | 24/100.0 [00:02<00:05, 13.24it/s] 26%|██▌       | 26/100.0 [00:03<00:05, 14.09it/s] 28%|██▊       | 28/100.0 [00:03<00:04, 14.74it/s] 30%|███       | 30/100.0 [00:03<00:04, 15.25it/s] 32%|███▏      | 32/100.0 [00:03<00:04, 15.62it/s] 34%|███▍      | 34/100.0 [00:03<00:04, 15.88it/s] 36%|███▌      | 36/100.0 [00:03<00:03, 16.08it/s] 38%|███▊      | 38/100.0 [00:03<00:03, 16.22it/s] 40%|████      | 40/100.0 [00:03<00:03, 16.31it/s] 42%|████▏     | 42/100.0 [00:04<00:03, 16.38it/s] 44%|████▍     | 44/100.0 [00:04<00:03, 16.44it/s] 46%|████▌     | 46/100.0 [00:04<00:03, 16.47it/s] 48%|████▊     | 48/100.0 [00:04<00:03, 16.49it/s] 50%|█████     | 50/100.0 [00:04<00:03, 16.50it/s] 52%|█████▏    | 52/100.0 [00:04<00:02, 16.51it/s] 54%|█████▍    | 54/100.0 [00:04<00:02, 16.53it/s] 56%|█████▌    | 56/100.0 [00:04<00:02, 16.53it/s] 58%|█████▊    | 58/100.0 [00:05<00:02, 16.53it/s] 60%|██████    | 60/100.0 [00:05<00:02, 16.53it/s] 62%|██████▏   | 62/100.0 [00:05<00:02, 16.54it/s] 64%|██████▍   | 64/100.0 [00:05<00:02, 16.54it/s] 66%|██████▌   | 66/100.0 [00:05<00:02, 16.54it/s] 68%|██████▊   | 68/100.0 [00:05<00:01, 16.55it/s] 70%|███████   | 70/100.0 [00:05<00:01, 16.54it/s] 72%|███████▏  | 72/100.0 [00:05<00:01, 16.54it/s] 74%|███████▍  | 74/100.0 [00:06<00:01, 16.55it/s] 76%|███████▌  | 76/100.0 [00:06<00:01, 16.55it/s] 78%|███████▊  | 78/100.0 [00:06<00:01, 16.54it/s] 80%|████████  | 80/100.0 [00:06<00:01, 16.53it/s] 82%|████████▏ | 82/100.0 [00:06<00:01, 16.53it/s] 84%|████████▍ | 84/100.0 [00:06<00:00, 16.54it/s] 86%|████████▌ | 86/100.0 [00:06<00:00, 16.54it/s] 88%|████████▊ | 88/100.0 [00:06<00:00, 16.54it/s] 90%|█████████ | 90/100.0 [00:06<00:00, 16.55it/s] 92%|█████████▏| 92/100.0 [00:07<00:00, 16.55it/s] 94%|█████████▍| 94/100.0 [00:07<00:00, 16.54it/s] 96%|█████████▌| 96/100.0 [00:07<00:00, 16.55it/s] 98%|█████████▊| 98/100.0 [00:07<00:00, 16.55it/s]100%|██████████| 100/100.0 [00:07<00:00, 16.54it/s]102it [00:07, 16.55it/s]                           104it [00:07, 16.54it/s]106it [00:07, 16.53it/s]108it [00:08, 16.54it/s]110it [00:08, 16.55it/s]112it [00:08, 16.56it/s]114it [00:08, 16.55it/s]116it [00:08, 16.56it/s]118it [00:08, 16.54it/s]120it [00:08, 16.53it/s]122it [00:08, 16.54it/s]124it [00:09, 16.55it/s]126it [00:09, 16.54it/s]128it [00:09, 16.54it/s]130it [00:09, 16.55it/s]132it [00:09, 16.55it/s]134it [00:09, 16.57it/s]136it [00:09, 16.56it/s]138it [00:09, 16.57it/s]140it [00:09, 16.57it/s]142it [00:10, 16.58it/s]144it [00:10, 16.59it/s]146it [00:10, 16.59it/s]148it [00:10, 16.59it/s]150it [00:10, 16.58it/s]152it [00:10, 16.58it/s]154it [00:10, 16.58it/s]156it [00:10, 16.58it/s]158it [00:11, 16.58it/s]160it [00:11, 16.58it/s]162it [00:11, 16.59it/s]164it [00:11, 16.59it/s]166it [00:11, 16.58it/s]168it [00:11, 16.58it/s]170it [00:11, 16.59it/s]172it [00:11, 16.59it/s]174it [00:12, 16.59it/s]176it [00:12, 16.59it/s]178it [00:12, 16.59it/s]180it [00:12, 16.59it/s]182it [00:12, 16.59it/s]184it [00:12, 16.59it/s]186it [00:12, 16.59it/s]188it [00:12, 16.58it/s]190it [00:13, 16.58it/s]192it [00:13, 16.58it/s]194it [00:13, 16.58it/s]196it [00:13, 16.57it/s]198it [00:13, 16.57it/s]200it [00:13, 16.58it/s]202it [00:13, 16.58it/s]204it [00:13, 16.59it/s]206it [00:13, 16.59it/s]208it [00:14, 16.57it/s]210it [00:14, 16.58it/s]212it [00:14, 16.58it/s]214it [00:14, 16.58it/s]216it [00:14, 16.58it/s]218it [00:14, 16.57it/s]220it [00:14, 16.57it/s]222it [00:14, 16.58it/s]224it [00:15, 16.58it/s]226it [00:15, 16.58it/s]228it [00:15, 16.58it/s]230it [00:15, 16.58it/s]232it [00:15, 16.58it/s]234it [00:15, 16.58it/s]236it [00:15, 16.57it/s]238it [00:15, 16.59it/s]240it [00:16, 16.59it/s]242it [00:16, 16.58it/s]244it [00:16, 16.58it/s]246it [00:16, 16.58it/s]248it [00:16, 16.58it/s]250it [00:16, 16.59it/s]252it [00:16, 16.59it/s]254it [00:16, 16.58it/s]256it [00:16, 16.58it/s]258it [00:17, 16.58it/s]260it [00:17, 16.58it/s]262it [00:17, 16.58it/s]264it [00:17, 16.59it/s]266it [00:17, 16.58it/s]268it [00:17, 16.58it/s]270it [00:17, 17.03it/s]Traceback (most recent call last):
  File "main.py", line 341, in <module>
    main(args)
  File "main.py", line 34, in main
    net.train()
  File "/gpfsdswork/projects/rech/rjg/uiu23ko/Thesis/Pytorch_vanilla_Beta_VAE/solver_classifier.py", line 1027, in train
    self.lambda_recons)
  File "/gpfsdswork/projects/rech/rjg/uiu23ko/Thesis/Pytorch_vanilla_Beta_VAE/solver_classifier.py", line 167, in compute_scores_and_loss_VAE
    lambda_recons)
  File "/gpfsdswork/projects/rech/rjg/uiu23ko/Thesis/Pytorch_vanilla_Beta_VAE/scores_classifier.py", line 165, in compute_scores_VAE
    prediction_var, prediction_struct = net(data, loss_struct_recons_class=loss_struct_recons_class)
  File "/gpfslocalsup/pub/anaconda-py3/2020.02/envs/pytorch-gpu-1.6.0/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/gpfsdswork/projects/rech/rjg/uiu23ko/Thesis/Pytorch_vanilla_Beta_VAE/models/VAE.py", line 394, in forward
    z_struct_rand_var = torch.cat((z_var_rand, z_struct), dim=1)
RuntimeError: All input tensors must be on the same device. Received cpu and cuda:0
270it [00:17, 15.00it/s]
+ wait
+ echo 'All done !'
