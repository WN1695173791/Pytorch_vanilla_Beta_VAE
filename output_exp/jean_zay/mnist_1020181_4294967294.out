use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_ES_binary_15_Hmg_dst_1_2nd_test-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 143/980. In percent: 0.14591836734693878
class 1: unique code: 68/1135. In percent: 0.05991189427312775
class 2: unique code: 154/1032. In percent: 0.14922480620155038
class 3: unique code: 84/1010. In percent: 0.08316831683168317
class 4: unique code: 101/982. In percent: 0.10285132382892057
class 5: unique code: 134/892. In percent: 0.15022421524663676
class 6: unique code: 83/958. In percent: 0.08663883089770355
class 7: unique code: 152/1028. In percent: 0.14785992217898833
class 8: unique code: 93/974. In percent: 0.09548254620123203
class 9: unique code: 106/1009. In percent: 0.10505450941526263
class 0: Average distance Hamming: tensor([2.0062])
class 1: Average distance Hamming: tensor([1.2507])
class 2: Average distance Hamming: tensor([1.9181])
class 3: Average distance Hamming: tensor([0.9924])
class 4: Average distance Hamming: tensor([1.6397])
class 5: Average distance Hamming: tensor([1.6689])
class 6: Average distance Hamming: tensor([1.1498])
class 7: Average distance Hamming: tensor([2.0723])
class 8: Average distance Hamming: tensor([1.3206])
class 9: Average distance Hamming: tensor([1.3040])
average distance: 1.5322692394256592
save z_struct representation for model mnist_ES_binary_15_Hmg_dst_1_2nd_test
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_ES_binary_15_Hmg_dst_1_2nd_test
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_ES_binary_15_Hmg_dst_1_2nd_test, shape: (10, 15)
save std z_struct representation for model mnist_ES_binary_15_Hmg_dst_1_2nd_test, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 0.2826685
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 143/980. In percent: 0.14591836734693878
class 1: unique code: 68/1135. In percent: 0.05991189427312775
class 2: unique code: 154/1032. In percent: 0.14922480620155038
class 3: unique code: 84/1010. In percent: 0.08316831683168317
class 4: unique code: 101/982. In percent: 0.10285132382892057
class 5: unique code: 134/892. In percent: 0.15022421524663676
class 6: unique code: 83/958. In percent: 0.08663883089770355
class 7: unique code: 152/1028. In percent: 0.14785992217898833
class 8: unique code: 93/974. In percent: 0.09548254620123203
class 9: unique code: 106/1009. In percent: 0.10505450941526263
__________------Hamming distance:------__________
class 0: Average distance Hamming: 2.006162166595459
class 1: Average distance Hamming: 1.2507190704345703
class 2: Average distance Hamming: 1.91808021068573
class 3: Average distance Hamming: 0.99244225025177
class 4: Average distance Hamming: 1.639683485031128
class 5: Average distance Hamming: 1.6689163446426392
class 6: Average distance Hamming: 1.149787425994873
class 7: Average distance Hamming: 2.0722875595092773
class 8: Average distance Hamming: 1.320575475692749
class 9: Average distance Hamming: 1.3040374517440796
average distance: 1.5322692394256592
for class 0, we have 256 z_struct with code [1. 1. 0. 1. 0. 1. 1. 0. 1. 0. 0. 0. 0. 1. 0.]. It represent 26.122% of total z_struct class
for class 1, we have 619 z_struct with code [0. 0. 1. 1. 1. 1. 0. 1. 0. 0. 0. 0. 1. 1. 1.]. It represent 54.537% of total z_struct class
for class 2, we have 302 z_struct with code [1. 1. 1. 1. 1. 1. 1. 0. 0. 1. 1. 0. 0. 0. 0.]. It represent 29.264% of total z_struct class
for class 3, we have 636 z_struct with code [0. 1. 1. 1. 0. 1. 0. 0. 0. 1. 1. 1. 1. 0. 0.]. It represent 62.97% of total z_struct class
for class 4, we have 387 z_struct with code [1. 0. 1. 1. 0. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1.]. It represent 39.409% of total z_struct class
for class 5, we have 434 z_struct with code [0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 1. 1. 1. 0. 1.]. It represent 48.655% of total z_struct class
for class 6, we have 604 z_struct with code [1. 0. 0. 1. 1. 1. 1. 1. 0. 1. 1. 0. 0. 1. 0.]. It represent 63.048% of total z_struct class
for class 7, we have 348 z_struct with code [0. 1. 1. 0. 0. 1. 0. 1. 0. 0. 0. 1. 1. 1. 0.]. It represent 33.852% of total z_struct class
for class 8, we have 567 z_struct with code [0. 1. 1. 0. 1. 1. 0. 0. 1. 1. 1. 0. 0. 0. 1.]. It represent 58.214% of total z_struct class
for class 9, we have 565 z_struct with code [0. 0. 1. 0. 0. 1. 1. 1. 1. 1. 1. 0. 1. 1. 0.]. It represent 55.996% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 100.0 %
figure saved for model mnist_ES_binary_15_Hmg_dst_1_2nd_test
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_ES_binary_15_Hmg_dst_2_2nd_test-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 143/980. In percent: 0.14591836734693878
class 1: unique code: 68/1135. In percent: 0.05991189427312775
class 2: unique code: 154/1032. In percent: 0.14922480620155038
class 3: unique code: 84/1010. In percent: 0.08316831683168317
class 4: unique code: 101/982. In percent: 0.10285132382892057
class 5: unique code: 134/892. In percent: 0.15022421524663676
class 6: unique code: 83/958. In percent: 0.08663883089770355
class 7: unique code: 152/1028. In percent: 0.14785992217898833
class 8: unique code: 93/974. In percent: 0.09548254620123203
class 9: unique code: 106/1009. In percent: 0.10505450941526263
class 0: Average distance Hamming: tensor([2.0062])
class 1: Average distance Hamming: tensor([1.2507])
class 2: Average distance Hamming: tensor([1.9181])
class 3: Average distance Hamming: tensor([0.9924])
class 4: Average distance Hamming: tensor([1.6397])
class 5: Average distance Hamming: tensor([1.6689])
class 6: Average distance Hamming: tensor([1.1498])
class 7: Average distance Hamming: tensor([2.0723])
class 8: Average distance Hamming: tensor([1.3206])
class 9: Average distance Hamming: tensor([1.3040])
average distance: 1.5322692394256592
save z_struct representation for model mnist_ES_binary_15_Hmg_dst_2_2nd_test
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_ES_binary_15_Hmg_dst_2_2nd_test
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_ES_binary_15_Hmg_dst_2_2nd_test, shape: (10, 15)
save std z_struct representation for model mnist_ES_binary_15_Hmg_dst_2_2nd_test, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 0.2826685
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 143/980. In percent: 0.14591836734693878
class 1: unique code: 68/1135. In percent: 0.05991189427312775
class 2: unique code: 154/1032. In percent: 0.14922480620155038
class 3: unique code: 84/1010. In percent: 0.08316831683168317
class 4: unique code: 101/982. In percent: 0.10285132382892057
class 5: unique code: 134/892. In percent: 0.15022421524663676
class 6: unique code: 83/958. In percent: 0.08663883089770355
class 7: unique code: 152/1028. In percent: 0.14785992217898833
class 8: unique code: 93/974. In percent: 0.09548254620123203
class 9: unique code: 106/1009. In percent: 0.10505450941526263
__________------Hamming distance:------__________
class 0: Average distance Hamming: 2.006162166595459
class 1: Average distance Hamming: 1.2507190704345703
class 2: Average distance Hamming: 1.91808021068573
class 3: Average distance Hamming: 0.99244225025177
class 4: Average distance Hamming: 1.639683485031128
class 5: Average distance Hamming: 1.6689163446426392
class 6: Average distance Hamming: 1.149787425994873
class 7: Average distance Hamming: 2.0722875595092773
class 8: Average distance Hamming: 1.320575475692749
class 9: Average distance Hamming: 1.3040374517440796
average distance: 1.5322692394256592
for class 0, we have 256 z_struct with code [1. 1. 0. 1. 0. 1. 1. 0. 1. 0. 0. 0. 0. 1. 0.]. It represent 26.122% of total z_struct class
for class 1, we have 619 z_struct with code [0. 0. 1. 1. 1. 1. 0. 1. 0. 0. 0. 0. 1. 1. 1.]. It represent 54.537% of total z_struct class
for class 2, we have 302 z_struct with code [1. 1. 1. 1. 1. 1. 1. 0. 0. 1. 1. 0. 0. 0. 0.]. It represent 29.264% of total z_struct class
for class 3, we have 636 z_struct with code [0. 1. 1. 1. 0. 1. 0. 0. 0. 1. 1. 1. 1. 0. 0.]. It represent 62.97% of total z_struct class
for class 4, we have 387 z_struct with code [1. 0. 1. 1. 0. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1.]. It represent 39.409% of total z_struct class
for class 5, we have 434 z_struct with code [0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 1. 1. 1. 0. 1.]. It represent 48.655% of total z_struct class
for class 6, we have 604 z_struct with code [1. 0. 0. 1. 1. 1. 1. 1. 0. 1. 1. 0. 0. 1. 0.]. It represent 63.048% of total z_struct class
for class 7, we have 348 z_struct with code [0. 1. 1. 0. 0. 1. 0. 1. 0. 0. 0. 1. 1. 1. 0.]. It represent 33.852% of total z_struct class
for class 8, we have 567 z_struct with code [0. 1. 1. 0. 1. 1. 0. 0. 1. 1. 1. 0. 0. 0. 1.]. It represent 58.214% of total z_struct class
for class 9, we have 565 z_struct with code [0. 0. 1. 0. 0. 1. 1. 1. 1. 1. 1. 0. 1. 1. 0.]. It represent 55.996% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 100.0 %
figure saved for model mnist_ES_binary_15_Hmg_dst_2_2nd_test
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_ES_binary_15_Hmg_dst_3_2nd_test-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 143/980. In percent: 0.14591836734693878
class 1: unique code: 68/1135. In percent: 0.05991189427312775
class 2: unique code: 154/1032. In percent: 0.14922480620155038
class 3: unique code: 84/1010. In percent: 0.08316831683168317
class 4: unique code: 101/982. In percent: 0.10285132382892057
class 5: unique code: 134/892. In percent: 0.15022421524663676
class 6: unique code: 83/958. In percent: 0.08663883089770355
class 7: unique code: 152/1028. In percent: 0.14785992217898833
class 8: unique code: 93/974. In percent: 0.09548254620123203
class 9: unique code: 106/1009. In percent: 0.10505450941526263
class 0: Average distance Hamming: tensor([2.0062])
class 1: Average distance Hamming: tensor([1.2507])
class 2: Average distance Hamming: tensor([1.9181])
class 3: Average distance Hamming: tensor([0.9924])
class 4: Average distance Hamming: tensor([1.6397])
class 5: Average distance Hamming: tensor([1.6689])
class 6: Average distance Hamming: tensor([1.1498])
class 7: Average distance Hamming: tensor([2.0723])
class 8: Average distance Hamming: tensor([1.3206])
class 9: Average distance Hamming: tensor([1.3040])
average distance: 1.5322692394256592
save z_struct representation for model mnist_ES_binary_15_Hmg_dst_3_2nd_test
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_ES_binary_15_Hmg_dst_3_2nd_test
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_ES_binary_15_Hmg_dst_3_2nd_test, shape: (10, 15)
save std z_struct representation for model mnist_ES_binary_15_Hmg_dst_3_2nd_test, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 0.2826685
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 143/980. In percent: 0.14591836734693878
class 1: unique code: 68/1135. In percent: 0.05991189427312775
class 2: unique code: 154/1032. In percent: 0.14922480620155038
class 3: unique code: 84/1010. In percent: 0.08316831683168317
class 4: unique code: 101/982. In percent: 0.10285132382892057
class 5: unique code: 134/892. In percent: 0.15022421524663676
class 6: unique code: 83/958. In percent: 0.08663883089770355
class 7: unique code: 152/1028. In percent: 0.14785992217898833
class 8: unique code: 93/974. In percent: 0.09548254620123203
class 9: unique code: 106/1009. In percent: 0.10505450941526263
__________------Hamming distance:------__________
class 0: Average distance Hamming: 2.006162166595459
class 1: Average distance Hamming: 1.2507190704345703
class 2: Average distance Hamming: 1.91808021068573
class 3: Average distance Hamming: 0.99244225025177
class 4: Average distance Hamming: 1.639683485031128
class 5: Average distance Hamming: 1.6689163446426392
class 6: Average distance Hamming: 1.149787425994873
class 7: Average distance Hamming: 2.0722875595092773
class 8: Average distance Hamming: 1.320575475692749
class 9: Average distance Hamming: 1.3040374517440796
average distance: 1.5322692394256592
for class 0, we have 256 z_struct with code [1. 1. 0. 1. 0. 1. 1. 0. 1. 0. 0. 0. 0. 1. 0.]. It represent 26.122% of total z_struct class
for class 1, we have 619 z_struct with code [0. 0. 1. 1. 1. 1. 0. 1. 0. 0. 0. 0. 1. 1. 1.]. It represent 54.537% of total z_struct class
for class 2, we have 302 z_struct with code [1. 1. 1. 1. 1. 1. 1. 0. 0. 1. 1. 0. 0. 0. 0.]. It represent 29.264% of total z_struct class
for class 3, we have 636 z_struct with code [0. 1. 1. 1. 0. 1. 0. 0. 0. 1. 1. 1. 1. 0. 0.]. It represent 62.97% of total z_struct class
for class 4, we have 387 z_struct with code [1. 0. 1. 1. 0. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1.]. It represent 39.409% of total z_struct class
for class 5, we have 434 z_struct with code [0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 1. 1. 1. 0. 1.]. It represent 48.655% of total z_struct class
for class 6, we have 604 z_struct with code [1. 0. 0. 1. 1. 1. 1. 1. 0. 1. 1. 0. 0. 1. 0.]. It represent 63.048% of total z_struct class
for class 7, we have 348 z_struct with code [0. 1. 1. 0. 0. 1. 0. 1. 0. 0. 0. 1. 1. 1. 0.]. It represent 33.852% of total z_struct class
for class 8, we have 567 z_struct with code [0. 1. 1. 0. 1. 1. 0. 0. 1. 1. 1. 0. 0. 0. 1.]. It represent 58.214% of total z_struct class
for class 9, we have 565 z_struct with code [0. 0. 1. 0. 0. 1. 1. 1. 1. 1. 1. 0. 1. 1. 0.]. It represent 55.996% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 100.0 %
figure saved for model mnist_ES_binary_15_Hmg_dst_3_2nd_test
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_ES_binary_15_Hmg_dst_4_2nd_test-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 144/980. In percent: 0.1469387755102041
class 1: unique code: 77/1135. In percent: 0.06784140969162995
class 2: unique code: 131/1032. In percent: 0.12693798449612403
class 3: unique code: 86/1010. In percent: 0.08514851485148515
class 4: unique code: 78/982. In percent: 0.07942973523421588
class 5: unique code: 130/892. In percent: 0.14573991031390135
class 6: unique code: 94/958. In percent: 0.09812108559498957
class 7: unique code: 146/1028. In percent: 0.14202334630350194
class 8: unique code: 96/974. In percent: 0.09856262833675565
class 9: unique code: 92/1009. In percent: 0.09117938553022795
class 0: Average distance Hamming: tensor([1.7541])
class 1: Average distance Hamming: tensor([0.7895])
class 2: Average distance Hamming: tensor([1.6007])
class 3: Average distance Hamming: tensor([1.0262])
class 4: Average distance Hamming: tensor([0.9745])
class 5: Average distance Hamming: tensor([1.5758])
class 6: Average distance Hamming: tensor([1.1348])
class 7: Average distance Hamming: tensor([2.1514])
class 8: Average distance Hamming: tensor([1.7009])
class 9: Average distance Hamming: tensor([1.2640])
average distance: 1.3971980810165405
save z_struct representation for model mnist_ES_binary_15_Hmg_dst_4_2nd_test
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_ES_binary_15_Hmg_dst_4_2nd_test
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_ES_binary_15_Hmg_dst_4_2nd_test, shape: (10, 15)
save std z_struct representation for model mnist_ES_binary_15_Hmg_dst_4_2nd_test, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 0.25794598
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 144/980. In percent: 0.1469387755102041
class 1: unique code: 77/1135. In percent: 0.06784140969162995
class 2: unique code: 131/1032. In percent: 0.12693798449612403
class 3: unique code: 86/1010. In percent: 0.08514851485148515
class 4: unique code: 78/982. In percent: 0.07942973523421588
class 5: unique code: 130/892. In percent: 0.14573991031390135
class 6: unique code: 94/958. In percent: 0.09812108559498957
class 7: unique code: 146/1028. In percent: 0.14202334630350194
class 8: unique code: 96/974. In percent: 0.09856262833675565
class 9: unique code: 92/1009. In percent: 0.09117938553022795
__________------Hamming distance:------__________
class 0: Average distance Hamming: 1.754093050956726
class 1: Average distance Hamming: 0.7895236611366272
class 2: Average distance Hamming: 1.6006981134414673
class 3: Average distance Hamming: 1.026242971420288
class 4: Average distance Hamming: 0.9744638800621033
class 5: Average distance Hamming: 1.5758380889892578
class 6: Average distance Hamming: 1.134844183921814
class 7: Average distance Hamming: 2.1513891220092773
class 8: Average distance Hamming: 1.700901746749878
class 9: Average distance Hamming: 1.263985276222229
average distance: 1.3971980810165405
for class 0, we have 409 z_struct with code [1. 1. 0. 1. 0. 1. 1. 1. 1. 0. 0. 0. 0. 1. 0.]. It represent 41.735% of total z_struct class
for class 1, we have 877 z_struct with code [0. 0. 1. 1. 1. 1. 0. 1. 1. 0. 0. 0. 1. 1. 1.]. It represent 77.269% of total z_struct class
for class 2, we have 507 z_struct with code [1. 1. 1. 1. 1. 1. 1. 0. 0. 1. 1. 0. 0. 0. 0.]. It represent 49.128% of total z_struct class
for class 3, we have 631 z_struct with code [0. 1. 1. 1. 0. 1. 0. 0. 0. 1. 1. 1. 1. 0. 0.]. It represent 62.475% of total z_struct class
for class 4, we have 646 z_struct with code [1. 0. 1. 1. 0. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1.]. It represent 65.784% of total z_struct class
for class 5, we have 501 z_struct with code [0. 1. 0. 0. 1. 1. 0. 0. 0. 1. 1. 1. 1. 0. 1.]. It represent 56.166% of total z_struct class
for class 6, we have 626 z_struct with code [1. 0. 0. 1. 1. 1. 1. 1. 0. 1. 1. 0. 0. 1. 0.]. It represent 65.344% of total z_struct class
for class 7, we have 226 z_struct with code [0. 1. 1. 0. 0. 1. 0. 1. 1. 0. 0. 1. 1. 1. 0.]. It represent 21.984% of total z_struct class
for class 8, we have 453 z_struct with code [0. 1. 1. 0. 1. 1. 0. 0. 1. 1. 1. 0. 0. 0. 1.]. It represent 46.509% of total z_struct class
for class 9, we have 605 z_struct with code [0. 1. 1. 0. 0. 1. 1. 1. 1. 1. 1. 0. 1. 1. 0.]. It represent 59.96% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 100.0 %
figure saved for model mnist_ES_binary_15_Hmg_dst_4_2nd_test
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_ES_binary_15_Hmg_dst_5_2nd_test-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 133/980. In percent: 0.1357142857142857
class 1: unique code: 70/1135. In percent: 0.06167400881057269
class 2: unique code: 135/1032. In percent: 0.1308139534883721
class 3: unique code: 77/1010. In percent: 0.07623762376237624
class 4: unique code: 68/982. In percent: 0.06924643584521385
class 5: unique code: 116/892. In percent: 0.13004484304932734
class 6: unique code: 82/958. In percent: 0.08559498956158663
class 7: unique code: 134/1028. In percent: 0.1303501945525292
class 8: unique code: 96/974. In percent: 0.09856262833675565
class 9: unique code: 92/1009. In percent: 0.09117938553022795
class 0: Average distance Hamming: tensor([1.8855])
class 1: Average distance Hamming: tensor([0.5824])
class 2: Average distance Hamming: tensor([1.6709])
class 3: Average distance Hamming: tensor([1.0762])
class 4: Average distance Hamming: tensor([0.9404])
class 5: Average distance Hamming: tensor([1.4866])
class 6: Average distance Hamming: tensor([1.2538])
class 7: Average distance Hamming: tensor([2.0481])
class 8: Average distance Hamming: tensor([1.8131])
class 9: Average distance Hamming: tensor([1.3935])
average distance: 1.4150550365447998
save z_struct representation for model mnist_ES_binary_15_Hmg_dst_5_2nd_test
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_ES_binary_15_Hmg_dst_5_2nd_test
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_ES_binary_15_Hmg_dst_5_2nd_test, shape: (10, 15)
save std z_struct representation for model mnist_ES_binary_15_Hmg_dst_5_2nd_test, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 0.27321976
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 133/980. In percent: 0.1357142857142857
class 1: unique code: 70/1135. In percent: 0.06167400881057269
class 2: unique code: 135/1032. In percent: 0.1308139534883721
class 3: unique code: 77/1010. In percent: 0.07623762376237624
class 4: unique code: 68/982. In percent: 0.06924643584521385
class 5: unique code: 116/892. In percent: 0.13004484304932734
class 6: unique code: 82/958. In percent: 0.08559498956158663
class 7: unique code: 134/1028. In percent: 0.1303501945525292
class 8: unique code: 96/974. In percent: 0.09856262833675565
class 9: unique code: 92/1009. In percent: 0.09117938553022795
__________------Hamming distance:------__________
class 0: Average distance Hamming: 1.885541319847107
class 1: Average distance Hamming: 0.582442581653595
class 2: Average distance Hamming: 1.6709110736846924
class 3: Average distance Hamming: 1.0761542320251465
class 4: Average distance Hamming: 0.9403970837593079
class 5: Average distance Hamming: 1.486645221710205
class 6: Average distance Hamming: 1.2538203001022339
class 7: Average distance Hamming: 2.048100233078003
class 8: Average distance Hamming: 1.8130741119384766
class 9: Average distance Hamming: 1.3934627771377563
average distance: 1.4150550365447998
for class 0, we have 352 z_struct with code [1. 1. 0. 1. 0. 1. 1. 1. 1. 0. 0. 0. 0. 1. 0.]. It represent 35.918% of total z_struct class
for class 1, we have 946 z_struct with code [0. 0. 1. 1. 1. 1. 0. 1. 1. 0. 0. 0. 1. 1. 1.]. It represent 83.348% of total z_struct class
for class 2, we have 503 z_struct with code [1. 1. 1. 1. 1. 1. 1. 0. 0. 1. 1. 0. 0. 0. 0.]. It represent 48.74% of total z_struct class
for class 3, we have 605 z_struct with code [0. 1. 1. 1. 0. 1. 0. 0. 0. 1. 1. 1. 1. 0. 0.]. It represent 59.901% of total z_struct class
for class 4, we have 661 z_struct with code [1. 0. 1. 1. 0. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1.]. It represent 67.312% of total z_struct class
for class 5, we have 503 z_struct with code [0. 1. 0. 0. 1. 1. 0. 0. 0. 1. 1. 1. 1. 0. 1.]. It represent 56.39% of total z_struct class
for class 6, we have 608 z_struct with code [1. 0. 0. 1. 1. 1. 1. 1. 0. 1. 1. 0. 0. 1. 0.]. It represent 63.466% of total z_struct class
for class 7, we have 278 z_struct with code [0. 1. 1. 0. 1. 1. 0. 1. 1. 0. 0. 1. 1. 1. 1.]. It represent 27.043% of total z_struct class
for class 8, we have 413 z_struct with code [0. 1. 1. 0. 1. 1. 0. 0. 1. 1. 1. 0. 0. 0. 1.]. It represent 42.402% of total z_struct class
for class 9, we have 559 z_struct with code [0. 1. 1. 0. 0. 1. 1. 1. 1. 1. 1. 0. 1. 1. 0.]. It represent 55.401% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 100.0 %
figure saved for model mnist_ES_binary_15_Hmg_dst_5_2nd_test
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_ES_binary_15_Hmg_dst_6_2nd_test-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 134/980. In percent: 0.13673469387755102
class 1: unique code: 69/1135. In percent: 0.06079295154185022
class 2: unique code: 137/1032. In percent: 0.13275193798449614
class 3: unique code: 76/1010. In percent: 0.07524752475247524
class 4: unique code: 69/982. In percent: 0.07026476578411406
class 5: unique code: 116/892. In percent: 0.13004484304932734
class 6: unique code: 82/958. In percent: 0.08559498956158663
class 7: unique code: 136/1028. In percent: 0.13229571984435798
class 8: unique code: 96/974. In percent: 0.09856262833675565
class 9: unique code: 94/1009. In percent: 0.0931615460852329
class 0: Average distance Hamming: tensor([1.8833])
class 1: Average distance Hamming: tensor([0.5808])
class 2: Average distance Hamming: tensor([1.6738])
class 3: Average distance Hamming: tensor([1.0724])
class 4: Average distance Hamming: tensor([0.9386])
class 5: Average distance Hamming: tensor([1.4890])
class 6: Average distance Hamming: tensor([1.2470])
class 7: Average distance Hamming: tensor([2.0523])
class 8: Average distance Hamming: tensor([1.8184])
class 9: Average distance Hamming: tensor([1.3965])
average distance: 1.4152288436889648
save z_struct representation for model mnist_ES_binary_15_Hmg_dst_6_2nd_test
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_ES_binary_15_Hmg_dst_6_2nd_test
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_ES_binary_15_Hmg_dst_6_2nd_test, shape: (10, 15)
save std z_struct representation for model mnist_ES_binary_15_Hmg_dst_6_2nd_test, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 0.2731729
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 134/980. In percent: 0.13673469387755102
class 1: unique code: 69/1135. In percent: 0.06079295154185022
class 2: unique code: 137/1032. In percent: 0.13275193798449614
class 3: unique code: 76/1010. In percent: 0.07524752475247524
class 4: unique code: 69/982. In percent: 0.07026476578411406
class 5: unique code: 116/892. In percent: 0.13004484304932734
class 6: unique code: 82/958. In percent: 0.08559498956158663
class 7: unique code: 136/1028. In percent: 0.13229571984435798
class 8: unique code: 96/974. In percent: 0.09856262833675565
class 9: unique code: 94/1009. In percent: 0.0931615460852329
__________------Hamming distance:------__________
class 0: Average distance Hamming: 1.8832919597625732
class 1: Average distance Hamming: 0.5808078646659851
class 2: Average distance Hamming: 1.6738396883010864
class 3: Average distance Hamming: 1.0724371671676636
class 4: Average distance Hamming: 0.9386095404624939
class 5: Average distance Hamming: 1.4890433549880981
class 6: Average distance Hamming: 1.2470402717590332
class 7: Average distance Hamming: 2.0523359775543213
class 8: Average distance Hamming: 1.8183881044387817
class 9: Average distance Hamming: 1.39649498462677
average distance: 1.4152288436889648
for class 0, we have 353 z_struct with code [1. 1. 0. 1. 0. 1. 1. 1. 1. 0. 0. 0. 0. 1. 0.]. It represent 36.02% of total z_struct class
for class 1, we have 945 z_struct with code [0. 0. 1. 1. 1. 1. 0. 1. 1. 0. 0. 0. 1. 1. 1.]. It represent 83.26% of total z_struct class
for class 2, we have 502 z_struct with code [1. 1. 1. 1. 1. 1. 1. 0. 0. 1. 1. 0. 0. 0. 0.]. It represent 48.643% of total z_struct class
for class 3, we have 605 z_struct with code [0. 1. 1. 1. 0. 1. 0. 0. 0. 1. 1. 1. 1. 0. 0.]. It represent 59.901% of total z_struct class
for class 4, we have 663 z_struct with code [1. 0. 1. 1. 0. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1.]. It represent 67.515% of total z_struct class
for class 5, we have 503 z_struct with code [0. 1. 0. 0. 1. 1. 0. 0. 0. 1. 1. 1. 1. 0. 1.]. It represent 56.39% of total z_struct class
for class 6, we have 610 z_struct with code [1. 0. 0. 1. 1. 1. 1. 1. 0. 1. 1. 0. 0. 1. 0.]. It represent 63.674% of total z_struct class
for class 7, we have 278 z_struct with code [0. 1. 1. 0. 1. 1. 0. 1. 1. 0. 0. 1. 1. 1. 1.]. It represent 27.043% of total z_struct class
for class 8, we have 412 z_struct with code [0. 1. 1. 0. 1. 1. 0. 0. 1. 1. 1. 0. 0. 0. 1.]. It represent 42.3% of total z_struct class
for class 9, we have 559 z_struct with code [0. 1. 1. 0. 0. 1. 1. 1. 1. 1. 1. 0. 1. 1. 0.]. It represent 55.401% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 100.0 %
figure saved for model mnist_ES_binary_15_Hmg_dst_6_2nd_test
All done !
