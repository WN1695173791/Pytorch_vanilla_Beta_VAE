Loading pytorch-gpu/py3/1.6.0
  Loading requirement: gcc/8.3.1 cuda/10.2 nccl/2.6.4-1-cuda
    cudnn/7.6.5.32-cuda-10.2 intel-mkl/2020.1 magma/2.5.3-cuda
    openmpi/4.0.2-cuda
++ sed -n 35p parameters_combinations/mnist_classifier_ratio.txt
+ LINE='--gpu_devices 0 --max_iter 100 --batch_size 250 --use_scheduler True --lr 1e-3 --GMP True --z_struct_size 15 --z_var_size 8 --is_VAE True --is_encoder_struct False --lambda_BCE 1 --beta 1 --lambda_struct_recons_class 1000  --loss_struct_recons_class True --big_kernel_size 8 --two_conv_layer True --three_conv_layer True --kernel_size_1 4 --kernel_size_2 4 --kernel_size_3 4 --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 64 --hidden_filters_layer2 64 --hidden_filters_layer3 64 --dataset_balanced True --binary_z True --binary_first_conv False --binary_second_conv False --binary_third_conv True --use_small_lr_encoder_var False --encoder_var_name None --encoder_struct_name mnist_ES_binary_15_Hmg_dst_4_2nd_test --freeze_Encoder True --size_average False --div_loss_per_batch False --exp_name mnist_VAE_s15Hmg4_v8_zstruct_class_6_mon_loss'
+ echo --gpu_devices 0 --max_iter 100 --batch_size 250 --use_scheduler True --lr 1e-3 --GMP True --z_struct_size 15 --z_var_size 8 --is_VAE True --is_encoder_struct False --lambda_BCE 1 --beta 1 --lambda_struct_recons_class 1000 --loss_struct_recons_class True --big_kernel_size 8 --two_conv_layer True --three_conv_layer True --kernel_size_1 4 --kernel_size_2 4 --kernel_size_3 4 --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 64 --hidden_filters_layer2 64 --hidden_filters_layer3 64 --dataset_balanced True --binary_z True --binary_first_conv False --binary_second_conv False --binary_third_conv True --use_small_lr_encoder_var False --encoder_var_name None --encoder_struct_name mnist_ES_binary_15_Hmg_dst_4_2nd_test --freeze_Encoder True --size_average False --div_loss_per_batch False --exp_name mnist_VAE_s15Hmg4_v8_zstruct_class_6_mon_loss
+ python3 -u main.py --gpu_devices 0 --max_iter 100 --batch_size 250 --use_scheduler True --lr 1e-3 --GMP True --z_struct_size 15 --z_var_size 8 --is_VAE True --is_encoder_struct False --lambda_BCE 1 --beta 1 --lambda_struct_recons_class 1000 --loss_struct_recons_class True --big_kernel_size 8 --two_conv_layer True --three_conv_layer True --kernel_size_1 4 --kernel_size_2 4 --kernel_size_3 4 --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 64 --hidden_filters_layer2 64 --hidden_filters_layer3 64 --dataset_balanced True --binary_z True --binary_first_conv False --binary_second_conv False --binary_third_conv True --use_small_lr_encoder_var False --encoder_var_name None --encoder_struct_name mnist_ES_binary_15_Hmg_dst_4_2nd_test --freeze_Encoder True --size_average False --div_loss_per_batch False --exp_name mnist_VAE_s15Hmg4_v8_zstruct_class_6_mon_loss
--- Logging error ---
Traceback (most recent call last):
  File "/gpfslocalsup/pub/anaconda-py3/2020.02/envs/pytorch-gpu-1.6.0/lib/python3.7/logging/__init__.py", line 1025, in emit
    msg = self.format(record)
  File "/gpfslocalsup/pub/anaconda-py3/2020.02/envs/pytorch-gpu-1.6.0/lib/python3.7/logging/__init__.py", line 869, in format
    return fmt.format(record)
  File "/gpfslocalsup/pub/anaconda-py3/2020.02/envs/pytorch-gpu-1.6.0/lib/python3.7/logging/__init__.py", line 611, in format
    s = self.formatMessage(record)
  File "/gpfslocalsup/pub/anaconda-py3/2020.02/envs/pytorch-gpu-1.6.0/lib/python3.7/logging/__init__.py", line 580, in formatMessage
    return self._style.format(record)
  File "/gpfslocalsup/pub/anaconda-py3/2020.02/envs/pytorch-gpu-1.6.0/lib/python3.7/logging/__init__.py", line 422, in format
    return self._fmt % record.__dict__
KeyError: 'asc_time'
Call stack:
  File "main.py", line 341, in <module>
    main(args)
  File "main.py", line 31, in main
    net = SolverClassifier(arguments)
  File "/gpfsdswork/projects/rech/rjg/uiu23ko/Thesis/Pytorch_vanilla_Beta_VAE/solver_classifier.py", line 422, in __init__
    self.test_loader_size))
Message: 'Dataset mnist: train with 60000 samples and 10000 test samples'
Arguments: ()
  0%|          | 0/100.0 [00:00<?, ?it/s]  2%|▏         | 2/100.0 [00:01<01:04,  1.53it/s]  4%|▍         | 4/100.0 [00:01<00:45,  2.09it/s]  6%|▌         | 6/100.0 [00:01<00:33,  2.82it/s]  7%|▋         | 7/100.0 [00:01<00:26,  3.53it/s]  9%|▉         | 9/100.0 [00:01<00:19,  4.62it/s] 11%|█         | 11/100.0 [00:01<00:15,  5.90it/s] 13%|█▎        | 13/100.0 [00:02<00:11,  7.31it/s] 15%|█▌        | 15/100.0 [00:02<00:09,  8.79it/s] 17%|█▋        | 17/100.0 [00:02<00:08, 10.23it/s] 19%|█▉        | 19/100.0 [00:02<00:07, 11.56it/s] 21%|██        | 21/100.0 [00:02<00:06, 12.72it/s] 23%|██▎       | 23/100.0 [00:02<00:05, 13.68it/s] 25%|██▌       | 25/100.0 [00:02<00:05, 14.45it/s] 27%|██▋       | 27/100.0 [00:02<00:04, 15.03it/s] 29%|██▉       | 29/100.0 [00:03<00:04, 15.46it/s] 31%|███       | 31/100.0 [00:03<00:04, 15.78it/s] 33%|███▎      | 33/100.0 [00:03<00:04, 16.02it/s] 35%|███▌      | 35/100.0 [00:03<00:04, 16.19it/s] 37%|███▋      | 37/100.0 [00:03<00:03, 16.30it/s] 39%|███▉      | 39/100.0 [00:03<00:03, 16.40it/s] 41%|████      | 41/100.0 [00:03<00:03, 16.45it/s] 43%|████▎     | 43/100.0 [00:03<00:03, 16.49it/s] 45%|████▌     | 45/100.0 [00:03<00:03, 16.52it/s] 47%|████▋     | 47/100.0 [00:04<00:03, 16.55it/s] 49%|████▉     | 49/100.0 [00:04<00:03, 16.58it/s] 51%|█████     | 51/100.0 [00:04<00:02, 16.58it/s] 53%|█████▎    | 53/100.0 [00:04<00:02, 16.58it/s] 55%|█████▌    | 55/100.0 [00:04<00:02, 16.59it/s] 57%|█████▋    | 57/100.0 [00:04<00:02, 16.60it/s] 59%|█████▉    | 59/100.0 [00:04<00:02, 16.59it/s] 61%|██████    | 61/100.0 [00:04<00:02, 16.59it/s] 63%|██████▎   | 63/100.0 [00:05<00:02, 16.59it/s] 65%|██████▌   | 65/100.0 [00:05<00:02, 16.59it/s] 67%|██████▋   | 67/100.0 [00:05<00:01, 16.59it/s] 69%|██████▉   | 69/100.0 [00:05<00:01, 16.61it/s] 71%|███████   | 71/100.0 [00:05<00:01, 16.60it/s] 73%|███████▎  | 73/100.0 [00:05<00:01, 16.60it/s] 75%|███████▌  | 75/100.0 [00:05<00:01, 16.61it/s] 77%|███████▋  | 77/100.0 [00:05<00:01, 16.62it/s] 79%|███████▉  | 79/100.0 [00:06<00:01, 16.60it/s] 81%|████████  | 81/100.0 [00:06<00:01, 16.60it/s] 83%|████████▎ | 83/100.0 [00:06<00:01, 16.61it/s] 85%|████████▌ | 85/100.0 [00:06<00:00, 16.61it/s] 87%|████████▋ | 87/100.0 [00:06<00:00, 16.60it/s] 89%|████████▉ | 89/100.0 [00:06<00:00, 16.62it/s] 91%|█████████ | 91/100.0 [00:06<00:00, 16.60it/s] 93%|█████████▎| 93/100.0 [00:06<00:00, 16.62it/s] 95%|█████████▌| 95/100.0 [00:06<00:00, 16.59it/s] 97%|█████████▋| 97/100.0 [00:07<00:00, 16.60it/s] 99%|█████████▉| 99/100.0 [00:07<00:00, 16.61it/s]101it [00:07, 16.60it/s]                          103it [00:07, 16.60it/s]105it [00:07, 16.60it/s]107it [00:07, 16.60it/s]109it [00:07, 16.60it/s]111it [00:07, 16.60it/s]113it [00:08, 16.60it/s]115it [00:08, 16.60it/s]117it [00:08, 16.60it/s]119it [00:08, 16.58it/s]121it [00:08, 16.62it/s]123it [00:08, 16.59it/s]125it [00:08, 16.58it/s]127it [00:08, 16.59it/s]129it [00:09, 16.60it/s]131it [00:09, 16.59it/s]133it [00:09, 16.59it/s]135it [00:09, 16.59it/s]137it [00:09, 16.60it/s]139it [00:09, 16.59it/s]141it [00:09, 16.60it/s]143it [00:09, 16.60it/s]145it [00:10, 16.59it/s]147it [00:10, 16.59it/s]149it [00:10, 16.60it/s]151it [00:10, 16.59it/s]153it [00:10, 16.60it/s]155it [00:10, 16.59it/s]157it [00:10, 16.59it/s]159it [00:10, 16.60it/s]161it [00:10, 16.60it/s]163it [00:11, 16.59it/s]165it [00:11, 16.59it/s]167it [00:11, 16.60it/s]169it [00:11, 16.60it/s]171it [00:11, 16.60it/s]173it [00:11, 16.60it/s]175it [00:11, 16.61it/s]177it [00:11, 16.59it/s]179it [00:12, 16.60it/s]181it [00:12, 16.60it/s]183it [00:12, 16.60it/s]185it [00:12, 16.60it/s]187it [00:12, 16.59it/s]189it [00:12, 16.59it/s]191it [00:12, 16.59it/s]193it [00:12, 16.60it/s]195it [00:13, 16.59it/s]197it [00:13, 16.60it/s]199it [00:13, 16.59it/s]201it [00:13, 16.60it/s]203it [00:13, 16.60it/s]205it [00:13, 16.59it/s]207it [00:13, 16.58it/s]209it [00:13, 16.59it/s]211it [00:13, 16.58it/s]213it [00:14, 16.58it/s]215it [00:14, 16.58it/s]217it [00:14, 16.59it/s]219it [00:14, 16.60it/s]221it [00:14, 16.60it/s]223it [00:14, 16.59it/s]225it [00:14, 16.61it/s]227it [00:14, 16.60it/s]229it [00:15, 16.61it/s]231it [00:15, 16.60it/s]233it [00:15, 16.61it/s]235it [00:15, 16.60it/s]237it [00:15, 16.60it/s]239it [00:15, 16.59it/s]241it [00:15, 16.60it/s]243it [00:15, 16.60it/s]245it [00:16, 16.60it/s]247it [00:16, 16.58it/s]249it [00:16, 16.60it/s]251it [00:16, 16.60it/s]253it [00:16, 16.60it/s]255it [00:16, 16.60it/s]257it [00:16, 16.60it/s]259it [00:16, 16.60it/s]261it [00:16, 16.60it/s]263it [00:17, 16.60it/s]265it [00:17, 16.60it/s]267it [00:17, 16.60it/s]269it [00:17, 16.60it/s]Traceback (most recent call last):
  File "main.py", line 341, in <module>
    main(args)
  File "main.py", line 34, in main
    net.train()
  File "/gpfsdswork/projects/rech/rjg/uiu23ko/Thesis/Pytorch_vanilla_Beta_VAE/solver_classifier.py", line 1027, in train
    self.lambda_recons)
  File "/gpfsdswork/projects/rech/rjg/uiu23ko/Thesis/Pytorch_vanilla_Beta_VAE/solver_classifier.py", line 167, in compute_scores_and_loss_VAE
    lambda_recons)
  File "/gpfsdswork/projects/rech/rjg/uiu23ko/Thesis/Pytorch_vanilla_Beta_VAE/scores_classifier.py", line 165, in compute_scores_VAE
    prediction_var, prediction_struct = net(data, loss_struct_recons_class=loss_struct_recons_class)
  File "/gpfslocalsup/pub/anaconda-py3/2020.02/envs/pytorch-gpu-1.6.0/lib/python3.7/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/gpfsdswork/projects/rech/rjg/uiu23ko/Thesis/Pytorch_vanilla_Beta_VAE/models/VAE.py", line 394, in forward
    z_struct_rand_var = torch.cat((z_var_rand, z_struct), dim=1)
RuntimeError: All input tensors must be on the same device. Received cpu and cuda:0
270it [00:17, 15.26it/s]
+ wait
+ echo 'All done !'
