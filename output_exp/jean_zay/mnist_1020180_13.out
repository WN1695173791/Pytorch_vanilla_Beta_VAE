13
--gpu_devices 0 --max_iter 100 --batch_size 250 --use_scheduler True --lr 1e-3 --GMP True --z_struct_size 15 --z_var_size 10 --is_VAE True --is_encoder_struct False --lambda_BCE 1 --beta 3 --lambda_recons 1 --lambda_EV_class 0.1 --big_kernel_size 8 --two_conv_layer True --three_conv_layer True --kernel_size_1 4 --kernel_size_2 4 --kernel_size_3 4 --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 64 --hidden_filters_layer2 64 --hidden_filters_layer3 64 --dataset_balanced True --binary_z True --binary_first_conv False --binary_second_conv False --binary_third_conv True --use_small_lr_encoder_var False --encoder_var_name None --encoder_struct_name mnist_ES_binary_15 --freeze_Encoder True --EV_classifier True --freeze_Encoder True --grad_inv True --exp_name mnist_VAE_s15_v10_class_inv_grad_2_beta
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, ES_reconstruction=False, EV_classifier=True, GMP=True, Hmg_dst_loss=False, IPC=False, L1_norm_act=False, L1_norm_weights=False, L2_dst_loss=False, L3_without_random=False, LOG_DIR='logs', PT_model=False, PT_model_EV_classifier=False, adapt_lr=False, add_classification_layer=True, add_dl_class=False, add_linear_after_GMP=True, add_z_struct_bottleneck=False, alpha=32, batch_size=250, beta=3.0, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=8, bin_after_GMP=False, binary_chain=False, binary_first_conv=False, binary_second_conv=False, binary_third_conv=True, binary_z=True, both_decoders_freeze=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, contrastive_loss=False, cuda=True, dataset='mnist', dataset_balanced=True, decoder_first_dense=36, decoder_kernel_size_1=4, decoder_kernel_size_2=3, decoder_kernel_size_3=4, decoder_n_filter_1=64, decoder_n_filter_2=64, decoder_n_filter_3=64, decoder_stride_1=2, decoder_stride_2=2, decoder_stride_3=1, diff_var=False, display_step=10000, dset_dir='data', encoder_struct_name='mnist_ES_binary_15', encoder_var_name='None', exp_name='mnist_VAE_s15_v10_class_inv_grad_2_beta', freeze_Encoder=True, gamma=1000, gpu_devices=[0], grad_inv=True, hidden_dim=20, hidden_filters_layer1=64, hidden_filters_layer2=64, hidden_filters_layer3=64, image_size=64, intra_class_variance_loss=False, is_C=True, is_E1=False, is_VAE=True, is_VAE_var=False, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=False, is_default_model=False, is_encoder_struct=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, kernel_size_1=4, kernel_size_2=4, kernel_size_3=4, lambda_BCE=1.0, lambda_EV_class=0.1, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_L2_dst=1, lambda_VAE=1, lambda_class=1, lambda_contrastive_loss=1, lambda_distance_mean=1, lambda_hmg_dst=1, lambda_intra_class_var=1, lambda_partial_class=1, lambda_ratio_reg=1, lambda_recon_wt_rand=1, lambda_recons=1.0, lambda_uniq_code_dst=1, lambda_var_distance=1, lambda_var_inter=1, lambda_var_intra=1, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', loss='Proxy_Anchor', loss_distance_mean=False, loss_min_distance_cl=False, lr=0.001, max_epoch_use_uniq_code_target=5, max_iter=100.0, model='CNN', mrg=0.1, nb_epochs_train_only_zvar=0, num_workers=2, old_weighted=False, optimizer='adamw', other_architecture=False, other_ratio=False, random_percentage=0.2, random_seed=10, randomness=True, ratio_reg=False, remark='', save_step=10000, second_layer_C=False, seed=1, stride_size=1, sz_embedding=5, three_conv_layer=True, train=True, train_var_struct_alternatively=False, two_conv_layer=True, two_encoder=False, uniq_code_dst_loss=False, use_VAE=False, use_decoder=False, use_early_stopping=True, use_scheduler=True, use_small_lr_encoder_var=False, use_structural_encoder=False, value_target_distance_mean=1, var_hidden_dim=256, var_hidden_filters_1=32, var_hidden_filters_2=32, var_hidden_filters_3=32, var_kernel_size_1=3, var_kernel_size_2=3, var_kernel_size_3=3, var_second_cnn_block=True, var_stride_size_1=1, var_stride_size_2=1, var_stride_size_3=1, var_third_cnn_block=False, var_three_conv_layer=False, warm=1, without_acc=False, z_struct_size=15, z_var_size=10, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
[Using Seed: 10]
Balanced dataset loaded
VAE doesn't exist but encoder struct yes ! load struct encoder weighs !
=> loaded checkpoint 'checkpoints_CNN/mnist_ES_binary_15/last (iter 22410)'
Weighs loaded for struct encoder !
use 1 gpu who named: Tesla V100-SXM2-32GB
VAE(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
  )
  (decoder): Sequential(
    (0): Linear(in_features=25, out_features=1600, bias=True)
    (1): ReLU(inplace=True)
    (2): View()
    (3): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (4): ReLU(inplace=True)
    (5): ConvTranspose2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (6): ReLU(inplace=True)
    (7): ConvTranspose2d(64, 32, kernel_size=(3, 3), stride=(1, 1))
    (8): ReLU(inplace=True)
    (9): ConvTranspose2d(32, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (10): ReLU(inplace=True)
    (11): ConvTranspose2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (12): ReLU(inplace=True)
    (13): ConvTranspose2d(32, 1, kernel_size=(3, 3), stride=(1, 1))
    (14): Sigmoid()
  )
  (encoder_var): Sequential(
    (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (4): ReLU(inplace=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Conv2d(32, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (7): ReLU(inplace=True)
    (8): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): Dropout(p=0.4, inplace=False)
    (10): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
    (11): ReLU(inplace=True)
    (12): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (13): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (14): ReLU(inplace=True)
    (15): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Conv2d(64, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (17): ReLU(inplace=True)
    (18): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (19): Dropout(p=0.4, inplace=False)
    (20): View()
    (21): Linear(in_features=1600, out_features=20, bias=True)
  )
  (var_classifier): Sequential(
    (0): RevGrad()
    (1): Linear(in_features=10, out_features=10, bias=True)
  )
)
The number of parameters of model is 499760
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 270, epoch 1.0)
score:  34.803333333333335
score:  32.38
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 270, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train: total:8335.67188, BCE:-14.80830, KLD:2783.49414,Test: total:33424.28516, BCE:-14.87002, KLD:11146.38477
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 540, epoch 2.0)
score:  38.336666666666666
score:  36.05
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 540, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train: total:8465.81934, BCE:-17.42228, KLD:2827.74683,Test: total:33835.57812, BCE:-17.48088, KLD:11284.35352
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 810, epoch 3.0)
score:  42.35666666666667
score:  39.24
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 810, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train: total:8698.10645, BCE:-15.13004, KLD:2904.40991,Test: total:34733.38672, BCE:-15.20097, KLD:11582.86230
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 1080, epoch 4.0)
score:  49.22666666666667
score:  45.23
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 1080, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train: total:8723.22168, BCE:-13.54579, KLD:2912.25562,Test: total:34767.19531, BCE:-13.61309, KLD:11593.60254
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 1350, epoch 5.0)
score:  54.20666666666666
score:  50.29
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 1350, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train: total:8890.27344, BCE:-12.66755, KLD:2967.64624,Test: total:35371.59766, BCE:-12.77502, KLD:11794.79102
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 1620, epoch 6.0)
score:  55.483333333333334
score:  51.51
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 1620, epoch 6.0)
[Save Checkpoint] epoch: [6.0], Train: total:9029.77051, BCE:-13.42542, KLD:3014.39844,Test: total:35883.54688, BCE:-13.49949, KLD:11965.68359
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 1890, epoch 7.0)
score:  55.32666666666667
score:  51.66
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 1890, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train: total:8778.00391, BCE:-13.89207, KLD:2930.63110,Test: total:34845.92969, BCE:-13.99022, KLD:11619.97168
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 2160, epoch 8.0)
score:  56.54833333333333
score:  51.6
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 2160, epoch 8.0)
[Save Checkpoint] epoch: [8.0], Train: total:8862.06543, BCE:-13.60055, KLD:2958.55396,Test: total:35180.87500, BCE:-13.71451, KLD:11731.53027
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 2430, epoch 9.0)
score:  55.346666666666664
score:  51.08
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 2430, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train: total:8961.15234, BCE:-13.72781, KLD:2991.62793,Test: total:35641.28516, BCE:-13.87177, KLD:11885.05176
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 2700, epoch 10.0)
score:  54.395
score:  50.26
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 2700, epoch 10.0)
[Save Checkpoint] epoch: [10.0], Train: total:8891.29492, BCE:-13.78839, KLD:2968.36084,Test: total:35320.37500, BCE:-13.92325, KLD:11778.10059
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 2970, epoch 11.0)
score:  54.69166666666667
score:  50.08
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 2970, epoch 11.0)
[Save Checkpoint] epoch: [11.0], Train: total:8991.31836, BCE:-14.06773, KLD:3001.79321,Test: total:35680.61328, BCE:-14.23009, KLD:11898.28125
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 3240, epoch 12.0)
score:  54.406666666666666
score:  50.07
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 3240, epoch 12.0)
[Save Checkpoint] epoch: [12.0], Train: total:8963.99707, BCE:-14.07705, KLD:2992.69238,Test: total:35582.97656, BCE:-14.25403, KLD:11865.74414
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 3510, epoch 13.0)
score:  52.45166666666667
score:  47.94
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 3510, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train: total:8827.85059, BCE:-13.68269, KLD:2947.17749,Test: total:34997.71094, BCE:-13.88061, KLD:11670.53125
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 3780, epoch 14.0)
score:  51.623333333333335
score:  47.67
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 3780, epoch 14.0)
[Save Checkpoint] epoch: [14.0], Train: total:8642.68262, BCE:-14.29267, KLD:2885.65625,Test: total:34238.19922, BCE:-14.48186, KLD:11417.56055
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 4050, epoch 15.0)
score:  50.87166666666667
score:  46.7
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 4050, epoch 15.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [15.0], Train: total:8737.60840, BCE:-14.62081, KLD:2917.41016,Test: total:34613.26953, BCE:-14.80455, KLD:11542.69141
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 4320, epoch 16.0)
score:  50.57666666666667
score:  45.95
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 4320, epoch 16.0)
[Save Checkpoint] epoch: [16.0], Train: total:8664.72656, BCE:-15.16653, KLD:2893.29785,Test: total:34323.04688, BCE:-15.39752, KLD:11446.14941
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 4590, epoch 17.0)
score:  49.135
score:  45.0
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 4590, epoch 17.0)
[Save Checkpoint] epoch: [17.0], Train: total:8604.73340, BCE:-15.86420, KLD:2873.53149,Test: total:34071.16797, BCE:-16.11548, KLD:11362.42871
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 4860, epoch 18.0)
score:  49.05
score:  44.87
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 4860, epoch 18.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [18.0], Train: total:8475.19727, BCE:-16.18951, KLD:2830.46265,Test: total:33573.34375, BCE:-16.40314, KLD:11196.58203
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 5130, epoch 19.0)
score:  48.413333333333334
score:  44.13
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 5130, epoch 19.0)
[Save Checkpoint] epoch: [19.0], Train: total:8731.39551, BCE:-16.74381, KLD:2916.04663,Test: total:34573.25781, BCE:-17.01129, KLD:11530.08984
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 5400, epoch 20.0)
score:  47.49333333333333
score:  42.71
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 5400, epoch 20.0)
[Save Checkpoint] epoch: [20.0], Train: total:8710.99512, BCE:-17.19205, KLD:2909.39673,Test: total:34521.35156, BCE:-17.42873, KLD:11512.92676
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 5670, epoch 21.0)
score:  47.27166666666667
score:  42.58
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 5670, epoch 21.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [21.0], Train: total:8787.62598, BCE:-17.97102, KLD:2935.19922,Test: total:34804.35938, BCE:-18.22735, KLD:11607.52930
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 5940, epoch 22.0)
score:  46.99166666666667
score:  43.15
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 5940, epoch 22.0)
[Save Checkpoint] epoch: [22.0], Train: total:8545.95605, BCE:-18.56013, KLD:2854.83838,Test: total:33855.31250, BCE:-18.81236, KLD:11291.37402
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 6210, epoch 23.0)
score:  46.69
score:  42.3
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 6210, epoch 23.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [23.0], Train: total:8673.04492, BCE:-18.03823, KLD:2897.02686,Test: total:34375.07422, BCE:-18.27510, KLD:11464.45020
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 6480, epoch 24.0)
score:  45.403333333333336
score:  41.1
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 6480, epoch 24.0)
[Save Checkpoint] epoch: [24.0], Train: total:8659.13379, BCE:-18.70357, KLD:2892.61279,Test: total:34332.05078, BCE:-18.93999, KLD:11450.33105
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 6750, epoch 25.0)
score:  45.083333333333336
score:  40.19
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 6750, epoch 25.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [25.0], Train: total:8551.87402, BCE:-19.03324, KLD:2856.96851,Test: total:33894.29297, BCE:-19.24282, KLD:11304.51074
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 7020, epoch 26.0)
score:  45.193333333333335
score:  40.78
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 7020, epoch 26.0)
[Save Checkpoint] epoch: [26.0], Train: total:8595.06738, BCE:-19.67275, KLD:2871.57959,Test: total:34040.88672, BCE:-19.87940, KLD:11353.58789
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 7290, epoch 27.0)
score:  43.21666666666667
score:  39.16
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 7290, epoch 27.0)
[Save Checkpoint] epoch: [27.0], Train: total:8614.77344, BCE:-20.05463, KLD:2878.27808,Test: total:34101.98047, BCE:-20.29243, KLD:11374.09082
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 7560, epoch 28.0)
score:  43.67
score:  39.53
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 7560, epoch 28.0)
[Save Checkpoint] epoch: [28.0], Train: total:8594.06348, BCE:-20.05994, KLD:2871.37427,Test: total:34049.22266, BCE:-20.26411, KLD:11356.49512
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 7830, epoch 29.0)
score:  42.18833333333333
score:  38.49
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 7830, epoch 29.0)
[Save Checkpoint] epoch: [29.0], Train: total:8520.38086, BCE:-20.60736, KLD:2846.99463,Test: total:33734.58203, BCE:-20.81032, KLD:11251.79688
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 8100, epoch 30.0)
score:  41.946666666666665
score:  38.64
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 8100, epoch 30.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [30.0], Train: total:8627.35840, BCE:-20.68012, KLD:2882.67725,Test: total:34182.12109, BCE:-20.89096, KLD:11401.00391
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 8370, epoch 31.0)
score:  41.821666666666665
score:  37.73
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 8370, epoch 31.0)
[Save Checkpoint] epoch: [31.0], Train: total:8545.37012, BCE:-21.06141, KLD:2855.47925,Test: total:33806.01953, BCE:-21.23329, KLD:11275.75098
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 8640, epoch 32.0)
score:  40.06
score:  37.01
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 8640, epoch 32.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [32.0], Train: total:8476.47949, BCE:-21.13460, KLD:2832.53687,Test: total:33577.50000, BCE:-21.30568, KLD:11199.60059
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 8910, epoch 33.0)
score:  40.461666666666666
score:  36.78
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 8910, epoch 33.0)
[Save Checkpoint] epoch: [33.0], Train: total:8514.23828, BCE:-20.94861, KLD:2845.06177,Test: total:33726.58594, BCE:-21.10253, KLD:11249.22949
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 9180, epoch 34.0)
score:  40.041666666666664
score:  36.74
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 9180, epoch 34.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [34.0], Train: total:8584.28418, BCE:-21.29219, KLD:2868.52637,Test: total:34021.03516, BCE:-21.43709, KLD:11347.49121
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 9450, epoch 35.0)
score:  39.788333333333334
score:  36.5
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 9450, epoch 35.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [35.0], Train: total:8601.85742, BCE:-21.85398, KLD:2874.57007,Test: total:34054.42188, BCE:-21.98475, KLD:11358.80371
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 9720, epoch 36.0)
score:  39.13
score:  35.61
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 9720, epoch 36.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [36.0], Train: total:8530.84668, BCE:-21.62338, KLD:2850.82422,Test: total:33766.87891, BCE:-21.74851, KLD:11262.87500
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 9990, epoch 37.0)
score:  38.446666666666665
score:  34.78
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 9990, epoch 37.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [37.0], Train: total:8455.24121, BCE:-22.02678, KLD:2825.75562,Test: total:33472.54297, BCE:-22.17461, KLD:11164.90625
Epoch    38: reducing learning rate of group 0 to 2.0000e-04.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 10260, epoch 38.0)
score:  37.95166666666667
score:  34.45
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 10260, epoch 38.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [38.0], Train: total:8445.90918, BCE:-21.69000, KLD:2822.53394,Test: total:33416.48047, BCE:-21.82125, KLD:11146.10059
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 10530, epoch 39.0)
score:  36.931666666666665
score:  33.53
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 10530, epoch 39.0)
[Save Checkpoint] epoch: [39.0], Train: total:8448.32520, BCE:-21.55882, KLD:2823.29297,Test: total:33430.38672, BCE:-21.69437, KLD:11150.69238
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 10800, epoch 40.0)
score:  36.983333333333334
score:  33.68
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 10800, epoch 40.0)
[Save Checkpoint] epoch: [40.0], Train: total:8486.71191, BCE:-21.67961, KLD:2836.13062,Test: total:33582.00781, BCE:-21.80842, KLD:11201.27246
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 11070, epoch 41.0)
score:  37.03333333333333
score:  33.6
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 11070, epoch 41.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [41.0], Train: total:8456.14453, BCE:-21.80886, KLD:2825.98511,Test: total:33447.96094, BCE:-21.89816, KLD:11156.61914
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 11340, epoch 42.0)
score:  36.681666666666665
score:  33.22
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 11340, epoch 42.0)
[Save Checkpoint] epoch: [42.0], Train: total:8492.59082, BCE:-21.94645, KLD:2838.17896,Test: total:33606.48047, BCE:-22.05462, KLD:11209.51074
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 11610, epoch 43.0)
score:  36.32
score:  32.66
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 11610, epoch 43.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [43.0], Train: total:8475.48633, BCE:-21.76006, KLD:2832.41772,Test: total:33544.43750, BCE:-21.89027, KLD:11188.77637
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 11880, epoch 44.0)
score:  36.03666666666667
score:  32.21
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 11880, epoch 44.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [44.0], Train: total:8410.10840, BCE:-21.91034, KLD:2810.67285,Test: total:33268.44141, BCE:-22.02059, KLD:11096.81934
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 12150, epoch 45.0)
score:  36.20333333333333
score:  32.27
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 12150, epoch 45.0)
[Save Checkpoint] epoch: [45.0], Train: total:8480.12500, BCE:-21.96960, KLD:2834.03027,Test: total:33566.01562, BCE:-22.05869, KLD:11196.02539
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 12420, epoch 46.0)
score:  36.275
score:  32.67
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 12420, epoch 46.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [46.0], Train: total:8467.64844, BCE:-21.73720, KLD:2829.79468,Test: total:33505.95703, BCE:-21.83416, KLD:11175.92871
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 12690, epoch 47.0)
score:  35.785
score:  32.63
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 12690, epoch 47.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [47.0], Train: total:8498.09863, BCE:-21.86830, KLD:2839.98950,Test: total:33626.82812, BCE:-21.98120, KLD:11216.27246
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 12960, epoch 48.0)
score:  36.163333333333334
score:  32.34
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 12960, epoch 48.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [48.0], Train: total:8501.29004, BCE:-21.93837, KLD:2841.07715,Test: total:33630.79688, BCE:-22.03739, KLD:11217.61133
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 13230, epoch 49.0)
score:  36.20333333333333
score:  33.39
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 13230, epoch 49.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [49.0], Train: total:8456.71289, BCE:-22.03057, KLD:2826.24731,Test: total:33462.41797, BCE:-22.13215, KLD:11161.51758
Epoch    50: reducing learning rate of group 0 to 4.0000e-05.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 13500, epoch 50.0)
score:  35.388333333333335
score:  32.04
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 13500, epoch 50.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [50.0], Train: total:8447.63672, BCE:-22.00439, KLD:2823.21338,Test: total:33422.84766, BCE:-22.10724, KLD:11148.31934
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 13770, epoch 51.0)
score:  35.42166666666667
score:  32.5
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 13770, epoch 51.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [51.0], Train: total:8441.65430, BCE:-21.80847, KLD:2821.15308,Test: total:33396.37891, BCE:-21.93296, KLD:11139.43652
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 14040, epoch 52.0)
score:  35.516666666666666
score:  31.26
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 14040, epoch 52.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [52.0], Train: total:8415.20508, BCE:-21.80140, KLD:2812.33594,Test: total:33291.23438, BCE:-21.90676, KLD:11104.37988
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 14310, epoch 53.0)
score:  35.35333333333333
score:  31.6
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 14310, epoch 53.0)
[Save Checkpoint] epoch: [53.0], Train: total:8418.03809, BCE:-21.78269, KLD:2813.27368,Test: total:33298.86328, BCE:-21.90754, KLD:11106.92285
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 14580, epoch 54.0)
score:  35.575
score:  32.25
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 14580, epoch 54.0)
[Save Checkpoint] epoch: [54.0], Train: total:8448.37305, BCE:-21.86612, KLD:2823.41211,Test: total:33427.13281, BCE:-21.96492, KLD:11149.69922
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 14850, epoch 55.0)
score:  35.13
score:  31.62
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 14850, epoch 55.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [55.0], Train: total:8468.31543, BCE:-21.94057, KLD:2830.08521,Test: total:33507.90234, BCE:-22.06859, KLD:11176.65625
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 15120, epoch 56.0)
score:  35.38666666666666
score:  31.66
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 15120, epoch 56.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [56.0], Train: total:8441.47461, BCE:-21.92624, KLD:2821.13110,Test: total:33399.88281, BCE:-22.02860, KLD:11140.63574
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 15390, epoch 57.0)
score:  35.11833333333333
score:  31.65
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 15390, epoch 57.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [57.0], Train: total:8428.39844, BCE:-21.94676, KLD:2816.78247,Test: total:33341.75391, BCE:-22.02715, KLD:11121.26074
Epoch    58: reducing learning rate of group 0 to 8.0000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 15660, epoch 58.0)
score:  35.196666666666665
score:  31.49
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 15660, epoch 58.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [58.0], Train: total:8418.80273, BCE:-21.97628, KLD:2813.59204,Test: total:33305.48047, BCE:-22.06574, KLD:11109.18262
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 15930, epoch 59.0)
score:  35.22
score:  31.82
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 15930, epoch 59.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [59.0], Train: total:8421.55859, BCE:-21.97888, KLD:2814.51147,Test: total:33315.18750, BCE:-22.05999, KLD:11112.41699
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 16200, epoch 60.0)
score:  35.181666666666665
score:  31.98
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 16200, epoch 60.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [60.0], Train: total:8414.20312, BCE:-21.98170, KLD:2812.06372,Test: total:33285.32812, BCE:-22.08943, KLD:11102.47363
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 16470, epoch 61.0)
score:  34.97833333333333
score:  31.87
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 16470, epoch 61.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [61.0], Train: total:8432.62305, BCE:-21.97374, KLD:2818.19873,Test: total:33359.51172, BCE:-22.07716, KLD:11127.19629
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 16740, epoch 62.0)
score:  35.306666666666665
score:  31.67
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 16740, epoch 62.0)
EarlyStopping counter: 8 out of 25
[Save Checkpoint] epoch: [62.0], Train: total:8421.95312, BCE:-21.94829, KLD:2814.63525,Test: total:33316.96875, BCE:-22.06688, KLD:11113.01074
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 17010, epoch 63.0)
score:  35.03666666666667
score:  31.23
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 17010, epoch 63.0)
[Save Checkpoint] epoch: [63.0], Train: total:8417.28613, BCE:-21.94723, KLD:2813.07739,Test: total:33301.01562, BCE:-22.07134, KLD:11107.69629
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 17280, epoch 64.0)
score:  35.108333333333334
score:  31.14
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 17280, epoch 64.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [64.0], Train: total:8424.29883, BCE:-22.00064, KLD:2815.43408,Test: total:33325.53906, BCE:-22.09360, KLD:11115.87500
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 17550, epoch 65.0)
score:  35.18833333333333
score:  31.63
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 17550, epoch 65.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [65.0], Train: total:8432.68164, BCE:-22.00428, KLD:2818.22974,Test: total:33357.78125, BCE:-22.11370, KLD:11126.63184
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 17820, epoch 66.0)
score:  35.32666666666667
score:  31.35
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 17820, epoch 66.0)
[Save Checkpoint] epoch: [66.0], Train: total:8420.97363, BCE:-21.99022, KLD:2814.32202,Test: total:33316.08984, BCE:-22.08158, KLD:11112.72168
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 18090, epoch 67.0)
score:  35.21666666666667
score:  31.15
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 18090, epoch 67.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [67.0], Train: total:8427.49414, BCE:-21.99280, KLD:2816.49536,Test: total:33339.60156, BCE:-22.07635, KLD:11120.55957
Epoch    68: reducing learning rate of group 0 to 1.6000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 18360, epoch 68.0)
score:  34.98166666666667
score:  31.6
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 18360, epoch 68.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [68.0], Train: total:8427.60840, BCE:-22.00206, KLD:2816.53613,Test: total:33340.16797, BCE:-22.11832, KLD:11120.76367
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 18630, epoch 69.0)
score:  35.125
score:  31.73
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 18630, epoch 69.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [69.0], Train: total:8433.28906, BCE:-22.04379, KLD:2818.44360,Test: total:33362.50781, BCE:-22.17374, KLD:11128.22656
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 18900, epoch 70.0)
score:  35.163333333333334
score:  31.57
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 18900, epoch 70.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [70.0], Train: total:8439.01660, BCE:-22.05441, KLD:2820.35571,Test: total:33384.27734, BCE:-22.13992, KLD:11135.47363
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 19170, epoch 71.0)
score:  35.16
score:  31.84
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 19170, epoch 71.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [71.0], Train: total:8436.98047, BCE:-22.06111, KLD:2819.67993,Test: total:33376.93750, BCE:-22.13680, KLD:11133.02441
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 19440, epoch 72.0)
score:  35.415
score:  31.47
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 19440, epoch 72.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [72.0], Train: total:8434.74023, BCE:-22.07299, KLD:2818.93750,Test: total:33367.78906, BCE:-22.17821, KLD:11129.98926
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 19710, epoch 73.0)
score:  35.315
score:  31.27
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 19710, epoch 73.0)
[Save Checkpoint] epoch: [73.0], Train: total:8427.79199, BCE:-22.07767, KLD:2816.62402,Test: total:33341.36719, BCE:-22.15876, KLD:11121.17480
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 19980, epoch 74.0)
score:  35.08166666666666
score:  31.67
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 19980, epoch 74.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [74.0], Train: total:8432.80664, BCE:-22.08089, KLD:2818.29639,Test: total:33361.07812, BCE:-22.15564, KLD:11127.74512
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 20250, epoch 75.0)
score:  35.14833333333333
score:  32.0
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 20250, epoch 75.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [75.0], Train: total:8431.98730, BCE:-22.08762, KLD:2818.02319,Test: total:33357.49609, BCE:-22.19570, KLD:11126.56348
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 20520, epoch 76.0)
score:  35.14666666666667
score:  31.72
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 20520, epoch 76.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [76.0], Train: total:8434.75195, BCE:-22.07370, KLD:2818.94165,Test: total:33368.12109, BCE:-22.17034, KLD:11130.09668
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 20790, epoch 77.0)
score:  35.16833333333334
score:  31.68
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 20790, epoch 77.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [77.0], Train: total:8430.12305, BCE:-22.07922, KLD:2817.40161,Test: total:33350.41016, BCE:-22.18358, KLD:11124.19824
Epoch    78: reducing learning rate of group 0 to 1.0000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 21060, epoch 78.0)
score:  35.35166666666667
score:  31.84
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 21060, epoch 78.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [78.0], Train: total:8430.20898, BCE:-22.07559, KLD:2817.42749,Test: total:33350.60547, BCE:-22.19371, KLD:11124.26465
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 21330, epoch 79.0)
score:  34.96
score:  31.89
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 21330, epoch 79.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [79.0], Train: total:8430.03027, BCE:-22.08744, KLD:2817.37305,Test: total:33350.12109, BCE:-22.18307, KLD:11124.10156
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 21600, epoch 80.0)
score:  34.94
score:  31.81
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 21600, epoch 80.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [80.0], Train: total:8433.90918, BCE:-22.07960, KLD:2818.66284,Test: total:33364.86328, BCE:-22.18429, KLD:11129.01465
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 21870, epoch 81.0)
score:  35.04833333333333
score:  31.17
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 21870, epoch 81.0)
EarlyStopping counter: 8 out of 25
[Save Checkpoint] epoch: [81.0], Train: total:8436.19043, BCE:-22.07706, KLD:2819.42114,Test: total:33373.85547, BCE:-22.20190, KLD:11132.01855
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 22140, epoch 82.0)
score:  35.38
score:  31.39
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 22140, epoch 82.0)
EarlyStopping counter: 9 out of 25
[Save Checkpoint] epoch: [82.0], Train: total:8434.64941, BCE:-22.08314, KLD:2818.91089,Test: total:33368.51953, BCE:-22.16794, KLD:11130.22852
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 22410, epoch 83.0)
score:  35.04666666666667
score:  32.11
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 22410, epoch 83.0)
EarlyStopping counter: 10 out of 25
[Save Checkpoint] epoch: [83.0], Train: total:8435.97559, BCE:-22.08959, KLD:2819.35596,Test: total:33373.13672, BCE:-22.20784, KLD:11131.78418
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 22680, epoch 84.0)
score:  35.23
score:  31.5
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 22680, epoch 84.0)
[Save Checkpoint] epoch: [84.0], Train: total:8434.66504, BCE:-22.09224, KLD:2818.91943,Test: total:33368.10547, BCE:-22.18023, KLD:11130.09668
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 22950, epoch 85.0)
score:  35.19833333333333
score:  31.61
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 22950, epoch 85.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [85.0], Train: total:8437.01660, BCE:-22.09666, KLD:2819.70483,Test: total:33377.78516, BCE:-22.19644, KLD:11133.32520
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 23220, epoch 86.0)
score:  35.075
score:  30.95
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 23220, epoch 86.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [86.0], Train: total:8438.28027, BCE:-22.09477, KLD:2820.12476,Test: total:33382.90625, BCE:-22.18628, KLD:11135.03027
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 23490, epoch 87.0)
score:  35.251666666666665
score:  31.6
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 23490, epoch 87.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [87.0], Train: total:8439.56934, BCE:-22.08151, KLD:2820.54956,Test: total:33387.68359, BCE:-22.18704, KLD:11136.62305
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 23760, epoch 88.0)
score:  34.88333333333333
score:  31.37
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 23760, epoch 88.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [88.0], Train: total:8436.95312, BCE:-22.07693, KLD:2819.67700,Test: total:33377.35547, BCE:-22.16370, KLD:11133.17285
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 24030, epoch 89.0)
score:  35.2
score:  31.48
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 24030, epoch 89.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [89.0], Train: total:8430.94824, BCE:-22.09041, KLD:2817.67871,Test: total:33353.91016, BCE:-22.19074, KLD:11125.36719
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 24300, epoch 90.0)
score:  35.22666666666667
score:  31.83
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 24300, epoch 90.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [90.0], Train: total:8432.70898, BCE:-22.10350, KLD:2818.27148,Test: total:33361.39062, BCE:-22.19493, KLD:11127.86328
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 24570, epoch 91.0)
score:  35.181666666666665
score:  31.31
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 24570, epoch 91.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [91.0], Train: total:8433.48340, BCE:-22.10357, KLD:2818.52930,Test: total:33364.32422, BCE:-22.20239, KLD:11128.84277
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 24840, epoch 92.0)
score:  35.205
score:  31.48
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 24840, epoch 92.0)
EarlyStopping counter: 8 out of 25
[Save Checkpoint] epoch: [92.0], Train: total:8434.13672, BCE:-22.09235, KLD:2818.74365,Test: total:33366.41016, BCE:-22.21333, KLD:11129.54199
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 25110, epoch 93.0)
score:  35.39666666666667
score:  31.87
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 25110, epoch 93.0)
EarlyStopping counter: 9 out of 25
[Save Checkpoint] epoch: [93.0], Train: total:8439.81738, BCE:-22.09444, KLD:2820.63599,Test: total:33388.90234, BCE:-22.19538, KLD:11137.03320
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 25380, epoch 94.0)
score:  35.24333333333333
score:  31.55
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 25380, epoch 94.0)
EarlyStopping counter: 10 out of 25
[Save Checkpoint] epoch: [94.0], Train: total:8437.14844, BCE:-22.10498, KLD:2819.75220,Test: total:33378.55078, BCE:-22.19935, KLD:11133.58398
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 25650, epoch 95.0)
score:  35.31166666666667
score:  30.92
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 25650, epoch 95.0)
EarlyStopping counter: 11 out of 25
[Save Checkpoint] epoch: [95.0], Train: total:8435.94824, BCE:-22.08986, KLD:2819.34546,Test: total:33373.42578, BCE:-22.18392, KLD:11131.86914
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 25920, epoch 96.0)
score:  35.13
score:  31.77
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 25920, epoch 96.0)
EarlyStopping counter: 12 out of 25
[Save Checkpoint] epoch: [96.0], Train: total:8434.57617, BCE:-22.10232, KLD:2818.89282,Test: total:33367.68750, BCE:-22.17405, KLD:11129.95312
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 26190, epoch 97.0)
score:  35.11
score:  31.62
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 26190, epoch 97.0)
EarlyStopping counter: 13 out of 25
[Save Checkpoint] epoch: [97.0], Train: total:8430.80371, BCE:-22.09664, KLD:2817.63306,Test: total:33353.53906, BCE:-22.20777, KLD:11125.24805
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 26460, epoch 98.0)
score:  35.098333333333336
score:  31.51
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 26460, epoch 98.0)
EarlyStopping counter: 14 out of 25
[Save Checkpoint] epoch: [98.0], Train: total:8432.56055, BCE:-22.09691, KLD:2818.21924,Test: total:33360.23828, BCE:-22.22603, KLD:11127.48730
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 26730, epoch 99.0)
score:  35.053333333333335
score:  31.19
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 26730, epoch 99.0)
EarlyStopping counter: 15 out of 25
[Save Checkpoint] epoch: [99.0], Train: total:8426.48047, BCE:-22.10008, KLD:2816.19434,Test: total:33336.84375, BCE:-22.20994, KLD:11119.68555
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 27000, epoch 100.0)
score:  34.995
score:  31.22
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_2_beta/last' (iter 27000, epoch 100.0)
EarlyStopping counter: 16 out of 25
[Save Checkpoint] epoch: [100.0], Train: total:8428.69434, BCE:-22.11105, KLD:2816.93457,Test: total:33345.65234, BCE:-22.21242, KLD:11122.62109
[Training Finished]
All done !
