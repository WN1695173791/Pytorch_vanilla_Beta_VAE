4
--gpu_devices 0 --max_iter 100 --batch_size 32 --lr 1e-4 --use_scheduler True --use_VAE True --is_VAE_var True --z_var_size 5 --lambda_BCE 1 --beta 1 --var_second_cnn_block True --var_third_cnn_block False --exp_name mnist_vae_var_kaggle_scheduler_3
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, GMP=True, Hmg_dst_loss=False, IPC=False, L1_norm_act=False, L1_norm_weights=False, L3_without_random=False, LOG_DIR='logs', adapt_lr=False, add_classification_layer=True, add_linear_after_GMP=True, add_z_struct_bottleneck=False, alpha=32, batch_size=32, beta=1.0, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=8, binary_chain=False, binary_first_conv=False, binary_second_conv=False, binary_third_conv=False, binary_z=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, contrastive_loss=False, cuda=True, dataset='mnist', dataset_balanced=False, decoder_first_dense=36, decoder_kernel_size_1=4, decoder_kernel_size_2=3, decoder_kernel_size_3=4, decoder_n_filter_1=64, decoder_n_filter_2=64, decoder_n_filter_3=64, decoder_stride_1=2, decoder_stride_2=2, decoder_stride_3=1, diff_var=False, display_step=10000, dset_dir='data', exp_name='mnist_vae_var_kaggle_scheduler_3', freeze_Encoder=True, gamma=1000, gpu_devices=[0], hidden_filters_layer1=32, hidden_filters_layer2=32, hidden_filters_layer3=32, image_size=64, intra_class_variance_loss=False, is_C=True, is_E1=False, is_VAE_var=True, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=False, is_default_model=False, is_encoder_struct=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, kernel_size_1=4, kernel_size_2=4, kernel_size_3=4, lambda_BCE=1.0, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_VAE=1, lambda_class=1, lambda_contrastive_loss=1, lambda_distance_mean=1, lambda_hmg_dst=1, lambda_intra_class_var=1, lambda_partial_class=1, lambda_ratio_reg=1, lambda_recon_wt_rand=1, lambda_recons=1, lambda_var_distance=1, lambda_var_inter=1, lambda_var_intra=1, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', loss='Proxy_Anchor', loss_distance_mean=False, loss_min_distance_cl=False, lr=0.0001, max_iter=100.0, model='CNN', mrg=0.1, nb_epochs_train_only_zvar=0, num_workers=2, old_weighted=False, optimizer='adamw', other_architecture=False, other_ratio=False, random_percentage=0.2, random_seed=10, randomness=True, ratio_reg=False, remark='', save_step=10000, second_layer_C=False, seed=1, stride_size=1, sz_embedding=5, three_conv_layer=False, train=True, train_var_struct_alternatively=False, two_conv_layer=True, two_encoder=False, use_VAE=True, use_decoder=False, use_early_stopping=True, use_scheduler=True, use_structural_encoder=False, value_target_distance_mean=1, var_hidden_dim=256, var_hidden_filters_1=32, var_hidden_filters_2=32, var_hidden_filters_3=32, var_kernel_size_1=3, var_kernel_size_2=3, var_kernel_size_3=3, var_second_cnn_block=True, var_stride_size_1=1, var_stride_size_2=1, var_stride_size_3=1, var_third_cnn_block=False, var_three_conv_layer=False, warm=1, without_acc=False, z_struct_size=32, z_var_size=5, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
[Using Seed: 10]
Load Encoder struct weights for VAE
use 1 gpu who named: Tesla V100-SXM2-32GB
=> loaded sample_scores and losses
=> no checkpoint found at 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last'
VAE_var(
  (encoder_var): Sequential(
    (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (1): ReLU(inplace=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (4): ReLU(inplace=True)
    (5): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): View()
    (7): Dropout(p=0.4, inplace=False)
    (8): Linear(in_features=4096, out_features=128, bias=True)
    (9): ReLU(inplace=True)
    (10): Linear(in_features=128, out_features=10, bias=True)
  )
  (decoder_var): Sequential(
    (0): Linear(in_features=5, out_features=4096, bias=True)
    (1): ReLU(inplace=True)
    (2): View()
    (3): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (4): ReLU(inplace=True)
    (5): ConvTranspose2d(64, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (6): ReLU(inplace=True)
    (7): ConvTranspose2d(32, 1, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (8): Sigmoid()
  )
)
The number of parameters of model is 667979
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 1875, epoch 1.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 1875, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train: total:3393.69116, BCE:-31.90756, KLD:3425.59766,Test: total:107171.62500, BCE:-32.36766, KLD:107204.00000
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 3750, epoch 2.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 3750, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train: total:2413.52637, BCE:-34.42841, KLD:2447.95093,Test: total:76602.02344, BCE:-34.85048, KLD:76636.88281
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 5625, epoch 3.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 5625, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train: total:2086.16406, BCE:-36.17508, KLD:2122.33813,Test: total:66591.95312, BCE:-36.57680, KLD:66628.52344
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 7500, epoch 4.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 7500, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train: total:1788.96130, BCE:-36.79037, KLD:1825.75208,Test: total:57213.80859, BCE:-37.15929, KLD:57250.96484
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 9375, epoch 5.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 9375, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train: total:1646.80762, BCE:-37.91106, KLD:1684.71887,Test: total:52771.01172, BCE:-38.27082, KLD:52809.28125
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 11250, epoch 6.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 11250, epoch 6.0)
EarlyStopping counter: 1 out of 20
[Save Checkpoint] epoch: [6.0], Train: total:1527.75403, BCE:-38.36001, KLD:1566.11389,Test: total:49019.60156, BCE:-38.69784, KLD:49058.29688
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 13125, epoch 7.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 13125, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train: total:1420.05322, BCE:-38.66964, KLD:1458.72363,Test: total:45626.53125, BCE:-38.99399, KLD:45665.53125
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 15000, epoch 8.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 15000, epoch 8.0)
[Save Checkpoint] epoch: [8.0], Train: total:1358.48340, BCE:-39.01865, KLD:1397.50122,Test: total:43744.37891, BCE:-39.34232, KLD:43783.72266
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 16875, epoch 9.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 16875, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train: total:1343.71948, BCE:-39.37679, KLD:1383.09668,Test: total:43284.35547, BCE:-39.67774, KLD:43324.03906
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 18750, epoch 10.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 18750, epoch 10.0)
EarlyStopping counter: 1 out of 20
[Save Checkpoint] epoch: [10.0], Train: total:1243.59167, BCE:-39.59995, KLD:1283.19250,Test: total:40185.19922, BCE:-39.89372, KLD:40225.08984
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 20625, epoch 11.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 20625, epoch 11.0)
EarlyStopping counter: 2 out of 20
[Save Checkpoint] epoch: [11.0], Train: total:1209.73914, BCE:-39.60662, KLD:1249.34717,Test: total:39127.27734, BCE:-39.90973, KLD:39167.18359
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 22500, epoch 12.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 22500, epoch 12.0)
EarlyStopping counter: 3 out of 20
[Save Checkpoint] epoch: [12.0], Train: total:1185.20203, BCE:-40.01179, KLD:1225.21558,Test: total:38415.55859, BCE:-40.30017, KLD:38455.85938
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 24375, epoch 13.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 24375, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train: total:1162.89465, BCE:-40.16685, KLD:1203.06287,Test: total:37661.29297, BCE:-40.45063, KLD:37701.74609
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 26250, epoch 14.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 26250, epoch 14.0)
EarlyStopping counter: 1 out of 20
[Save Checkpoint] epoch: [14.0], Train: total:1122.85083, BCE:-40.26092, KLD:1163.11145,Test: total:36447.33984, BCE:-40.53367, KLD:36487.87109
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 28125, epoch 15.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 28125, epoch 15.0)
EarlyStopping counter: 2 out of 20
[Save Checkpoint] epoch: [15.0], Train: total:1100.83704, BCE:-40.35614, KLD:1141.19324,Test: total:35729.06250, BCE:-40.63548, KLD:35769.69922
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 30000, epoch 16.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 30000, epoch 16.0)
EarlyStopping counter: 3 out of 20
[Save Checkpoint] epoch: [16.0], Train: total:1065.18860, BCE:-40.45196, KLD:1105.64124,Test: total:34642.73828, BCE:-40.72684, KLD:34683.46875
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 31875, epoch 17.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 31875, epoch 17.0)
EarlyStopping counter: 4 out of 20
[Save Checkpoint] epoch: [17.0], Train: total:1055.44263, BCE:-40.53823, KLD:1095.98022,Test: total:34365.64453, BCE:-40.79939, KLD:34406.44141
Epoch    18: reducing learning rate of group 0 to 2.0000e-05.
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 33750, epoch 18.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 33750, epoch 18.0)
EarlyStopping counter: 5 out of 20
[Save Checkpoint] epoch: [18.0], Train: total:1052.11597, BCE:-40.72071, KLD:1092.83740,Test: total:34249.99609, BCE:-40.97040, KLD:34290.96484
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 35625, epoch 19.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 35625, epoch 19.0)
EarlyStopping counter: 6 out of 20
[Save Checkpoint] epoch: [19.0], Train: total:1045.79370, BCE:-40.77594, KLD:1086.57031,Test: total:34054.53516, BCE:-41.02491, KLD:34095.55859
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 37500, epoch 20.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 37500, epoch 20.0)
EarlyStopping counter: 7 out of 20
[Save Checkpoint] epoch: [20.0], Train: total:1034.41760, BCE:-40.78704, KLD:1075.20447,Test: total:33686.79688, BCE:-41.03104, KLD:33727.82812
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 39375, epoch 21.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 39375, epoch 21.0)
EarlyStopping counter: 8 out of 20
[Save Checkpoint] epoch: [21.0], Train: total:1034.96289, BCE:-40.82013, KLD:1075.78259,Test: total:33709.56641, BCE:-41.06055, KLD:33750.62891
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 41250, epoch 22.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 41250, epoch 22.0)
[Save Checkpoint] epoch: [22.0], Train: total:1036.19629, BCE:-40.85439, KLD:1077.04956,Test: total:33737.93359, BCE:-41.09679, KLD:33779.02734
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 43125, epoch 23.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 43125, epoch 23.0)
EarlyStopping counter: 1 out of 20
[Save Checkpoint] epoch: [23.0], Train: total:1037.20264, BCE:-40.92622, KLD:1078.12805,Test: total:33776.92188, BCE:-41.15959, KLD:33818.08203
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 45000, epoch 24.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 45000, epoch 24.0)
EarlyStopping counter: 2 out of 20
[Save Checkpoint] epoch: [24.0], Train: total:1027.11169, BCE:-40.88678, KLD:1067.99951,Test: total:33456.32422, BCE:-41.12224, KLD:33497.44531
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 46875, epoch 25.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 46875, epoch 25.0)
EarlyStopping counter: 3 out of 20
[Save Checkpoint] epoch: [25.0], Train: total:1030.87683, BCE:-40.97707, KLD:1071.85400,Test: total:33590.91797, BCE:-41.20830, KLD:33632.12109
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 48750, epoch 26.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 48750, epoch 26.0)
EarlyStopping counter: 4 out of 20
[Save Checkpoint] epoch: [26.0], Train: total:1025.78650, BCE:-41.00479, KLD:1066.79053,Test: total:33419.57422, BCE:-41.23581, KLD:33460.80859
Epoch    27: reducing learning rate of group 0 to 4.0000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 50625, epoch 27.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 50625, epoch 27.0)
EarlyStopping counter: 5 out of 20
[Save Checkpoint] epoch: [27.0], Train: total:1018.41028, BCE:-40.98785, KLD:1059.39978,Test: total:33194.18359, BCE:-41.21722, KLD:33235.39844
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 52500, epoch 28.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 52500, epoch 28.0)
EarlyStopping counter: 6 out of 20
[Save Checkpoint] epoch: [28.0], Train: total:1018.30255, BCE:-41.01391, KLD:1059.31604,Test: total:33189.29688, BCE:-41.24627, KLD:33230.54297
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 54375, epoch 29.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 54375, epoch 29.0)
EarlyStopping counter: 7 out of 20
[Save Checkpoint] epoch: [29.0], Train: total:1018.04205, BCE:-41.03704, KLD:1059.07947,Test: total:33174.48828, BCE:-41.26627, KLD:33215.75391
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 56250, epoch 30.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 56250, epoch 30.0)
EarlyStopping counter: 8 out of 20
[Save Checkpoint] epoch: [30.0], Train: total:1014.87329, BCE:-41.04451, KLD:1055.91797,Test: total:33078.16797, BCE:-41.27148, KLD:33119.43750
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 58125, epoch 31.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 58125, epoch 31.0)
EarlyStopping counter: 9 out of 20
[Save Checkpoint] epoch: [31.0], Train: total:1012.52808, BCE:-41.03957, KLD:1053.56714,Test: total:33001.59766, BCE:-41.27047, KLD:33042.87109
Epoch    32: reducing learning rate of group 0 to 1.0000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 60000, epoch 32.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 60000, epoch 32.0)
EarlyStopping counter: 10 out of 20
[Save Checkpoint] epoch: [32.0], Train: total:1013.33667, BCE:-41.04673, KLD:1054.38416,Test: total:33029.89844, BCE:-41.27623, KLD:33071.17188
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 61875, epoch 33.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 61875, epoch 33.0)
EarlyStopping counter: 11 out of 20
[Save Checkpoint] epoch: [33.0], Train: total:1012.14502, BCE:-41.03620, KLD:1053.18066,Test: total:32986.12109, BCE:-41.26598, KLD:33027.38672
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 63750, epoch 34.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 63750, epoch 34.0)
EarlyStopping counter: 12 out of 20
[Save Checkpoint] epoch: [34.0], Train: total:1010.92310, BCE:-41.03350, KLD:1051.95569,Test: total:32950.53906, BCE:-41.26161, KLD:32991.80078
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 65625, epoch 35.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 65625, epoch 35.0)
EarlyStopping counter: 13 out of 20
[Save Checkpoint] epoch: [35.0], Train: total:1010.08417, BCE:-41.04326, KLD:1051.12769,Test: total:32926.23047, BCE:-41.27114, KLD:32967.50000
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 67500, epoch 36.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 67500, epoch 36.0)
EarlyStopping counter: 14 out of 20
[Save Checkpoint] epoch: [36.0], Train: total:1015.81104, BCE:-41.06376, KLD:1056.87415,Test: total:33104.66797, BCE:-41.29212, KLD:33145.96094
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 69375, epoch 37.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 69375, epoch 37.0)
[Save Checkpoint] epoch: [37.0], Train: total:1012.18176, BCE:-41.04312, KLD:1053.22485,Test: total:32986.30469, BCE:-41.27024, KLD:33027.57031
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 71250, epoch 38.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 71250, epoch 38.0)
EarlyStopping counter: 1 out of 20
[Save Checkpoint] epoch: [38.0], Train: total:1013.35547, BCE:-41.04964, KLD:1054.40405,Test: total:33024.01562, BCE:-41.27635, KLD:33065.29297
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 73125, epoch 39.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 73125, epoch 39.0)
EarlyStopping counter: 2 out of 20
[Save Checkpoint] epoch: [39.0], Train: total:1010.16272, BCE:-41.04028, KLD:1051.20117,Test: total:32925.38672, BCE:-41.26770, KLD:32966.65234
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 75000, epoch 40.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 75000, epoch 40.0)
EarlyStopping counter: 3 out of 20
[Save Checkpoint] epoch: [40.0], Train: total:1011.35345, BCE:-41.05233, KLD:1052.40625,Test: total:32963.53516, BCE:-41.28051, KLD:33004.81250
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 76875, epoch 41.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 76875, epoch 41.0)
EarlyStopping counter: 4 out of 20
[Save Checkpoint] epoch: [41.0], Train: total:1014.42480, BCE:-41.06438, KLD:1055.48987,Test: total:33059.89844, BCE:-41.29189, KLD:33101.18750
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 78750, epoch 42.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 78750, epoch 42.0)
EarlyStopping counter: 5 out of 20
[Save Checkpoint] epoch: [42.0], Train: total:1012.51013, BCE:-41.06165, KLD:1053.57117,Test: total:33000.44141, BCE:-41.28788, KLD:33041.72656
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 80625, epoch 43.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 80625, epoch 43.0)
EarlyStopping counter: 6 out of 20
[Save Checkpoint] epoch: [43.0], Train: total:1012.72864, BCE:-41.06379, KLD:1053.79065,Test: total:33008.87109, BCE:-41.29206, KLD:33050.16797
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 82500, epoch 44.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 82500, epoch 44.0)
EarlyStopping counter: 7 out of 20
[Save Checkpoint] epoch: [44.0], Train: total:1014.51636, BCE:-41.07588, KLD:1055.59180,Test: total:33062.55859, BCE:-41.30464, KLD:33103.86719
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 84375, epoch 45.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 84375, epoch 45.0)
EarlyStopping counter: 8 out of 20
[Save Checkpoint] epoch: [45.0], Train: total:1012.56866, BCE:-41.07243, KLD:1053.64038,Test: total:33003.16406, BCE:-41.29974, KLD:33044.45703
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 86250, epoch 46.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 86250, epoch 46.0)
EarlyStopping counter: 9 out of 20
[Save Checkpoint] epoch: [46.0], Train: total:1011.59662, BCE:-41.06218, KLD:1052.65967,Test: total:32971.16797, BCE:-41.28690, KLD:33012.45703
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 88125, epoch 47.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 88125, epoch 47.0)
EarlyStopping counter: 10 out of 20
[Save Checkpoint] epoch: [47.0], Train: total:1010.25281, BCE:-41.05626, KLD:1051.30981,Test: total:32929.96484, BCE:-41.28301, KLD:32971.24609
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 90000, epoch 48.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 90000, epoch 48.0)
EarlyStopping counter: 11 out of 20
[Save Checkpoint] epoch: [48.0], Train: total:1013.09839, BCE:-41.07445, KLD:1054.17249,Test: total:33021.08203, BCE:-41.29713, KLD:33062.37891
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 91875, epoch 49.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 91875, epoch 49.0)
[Save Checkpoint] epoch: [49.0], Train: total:1007.36896, BCE:-41.05404, KLD:1048.42310,Test: total:32842.18750, BCE:-41.28030, KLD:32883.46875
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 93750, epoch 50.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 93750, epoch 50.0)
EarlyStopping counter: 1 out of 20
[Save Checkpoint] epoch: [50.0], Train: total:1008.06555, BCE:-41.06020, KLD:1049.12598,Test: total:32863.24609, BCE:-41.28552, KLD:32904.52734
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 95625, epoch 51.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 95625, epoch 51.0)
EarlyStopping counter: 2 out of 20
[Save Checkpoint] epoch: [51.0], Train: total:1006.69153, BCE:-41.05787, KLD:1047.74939,Test: total:32818.88672, BCE:-41.28573, KLD:32860.17578
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 97500, epoch 52.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 97500, epoch 52.0)
EarlyStopping counter: 3 out of 20
[Save Checkpoint] epoch: [52.0], Train: total:1013.73401, BCE:-41.09031, KLD:1054.82410,Test: total:33040.77734, BCE:-41.31604, KLD:33082.08984
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 99375, epoch 53.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 99375, epoch 53.0)
EarlyStopping counter: 4 out of 20
[Save Checkpoint] epoch: [53.0], Train: total:1010.10449, BCE:-41.07513, KLD:1051.17896,Test: total:32929.12500, BCE:-41.30265, KLD:32970.43359
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 101250, epoch 54.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 101250, epoch 54.0)
EarlyStopping counter: 5 out of 20
[Save Checkpoint] epoch: [54.0], Train: total:1010.90674, BCE:-41.07452, KLD:1051.98132,Test: total:32950.32031, BCE:-41.30146, KLD:32991.62109
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 103125, epoch 55.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 103125, epoch 55.0)
EarlyStopping counter: 6 out of 20
[Save Checkpoint] epoch: [55.0], Train: total:1010.66296, BCE:-41.08357, KLD:1051.74585,Test: total:32944.96484, BCE:-41.30706, KLD:32986.27344
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 105000, epoch 56.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 105000, epoch 56.0)
EarlyStopping counter: 7 out of 20
[Save Checkpoint] epoch: [56.0], Train: total:1009.70630, BCE:-41.08199, KLD:1050.78845,Test: total:32914.56641, BCE:-41.30804, KLD:32955.87500
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 106875, epoch 57.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 106875, epoch 57.0)
EarlyStopping counter: 8 out of 20
[Save Checkpoint] epoch: [57.0], Train: total:1009.36230, BCE:-41.07930, KLD:1050.44250,Test: total:32903.28516, BCE:-41.30610, KLD:32944.58984
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 108750, epoch 58.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 108750, epoch 58.0)
EarlyStopping counter: 9 out of 20
[Save Checkpoint] epoch: [58.0], Train: total:1011.34540, BCE:-41.08561, KLD:1052.43213,Test: total:32965.31641, BCE:-41.31240, KLD:33006.62891
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 110625, epoch 59.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 110625, epoch 59.0)
EarlyStopping counter: 10 out of 20
[Save Checkpoint] epoch: [59.0], Train: total:1008.29724, BCE:-41.07409, KLD:1049.37036,Test: total:32868.22656, BCE:-41.29792, KLD:32909.52344
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 112500, epoch 60.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 112500, epoch 60.0)
EarlyStopping counter: 11 out of 20
[Save Checkpoint] epoch: [60.0], Train: total:1007.68719, BCE:-41.08390, KLD:1048.77075,Test: total:32855.13281, BCE:-41.30807, KLD:32896.43750
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 114375, epoch 61.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 114375, epoch 61.0)
EarlyStopping counter: 12 out of 20
[Save Checkpoint] epoch: [61.0], Train: total:1010.40771, BCE:-41.09106, KLD:1051.49902,Test: total:32935.93750, BCE:-41.31645, KLD:32977.25781
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 116250, epoch 62.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 116250, epoch 62.0)
EarlyStopping counter: 13 out of 20
[Save Checkpoint] epoch: [62.0], Train: total:1007.90399, BCE:-41.08820, KLD:1048.99182,Test: total:32859.51172, BCE:-41.31488, KLD:32900.82422
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 118125, epoch 63.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 118125, epoch 63.0)
EarlyStopping counter: 14 out of 20
[Save Checkpoint] epoch: [63.0], Train: total:1004.72253, BCE:-41.07322, KLD:1045.79346,Test: total:32755.32617, BCE:-41.29891, KLD:32796.62109
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 120000, epoch 64.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 120000, epoch 64.0)
EarlyStopping counter: 15 out of 20
[Save Checkpoint] epoch: [64.0], Train: total:1010.13525, BCE:-41.09495, KLD:1051.23120,Test: total:32925.80078, BCE:-41.31844, KLD:32967.11328
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 121875, epoch 65.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 121875, epoch 65.0)
EarlyStopping counter: 16 out of 20
[Save Checkpoint] epoch: [65.0], Train: total:1006.28741, BCE:-41.08525, KLD:1047.37366,Test: total:32806.45703, BCE:-41.30865, KLD:32847.76172
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 123750, epoch 66.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 123750, epoch 66.0)
EarlyStopping counter: 17 out of 20
[Save Checkpoint] epoch: [66.0], Train: total:1006.00647, BCE:-41.08236, KLD:1047.08813,Test: total:32797.44531, BCE:-41.30584, KLD:32838.75000
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 125625, epoch 67.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 125625, epoch 67.0)
EarlyStopping counter: 18 out of 20
[Save Checkpoint] epoch: [67.0], Train: total:1006.78510, BCE:-41.10028, KLD:1047.88611,Test: total:32823.67578, BCE:-41.32791, KLD:32865.00000
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 127500, epoch 68.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 127500, epoch 68.0)
EarlyStopping counter: 19 out of 20
[Save Checkpoint] epoch: [68.0], Train: total:1006.47821, BCE:-41.08830, KLD:1047.56738,Test: total:32812.87500, BCE:-41.31309, KLD:32854.18750
=> saved checkpoint 'checkpoints_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 129375, epoch 69.0)
=> saved checkpoint 'checkpoint_scores_CNN/mnist_vae_var_kaggle_scheduler_3/last' (iter 129375, epoch 69.0)
EarlyStopping counter: 20 out of 20
[Save Checkpoint] epoch: [69.0], Train: total:1004.92053, BCE:-41.07518, KLD:1045.99475,Test: total:32760.28711, BCE:-41.29857, KLD:32801.58984
Early stopping
[Training Finished]
All done !
