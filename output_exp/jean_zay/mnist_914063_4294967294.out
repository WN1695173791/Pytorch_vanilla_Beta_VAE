use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_4-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=30, bias=True)
    (13): BatchNorm1d(30, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU(inplace=True)
    (15): Linear(in_features=30, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
class 0: Average distance Hamming: tensor([14.9981])
class 1: Average distance Hamming: tensor([15.1036])
class 2: Average distance Hamming: tensor([14.9971])
class 3: Average distance Hamming: tensor([14.9977])
class 4: Average distance Hamming: tensor([14.9918])
class 5: Average distance Hamming: tensor([14.9970])
class 6: Average distance Hamming: tensor([14.9962])
class 7: Average distance Hamming: tensor([14.9900])
class 8: Average distance Hamming: tensor([14.9974])
class 9: Average distance Hamming: tensor([14.9881])
average distance: 15.005694389343262
save z_struct representation for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_4
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_4
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_4, shape: (10, 15)
save std z_struct representation for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_4, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 35.62151
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
__________------Hamming distance:------__________
class 0: Average distance Hamming: 14.998106956481934
class 1: Average distance Hamming: 15.103580474853516
class 2: Average distance Hamming: 14.997127532958984
class 3: Average distance Hamming: 14.99767017364502
class 4: Average distance Hamming: 14.991836547851562
class 5: Average distance Hamming: 14.996954917907715
class 6: Average distance Hamming: 14.996177673339844
class 7: Average distance Hamming: 14.990020751953125
class 8: Average distance Hamming: 14.997406005859375
class 9: Average distance Hamming: 14.988059997558594
average distance: 15.005694389343262
for class 0, we have 1 z_struct with code [0.07915162 0.5643235  0.3767479  0.00689365 0.5586252  0.37278068
 0.5470036  0.04959948 0.5056644  0.06159701 0.5819575  0.5611158
 0.54264474 0.47392878 0.4600112 ]. It represent 0.102% of total z_struct class
for class 1, we have 1 z_struct with code [0.08008239 0.5645621  0.37673005 0.00609474 0.55916244 0.37307498
 0.54724175 0.04928274 0.5061574  0.06163048 0.5828346  0.5615848
 0.542902   0.47417176 0.46016085]. It represent 0.088% of total z_struct class
for class 2, we have 1 z_struct with code [0.08087537 0.5646271  0.3767482  0.00691002 0.55914104 0.37309426
 0.54723877 0.04962587 0.5061617  0.06187862 0.58302784 0.56153023
 0.5429416  0.4742363  0.46027   ]. It represent 0.097% of total z_struct class
for class 3, we have 1 z_struct with code [0.08038978 0.56458175 0.37674284 0.00681814 0.55922836 0.37309557
 0.5472854  0.04952491 0.50616956 0.06189405 0.5828646  0.5615622
 0.5429092  0.4742269  0.46015602]. It represent 0.099% of total z_struct class
for class 4, we have 1 z_struct with code [0.08168029 0.5645506  0.37671173 0.00688716 0.55913746 0.37306145
 0.54723245 0.04955713 0.506159   0.06208348 0.5828008  0.56154805
 0.54290783 0.47415483 0.46013132]. It represent 0.102% of total z_struct class
for class 5, we have 1 z_struct with code [0.07212897 0.5646652  0.37677422 0.0066736  0.55923706 0.373089
 0.5473126  0.04952205 0.50615126 0.0599236  0.5828375  0.5615727
 0.54298353 0.4742456  0.46015927]. It represent 0.112% of total z_struct class
for class 6, we have 1 z_struct with code [0.07877664 0.564549   0.37674487 0.00641431 0.5591796  0.3730727
 0.5472652  0.04929354 0.50617355 0.06126964 0.5828449  0.5615395
 0.54294074 0.47417882 0.460149  ]. It represent 0.104% of total z_struct class
for class 7, we have 1 z_struct with code [0.08031309 0.56456554 0.37673116 0.00685765 0.55916995 0.3730928
 0.54729015 0.04956365 0.50615185 0.06185269 0.5828801  0.5615586
 0.54290324 0.47417834 0.46019182]. It represent 0.097% of total z_struct class
for class 8, we have 1 z_struct with code [0.08181485 0.56322044 0.376739   0.00691981 0.55563885 0.3724745
 0.54461336 0.04961456 0.5047219  0.06207266 0.5773512  0.55731905
 0.53985506 0.4735091  0.45745575]. It represent 0.103% of total z_struct class
for class 9, we have 1 z_struct with code [0.08055816 0.5645766  0.37673768 0.00691281 0.5591873  0.3730667
 0.54738545 0.04958414 0.5061862  0.06181597 0.58287585 0.5615623
 0.54290545 0.47418863 0.46013963]. It represent 0.099% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 10.09 %
figure saved for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_4
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP_L2_dst_1-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
class 0: Average distance Hamming: tensor([7.1933])
class 1: Average distance Hamming: tensor([6.2355])
class 2: Average distance Hamming: tensor([9.0799])
class 3: Average distance Hamming: tensor([10.0450])
class 4: Average distance Hamming: tensor([10.5266])
class 5: Average distance Hamming: tensor([8.6328])
class 6: Average distance Hamming: tensor([8.4962])
class 7: Average distance Hamming: tensor([6.7504])
class 8: Average distance Hamming: tensor([9.1328])
class 9: Average distance Hamming: tensor([7.5709])
average distance: 8.36631965637207
save z_struct representation for model mnist_binary_ES_15_BAGMP_L2_dst_1
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_binary_ES_15_BAGMP_L2_dst_1
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_binary_ES_15_BAGMP_L2_dst_1, shape: (10, 15)
save std z_struct representation for model mnist_binary_ES_15_BAGMP_L2_dst_1, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 0.54472816
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
__________------Hamming distance:------__________
class 0: Average distance Hamming: 7.193266868591309
class 1: Average distance Hamming: 6.2354583740234375
class 2: Average distance Hamming: 9.079900741577148
class 3: Average distance Hamming: 10.044958114624023
class 4: Average distance Hamming: 10.52656078338623
class 5: Average distance Hamming: 8.632790565490723
class 6: Average distance Hamming: 8.496203422546387
class 7: Average distance Hamming: 6.750419616699219
class 8: Average distance Hamming: 9.132776260375977
class 9: Average distance Hamming: 7.5708699226379395
average distance: 8.36631965637207
for class 0, we have 1 z_struct with code [0.         0.         0.         0.22074708 0.         0.691932
 0.         0.         0.57817864 0.         0.         0.
 0.         1.451205   0.        ]. It represent 0.102% of total z_struct class
for class 1, we have 1 z_struct with code [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.84712034 1.090118   0.        ]. It represent 0.088% of total z_struct class
for class 2, we have 1 z_struct with code [0.         0.03915609 1.8114548  0.09002054 0.         0.
 0.         0.         0.978237   0.         0.         0.
 0.         0.35060826 0.        ]. It represent 0.097% of total z_struct class
for class 3, we have 1 z_struct with code [0.         0.         0.         0.         0.         0.
 0.         0.         1.5666547  0.         0.5787802  1.1407462
 0.38245237 0.         0.        ]. It represent 0.099% of total z_struct class
for class 4, we have 1 z_struct with code [0.         0.         0.         0.         0.         0.
 0.33135417 0.14333479 1.302533   0.         0.97822076 0.00990109
 0.12960948 0.         0.        ]. It represent 0.102% of total z_struct class
for class 5, we have 1 z_struct with code [0.         0.         0.         0.         0.         0.17064819
 0.         0.         0.         1.0506145  1.4326605  0.
 1.0870882  0.         0.        ]. It represent 0.112% of total z_struct class
for class 6, we have 1 z_struct with code [0.         0.         0.         0.         0.         0.
 0.         0.35451385 0.         1.9046162  1.6546038  0.
 0.         1.1807481  0.        ]. It represent 0.104% of total z_struct class
for class 7, we have 1 z_struct with code [0.         0.         0.         0.         0.         0.
 0.00805674 0.35599053 0.6638248  0.         0.31579718 1.0173968
 1.1389885  1.202605   0.        ]. It represent 0.097% of total z_struct class
for class 8, we have 1 z_struct with code [0.         0.         0.         0.         0.06910098 0.36639643
 0.         0.32416508 0.48033768 0.3867536  0.55701494 0.
 0.         0.         0.8408014 ]. It represent 0.103% of total z_struct class
for class 9, we have 1 z_struct with code [0.         0.         0.         0.         0.         0.
 0.08241486 0.         0.54640025 0.         0.3381523  0.
 0.94260156 1.2923497  0.        ]. It represent 0.099% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 79.4 %
figure saved for model mnist_binary_ES_15_BAGMP_L2_dst_1
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP_L2_dst_2-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
class 0: Average distance Hamming: tensor([8.0640])
class 1: Average distance Hamming: tensor([7.8684])
class 2: Average distance Hamming: tensor([10.4250])
class 3: Average distance Hamming: tensor([10.7304])
class 4: Average distance Hamming: tensor([12.5409])
class 5: Average distance Hamming: tensor([10.0808])
class 6: Average distance Hamming: tensor([11.2665])
class 7: Average distance Hamming: tensor([9.2864])
class 8: Average distance Hamming: tensor([9.7663])
class 9: Average distance Hamming: tensor([9.2680])
average distance: 9.929662704467773
save z_struct representation for model mnist_binary_ES_15_BAGMP_L2_dst_2
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_binary_ES_15_BAGMP_L2_dst_2
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_binary_ES_15_BAGMP_L2_dst_2, shape: (10, 15)
save std z_struct representation for model mnist_binary_ES_15_BAGMP_L2_dst_2, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 0.4010371
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
__________------Hamming distance:------__________
class 0: Average distance Hamming: 8.063953399658203
class 1: Average distance Hamming: 7.8683881759643555
class 2: Average distance Hamming: 10.424956321716309
class 3: Average distance Hamming: 10.730440139770508
class 4: Average distance Hamming: 12.540914535522461
class 5: Average distance Hamming: 10.080822944641113
class 6: Average distance Hamming: 11.26646614074707
class 7: Average distance Hamming: 9.286352157592773
class 8: Average distance Hamming: 9.7662935256958
class 9: Average distance Hamming: 9.26803207397461
average distance: 9.929662704467773
for class 0, we have 1 z_struct with code [0.         0.21107878 0.         0.1157947  0.         0.8535315
 0.         0.3760752  0.82955265 0.69283706 0.         0.
 0.         1.2183608  0.        ]. It represent 0.102% of total z_struct class
for class 1, we have 1 z_struct with code [0.         0.         0.         0.6250376  0.         0.89378273
 0.         0.         0.11981973 0.         0.         0.
 0.7150492  0.9945288  0.03018647]. It represent 0.088% of total z_struct class
for class 2, we have 1 z_struct with code [0.         0.6754235  0.8554618  0.         0.599602   0.02052903
 0.33651915 0.         0.73693335 0.52639025 0.08943973 0.
 0.26146683 0.48027828 0.        ]. It represent 0.097% of total z_struct class
for class 3, we have 1 z_struct with code [0.         0.5092459  1.2535592  0.9215314  0.         0.
 0.         0.         0.42263332 0.9781722  1.4447057  0.6208308
 0.6727521  0.         0.        ]. It represent 0.099% of total z_struct class
for class 4, we have 1 z_struct with code [0.         0.02470461 1.0577122  0.9958619  0.         0.98098516
 0.6791224  0.96601456 0.8253757  0.         0.555513   0.
 0.8873588  0.95177764 0.18659061]. It represent 0.102% of total z_struct class
for class 5, we have 1 z_struct with code [0.         0.5815165  0.         0.4500045  0.         0.6904886
 0.8689729  0.         0.10568167 0.39334655 1.1385483  0.52939683
 1.1728684  0.         0.        ]. It represent 0.112% of total z_struct class
for class 6, we have 1 z_struct with code [0.         0.13120781 0.         1.3669086  2.4082973  0.0563156
 0.1992068  0.52316684 0.         0.         0.42744413 0.
 0.9218061  0.77532303 0.        ]. It represent 0.104% of total z_struct class
for class 7, we have 1 z_struct with code [0.         0.6627734  1.0325118  0.         0.         0.804133
 0.         0.         0.80995965 0.62347573 0.         0.6072055
 0.71911216 0.94709766 0.12059164]. It represent 0.097% of total z_struct class
for class 8, we have 1 z_struct with code [0.         0.24827313 0.08266655 0.32186067 2.3807495  0.9255997
 0.         1.5191251  1.301393   0.63684714 1.7535247  0.
 0.06204859 0.58002084 1.8801378 ]. It represent 0.103% of total z_struct class
for class 9, we have 1 z_struct with code [0.         0.48483002 0.9862039  0.         0.         0.86893433
 0.6948321  0.12879877 0.81768966 0.9205598  0.5728191  0.
 0.41091192 0.75181437 0.12489717]. It represent 0.099% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 79.59 %
figure saved for model mnist_binary_ES_15_BAGMP_L2_dst_2
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP_L2_dst_3-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
class 0: Average distance Hamming: tensor([8.5890])
class 1: Average distance Hamming: tensor([9.3472])
class 2: Average distance Hamming: tensor([10.5782])
class 3: Average distance Hamming: tensor([8.4342])
class 4: Average distance Hamming: tensor([11.6774])
class 5: Average distance Hamming: tensor([8.7087])
class 6: Average distance Hamming: tensor([10.9612])
class 7: Average distance Hamming: tensor([10.0449])
class 8: Average distance Hamming: tensor([10.2103])
class 9: Average distance Hamming: tensor([9.0529])
average distance: 9.760395050048828
save z_struct representation for model mnist_binary_ES_15_BAGMP_L2_dst_3
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_binary_ES_15_BAGMP_L2_dst_3
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_binary_ES_15_BAGMP_L2_dst_3, shape: (10, 15)
save std z_struct representation for model mnist_binary_ES_15_BAGMP_L2_dst_3, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 1.1645439
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
__________------Hamming distance:------__________
class 0: Average distance Hamming: 8.588985443115234
class 1: Average distance Hamming: 9.347192764282227
class 2: Average distance Hamming: 10.578179359436035
class 3: Average distance Hamming: 8.434160232543945
class 4: Average distance Hamming: 11.677441596984863
class 5: Average distance Hamming: 8.708708763122559
class 6: Average distance Hamming: 10.961195945739746
class 7: Average distance Hamming: 10.044949531555176
class 8: Average distance Hamming: 10.210285186767578
class 9: Average distance Hamming: 9.052851676940918
average distance: 9.760395050048828
for class 0, we have 1 z_struct with code [0.         1.0004437  0.         0.34580684 0.         1.0034516
 0.73181313 0.39698264 0.6890954  0.7490731  0.         0.
 0.         0.41498256 0.        ]. It represent 0.102% of total z_struct class
for class 1, we have 1 z_struct with code [0.         1.0005238  0.55174595 1.0035136  0.         1.0030065
 0.         0.96978384 0.9314735  0.7090806  0.         0.
 1.4289731  0.04251584 0.17486413]. It represent 0.088% of total z_struct class
for class 2, we have 1 z_struct with code [0.         1.0005485  0.         1.1461455  0.         1.0060359
 0.         0.         0.78915995 0.72277737 0.42191663 1.7180876
 0.         0.         0.        ]. It represent 0.097% of total z_struct class
for class 3, we have 1 z_struct with code [0.         1.0003917  0.         0.9459256  0.         0.998985
 0.         0.724874   0.89537865 0.7102393  0.7485357  1.2675424
 0.         0.         0.68190527]. It represent 0.099% of total z_struct class
for class 4, we have 1 z_struct with code [0.         1.0004827  0.5303553  0.5711764  0.         1.0045425
 1.2259253  0.8808191  0.9357307  0.6220141  0.9204664  0.
 0.82569414 0.21808247 0.        ]. It represent 0.102% of total z_struct class
for class 5, we have 1 z_struct with code [0.         1.0005118  0.         0.         0.         1.0062574
 1.0275459  0.         0.82510036 0.7595144  1.0225421  0.28023386
 0.         0.42331555 0.31524178]. It represent 0.112% of total z_struct class
for class 6, we have 1 z_struct with code [0.         1.0005053  0.70070153 0.643505   0.         1.0036732
 0.71625286 0.7965904  0.65607053 0.70499444 1.1126789  0.
 0.         0.03816431 0.        ]. It represent 0.104% of total z_struct class
for class 7, we have 1 z_struct with code [0.         1.0005374  0.         0.99607617 0.         1.006526
 0.         0.96730053 0.70740885 0.71701604 0.18996106 1.1351967
 0.         0.49159032 0.5321847 ]. It represent 0.097% of total z_struct class
for class 8, we have 1 z_struct with code [0.         1.0005094  0.         0.         0.826027   1.007054
 0.3224087  0.0880573  0.6918886  0.71847117 0.21478207 0.
 0.         0.19768108 0.        ]. It represent 0.103% of total z_struct class
for class 9, we have 1 z_struct with code [0.         1.0005667  0.         1.016275   0.         1.0066063
 0.5537388  0.9764626  0.7246532  0.8263481  1.0220418  0.12468392
 0.         0.12160562 0.        ]. It represent 0.099% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 89.68 %
figure saved for model mnist_binary_ES_15_BAGMP_L2_dst_3
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP_L2_dst_4-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
class 0: Average distance Hamming: tensor([8.9968])
class 1: Average distance Hamming: tensor([8.9750])
class 2: Average distance Hamming: tensor([8.9970])
class 3: Average distance Hamming: tensor([8.9976])
class 4: Average distance Hamming: tensor([8.9945])
class 5: Average distance Hamming: tensor([8.9965])
class 6: Average distance Hamming: tensor([8.9957])
class 7: Average distance Hamming: tensor([8.9924])
class 8: Average distance Hamming: tensor([8.9967])
class 9: Average distance Hamming: tensor([8.9918])
average distance: 8.993398666381836
save z_struct representation for model mnist_binary_ES_15_BAGMP_L2_dst_4
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_binary_ES_15_BAGMP_L2_dst_4
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_binary_ES_15_BAGMP_L2_dst_4, shape: (10, 15)
save std z_struct representation for model mnist_binary_ES_15_BAGMP_L2_dst_4, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 32.06284
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
__________------Hamming distance:------__________
class 0: Average distance Hamming: 8.996777534484863
class 1: Average distance Hamming: 8.974955558776855
class 2: Average distance Hamming: 8.997041702270508
class 3: Average distance Hamming: 8.997607231140137
class 4: Average distance Hamming: 8.994498252868652
class 5: Average distance Hamming: 8.996479034423828
class 6: Average distance Hamming: 8.995694160461426
class 7: Average distance Hamming: 8.992400169372559
class 8: Average distance Hamming: 8.996726989746094
class 9: Average distance Hamming: 8.991804122924805
average distance: 8.993398666381836
for class 0, we have 1 z_struct with code [0.24794422 1.032024   1.0110921  0.         0.         0.77621686
 0.         0.         0.8988568  0.6817679  0.         0.16393238
 0.         0.23154527 0.52168965]. It represent 0.102% of total z_struct class
for class 1, we have 1 z_struct with code [0.24485245 1.0320742  1.0104442  0.         0.         0.7762638
 0.         0.         0.8986126  0.68181646 0.         0.16393979
 0.         0.23155804 0.52172524]. It represent 0.088% of total z_struct class
for class 2, we have 1 z_struct with code [0.24785985 1.0320715  1.0113826  0.         0.         0.77622586
 0.         0.         0.89879924 0.68182695 0.         0.16396306
 0.         0.23154634 0.52170455]. It represent 0.097% of total z_struct class
for class 3, we have 1 z_struct with code [0.24653728 1.0321865  1.0119097  0.         0.         0.7762622
 0.         0.         0.8987932  0.6818488  0.         0.16394784
 0.         0.2315867  0.52178854]. It represent 0.099% of total z_struct class
for class 4, we have 1 z_struct with code [0.24767931 1.0320959  1.0130972  0.         0.         0.77622616
 0.         0.         0.898892   0.68180794 0.         0.16401842
 0.         0.23159578 0.52179784]. It represent 0.102% of total z_struct class
for class 5, we have 1 z_struct with code [0.24386795 1.0321156  1.0129021  0.         0.         0.77631766
 0.         0.         0.8987844  0.6818548  0.         0.16400152
 0.         0.23157215 0.5218278 ]. It represent 0.112% of total z_struct class
for class 6, we have 1 z_struct with code [0.2452354  1.0320652  1.0105     0.         0.         0.77630496
 0.         0.         0.89853954 0.68175286 0.         0.1638876
 0.         0.23150793 0.52166504]. It represent 0.104% of total z_struct class
for class 7, we have 1 z_struct with code [0.24758941 1.0321188  1.0129237  0.         0.         0.7762467
 0.         0.         0.89875543 0.68183625 0.         0.16394147
 0.         0.23154695 0.52188873]. It represent 0.097% of total z_struct class
for class 8, we have 1 z_struct with code [0.247418   1.0320376  1.0126423  0.         0.         0.77621615
 0.         0.         0.8987815  0.68179125 0.         0.16392398
 0.         0.23153073 0.5217115 ]. It represent 0.103% of total z_struct class
for class 9, we have 1 z_struct with code [0.24852939 1.0320967  1.0139612  0.         0.         0.77627164
 0.         0.         0.898877   0.68183285 0.         0.16394736
 0.         0.23155734 0.5217762 ]. It represent 0.099% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 9.8 %
figure saved for model mnist_binary_ES_15_BAGMP_L2_dst_4
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP_Hmg_dst_1-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
class 0: Average distance Hamming: tensor([8.9454])
class 1: Average distance Hamming: tensor([8.8297])
class 2: Average distance Hamming: tensor([9.8219])
class 3: Average distance Hamming: tensor([8.4452])
class 4: Average distance Hamming: tensor([12.3976])
class 5: Average distance Hamming: tensor([8.8921])
class 6: Average distance Hamming: tensor([9.6325])
class 7: Average distance Hamming: tensor([9.2643])
class 8: Average distance Hamming: tensor([9.3431])
class 9: Average distance Hamming: tensor([10.4649])
average distance: 9.603670120239258
save z_struct representation for model mnist_binary_ES_15_BAGMP_Hmg_dst_1
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_binary_ES_15_BAGMP_Hmg_dst_1
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_binary_ES_15_BAGMP_Hmg_dst_1, shape: (10, 15)
save std z_struct representation for model mnist_binary_ES_15_BAGMP_Hmg_dst_1, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 0.7218771
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
__________------Hamming distance:------__________
class 0: Average distance Hamming: 8.945440292358398
class 1: Average distance Hamming: 8.829667091369629
class 2: Average distance Hamming: 9.821917533874512
class 3: Average distance Hamming: 8.445169448852539
class 4: Average distance Hamming: 12.397578239440918
class 5: Average distance Hamming: 8.892114639282227
class 6: Average distance Hamming: 9.632489204406738
class 7: Average distance Hamming: 9.264347076416016
class 8: Average distance Hamming: 9.343097686767578
class 9: Average distance Hamming: 10.464871406555176
average distance: 9.603670120239258
for class 0, we have 1 z_struct with code [0.         0.         0.         0.         0.52118814 3.059645
 1.4061676  0.         0.         1.052515   1.2370174  0.
 0.         0.         0.        ]. It represent 0.102% of total z_struct class
for class 1, we have 1 z_struct with code [0.         0.         0.         0.         0.         3.6215496
 0.         0.         0.         0.         0.         0.
 0.         0.85634655 0.        ]. It represent 0.088% of total z_struct class
for class 2, we have 1 z_struct with code [0.         0.         1.7508986  0.01669203 0.509847   3.3719654
 0.         0.         0.         0.12797791 0.32298887 0.
 0.         0.         0.        ]. It represent 0.097% of total z_struct class
for class 3, we have 1 z_struct with code [0.         0.         0.06103233 0.0663329  0.         2.8661332
 0.         0.         0.         0.4901564  0.28084153 0.13489054
 1.4406894  0.         0.31054485]. It represent 0.099% of total z_struct class
for class 4, we have 1 z_struct with code [0.         0.         0.5267351  0.         0.15941371 3.3364055
 0.         0.65982777 1.0441219  0.3229917  0.64545393 0.
 1.4235858  0.55800384 0.4913968 ]. It represent 0.102% of total z_struct class
for class 5, we have 1 z_struct with code [0.        0.        0.        0.        0.        2.783628  0.
 0.        0.        1.2529248 1.3576143 1.3366449 1.5180026 0.
 0.       ]. It represent 0.112% of total z_struct class
for class 6, we have 1 z_struct with code [0.         0.         0.         0.         0.46663123 2.8982058
 0.14307883 1.3153778  0.         1.4674913  1.4198686  0.
 0.         1.1401031  0.        ]. It represent 0.104% of total z_struct class
for class 7, we have 1 z_struct with code [0.         0.         0.45526698 0.3933174  0.         2.4233956
 0.         0.22672237 0.         0.         0.         0.
 0.73208696 0.3843006  0.33262017]. It represent 0.097% of total z_struct class
for class 8, we have 1 z_struct with code [0.         0.         0.         0.         0.77491724 3.4690785
 0.         0.         0.09199157 0.7359497  0.         0.
 0.         0.01837699 0.        ]. It represent 0.103% of total z_struct class
for class 9, we have 1 z_struct with code [0.         0.         0.         0.         0.         2.537324
 0.9576583  0.         0.16473718 0.9887631  0.61339784 0.16411786
 0.6394267  0.         0.        ]. It represent 0.099% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 49.01 %
figure saved for model mnist_binary_ES_15_BAGMP_Hmg_dst_1
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP_Hmg_dst_2-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
class 0: Average distance Hamming: tensor([8.9454])
class 1: Average distance Hamming: tensor([8.8297])
class 2: Average distance Hamming: tensor([9.8219])
class 3: Average distance Hamming: tensor([8.4452])
class 4: Average distance Hamming: tensor([12.3976])
class 5: Average distance Hamming: tensor([8.8921])
class 6: Average distance Hamming: tensor([9.6325])
class 7: Average distance Hamming: tensor([9.2643])
class 8: Average distance Hamming: tensor([9.3431])
class 9: Average distance Hamming: tensor([10.4649])
average distance: 9.603670120239258
save z_struct representation for model mnist_binary_ES_15_BAGMP_Hmg_dst_2
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_binary_ES_15_BAGMP_Hmg_dst_2
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_binary_ES_15_BAGMP_Hmg_dst_2, shape: (10, 15)
save std z_struct representation for model mnist_binary_ES_15_BAGMP_Hmg_dst_2, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 0.7218771
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
__________------Hamming distance:------__________
class 0: Average distance Hamming: 8.945440292358398
class 1: Average distance Hamming: 8.829667091369629
class 2: Average distance Hamming: 9.821917533874512
class 3: Average distance Hamming: 8.445169448852539
class 4: Average distance Hamming: 12.397578239440918
class 5: Average distance Hamming: 8.892114639282227
class 6: Average distance Hamming: 9.632489204406738
class 7: Average distance Hamming: 9.264347076416016
class 8: Average distance Hamming: 9.343097686767578
class 9: Average distance Hamming: 10.464871406555176
average distance: 9.603670120239258
for class 0, we have 1 z_struct with code [0.         0.         0.         0.         0.52118814 3.059645
 1.4061676  0.         0.         1.052515   1.2370174  0.
 0.         0.         0.        ]. It represent 0.102% of total z_struct class
for class 1, we have 1 z_struct with code [0.         0.         0.         0.         0.         3.6215496
 0.         0.         0.         0.         0.         0.
 0.         0.85634655 0.        ]. It represent 0.088% of total z_struct class
for class 2, we have 1 z_struct with code [0.         0.         1.7508986  0.01669203 0.509847   3.3719654
 0.         0.         0.         0.12797791 0.32298887 0.
 0.         0.         0.        ]. It represent 0.097% of total z_struct class
for class 3, we have 1 z_struct with code [0.         0.         0.06103233 0.0663329  0.         2.8661332
 0.         0.         0.         0.4901564  0.28084153 0.13489054
 1.4406894  0.         0.31054485]. It represent 0.099% of total z_struct class
for class 4, we have 1 z_struct with code [0.         0.         0.5267351  0.         0.15941371 3.3364055
 0.         0.65982777 1.0441219  0.3229917  0.64545393 0.
 1.4235858  0.55800384 0.4913968 ]. It represent 0.102% of total z_struct class
for class 5, we have 1 z_struct with code [0.        0.        0.        0.        0.        2.783628  0.
 0.        0.        1.2529248 1.3576143 1.3366449 1.5180026 0.
 0.       ]. It represent 0.112% of total z_struct class
for class 6, we have 1 z_struct with code [0.         0.         0.         0.         0.46663123 2.8982058
 0.14307883 1.3153778  0.         1.4674913  1.4198686  0.
 0.         1.1401031  0.        ]. It represent 0.104% of total z_struct class
for class 7, we have 1 z_struct with code [0.         0.         0.45526698 0.3933174  0.         2.4233956
 0.         0.22672237 0.         0.         0.         0.
 0.73208696 0.3843006  0.33262017]. It represent 0.097% of total z_struct class
for class 8, we have 1 z_struct with code [0.         0.         0.         0.         0.77491724 3.4690785
 0.         0.         0.09199157 0.7359497  0.         0.
 0.         0.01837699 0.        ]. It represent 0.103% of total z_struct class
for class 9, we have 1 z_struct with code [0.         0.         0.         0.         0.         2.537324
 0.9576583  0.         0.16473718 0.9887631  0.61339784 0.16411786
 0.6394267  0.         0.        ]. It represent 0.099% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 49.01 %
figure saved for model mnist_binary_ES_15_BAGMP_Hmg_dst_2
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP_Hmg_dst_3-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
class 0: Average distance Hamming: tensor([9.3161])
class 1: Average distance Hamming: tensor([9.0417])
class 2: Average distance Hamming: tensor([9.8142])
class 3: Average distance Hamming: tensor([8.6171])
class 4: Average distance Hamming: tensor([12.5089])
class 5: Average distance Hamming: tensor([9.1388])
class 6: Average distance Hamming: tensor([9.7617])
class 7: Average distance Hamming: tensor([9.5118])
class 8: Average distance Hamming: tensor([9.5724])
class 9: Average distance Hamming: tensor([10.6291])
average distance: 9.791170120239258
save z_struct representation for model mnist_binary_ES_15_BAGMP_Hmg_dst_3
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_binary_ES_15_BAGMP_Hmg_dst_3
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_binary_ES_15_BAGMP_Hmg_dst_3, shape: (10, 15)
save std z_struct representation for model mnist_binary_ES_15_BAGMP_Hmg_dst_3, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 0.6753371
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
__________------Hamming distance:------__________
class 0: Average distance Hamming: 9.316134452819824
class 1: Average distance Hamming: 9.041661262512207
class 2: Average distance Hamming: 9.814231872558594
class 3: Average distance Hamming: 8.617070198059082
class 4: Average distance Hamming: 12.508864402770996
class 5: Average distance Hamming: 9.138816833496094
class 6: Average distance Hamming: 9.761727333068848
class 7: Average distance Hamming: 9.511778831481934
class 8: Average distance Hamming: 9.57235336303711
class 9: Average distance Hamming: 10.629060745239258
average distance: 9.791170120239258
for class 0, we have 1 z_struct with code [0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00 1.7241450e-01
 2.5503643e+00 0.0000000e+00 5.0557405e-01 5.9072405e-01 0.0000000e+00
 0.0000000e+00 0.0000000e+00 0.0000000e+00 1.3920368e-03 0.0000000e+00]. It represent 0.102% of total z_struct class
for class 1, we have 1 z_struct with code [0.         0.         0.         0.         0.         2.5107982
 0.         0.7013174  0.         0.         0.         0.
 1.0046058  1.0618778  0.78906536]. It represent 0.088% of total z_struct class
for class 2, we have 1 z_struct with code [0.         0.4089579  1.8681372  0.1140952  0.14976485 3.1909254
 0.36730552 0.         0.         0.         0.26876688 0.
 0.         0.         0.        ]. It represent 0.097% of total z_struct class
for class 3, we have 1 z_struct with code [0.         0.         0.         1.2026083  0.         2.4773378
 0.         0.         0.         1.2373236  0.24735196 0.7073097
 1.4427924  0.         0.        ]. It represent 0.099% of total z_struct class
for class 4, we have 1 z_struct with code [0.         0.         0.         0.         0.44864693 3.1319482
 0.29870304 0.         1.2916034  0.6272088  0.72756445 0.
 0.74661916 0.18793322 0.33576787]. It represent 0.102% of total z_struct class
for class 5, we have 1 z_struct with code [0.         0.         0.         0.         0.         2.719387
 1.6521871  0.         0.         1.0990599  0.20296836 1.1783214
 1.0287502  0.         0.        ]. It represent 0.112% of total z_struct class
for class 6, we have 1 z_struct with code [0.         0.         0.         0.         0.11505228 3.250911
 1.3242259  0.67795247 0.         1.0816704  0.8203451  0.
 0.         1.0884532  0.        ]. It represent 0.104% of total z_struct class
for class 7, we have 1 z_struct with code [0.         0.         0.4733473  0.54289854 0.         2.4082224
 0.         0.57264984 0.         0.         0.         0.
 0.7138798  0.5877478  0.17667939]. It represent 0.097% of total z_struct class
for class 8, we have 1 z_struct with code [0.         0.         0.         0.         1.4359939  3.316641
 0.15886742 0.         0.42064995 1.7871228  0.16673619 0.
 0.         0.         0.86583865]. It represent 0.103% of total z_struct class
for class 9, we have 1 z_struct with code [0.         0.         0.         0.         0.01203499 2.4780183
 1.4185776  0.23436442 0.285535   1.3285954  0.7669332  0.12056939
 0.69028914 0.         0.        ]. It represent 0.099% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 70.1 %
figure saved for model mnist_binary_ES_15_BAGMP_Hmg_dst_3
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP_Hmg_dst_4-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
class 0: Average distance Hamming: tensor([8.9454])
class 1: Average distance Hamming: tensor([8.8297])
class 2: Average distance Hamming: tensor([9.8219])
class 3: Average distance Hamming: tensor([8.4452])
class 4: Average distance Hamming: tensor([12.3976])
class 5: Average distance Hamming: tensor([8.8921])
class 6: Average distance Hamming: tensor([9.6325])
class 7: Average distance Hamming: tensor([9.2643])
class 8: Average distance Hamming: tensor([9.3431])
class 9: Average distance Hamming: tensor([10.4649])
average distance: 9.603670120239258
save z_struct representation for model mnist_binary_ES_15_BAGMP_Hmg_dst_4
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_binary_ES_15_BAGMP_Hmg_dst_4
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_binary_ES_15_BAGMP_Hmg_dst_4, shape: (10, 15)
save std z_struct representation for model mnist_binary_ES_15_BAGMP_Hmg_dst_4, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 0.7218771
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
__________------Hamming distance:------__________
class 0: Average distance Hamming: 8.945440292358398
class 1: Average distance Hamming: 8.829667091369629
class 2: Average distance Hamming: 9.821917533874512
class 3: Average distance Hamming: 8.445169448852539
class 4: Average distance Hamming: 12.397578239440918
class 5: Average distance Hamming: 8.892114639282227
class 6: Average distance Hamming: 9.632489204406738
class 7: Average distance Hamming: 9.264347076416016
class 8: Average distance Hamming: 9.343097686767578
class 9: Average distance Hamming: 10.464871406555176
average distance: 9.603670120239258
for class 0, we have 1 z_struct with code [0.         0.         0.         0.         0.52118814 3.059645
 1.4061676  0.         0.         1.052515   1.2370174  0.
 0.         0.         0.        ]. It represent 0.102% of total z_struct class
for class 1, we have 1 z_struct with code [0.         0.         0.         0.         0.         3.6215496
 0.         0.         0.         0.         0.         0.
 0.         0.85634655 0.        ]. It represent 0.088% of total z_struct class
for class 2, we have 1 z_struct with code [0.         0.         1.7508986  0.01669203 0.509847   3.3719654
 0.         0.         0.         0.12797791 0.32298887 0.
 0.         0.         0.        ]. It represent 0.097% of total z_struct class
for class 3, we have 1 z_struct with code [0.         0.         0.06103233 0.0663329  0.         2.8661332
 0.         0.         0.         0.4901564  0.28084153 0.13489054
 1.4406894  0.         0.31054485]. It represent 0.099% of total z_struct class
for class 4, we have 1 z_struct with code [0.         0.         0.5267351  0.         0.15941371 3.3364055
 0.         0.65982777 1.0441219  0.3229917  0.64545393 0.
 1.4235858  0.55800384 0.4913968 ]. It represent 0.102% of total z_struct class
for class 5, we have 1 z_struct with code [0.        0.        0.        0.        0.        2.783628  0.
 0.        0.        1.2529248 1.3576143 1.3366449 1.5180026 0.
 0.       ]. It represent 0.112% of total z_struct class
for class 6, we have 1 z_struct with code [0.         0.         0.         0.         0.46663123 2.8982058
 0.14307883 1.3153778  0.         1.4674913  1.4198686  0.
 0.         1.1401031  0.        ]. It represent 0.104% of total z_struct class
for class 7, we have 1 z_struct with code [0.         0.         0.45526698 0.3933174  0.         2.4233956
 0.         0.22672237 0.         0.         0.         0.
 0.73208696 0.3843006  0.33262017]. It represent 0.097% of total z_struct class
for class 8, we have 1 z_struct with code [0.         0.         0.         0.         0.77491724 3.4690785
 0.         0.         0.09199157 0.7359497  0.         0.
 0.         0.01837699 0.        ]. It represent 0.103% of total z_struct class
for class 9, we have 1 z_struct with code [0.         0.         0.         0.         0.         2.537324
 0.9576583  0.         0.16473718 0.9887631  0.61339784 0.16411786
 0.6394267  0.         0.        ]. It represent 0.099% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 49.01 %
figure saved for model mnist_binary_ES_15_BAGMP_Hmg_dst_4
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP_Hmg_dst_5-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
class 0: Average distance Hamming: tensor([8.9454])
class 1: Average distance Hamming: tensor([8.8297])
class 2: Average distance Hamming: tensor([9.8219])
class 3: Average distance Hamming: tensor([8.4452])
class 4: Average distance Hamming: tensor([12.3976])
class 5: Average distance Hamming: tensor([8.8921])
