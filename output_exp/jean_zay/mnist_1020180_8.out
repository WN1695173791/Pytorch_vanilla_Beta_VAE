8
--gpu_devices 0 --max_iter 100 --batch_size 250 --use_scheduler True --lr 1e-3 --GMP True --z_struct_size 15 --z_var_size 10 --is_VAE True --is_encoder_struct False --lambda_BCE 1 --beta 1 --lambda_recons 10 --lambda_EV_class 1 --big_kernel_size 8 --two_conv_layer True --three_conv_layer True --kernel_size_1 4 --kernel_size_2 4 --kernel_size_3 4 --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 64 --hidden_filters_layer2 64 --hidden_filters_layer3 64 --dataset_balanced True --binary_z True --binary_first_conv False --binary_second_conv False --binary_third_conv True --use_small_lr_encoder_var False --encoder_var_name None --encoder_struct_name mnist_ES_binary_15 --freeze_Encoder True --EV_classifier True --freeze_Encoder True --grad_inv True --exp_name mnist_VAE_s15_v10_class_inv_grad_6
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, ES_reconstruction=False, EV_classifier=True, GMP=True, Hmg_dst_loss=False, IPC=False, L1_norm_act=False, L1_norm_weights=False, L2_dst_loss=False, L3_without_random=False, LOG_DIR='logs', PT_model=False, PT_model_EV_classifier=False, adapt_lr=False, add_classification_layer=True, add_dl_class=False, add_linear_after_GMP=True, add_z_struct_bottleneck=False, alpha=32, batch_size=250, beta=1.0, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=8, bin_after_GMP=False, binary_chain=False, binary_first_conv=False, binary_second_conv=False, binary_third_conv=True, binary_z=True, both_decoders_freeze=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, contrastive_loss=False, cuda=True, dataset='mnist', dataset_balanced=True, decoder_first_dense=36, decoder_kernel_size_1=4, decoder_kernel_size_2=3, decoder_kernel_size_3=4, decoder_n_filter_1=64, decoder_n_filter_2=64, decoder_n_filter_3=64, decoder_stride_1=2, decoder_stride_2=2, decoder_stride_3=1, diff_var=False, display_step=10000, dset_dir='data', encoder_struct_name='mnist_ES_binary_15', encoder_var_name='None', exp_name='mnist_VAE_s15_v10_class_inv_grad_6', freeze_Encoder=True, gamma=1000, gpu_devices=[0], grad_inv=True, hidden_dim=20, hidden_filters_layer1=64, hidden_filters_layer2=64, hidden_filters_layer3=64, image_size=64, intra_class_variance_loss=False, is_C=True, is_E1=False, is_VAE=True, is_VAE_var=False, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=False, is_default_model=False, is_encoder_struct=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, kernel_size_1=4, kernel_size_2=4, kernel_size_3=4, lambda_BCE=1.0, lambda_EV_class=1.0, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_L2_dst=1, lambda_VAE=1, lambda_class=1, lambda_contrastive_loss=1, lambda_distance_mean=1, lambda_hmg_dst=1, lambda_intra_class_var=1, lambda_partial_class=1, lambda_ratio_reg=1, lambda_recon_wt_rand=1, lambda_recons=10.0, lambda_uniq_code_dst=1, lambda_var_distance=1, lambda_var_inter=1, lambda_var_intra=1, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', loss='Proxy_Anchor', loss_distance_mean=False, loss_min_distance_cl=False, lr=0.001, max_epoch_use_uniq_code_target=5, max_iter=100.0, model='CNN', mrg=0.1, nb_epochs_train_only_zvar=0, num_workers=2, old_weighted=False, optimizer='adamw', other_architecture=False, other_ratio=False, random_percentage=0.2, random_seed=10, randomness=True, ratio_reg=False, remark='', save_step=10000, second_layer_C=False, seed=1, stride_size=1, sz_embedding=5, three_conv_layer=True, train=True, train_var_struct_alternatively=False, two_conv_layer=True, two_encoder=False, uniq_code_dst_loss=False, use_VAE=False, use_decoder=False, use_early_stopping=True, use_scheduler=True, use_small_lr_encoder_var=False, use_structural_encoder=False, value_target_distance_mean=1, var_hidden_dim=256, var_hidden_filters_1=32, var_hidden_filters_2=32, var_hidden_filters_3=32, var_kernel_size_1=3, var_kernel_size_2=3, var_kernel_size_3=3, var_second_cnn_block=True, var_stride_size_1=1, var_stride_size_2=1, var_stride_size_3=1, var_third_cnn_block=False, var_three_conv_layer=False, warm=1, without_acc=False, z_struct_size=15, z_var_size=10, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
[Using Seed: 10]
Balanced dataset loaded
VAE doesn't exist but encoder struct yes ! load struct encoder weighs !
=> loaded checkpoint 'checkpoints_CNN/mnist_ES_binary_15/last (iter 22410)'
Weighs loaded for struct encoder !
use 1 gpu who named: Tesla V100-SXM2-32GB
VAE(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
  )
  (decoder): Sequential(
    (0): Linear(in_features=25, out_features=1600, bias=True)
    (1): ReLU(inplace=True)
    (2): View()
    (3): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (4): ReLU(inplace=True)
    (5): ConvTranspose2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (6): ReLU(inplace=True)
    (7): ConvTranspose2d(64, 32, kernel_size=(3, 3), stride=(1, 1))
    (8): ReLU(inplace=True)
    (9): ConvTranspose2d(32, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (10): ReLU(inplace=True)
    (11): ConvTranspose2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (12): ReLU(inplace=True)
    (13): ConvTranspose2d(32, 1, kernel_size=(3, 3), stride=(1, 1))
    (14): Sigmoid()
  )
  (encoder_var): Sequential(
    (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (4): ReLU(inplace=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Conv2d(32, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (7): ReLU(inplace=True)
    (8): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): Dropout(p=0.4, inplace=False)
    (10): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
    (11): ReLU(inplace=True)
    (12): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (13): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (14): ReLU(inplace=True)
    (15): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Conv2d(64, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (17): ReLU(inplace=True)
    (18): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (19): Dropout(p=0.4, inplace=False)
    (20): View()
    (21): Linear(in_features=1600, out_features=20, bias=True)
  )
  (var_classifier): Sequential(
    (0): RevGrad()
    (1): Linear(in_features=10, out_features=10, bias=True)
  )
)
The number of parameters of model is 499760
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 270, epoch 1.0)
score:  38.315
score:  35.84
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 270, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train: total:5115.70654, BCE:-16.35792, KLD:5132.06494,Test: total:20517.49805, BCE:-16.42541, KLD:20533.92188
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 540, epoch 2.0)
score:  50.37166666666667
score:  46.28
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 540, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train: total:4824.28662, BCE:-19.27091, KLD:4843.55908,Test: total:19315.86719, BCE:-19.32751, KLD:19335.19336
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 810, epoch 3.0)
score:  63.373333333333335
score:  58.09
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 810, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train: total:4868.79492, BCE:-13.22782, KLD:4882.02393,Test: total:19465.34375, BCE:-13.26481, KLD:19478.60742
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 1080, epoch 4.0)
score:  69.0
score:  62.48
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 1080, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train: total:4930.08887, BCE:-14.85169, KLD:4944.94043,Test: total:19692.18945, BCE:-14.88411, KLD:19707.07031
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 1350, epoch 5.0)
score:  72.655
score:  65.67
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 1350, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train: total:5020.36719, BCE:-14.89941, KLD:5035.26221,Test: total:20015.95508, BCE:-14.96124, KLD:20030.91992
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 1620, epoch 6.0)
score:  75.36666666666666
score:  68.46
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 1620, epoch 6.0)
[Save Checkpoint] epoch: [6.0], Train: total:5060.60986, BCE:-15.05856, KLD:5075.66602,Test: total:20187.48047, BCE:-15.10944, KLD:20202.58789
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 1890, epoch 7.0)
score:  76.44333333333333
score:  69.74
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 1890, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train: total:4935.75293, BCE:-14.89737, KLD:4950.64844,Test: total:19679.94141, BCE:-14.97758, KLD:19694.91992
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 2160, epoch 8.0)
score:  77.665
score:  70.65
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 2160, epoch 8.0)
[Save Checkpoint] epoch: [8.0], Train: total:5088.49854, BCE:-15.46642, KLD:5103.96729,Test: total:20289.59766, BCE:-15.56944, KLD:20305.16602
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 2430, epoch 9.0)
score:  78.18166666666667
score:  71.5
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 2430, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train: total:5096.79736, BCE:-15.56797, KLD:5112.36768,Test: total:20334.03711, BCE:-15.71820, KLD:20349.75781
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 2700, epoch 10.0)
score:  78.79666666666667
score:  71.54
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 2700, epoch 10.0)
[Save Checkpoint] epoch: [10.0], Train: total:5065.48877, BCE:-15.99018, KLD:5081.47803,Test: total:20204.11328, BCE:-16.14802, KLD:20220.26172
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 2970, epoch 11.0)
score:  78.87166666666667
score:  71.37
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 2970, epoch 11.0)
[Save Checkpoint] epoch: [11.0], Train: total:5033.92334, BCE:-15.66537, KLD:5049.58643,Test: total:20072.02930, BCE:-15.83875, KLD:20087.86914
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 3240, epoch 12.0)
score:  79.2
score:  71.8
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 3240, epoch 12.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [12.0], Train: total:5077.49658, BCE:-14.48345, KLD:5091.97900,Test: total:20226.52539, BCE:-14.68549, KLD:20241.20898
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 3510, epoch 13.0)
score:  79.25333333333333
score:  71.65
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 3510, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train: total:5047.62598, BCE:-14.86070, KLD:5062.48486,Test: total:20080.89648, BCE:-15.05779, KLD:20095.95703
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 3780, epoch 14.0)
score:  78.79833333333333
score:  71.31
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 3780, epoch 14.0)
[Save Checkpoint] epoch: [14.0], Train: total:5027.06738, BCE:-15.30612, KLD:5042.37256,Test: total:20029.14258, BCE:-15.52253, KLD:20044.66602
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 4050, epoch 15.0)
score:  79.08333333333333
score:  71.58
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 4050, epoch 15.0)
[Save Checkpoint] epoch: [15.0], Train: total:5080.94092, BCE:-15.66669, KLD:5096.60742,Test: total:20220.50586, BCE:-15.90530, KLD:20236.40625
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 4320, epoch 16.0)
score:  78.98666666666666
score:  71.26
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 4320, epoch 16.0)
[Save Checkpoint] epoch: [16.0], Train: total:5078.41113, BCE:-16.51291, KLD:5094.92725,Test: total:20204.80664, BCE:-16.79638, KLD:20221.60742
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 4590, epoch 17.0)
score:  78.57
score:  71.45
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 4590, epoch 17.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [17.0], Train: total:5046.15869, BCE:-16.31110, KLD:5062.47314,Test: total:20071.38281, BCE:-16.58432, KLD:20087.96875
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 4860, epoch 18.0)
score:  78.785
score:  71.26
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 4860, epoch 18.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [18.0], Train: total:5064.63232, BCE:-16.28332, KLD:5080.91992,Test: total:20171.37500, BCE:-16.59787, KLD:20187.97461
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 5130, epoch 19.0)
score:  78.57166666666667
score:  71.17
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 5130, epoch 19.0)
[Save Checkpoint] epoch: [19.0], Train: total:5036.78418, BCE:-16.61765, KLD:5053.40186,Test: total:20049.03906, BCE:-16.93532, KLD:20065.97461
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 5400, epoch 20.0)
score:  78.28
score:  70.95
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 5400, epoch 20.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [20.0], Train: total:4995.14062, BCE:-17.17565, KLD:5012.31348,Test: total:19896.59766, BCE:-17.47638, KLD:19914.07227
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 5670, epoch 21.0)
score:  78.38666666666667
score:  70.93
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 5670, epoch 21.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [21.0], Train: total:5108.16699, BCE:-17.96304, KLD:5126.12891,Test: total:20342.17773, BCE:-18.26808, KLD:20360.44531
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 5940, epoch 22.0)
score:  77.77
score:  70.08
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 5940, epoch 22.0)
[Save Checkpoint] epoch: [22.0], Train: total:5049.84961, BCE:-17.94861, KLD:5067.80078,Test: total:20100.77539, BCE:-18.26489, KLD:20119.04102
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 6210, epoch 23.0)
score:  77.795
score:  70.31
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 6210, epoch 23.0)
[Save Checkpoint] epoch: [23.0], Train: total:5005.00635, BCE:-18.71029, KLD:5023.71582,Test: total:19935.98828, BCE:-19.02468, KLD:19955.01172
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 6480, epoch 24.0)
score:  77.86
score:  70.29
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 6480, epoch 24.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [24.0], Train: total:5016.87695, BCE:-19.42426, KLD:5036.30176,Test: total:19973.61719, BCE:-19.72304, KLD:19993.34180
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 6750, epoch 25.0)
score:  77.48833333333333
score:  69.91
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 6750, epoch 25.0)
[Save Checkpoint] epoch: [25.0], Train: total:5074.11621, BCE:-19.61762, KLD:5093.73486,Test: total:20200.29492, BCE:-19.90826, KLD:20220.20117
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 7020, epoch 26.0)
score:  77.42666666666666
score:  69.81
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 7020, epoch 26.0)
[Save Checkpoint] epoch: [26.0], Train: total:5010.68115, BCE:-20.24747, KLD:5030.92871,Test: total:19942.81055, BCE:-20.54114, KLD:19963.35352
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 7290, epoch 27.0)
score:  77.175
score:  69.69
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 7290, epoch 27.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [27.0], Train: total:5016.88721, BCE:-20.75061, KLD:5037.63916,Test: total:19964.79492, BCE:-21.01993, KLD:19985.81250
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 7560, epoch 28.0)
score:  77.06
score:  69.61
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 7560, epoch 28.0)
[Save Checkpoint] epoch: [28.0], Train: total:5000.47363, BCE:-20.83609, KLD:5021.30859,Test: total:19899.08789, BCE:-21.12164, KLD:19920.20898
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 7830, epoch 29.0)
score:  76.60666666666667
score:  69.4
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 7830, epoch 29.0)
[Save Checkpoint] epoch: [29.0], Train: total:5000.91260, BCE:-20.92838, KLD:5021.84131,Test: total:19890.27930, BCE:-21.20177, KLD:19911.47852
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 8100, epoch 30.0)
score:  76.27666666666667
score:  69.12
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 8100, epoch 30.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [30.0], Train: total:5003.29102, BCE:-21.42343, KLD:5024.71680,Test: total:19918.60742, BCE:-21.68853, KLD:19940.29492
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 8370, epoch 31.0)
score:  76.06833333333333
score:  68.91
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 8370, epoch 31.0)
[Save Checkpoint] epoch: [31.0], Train: total:4977.29443, BCE:-21.90726, KLD:4999.20166,Test: total:19801.55469, BCE:-22.15344, KLD:19823.71094
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 8640, epoch 32.0)
score:  76.22166666666666
score:  68.94
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 8640, epoch 32.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [32.0], Train: total:4917.84668, BCE:-22.07687, KLD:4939.92334,Test: total:19562.70898, BCE:-22.32219, KLD:19585.03320
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 8910, epoch 33.0)
score:  75.66
score:  68.46
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 8910, epoch 33.0)
[Save Checkpoint] epoch: [33.0], Train: total:5005.56543, BCE:-22.06605, KLD:5027.63232,Test: total:19909.16602, BCE:-22.29451, KLD:19931.45898
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 9180, epoch 34.0)
score:  75.89333333333333
score:  68.38
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 9180, epoch 34.0)
[Save Checkpoint] epoch: [34.0], Train: total:4959.23145, BCE:-22.17440, KLD:4981.40625,Test: total:19741.27930, BCE:-22.39288, KLD:19763.67188
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 9450, epoch 35.0)
score:  75.68
score:  68.04
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 9450, epoch 35.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [35.0], Train: total:4980.90771, BCE:-22.01047, KLD:5002.91748,Test: total:19809.47461, BCE:-22.24067, KLD:19831.71484
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 9720, epoch 36.0)
score:  75.30666666666667
score:  68.09
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 9720, epoch 36.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [36.0], Train: total:4969.81592, BCE:-22.46151, KLD:4992.27588,Test: total:19775.11523, BCE:-22.67908, KLD:19797.79492
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 9990, epoch 37.0)
score:  75.405
score:  68.37
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 9990, epoch 37.0)
[Save Checkpoint] epoch: [37.0], Train: total:4968.97412, BCE:-22.53241, KLD:4991.50342,Test: total:19764.23242, BCE:-22.73297, KLD:19786.96484
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 10260, epoch 38.0)
score:  74.53333333333333
score:  67.28
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 10260, epoch 38.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [38.0], Train: total:4917.56152, BCE:-22.40306, KLD:4939.96533,Test: total:19550.14844, BCE:-22.59753, KLD:19572.74609
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 10530, epoch 39.0)
score:  75.04166666666667
score:  68.04
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 10530, epoch 39.0)
[Save Checkpoint] epoch: [39.0], Train: total:4941.74365, BCE:-22.77566, KLD:4964.52246,Test: total:19642.31836, BCE:-22.96836, KLD:19665.28711
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 10800, epoch 40.0)
score:  75.34
score:  67.8
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 10800, epoch 40.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [40.0], Train: total:4986.54639, BCE:-22.90481, KLD:5009.45215,Test: total:19831.42578, BCE:-23.08714, KLD:19854.51172
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 11070, epoch 41.0)
score:  75.20666666666666
score:  67.75
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 11070, epoch 41.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [41.0], Train: total:5014.23145, BCE:-23.02032, KLD:5037.25146,Test: total:19929.63281, BCE:-23.17697, KLD:19952.81055
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 11340, epoch 42.0)
score:  74.52166666666666
score:  67.31
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 11340, epoch 42.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [42.0], Train: total:4945.39160, BCE:-22.75182, KLD:4968.14404,Test: total:19660.41016, BCE:-22.93017, KLD:19683.34180
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 11610, epoch 43.0)
score:  74.64
score:  67.49
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 11610, epoch 43.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [43.0], Train: total:5023.02930, BCE:-22.86379, KLD:5045.89502,Test: total:19973.06641, BCE:-23.04631, KLD:19996.11328
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 11880, epoch 44.0)
score:  73.65833333333333
score:  66.61
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 11880, epoch 44.0)
[Save Checkpoint] epoch: [44.0], Train: total:4928.81348, BCE:-23.06604, KLD:4951.87891,Test: total:19604.16211, BCE:-23.22647, KLD:19627.38672
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 12150, epoch 45.0)
score:  73.81833333333333
score:  66.41
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 12150, epoch 45.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [45.0], Train: total:4929.60986, BCE:-23.07938, KLD:4952.68945,Test: total:19598.14453, BCE:-23.24286, KLD:19621.38867
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 12420, epoch 46.0)
score:  74.07666666666667
score:  66.47
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 12420, epoch 46.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [46.0], Train: total:4931.12354, BCE:-23.19375, KLD:4954.31689,Test: total:19595.35156, BCE:-23.35654, KLD:19618.70898
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 12690, epoch 47.0)
score:  73.31166666666667
score:  66.16
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 12690, epoch 47.0)
[Save Checkpoint] epoch: [47.0], Train: total:4934.63623, BCE:-23.19822, KLD:4957.83252,Test: total:19619.23828, BCE:-23.36353, KLD:19642.59961
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 12960, epoch 48.0)
score:  73.235
score:  66.16
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 12960, epoch 48.0)
[Save Checkpoint] epoch: [48.0], Train: total:4894.14844, BCE:-23.39905, KLD:4917.54688,Test: total:19452.05469, BCE:-23.55145, KLD:19475.60742
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 13230, epoch 49.0)
score:  73.68
score:  66.26
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 13230, epoch 49.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [49.0], Train: total:4929.97559, BCE:-23.32216, KLD:4953.29736,Test: total:19597.28711, BCE:-23.47898, KLD:19620.76953
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 13500, epoch 50.0)
score:  73.14166666666667
score:  66.02
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 13500, epoch 50.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [50.0], Train: total:4941.81299, BCE:-23.64764, KLD:4965.46289,Test: total:19647.25391, BCE:-23.80734, KLD:19671.06055
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 13770, epoch 51.0)
score:  73.31833333333333
score:  66.36
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 13770, epoch 51.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [51.0], Train: total:4916.50439, BCE:-23.65327, KLD:4940.15430,Test: total:19533.05273, BCE:-23.81816, KLD:19556.87305
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 14040, epoch 52.0)
score:  72.885
score:  65.92
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 14040, epoch 52.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [52.0], Train: total:4851.19141, BCE:-24.02912, KLD:4875.21777,Test: total:19280.62305, BCE:-24.14721, KLD:19304.77148
Epoch    53: reducing learning rate of group 0 to 2.0000e-04.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 14310, epoch 53.0)
score:  72.22833333333334
score:  65.34
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 14310, epoch 53.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [53.0], Train: total:4842.16553, BCE:-23.82428, KLD:4865.99268,Test: total:19253.30078, BCE:-23.93389, KLD:19277.23242
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 14580, epoch 54.0)
score:  72.42666666666666
score:  65.3
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 14580, epoch 54.0)
[Save Checkpoint] epoch: [54.0], Train: total:4903.69482, BCE:-23.56837, KLD:4927.26172,Test: total:19487.80859, BCE:-23.70797, KLD:19511.51758
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 14850, epoch 55.0)
score:  72.49
score:  65.43
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 14850, epoch 55.0)
[Save Checkpoint] epoch: [55.0], Train: total:4902.70703, BCE:-23.56851, KLD:4926.27197,Test: total:19486.48633, BCE:-23.68747, KLD:19510.17188
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 15120, epoch 56.0)
score:  72.63666666666667
score:  65.76
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 15120, epoch 56.0)
[Save Checkpoint] epoch: [56.0], Train: total:4921.05029, BCE:-23.53439, KLD:4944.58447,Test: total:19558.72070, BCE:-23.66724, KLD:19582.38867
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 15390, epoch 57.0)
score:  72.74833333333333
score:  65.87
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 15390, epoch 57.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [57.0], Train: total:4914.77881, BCE:-23.60105, KLD:4938.38184,Test: total:19535.95117, BCE:-23.74706, KLD:19559.70117
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 15660, epoch 58.0)
score:  72.46166666666667
score:  65.82
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 15660, epoch 58.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [58.0], Train: total:4910.24756, BCE:-23.56488, KLD:4933.81543,Test: total:19519.75586, BCE:-23.69651, KLD:19543.45117
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 15930, epoch 59.0)
score:  72.46666666666667
score:  65.6
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 15930, epoch 59.0)
[Save Checkpoint] epoch: [59.0], Train: total:4928.01221, BCE:-23.68959, KLD:4951.70117,Test: total:19584.77734, BCE:-23.81065, KLD:19608.58789
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 16200, epoch 60.0)
score:  72.23333333333333
score:  65.37
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 16200, epoch 60.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [60.0], Train: total:4892.46924, BCE:-23.67637, KLD:4916.14502,Test: total:19435.25391, BCE:-23.79220, KLD:19459.04688
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 16470, epoch 61.0)
score:  72.32166666666667
score:  65.31
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 16470, epoch 61.0)
[Save Checkpoint] epoch: [61.0], Train: total:4923.27051, BCE:-23.73112, KLD:4946.99805,Test: total:19563.15820, BCE:-23.85665, KLD:19587.01562
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 16740, epoch 62.0)
score:  72.05333333333333
score:  65.5
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 16740, epoch 62.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [62.0], Train: total:4893.11670, BCE:-23.74838, KLD:4916.86475,Test: total:19438.90625, BCE:-23.88026, KLD:19462.78711
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 17010, epoch 63.0)
score:  72.205
score:  64.92
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 17010, epoch 63.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [63.0], Train: total:4903.78027, BCE:-23.60103, KLD:4927.38184,Test: total:19480.53906, BCE:-23.71507, KLD:19504.25195
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 17280, epoch 64.0)
score:  72.00333333333333
score:  65.37
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 17280, epoch 64.0)
[Save Checkpoint] epoch: [64.0], Train: total:4894.57422, BCE:-23.62825, KLD:4918.19824,Test: total:19438.11133, BCE:-23.74001, KLD:19461.84961
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 17550, epoch 65.0)
score:  72.11333333333333
score:  64.95
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 17550, epoch 65.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [65.0], Train: total:4906.93555, BCE:-23.65087, KLD:4930.58887,Test: total:19497.83398, BCE:-23.77267, KLD:19521.60938
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 17820, epoch 66.0)
score:  71.96
score:  65.22
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 17820, epoch 66.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [66.0], Train: total:4895.57129, BCE:-23.67471, KLD:4919.24951,Test: total:19448.59961, BCE:-23.81231, KLD:19472.41016
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 18090, epoch 67.0)
score:  72.025
score:  65.55
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 18090, epoch 67.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [67.0], Train: total:4893.36572, BCE:-23.63776, KLD:4917.00293,Test: total:19442.05859, BCE:-23.75541, KLD:19465.81445
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 18360, epoch 68.0)
score:  71.60833333333333
score:  64.66
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 18360, epoch 68.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [68.0], Train: total:4923.19336, BCE:-23.71098, KLD:4946.89990,Test: total:19554.57422, BCE:-23.82772, KLD:19578.40039
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 18630, epoch 69.0)
score:  71.59
score:  64.88
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 18630, epoch 69.0)
[Save Checkpoint] epoch: [69.0], Train: total:4881.83789, BCE:-23.66951, KLD:4905.50781,Test: total:19390.98633, BCE:-23.80193, KLD:19414.78711
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 18900, epoch 70.0)
score:  71.68
score:  64.43
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 18900, epoch 70.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [70.0], Train: total:4878.21094, BCE:-23.70526, KLD:4901.91846,Test: total:19379.54297, BCE:-23.82115, KLD:19403.36328
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 19170, epoch 71.0)
score:  71.87166666666667
score:  65.08
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 19170, epoch 71.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [71.0], Train: total:4922.96240, BCE:-23.59955, KLD:4946.56299,Test: total:19559.11719, BCE:-23.72688, KLD:19582.84375
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 19440, epoch 72.0)
score:  71.38166666666666
score:  64.5
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 19440, epoch 72.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [72.0], Train: total:4908.72900, BCE:-23.55430, KLD:4932.28223,Test: total:19495.83203, BCE:-23.68239, KLD:19519.51367
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 19710, epoch 73.0)
score:  71.32166666666667
score:  64.73
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 19710, epoch 73.0)
[Save Checkpoint] epoch: [73.0], Train: total:4907.01904, BCE:-23.79760, KLD:4930.81494,Test: total:19498.91211, BCE:-23.92801, KLD:19522.83789
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 19980, epoch 74.0)
score:  71.66
score:  64.5
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 19980, epoch 74.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [74.0], Train: total:4908.25293, BCE:-23.70706, KLD:4931.95996,Test: total:19499.97852, BCE:-23.80676, KLD:19523.78320
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 20250, epoch 75.0)
score:  71.655
score:  65.07
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 20250, epoch 75.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [75.0], Train: total:4903.72949, BCE:-23.79122, KLD:4927.51855,Test: total:19478.99609, BCE:-23.90173, KLD:19502.89648
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 20520, epoch 76.0)
score:  71.38333333333334
score:  64.44
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 20520, epoch 76.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [76.0], Train: total:4893.02490, BCE:-23.69422, KLD:4916.71729,Test: total:19433.86719, BCE:-23.79895, KLD:19457.66602
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 20790, epoch 77.0)
score:  71.33
score:  64.47
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 20790, epoch 77.0)
[Save Checkpoint] epoch: [77.0], Train: total:4908.67578, BCE:-23.71523, KLD:4932.38965,Test: total:19498.63086, BCE:-23.83054, KLD:19522.45898
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 21060, epoch 78.0)
score:  71.32166666666667
score:  64.54
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 21060, epoch 78.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [78.0], Train: total:4903.69775, BCE:-23.85641, KLD:4927.55371,Test: total:19480.76953, BCE:-23.95844, KLD:19504.73047
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 21330, epoch 79.0)
score:  71.24833333333333
score:  64.67
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 21330, epoch 79.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [79.0], Train: total:4882.28711, BCE:-23.73521, KLD:4906.02100,Test: total:19394.53320, BCE:-23.85579, KLD:19418.38867
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 21600, epoch 80.0)
score:  71.215
score:  64.01
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 21600, epoch 80.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [80.0], Train: total:4924.27490, BCE:-23.72837, KLD:4948.00439,Test: total:19558.83984, BCE:-23.83609, KLD:19582.67383
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 21870, epoch 81.0)
score:  71.335
score:  64.08
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 21870, epoch 81.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [81.0], Train: total:4925.17480, BCE:-23.85554, KLD:4949.03076,Test: total:19565.37891, BCE:-23.95895, KLD:19589.33398
Epoch    82: reducing learning rate of group 0 to 4.0000e-05.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 22140, epoch 82.0)
score:  71.305
score:  64.13
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 22140, epoch 82.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [82.0], Train: total:4891.01660, BCE:-23.86224, KLD:4914.87988,Test: total:19430.10938, BCE:-23.95853, KLD:19454.06836
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 22410, epoch 83.0)
score:  71.18166666666667
score:  64.01
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 22410, epoch 83.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [83.0], Train: total:4897.55664, BCE:-23.78255, KLD:4921.34229,Test: total:19457.14648, BCE:-23.90671, KLD:19481.05273
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 22680, epoch 84.0)
score:  71.04
score:  64.12
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 22680, epoch 84.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [84.0], Train: total:4887.51611, BCE:-23.80376, KLD:4911.31836,Test: total:19418.69531, BCE:-23.91182, KLD:19442.60742
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 22950, epoch 85.0)
score:  71.31833333333333
score:  64.11
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 22950, epoch 85.0)
EarlyStopping counter: 8 out of 25
[Save Checkpoint] epoch: [85.0], Train: total:4899.74023, BCE:-23.73418, KLD:4923.47559,Test: total:19466.34961, BCE:-23.87074, KLD:19490.22070
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 23220, epoch 86.0)
score:  70.95
score:  64.35
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 23220, epoch 86.0)
EarlyStopping counter: 9 out of 25
[Save Checkpoint] epoch: [86.0], Train: total:4902.44482, BCE:-23.73230, KLD:4926.17725,Test: total:19476.56445, BCE:-23.84031, KLD:19500.40625
Epoch    87: reducing learning rate of group 0 to 8.0000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 23490, epoch 87.0)
score:  70.92666666666666
score:  64.35
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 23490, epoch 87.0)
EarlyStopping counter: 10 out of 25
[Save Checkpoint] epoch: [87.0], Train: total:4897.40137, BCE:-23.79745, KLD:4921.19482,Test: total:19455.97461, BCE:-23.92829, KLD:19479.90234
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 23760, epoch 88.0)
score:  70.96333333333334
score:  64.21
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 23760, epoch 88.0)
EarlyStopping counter: 11 out of 25
[Save Checkpoint] epoch: [88.0], Train: total:4885.18457, BCE:-23.79291, KLD:4908.97656,Test: total:19406.04297, BCE:-23.90481, KLD:19429.94922
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 24030, epoch 89.0)
score:  70.96666666666667
score:  63.8
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 24030, epoch 89.0)
EarlyStopping counter: 12 out of 25
[Save Checkpoint] epoch: [89.0], Train: total:4885.10498, BCE:-23.80857, KLD:4908.91455,Test: total:19406.19141, BCE:-23.92140, KLD:19430.11133
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 24300, epoch 90.0)
score:  70.925
score:  64.15
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 24300, epoch 90.0)
EarlyStopping counter: 13 out of 25
[Save Checkpoint] epoch: [90.0], Train: total:4880.30078, BCE:-23.80859, KLD:4904.11035,Test: total:19386.81055, BCE:-23.92346, KLD:19410.73242
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 24570, epoch 91.0)
score:  70.865
score:  64.07
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 24570, epoch 91.0)
EarlyStopping counter: 14 out of 25
[Save Checkpoint] epoch: [91.0], Train: total:4880.89551, BCE:-23.82390, KLD:4904.72021,Test: total:19388.96680, BCE:-23.93740, KLD:19412.90430
Epoch    92: reducing learning rate of group 0 to 1.6000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 24840, epoch 92.0)
score:  71.20833333333333
score:  64.18
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 24840, epoch 92.0)
EarlyStopping counter: 15 out of 25
[Save Checkpoint] epoch: [92.0], Train: total:4884.56689, BCE:-23.83464, KLD:4908.39990,Test: total:19404.48828, BCE:-23.94962, KLD:19428.43555
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 25110, epoch 93.0)
score:  71.00333333333333
score:  64.51
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 25110, epoch 93.0)
EarlyStopping counter: 16 out of 25
[Save Checkpoint] epoch: [93.0], Train: total:4887.76562, BCE:-23.85617, KLD:4911.62549,Test: total:19417.25391, BCE:-23.97345, KLD:19441.22852
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 25380, epoch 94.0)
score:  70.99666666666667
score:  64.33
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 25380, epoch 94.0)
EarlyStopping counter: 17 out of 25
[Save Checkpoint] epoch: [94.0], Train: total:4889.09229, BCE:-23.86694, KLD:4912.95996,Test: total:19422.24023, BCE:-23.97809, KLD:19446.21680
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 25650, epoch 95.0)
score:  70.94833333333334
score:  63.91
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 25650, epoch 95.0)
[Save Checkpoint] epoch: [95.0], Train: total:4889.93506, BCE:-23.86896, KLD:4913.80322,Test: total:19426.03516, BCE:-23.97897, KLD:19450.01367
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 25920, epoch 96.0)
score:  70.95666666666666
score:  64.61
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 25920, epoch 96.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [96.0], Train: total:4889.85693, BCE:-23.85990, KLD:4913.71875,Test: total:19425.37891, BCE:-23.97820, KLD:19449.35742
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 26190, epoch 97.0)
score:  70.915
score:  64.17
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 26190, epoch 97.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [97.0], Train: total:4889.89941, BCE:-23.87144, KLD:4913.77246,Test: total:19425.82812, BCE:-23.98527, KLD:19449.81055
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 26460, epoch 98.0)
score:  70.945
score:  63.99
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 26460, epoch 98.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [98.0], Train: total:4887.70654, BCE:-23.87089, KLD:4911.57471,Test: total:19417.12305, BCE:-23.99673, KLD:19441.12109
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 26730, epoch 99.0)
score:  70.99666666666667
score:  64.68
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 26730, epoch 99.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [99.0], Train: total:4886.77637, BCE:-23.86540, KLD:4910.64062,Test: total:19413.50391, BCE:-23.98041, KLD:19437.48242
Epoch   100: reducing learning rate of group 0 to 1.0000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 27000, epoch 100.0)
score:  71.08833333333334
score:  64.16
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_6/last' (iter 27000, epoch 100.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [100.0], Train: total:4887.05029, BCE:-23.86955, KLD:4910.91846,Test: total:19414.39453, BCE:-23.99665, KLD:19438.39062
[Training Finished]
All done !
