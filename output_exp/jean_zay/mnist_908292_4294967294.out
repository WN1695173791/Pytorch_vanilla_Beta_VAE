use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
class 0: Average distance Hamming: tensor([6.7800])
class 1: Average distance Hamming: tensor([5.8397])
class 2: Average distance Hamming: tensor([8.3004])
class 3: Average distance Hamming: tensor([7.0382])
class 4: Average distance Hamming: tensor([11.8422])
class 5: Average distance Hamming: tensor([6.7315])
class 6: Average distance Hamming: tensor([9.1488])
class 7: Average distance Hamming: tensor([6.5371])
class 8: Average distance Hamming: tensor([7.8611])
class 9: Average distance Hamming: tensor([9.0023])
average distance: 7.908143520355225
save z_struct representation for model mnist_binary_ES_15_BAGMP
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_binary_ES_15_BAGMP
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_binary_ES_15_BAGMP, shape: (10, 15)
save std z_struct representation for model mnist_binary_ES_15_BAGMP, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 0.7949199
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
__________------Hamming distance:------__________
class 0: Average distance Hamming: 6.780046463012695
class 1: Average distance Hamming: 5.839687824249268
class 2: Average distance Hamming: 8.300439834594727
class 3: Average distance Hamming: 7.038236141204834
class 4: Average distance Hamming: 11.842151641845703
class 5: Average distance Hamming: 6.731533050537109
class 6: Average distance Hamming: 9.148792266845703
class 7: Average distance Hamming: 6.537129878997803
class 8: Average distance Hamming: 7.861110210418701
class 9: Average distance Hamming: 9.002314567565918
average distance: 7.908143520355225
for class 0, we have 1 z_struct with code [0.        0.        0.        0.        0.        2.04443   1.0068581
 0.        2.0755246 0.        0.        0.        0.        0.
 0.       ]. It represent 0.102% of total z_struct class
for class 1, we have 1 z_struct with code [0.         0.         0.         0.         0.         1.91203
 0.         0.         0.         0.35027182 0.         0.
 1.0814917  0.39259833 0.        ]. It represent 0.088% of total z_struct class
for class 2, we have 1 z_struct with code [0.         0.         0.         0.         0.         2.941122
 0.07443301 0.         0.         0.08115351 0.         0.
 0.         0.         0.        ]. It represent 0.097% of total z_struct class
for class 3, we have 1 z_struct with code [0.         0.         0.         0.         0.         1.8457786
 0.         0.         0.         2.507053   0.61875826 0.7957549
 1.309289   0.         0.        ]. It represent 0.099% of total z_struct class
for class 4, we have 1 z_struct with code [0.         0.         0.         0.         0.         2.4641418
 0.         0.00660077 1.0626236  0.13888337 0.         0.
 0.         0.         0.        ]. It represent 0.102% of total z_struct class
for class 5, we have 1 z_struct with code [0.         0.         0.         0.         0.         2.0424006
 0.         0.         0.         0.62719846 0.         0.97536707
 1.1444387  0.         0.        ]. It represent 0.112% of total z_struct class
for class 6, we have 1 z_struct with code [0.         0.         0.         0.         0.         2.4266171
 0.         0.57540596 0.         0.         0.42426854 0.
 0.         1.1504375  0.6228231 ]. It represent 0.104% of total z_struct class
for class 7, we have 1 z_struct with code [0.        0.        0.        0.        0.        2.3987932 0.
 0.4032535 0.1250229 0.        0.        0.        0.7563785 0.1639721
 0.       ]. It represent 0.097% of total z_struct class
for class 8, we have 1 z_struct with code [0.         0.         0.         0.         0.         2.6387553
 0.         0.         2.1310143  0.36971328 0.8336108  0.
 0.         0.         0.        ]. It represent 0.103% of total z_struct class
for class 9, we have 1 z_struct with code [0.         0.         0.         0.         0.         1.688955
 1.7900465  0.         1.8198086  0.62254    1.6820303  1.7458279
 1.2929429  0.59350145 0.        ]. It represent 0.099% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 48.83 %
figure saved for model mnist_binary_ES_15_BAGMP
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP_sdl_30-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=30, bias=True)
    (13): BatchNorm1d(30, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU(inplace=True)
    (15): Linear(in_features=30, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 827/980. In percent: 0.8438775510204082
class 1: unique code: 7/1135. In percent: 0.006167400881057269
class 2: unique code: 877/1032. In percent: 0.8498062015503876
class 3: unique code: 947/1010. In percent: 0.9376237623762376
class 4: unique code: 321/982. In percent: 0.3268839103869654
class 5: unique code: 829/892. In percent: 0.929372197309417
class 6: unique code: 747/958. In percent: 0.7797494780793319
class 7: unique code: 694/1028. In percent: 0.6750972762645915
class 8: unique code: 853/974. In percent: 0.8757700205338809
class 9: unique code: 616/1009. In percent: 0.6105054509415263
class 0: Average distance Hamming: tensor([1.0193])
class 1: Average distance Hamming: tensor([0.0106])
class 2: Average distance Hamming: tensor([1.7274])
class 3: Average distance Hamming: tensor([1.9807])
class 4: Average distance Hamming: tensor([0.6506])
class 5: Average distance Hamming: tensor([1.9224])
class 6: Average distance Hamming: tensor([1.0463])
class 7: Average distance Hamming: tensor([1.1282])
class 8: Average distance Hamming: tensor([1.1406])
class 9: Average distance Hamming: tensor([0.9917])
average distance: 1.1617733240127563
save z_struct representation for model mnist_binary_ES_15_BAGMP_sdl_30
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_binary_ES_15_BAGMP_sdl_30
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_binary_ES_15_BAGMP_sdl_30, shape: (10, 15)
save std z_struct representation for model mnist_binary_ES_15_BAGMP_sdl_30, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 18.480003
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 827/980. In percent: 0.8438775510204082
class 1: unique code: 7/1135. In percent: 0.006167400881057269
class 2: unique code: 877/1032. In percent: 0.8498062015503876
class 3: unique code: 947/1010. In percent: 0.9376237623762376
class 4: unique code: 321/982. In percent: 0.3268839103869654
class 5: unique code: 829/892. In percent: 0.929372197309417
class 6: unique code: 747/958. In percent: 0.7797494780793319
class 7: unique code: 694/1028. In percent: 0.6750972762645915
class 8: unique code: 853/974. In percent: 0.8757700205338809
class 9: unique code: 616/1009. In percent: 0.6105054509415263
__________------Hamming distance:------__________
class 0: Average distance Hamming: 1.0193283557891846
class 1: Average distance Hamming: 0.010557148605585098
class 2: Average distance Hamming: 1.7274171113967896
class 3: Average distance Hamming: 1.9806926250457764
class 4: Average distance Hamming: 0.6505810022354126
class 5: Average distance Hamming: 1.9223500490188599
class 6: Average distance Hamming: 1.0462779998779297
class 7: Average distance Hamming: 1.128226637840271
class 8: Average distance Hamming: 1.140618085861206
class 9: Average distance Hamming: 0.9916839599609375
average distance: 1.1617733240127563
for class 0, we have 154 z_struct with code [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]. It represent 15.714% of total z_struct class
for class 1, we have 1129 z_struct with code [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]. It represent 99.471% of total z_struct class
for class 2, we have 156 z_struct with code [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]. It represent 15.116% of total z_struct class
for class 3, we have 64 z_struct with code [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]. It represent 6.337% of total z_struct class
for class 4, we have 662 z_struct with code [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]. It represent 67.413% of total z_struct class
for class 5, we have 64 z_struct with code [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]. It represent 7.175% of total z_struct class
for class 6, we have 212 z_struct with code [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]. It represent 22.129% of total z_struct class
for class 7, we have 335 z_struct with code [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]. It represent 32.588% of total z_struct class
for class 8, we have 122 z_struct with code [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]. It represent 12.526% of total z_struct class
for class 9, we have 394 z_struct with code [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]. It represent 39.049% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 11.35 %
figure saved for model mnist_binary_ES_15_BAGMP_sdl_30
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_sdl_30_BN-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): Linear(in_features=15, out_features=30, bias=True)
    (12): BatchNorm1d(30, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (13): ReLU(inplace=True)
    (14): Linear(in_features=30, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 1/980. In percent: 0.0010204081632653062
class 1: unique code: 1/1135. In percent: 0.000881057268722467
class 2: unique code: 1/1032. In percent: 0.0009689922480620155
class 3: unique code: 1/1010. In percent: 0.0009900990099009901
class 4: unique code: 1/982. In percent: 0.0010183299389002036
class 5: unique code: 1/892. In percent: 0.0011210762331838565
class 6: unique code: 1/958. In percent: 0.0010438413361169101
class 7: unique code: 1/1028. In percent: 0.0009727626459143969
class 8: unique code: 1/974. In percent: 0.001026694045174538
class 9: unique code: 1/1009. In percent: 0.0009910802775024777
class 0: Average distance Hamming: tensor([0.])
class 1: Average distance Hamming: tensor([0.])
class 2: Average distance Hamming: tensor([0.])
class 3: Average distance Hamming: tensor([0.])
class 4: Average distance Hamming: tensor([0.])
class 5: Average distance Hamming: tensor([0.])
class 6: Average distance Hamming: tensor([0.])
class 7: Average distance Hamming: tensor([0.])
class 8: Average distance Hamming: tensor([0.])
class 9: Average distance Hamming: tensor([0.])
average distance: 0.0
save z_struct representation for model mnist_binary_ES_15_sdl_30_BN
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_binary_ES_15_sdl_30_BN
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_binary_ES_15_sdl_30_BN, shape: (10, 15)
save std z_struct representation for model mnist_binary_ES_15_sdl_30_BN, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 0.0
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 1/980. In percent: 0.0010204081632653062
class 1: unique code: 1/1135. In percent: 0.000881057268722467
class 2: unique code: 1/1032. In percent: 0.0009689922480620155
class 3: unique code: 1/1010. In percent: 0.0009900990099009901
class 4: unique code: 1/982. In percent: 0.0010183299389002036
class 5: unique code: 1/892. In percent: 0.0011210762331838565
class 6: unique code: 1/958. In percent: 0.0010438413361169101
class 7: unique code: 1/1028. In percent: 0.0009727626459143969
class 8: unique code: 1/974. In percent: 0.001026694045174538
class 9: unique code: 1/1009. In percent: 0.0009910802775024777
__________------Hamming distance:------__________
class 0: Average distance Hamming: 0.0
class 1: Average distance Hamming: 0.0
class 2: Average distance Hamming: 0.0
class 3: Average distance Hamming: 0.0
class 4: Average distance Hamming: 0.0
class 5: Average distance Hamming: 0.0
class 6: Average distance Hamming: 0.0
class 7: Average distance Hamming: 0.0
class 8: Average distance Hamming: 0.0
class 9: Average distance Hamming: 0.0
average distance: 0.0
for class 0, we have 980 z_struct with code [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]. It represent 100.0% of total z_struct class
for class 1, we have 1135 z_struct with code [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]. It represent 100.0% of total z_struct class
for class 2, we have 1032 z_struct with code [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]. It represent 100.0% of total z_struct class
for class 3, we have 1010 z_struct with code [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]. It represent 100.0% of total z_struct class
for class 4, we have 982 z_struct with code [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]. It represent 100.0% of total z_struct class
for class 5, we have 892 z_struct with code [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]. It represent 100.0% of total z_struct class
for class 6, we have 958 z_struct with code [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]. It represent 100.0% of total z_struct class
for class 7, we have 1028 z_struct with code [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]. It represent 100.0% of total z_struct class
for class 8, we have 974 z_struct with code [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]. It represent 100.0% of total z_struct class
for class 9, we have 1009 z_struct with code [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]. It represent 100.0% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 10.09 %
figure saved for model mnist_binary_ES_15_sdl_30_BN
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_1-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=30, bias=True)
    (13): BatchNorm1d(30, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU(inplace=True)
    (15): Linear(in_features=30, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1131/1135. In percent: 0.9964757709251101
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 956/958. In percent: 0.9979123173277662
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
class 0: Average distance Hamming: tensor([3.1438])
class 1: Average distance Hamming: tensor([2.0769])
class 2: Average distance Hamming: tensor([2.8996])
class 3: Average distance Hamming: tensor([3.1633])
class 4: Average distance Hamming: tensor([5.3242])
class 5: Average distance Hamming: tensor([4.1199])
class 6: Average distance Hamming: tensor([1.3973])
class 7: Average distance Hamming: tensor([4.2716])
class 8: Average distance Hamming: tensor([3.6027])
class 9: Average distance Hamming: tensor([3.4993])
average distance: 3.3498504161834717
save z_struct representation for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_1
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_1
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_1, shape: (10, 15)
save std z_struct representation for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_1, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 17.915825
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1131/1135. In percent: 0.9964757709251101
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 956/958. In percent: 0.9979123173277662
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
__________------Hamming distance:------__________
class 0: Average distance Hamming: 3.143770217895508
class 1: Average distance Hamming: 2.07694411277771
class 2: Average distance Hamming: 2.899578094482422
class 3: Average distance Hamming: 3.163341760635376
class 4: Average distance Hamming: 5.324171543121338
class 5: Average distance Hamming: 4.119898319244385
class 6: Average distance Hamming: 1.3972574472427368
class 7: Average distance Hamming: 4.271614074707031
class 8: Average distance Hamming: 3.602670431137085
class 9: Average distance Hamming: 3.499260663986206
average distance: 3.3498504161834717
for class 0, we have 1 z_struct with code [0.       0.       0.       0.       0.       0.       0.       0.
 0.       0.       1.454148 0.       0.       0.       0.      ]. It represent 0.102% of total z_struct class
for class 1, we have 2 z_struct with code [0.        0.        0.        0.        0.        0.        0.
 0.        0.        0.        1.5475433 0.        0.        0.
 0.       ]. It represent 0.176% of total z_struct class
for class 2, we have 1 z_struct with code [0.         0.         0.         0.05754048 0.         0.
 0.         0.         0.         0.         1.5361997  0.
 0.         0.         0.        ]. It represent 0.097% of total z_struct class
for class 3, we have 1 z_struct with code [0.         0.         0.         0.49257237 0.         0.14447412
 0.         0.         0.         0.         1.5612504  0.
 0.         0.         0.        ]. It represent 0.099% of total z_struct class
for class 4, we have 1 z_struct with code [0.        0.        0.        0.        0.        0.        0.
 0.        0.        0.        1.5452952 0.        0.        0.
 0.       ]. It represent 0.102% of total z_struct class
for class 5, we have 1 z_struct with code [0.         0.         0.         0.07705601 0.         0.
 0.         0.         0.         0.         1.5763956  0.
 0.         0.         0.        ]. It represent 0.112% of total z_struct class
for class 6, we have 2 z_struct with code [0.        0.        0.        0.        0.        0.        0.
 0.        0.        0.        1.5410314 0.        0.        0.
 0.       ]. It represent 0.209% of total z_struct class
for class 7, we have 1 z_struct with code [0.         0.         0.         0.30177072 0.         0.
 0.         0.         0.         0.         1.5774219  0.
 0.         0.         0.21128318]. It represent 0.097% of total z_struct class
for class 8, we have 1 z_struct with code [0.        0.        0.        0.        0.        0.        0.
 0.        0.        0.        1.5270909 0.        0.        0.1315495
 0.       ]. It represent 0.103% of total z_struct class
for class 9, we have 1 z_struct with code [0.         0.         0.         0.04853718 0.         0.
 0.         0.         0.         0.43893558 1.5555843  0.
 0.         0.         0.4108067 ]. It represent 0.099% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 29.42 %
figure saved for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_1
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_2-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=30, bias=True)
    (13): BatchNorm1d(30, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU(inplace=True)
    (15): Linear(in_features=30, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
class 0: Average distance Hamming: tensor([14.9986])
class 1: Average distance Hamming: tensor([15.1181])
class 2: Average distance Hamming: tensor([14.9988])
class 3: Average distance Hamming: tensor([14.9989])
class 4: Average distance Hamming: tensor([14.9971])
class 5: Average distance Hamming: tensor([14.9987])
class 6: Average distance Hamming: tensor([14.9984])
class 7: Average distance Hamming: tensor([14.9965])
class 8: Average distance Hamming: tensor([14.9986])
class 9: Average distance Hamming: tensor([14.9949])
average distance: 15.009866714477539
save z_struct representation for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_2
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_2
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_2, shape: (10, 15)
save std z_struct representation for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_2, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 60.513687
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
__________------Hamming distance:------__________
class 0: Average distance Hamming: 14.998595237731934
class 1: Average distance Hamming: 15.11811637878418
class 2: Average distance Hamming: 14.998838424682617
class 3: Average distance Hamming: 14.99891471862793
class 4: Average distance Hamming: 14.997052192687988
class 5: Average distance Hamming: 14.99869441986084
class 6: Average distance Hamming: 14.998446464538574
class 7: Average distance Hamming: 14.99653148651123
class 8: Average distance Hamming: 14.99860668182373
class 9: Average distance Hamming: 14.994877815246582
average distance: 15.009866714477539
for class 0, we have 1 z_struct with code [0.8000275  0.8688666  0.7212005  0.78996634 0.89603907 0.8032405
 0.83762616 0.48806128 0.896368   0.80829006 0.9099145  0.8614207
 0.8843712  0.86571795 0.8673047 ]. It represent 0.102% of total z_struct class
for class 1, we have 1 z_struct with code [0.7942472  0.8688528  0.72097564 0.7838985  0.8963251  0.8034682
 0.84048665 0.48320782 0.89598155 0.7977153  0.9099179  0.8616619
 0.8845409  0.86558    0.86717266]. It represent 0.088% of total z_struct class
for class 2, we have 1 z_struct with code [0.8020896  0.86876637 0.72143793 0.7887556  0.8962145  0.8036058
 0.8377302  0.48721594 0.8962286  0.8060973  0.91041946 0.86157304
 0.8843108  0.86560607 0.86707723]. It represent 0.097% of total z_struct class
for class 3, we have 1 z_struct with code [0.8031245  0.86948365 0.7213368  0.7941993  0.89634866 0.8038191
 0.8380119  0.48607996 0.89627886 0.8086852  0.910052   0.8614801
 0.88439626 0.8666086  0.86723936]. It represent 0.099% of total z_struct class
for class 4, we have 1 z_struct with code [0.8060908  0.8685729  0.7210155  0.7931274  0.89604497 0.803306
 0.837623   0.48571688 0.89597553 0.8095838  0.9097112  0.86119336
 0.8843072  0.86557627 0.8668955 ]. It represent 0.102% of total z_struct class
for class 5, we have 1 z_struct with code [0.75838953 0.8687051  0.7212954  0.7467809  0.89656156 0.80398417
 0.83804137 0.4840997  0.89639026 0.7612175  0.9104773  0.861743
 0.88476515 0.86605555 0.86702126]. It represent 0.112% of total z_struct class
for class 6, we have 1 z_struct with code [0.78495157 0.86871487 0.72113615 0.75980854 0.8962748  0.80339164
 0.8382494  0.46930805 0.89612406 0.786749   0.9098788  0.86273044
 0.88453513 0.8656232  0.8670874 ]. It represent 0.104% of total z_struct class
for class 7, we have 1 z_struct with code [0.805816   0.86876804 0.72100735 0.7936096  0.8962277  0.8033527
 0.8377434  0.48367807 0.89610785 0.8086429  0.90972894 0.8613084
 0.8843806  0.8655155  0.86703646]. It represent 0.097% of total z_struct class
for class 8, we have 1 z_struct with code [0.8015673  0.8683962  0.7207513  0.79071295 0.8960636  0.8033306
 0.8371782  0.48773262 0.8959246  0.80815893 0.90957624 0.8612398
 0.88429505 0.86553884 0.86697114]. It represent 0.103% of total z_struct class
for class 9, we have 1 z_struct with code [0.80178577 0.86938447 0.7210313  0.786094   0.89629453 0.80356723
 0.83757824 0.48768142 0.8966623  0.80332357 0.91009843 0.86154103
 0.8845159  0.86609215 0.8670916 ]. It represent 0.099% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 10.32 %
figure saved for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_2
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_3-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=30, bias=True)
    (13): BatchNorm1d(30, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU(inplace=True)
    (15): Linear(in_features=30, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
class 0: Average distance Hamming: tensor([14.9982])
class 1: Average distance Hamming: tensor([15.0949])
class 2: Average distance Hamming: tensor([14.9975])
class 3: Average distance Hamming: tensor([14.9975])
class 4: Average distance Hamming: tensor([14.9919])
class 5: Average distance Hamming: tensor([14.9970])
class 6: Average distance Hamming: tensor([14.9959])
class 7: Average distance Hamming: tensor([14.9920])
class 8: Average distance Hamming: tensor([14.9973])
class 9: Average distance Hamming: tensor([14.9880])
average distance: 15.005038261413574
save z_struct representation for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_3
save label list
save prediction
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
save z_struct representation per class for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_3
load z_struct representation per class, shape: (10,)
save average z_struct representation for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_3, shape: (10, 15)
save std z_struct representation for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_3, shaape: (10, 15)
load z_struct representation, shape: (10000, 15)
load label list, shape: (10000,)
load prediction, shape: (10000, 10)
load z_struct representation per class, shape: (10,)
normalized z_struct
Var intra class shape:  (10, 15) (15,)
Var inter class shape:  (15,)
ratio Var intra / Var inter:  (15,) 43.526867
Computing scores...
load average z_struct representation, shape: (10, 15)
load std z_struct representation, shape: (10, 15)
Load all binary encoder struct values:
__________------Uniq code:------__________
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
__________------Hamming distance:------__________
class 0: Average distance Hamming: 14.998165130615234
class 1: Average distance Hamming: 15.094928741455078
class 2: Average distance Hamming: 14.997498512268066
class 3: Average distance Hamming: 14.997540473937988
class 4: Average distance Hamming: 14.991928100585938
class 5: Average distance Hamming: 14.997040748596191
class 6: Average distance Hamming: 14.995911598205566
class 7: Average distance Hamming: 14.992032051086426
class 8: Average distance Hamming: 14.997303009033203
class 9: Average distance Hamming: 14.988036155700684
average distance: 15.005038261413574
for class 0, we have 1 z_struct with code [0.14493994 0.55052316 0.38328683 0.02619287 0.5137895  0.4495212
 0.56460303 0.10715931 0.48111132 0.37787706 0.5759054  0.45364305
 0.5737862  0.5153769  0.53983   ]. It represent 0.102% of total z_struct class
for class 1, we have 1 z_struct with code [0.14168812 0.55093086 0.38366425 0.02418431 0.5141512  0.44942403
 0.5647296  0.10570697 0.48155916 0.36609605 0.57629186 0.45357096
 0.57408947 0.5157084  0.54017305]. It represent 0.088% of total z_struct class
for class 2, we have 1 z_struct with code [0.14735901 0.5508465  0.3837179  0.02620245 0.5144358  0.44940338
 0.56484246 0.10715598 0.48164484 0.3843205  0.5765405  0.45355493
 0.5740898  0.51574385 0.5401475 ]. It represent 0.097% of total z_struct class
for class 3, we have 1 z_struct with code [0.14694616 0.55091166 0.38368326 0.02604234 0.5141746  0.44943506
 0.5648159  0.1069883  0.48157725 0.38343206 0.5762994  0.45355874
 0.5740737  0.51570654 0.54026777]. It represent 0.099% of total z_struct class
for class 4, we have 1 z_struct with code [0.14782763 0.55112946 0.38362685 0.02623689 0.5140692  0.44958597
 0.56482565 0.10715962 0.4815346  0.3855656  0.5763232  0.45354912
 0.5742835  0.5157443  0.5403224 ]. It represent 0.102% of total z_struct class
for class 5, we have 1 z_struct with code [0.13534066 0.5508778  0.3837149  0.02564299 0.51411676 0.44940996
 0.5649056  0.10697671 0.48152578 0.3547534  0.57629424 0.4536732
 0.57414603 0.51574254 0.5402044 ]. It represent 0.112% of total z_struct class
for class 6, we have 1 z_struct with code [0.14484452 0.5508698  0.3836932  0.02537622 0.51409453 0.44939318
 0.5647228  0.10654102 0.48154902 0.3784901  0.57628125 0.45360416
 0.5740697  0.5156931  0.5401514 ]. It represent 0.104% of total z_struct class
for class 7, we have 1 z_struct with code [0.14677568 0.5508392  0.3836678  0.02613334 0.5141143  0.449408
 0.5647689  0.10699984 0.48155022 0.3818776  0.5762935  0.45357522
 0.57406366 0.5157045  0.54016507]. It represent 0.097% of total z_struct class
for class 8, we have 1 z_struct with code [0.14773884 0.5462909  0.38291037 0.02620047 0.5130617  0.4478651
 0.56244403 0.10716263 0.48077667 0.3847944  0.5754014  0.45280302
 0.57278806 0.51356274 0.5372876 ]. It represent 0.103% of total z_struct class
for class 9, we have 1 z_struct with code [0.14749752 0.5509476  0.38367346 0.02618239 0.5141043  0.44939858
 0.5647574  0.10715614 0.4816202  0.38345733 0.57626384 0.4535598
 0.5740643  0.51570255 0.54019564]. It represent 0.099% of total z_struct class
Compute all binary encoder struct values:
prediction with same best uniq code for test set: 8.92 %
figure saved for model mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_3
use 1 gpu who named: Tesla V100-SXM2-32GB
________________------------------mnist_binary_ES_15_BAGMP_sdl_30_L2_dst_4-----------------_____________________
Encoder_struct(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
    (12): Linear(in_features=15, out_features=30, bias=True)
    (13): BatchNorm1d(30, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU(inplace=True)
    (15): Linear(in_features=30, out_features=10, bias=True)
  )
)
Compute all binary encoder struct values:
class 0: unique code: 980/980. In percent: 1.0
class 1: unique code: 1135/1135. In percent: 1.0
class 2: unique code: 1032/1032. In percent: 1.0
class 3: unique code: 1010/1010. In percent: 1.0
class 4: unique code: 982/982. In percent: 1.0
class 5: unique code: 892/892. In percent: 1.0
class 6: unique code: 958/958. In percent: 1.0
class 7: unique code: 1028/1028. In percent: 1.0
class 8: unique code: 974/974. In percent: 1.0
class 9: unique code: 1009/1009. In percent: 1.0
class 0: Average distance Hamming: tensor([14.9981])
class 1: Average distance Hamming: tensor([15.1036])
class 2: Average distance Hamming: tensor([14.9971])
class 3: Average distance Hamming: tensor([14.9977])
class 4: Average distance Hamming: tensor([14.9918])
class 5: Average distance Hamming: tensor([14.9970])
class 6: Average distance Hamming: tensor([14.9962])
class 7: Average distance Hamming: tensor([14.9900])
