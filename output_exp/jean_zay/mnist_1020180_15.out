15
--gpu_devices 0 --max_iter 100 --batch_size 250 --use_scheduler True --lr 1e-3 --GMP True --z_struct_size 15 --z_var_size 10 --is_VAE True --is_encoder_struct False --lambda_BCE 1 --beta 3 --lambda_recons 0.1 --lambda_EV_class 1 --big_kernel_size 8 --two_conv_layer True --three_conv_layer True --kernel_size_1 4 --kernel_size_2 4 --kernel_size_3 4 --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 64 --hidden_filters_layer2 64 --hidden_filters_layer3 64 --dataset_balanced True --binary_z True --binary_first_conv False --binary_second_conv False --binary_third_conv True --use_small_lr_encoder_var False --encoder_var_name None --encoder_struct_name mnist_ES_binary_15 --freeze_Encoder True --EV_classifier True --freeze_Encoder True --grad_inv True --exp_name mnist_VAE_s15_v10_class_inv_grad_4_beta
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, ES_reconstruction=False, EV_classifier=True, GMP=True, Hmg_dst_loss=False, IPC=False, L1_norm_act=False, L1_norm_weights=False, L2_dst_loss=False, L3_without_random=False, LOG_DIR='logs', PT_model=False, PT_model_EV_classifier=False, adapt_lr=False, add_classification_layer=True, add_dl_class=False, add_linear_after_GMP=True, add_z_struct_bottleneck=False, alpha=32, batch_size=250, beta=3.0, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=8, bin_after_GMP=False, binary_chain=False, binary_first_conv=False, binary_second_conv=False, binary_third_conv=True, binary_z=True, both_decoders_freeze=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, contrastive_loss=False, cuda=True, dataset='mnist', dataset_balanced=True, decoder_first_dense=36, decoder_kernel_size_1=4, decoder_kernel_size_2=3, decoder_kernel_size_3=4, decoder_n_filter_1=64, decoder_n_filter_2=64, decoder_n_filter_3=64, decoder_stride_1=2, decoder_stride_2=2, decoder_stride_3=1, diff_var=False, display_step=10000, dset_dir='data', encoder_struct_name='mnist_ES_binary_15', encoder_var_name='None', exp_name='mnist_VAE_s15_v10_class_inv_grad_4_beta', freeze_Encoder=True, gamma=1000, gpu_devices=[0], grad_inv=True, hidden_dim=20, hidden_filters_layer1=64, hidden_filters_layer2=64, hidden_filters_layer3=64, image_size=64, intra_class_variance_loss=False, is_C=True, is_E1=False, is_VAE=True, is_VAE_var=False, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=False, is_default_model=False, is_encoder_struct=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, kernel_size_1=4, kernel_size_2=4, kernel_size_3=4, lambda_BCE=1.0, lambda_EV_class=1.0, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_L2_dst=1, lambda_VAE=1, lambda_class=1, lambda_contrastive_loss=1, lambda_distance_mean=1, lambda_hmg_dst=1, lambda_intra_class_var=1, lambda_partial_class=1, lambda_ratio_reg=1, lambda_recon_wt_rand=1, lambda_recons=0.1, lambda_uniq_code_dst=1, lambda_var_distance=1, lambda_var_inter=1, lambda_var_intra=1, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', loss='Proxy_Anchor', loss_distance_mean=False, loss_min_distance_cl=False, lr=0.001, max_epoch_use_uniq_code_target=5, max_iter=100.0, model='CNN', mrg=0.1, nb_epochs_train_only_zvar=0, num_workers=2, old_weighted=False, optimizer='adamw', other_architecture=False, other_ratio=False, random_percentage=0.2, random_seed=10, randomness=True, ratio_reg=False, remark='', save_step=10000, second_layer_C=False, seed=1, stride_size=1, sz_embedding=5, three_conv_layer=True, train=True, train_var_struct_alternatively=False, two_conv_layer=True, two_encoder=False, uniq_code_dst_loss=False, use_VAE=False, use_decoder=False, use_early_stopping=True, use_scheduler=True, use_small_lr_encoder_var=False, use_structural_encoder=False, value_target_distance_mean=1, var_hidden_dim=256, var_hidden_filters_1=32, var_hidden_filters_2=32, var_hidden_filters_3=32, var_kernel_size_1=3, var_kernel_size_2=3, var_kernel_size_3=3, var_second_cnn_block=True, var_stride_size_1=1, var_stride_size_2=1, var_stride_size_3=1, var_third_cnn_block=False, var_three_conv_layer=False, warm=1, without_acc=False, z_struct_size=15, z_var_size=10, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
[Using Seed: 10]
Balanced dataset loaded
VAE doesn't exist but encoder struct yes ! load struct encoder weighs !
=> loaded checkpoint 'checkpoints_CNN/mnist_ES_binary_15/last (iter 22410)'
Weighs loaded for struct encoder !
use 1 gpu who named: Tesla V100-SXM2-32GB
VAE(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
  )
  (decoder): Sequential(
    (0): Linear(in_features=25, out_features=1600, bias=True)
    (1): ReLU(inplace=True)
    (2): View()
    (3): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (4): ReLU(inplace=True)
    (5): ConvTranspose2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (6): ReLU(inplace=True)
    (7): ConvTranspose2d(64, 32, kernel_size=(3, 3), stride=(1, 1))
    (8): ReLU(inplace=True)
    (9): ConvTranspose2d(32, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (10): ReLU(inplace=True)
    (11): ConvTranspose2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (12): ReLU(inplace=True)
    (13): ConvTranspose2d(32, 1, kernel_size=(3, 3), stride=(1, 1))
    (14): Sigmoid()
  )
  (encoder_var): Sequential(
    (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (4): ReLU(inplace=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Conv2d(32, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (7): ReLU(inplace=True)
    (8): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): Dropout(p=0.4, inplace=False)
    (10): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
    (11): ReLU(inplace=True)
    (12): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (13): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (14): ReLU(inplace=True)
    (15): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Conv2d(64, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (17): ReLU(inplace=True)
    (18): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (19): Dropout(p=0.4, inplace=False)
    (20): View()
    (21): Linear(in_features=1600, out_features=20, bias=True)
  )
  (var_classifier): Sequential(
    (0): RevGrad()
    (1): Linear(in_features=10, out_features=10, bias=True)
  )
)
The number of parameters of model is 499760
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 270, epoch 1.0)
score:  34.175
score:  31.59
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 270, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train: total:8582.43457, BCE:-17.05048, KLD:2866.49438,Test: total:34400.85547, BCE:-17.13770, KLD:11472.66309
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 540, epoch 2.0)
score:  40.255
score:  37.42
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 540, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train: total:8557.72461, BCE:-17.74323, KLD:2858.48901,Test: total:34169.36328, BCE:-17.78536, KLD:11395.71680
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 810, epoch 3.0)
score:  46.913333333333334
score:  42.47
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 810, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train: total:8541.85254, BCE:-17.36044, KLD:2853.07153,Test: total:34020.24219, BCE:-17.39784, KLD:11345.87988
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 1080, epoch 4.0)
score:  53.60666666666667
score:  47.91
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 1080, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train: total:8707.57910, BCE:-16.62965, KLD:2908.06860,Test: total:34614.17969, BCE:-16.67266, KLD:11543.61719
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 1350, epoch 5.0)
score:  54.843333333333334
score:  49.43
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 1350, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train: total:8838.54102, BCE:-13.80281, KLD:2950.78027,Test: total:35093.44141, BCE:-13.86277, KLD:11702.43555
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 1620, epoch 6.0)
score:  55.151666666666664
score:  49.38
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 1620, epoch 6.0)
[Save Checkpoint] epoch: [6.0], Train: total:8828.21387, BCE:-12.48345, KLD:2946.89868,Test: total:35048.44141, BCE:-12.56440, KLD:11687.00195
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 1890, epoch 7.0)
score:  55.276666666666664
score:  50.28
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 1890, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train: total:8986.33008, BCE:-11.91575, KLD:2999.41431,Test: total:35649.08203, BCE:-11.99689, KLD:11887.02637
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 2160, epoch 8.0)
score:  55.736666666666665
score:  49.67
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 2160, epoch 8.0)
[Save Checkpoint] epoch: [8.0], Train: total:8997.09277, BCE:-12.31346, KLD:3003.13525,Test: total:35729.80859, BCE:-12.42041, KLD:11914.07715
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 2430, epoch 9.0)
score:  55.16166666666667
score:  49.76
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 2430, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train: total:9180.90918, BCE:-12.37368, KLD:3064.42725,Test: total:36454.48047, BCE:-12.52579, KLD:12155.66895
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 2700, epoch 10.0)
score:  54.968333333333334
score:  49.94
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 2700, epoch 10.0)
[Save Checkpoint] epoch: [10.0], Train: total:9140.58496, BCE:-12.86039, KLD:3051.14893,Test: total:36302.09375, BCE:-13.00597, KLD:12105.03320
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 2970, epoch 11.0)
score:  54.8
score:  49.6
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 2970, epoch 11.0)
[Save Checkpoint] epoch: [11.0], Train: total:9136.66797, BCE:-12.88765, KLD:3049.85156,Test: total:36234.05078, BCE:-13.05180, KLD:12082.36719
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 3240, epoch 12.0)
score:  54.00333333333333
score:  49.28
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 3240, epoch 12.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [12.0], Train: total:8872.72754, BCE:-12.80148, KLD:2961.84204,Test: total:35215.95703, BCE:-12.98017, KLD:11742.97949
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 3510, epoch 13.0)
score:  53.151666666666664
score:  48.43
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 3510, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train: total:9027.34375, BCE:-13.58919, KLD:3013.64380,Test: total:35800.24609, BCE:-13.83541, KLD:11938.02832
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 3780, epoch 14.0)
score:  51.93666666666667
score:  47.0
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 3780, epoch 14.0)
[Save Checkpoint] epoch: [14.0], Train: total:8836.52051, BCE:-13.33532, KLD:2949.95068,Test: total:35034.75000, BCE:-13.50903, KLD:11682.75293
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 4050, epoch 15.0)
score:  51.815
score:  46.97
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 4050, epoch 15.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [15.0], Train: total:8955.69043, BCE:-13.85278, KLD:2989.84692,Test: total:35517.57422, BCE:-14.07976, KLD:11843.88574
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 4320, epoch 16.0)
score:  51.09166666666667
score:  46.63
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 4320, epoch 16.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [16.0], Train: total:8907.81055, BCE:-14.37759, KLD:2974.06152,Test: total:35344.71875, BCE:-14.64129, KLD:11786.45508
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 4590, epoch 17.0)
score:  50.04833333333333
score:  46.17
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 4590, epoch 17.0)
[Save Checkpoint] epoch: [17.0], Train: total:8745.13770, BCE:-14.26479, KLD:2919.80054,Test: total:34622.35547, BCE:-14.50200, KLD:11545.62012
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 4860, epoch 18.0)
score:  49.401666666666664
score:  44.91
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 4860, epoch 18.0)
[Save Checkpoint] epoch: [18.0], Train: total:8747.04199, BCE:-14.79268, KLD:2920.61206,Test: total:34699.23047, BCE:-15.02782, KLD:11571.41992
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 5130, epoch 19.0)
score:  48.05833333333333
score:  43.51
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 5130, epoch 19.0)
[Save Checkpoint] epoch: [19.0], Train: total:8862.55664, BCE:-15.35054, KLD:2959.30371,Test: total:35094.59766, BCE:-15.61858, KLD:11703.40527
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 5400, epoch 20.0)
score:  47.13166666666667
score:  42.33
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 5400, epoch 20.0)
[Save Checkpoint] epoch: [20.0], Train: total:8792.38574, BCE:-15.60511, KLD:2935.99683,Test: total:34836.29688, BCE:-15.87041, KLD:11617.38770
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 5670, epoch 21.0)
score:  47.93833333333333
score:  43.31
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 5670, epoch 21.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [21.0], Train: total:8757.36621, BCE:-16.23782, KLD:2924.53516,Test: total:34718.41406, BCE:-16.49650, KLD:11578.30273
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 5940, epoch 22.0)
score:  48.59
score:  43.77
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 5940, epoch 22.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [22.0], Train: total:8831.10059, BCE:-17.00841, KLD:2949.36938,Test: total:35015.53125, BCE:-17.25970, KLD:11677.59668
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 6210, epoch 23.0)
score:  47.61833333333333
score:  42.86
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 6210, epoch 23.0)
[Save Checkpoint] epoch: [23.0], Train: total:8918.64941, BCE:-17.22253, KLD:2978.62329,Test: total:35364.20703, BCE:-17.47857, KLD:11793.89648
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 6480, epoch 24.0)
score:  46.04833333333333
score:  41.35
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 6480, epoch 24.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [24.0], Train: total:8710.69336, BCE:-17.07617, KLD:2909.25854,Test: total:34515.98828, BCE:-17.34203, KLD:11511.11035
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 6750, epoch 25.0)
score:  46.181666666666665
score:  40.95
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 6750, epoch 25.0)
[Save Checkpoint] epoch: [25.0], Train: total:8819.99707, BCE:-18.22862, KLD:2946.07471,Test: total:34960.73828, BCE:-18.46145, KLD:11659.73340
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 7020, epoch 26.0)
score:  44.641666666666666
score:  40.19
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 7020, epoch 26.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [26.0], Train: total:8668.51172, BCE:-18.73803, KLD:2895.75024,Test: total:34347.60938, BCE:-18.97277, KLD:11455.52637
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 7290, epoch 27.0)
score:  44.265
score:  40.1
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 7290, epoch 27.0)
[Save Checkpoint] epoch: [27.0], Train: total:8620.99902, BCE:-18.75884, KLD:2879.91821,Test: total:34129.43359, BCE:-19.03280, KLD:11382.82227
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 7560, epoch 28.0)
score:  44.09166666666667
score:  39.84
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 7560, epoch 28.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [28.0], Train: total:8671.54785, BCE:-18.99654, KLD:2896.84961,Test: total:34347.26953, BCE:-19.24162, KLD:11455.50391
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 7830, epoch 29.0)
score:  42.803333333333335
score:  38.64
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 7830, epoch 29.0)
[Save Checkpoint] epoch: [29.0], Train: total:8618.61816, BCE:-19.52038, KLD:2879.38086,Test: total:34115.00391, BCE:-19.73117, KLD:11378.24512
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 8100, epoch 30.0)
score:  41.85666666666667
score:  37.98
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 8100, epoch 30.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [30.0], Train: total:8681.13379, BCE:-19.81050, KLD:2900.31274,Test: total:34352.01172, BCE:-20.03006, KLD:11457.34668
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 8370, epoch 31.0)
score:  43.335
score:  38.91
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 8370, epoch 31.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [31.0], Train: total:8691.44824, BCE:-20.23728, KLD:2903.89478,Test: total:34434.31641, BCE:-20.45000, KLD:11484.92090
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 8640, epoch 32.0)
score:  40.22
score:  36.12
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 8640, epoch 32.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [32.0], Train: total:8455.46387, BCE:-20.30986, KLD:2825.26025,Test: total:33481.20703, BCE:-20.51947, KLD:11167.24121
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 8910, epoch 33.0)
score:  39.93666666666667
score:  35.64
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 8910, epoch 33.0)
[Save Checkpoint] epoch: [33.0], Train: total:8519.50098, BCE:-20.57965, KLD:2846.69385,Test: total:33746.01562, BCE:-20.76131, KLD:11255.59180
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 9180, epoch 34.0)
score:  40.06333333333333
score:  36.84
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 9180, epoch 34.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [34.0], Train: total:8651.91406, BCE:-20.84309, KLD:2890.91870,Test: total:34256.40234, BCE:-21.01642, KLD:11425.80469
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 9450, epoch 35.0)
score:  39.64833333333333
score:  35.39
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 9450, epoch 35.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [35.0], Train: total:8611.55664, BCE:-20.81654, KLD:2877.45898,Test: total:34085.89453, BCE:-21.02787, KLD:11368.97461
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 9720, epoch 36.0)
score:  39.96666666666667
score:  35.34
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 9720, epoch 36.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [36.0], Train: total:8567.73145, BCE:-21.34569, KLD:2863.02539,Test: total:33903.96875, BCE:-21.51966, KLD:11308.49707
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 9990, epoch 37.0)
score:  38.166666666666664
score:  34.56
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 9990, epoch 37.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [37.0], Train: total:8442.38867, BCE:-21.45983, KLD:2821.28198,Test: total:33420.50781, BCE:-21.64567, KLD:11147.38281
Epoch    38: reducing learning rate of group 0 to 2.0000e-04.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 10260, epoch 38.0)
score:  38.348333333333336
score:  34.32
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 10260, epoch 38.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [38.0], Train: total:8368.14160, BCE:-21.31551, KLD:2796.48560,Test: total:33087.42578, BCE:-21.50037, KLD:11036.30762
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 10530, epoch 39.0)
score:  37.415
score:  33.46
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 10530, epoch 39.0)
[Save Checkpoint] epoch: [39.0], Train: total:8549.02832, BCE:-20.75580, KLD:2856.59546,Test: total:33836.04688, BCE:-20.91973, KLD:11285.65625
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 10800, epoch 40.0)
score:  36.93333333333333
score:  33.09
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 10800, epoch 40.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [40.0], Train: total:8542.31055, BCE:-20.95795, KLD:2854.42236,Test: total:33795.49609, BCE:-21.13325, KLD:11272.20898
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 11070, epoch 41.0)
score:  36.935
score:  33.1
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 11070, epoch 41.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [41.0], Train: total:8600.58789, BCE:-20.93711, KLD:2873.84082,Test: total:34017.50781, BCE:-21.06580, KLD:11346.19141
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 11340, epoch 42.0)
score:  36.968333333333334
score:  32.85
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 11340, epoch 42.0)
[Save Checkpoint] epoch: [42.0], Train: total:8613.72754, BCE:-21.20316, KLD:2878.31104,Test: total:34073.86328, BCE:-21.35545, KLD:11365.07031
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 11610, epoch 43.0)
score:  36.52166666666667
score:  32.86
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 11610, epoch 43.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [43.0], Train: total:8548.51172, BCE:-21.00083, KLD:2856.50244,Test: total:33825.91797, BCE:-21.18960, KLD:11282.36719
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 11880, epoch 44.0)
score:  35.858333333333334
score:  31.88
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 11880, epoch 44.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [44.0], Train: total:8529.09668, BCE:-21.09373, KLD:2850.06543,Test: total:33757.76562, BCE:-21.25974, KLD:11259.67676
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 12150, epoch 45.0)
score:  36.3
score:  32.81
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 12150, epoch 45.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [45.0], Train: total:8568.56445, BCE:-21.05826, KLD:2863.20776,Test: total:33920.73828, BCE:-21.20153, KLD:11313.97949
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 12420, epoch 46.0)
score:  36.09
score:  32.43
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 12420, epoch 46.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [46.0], Train: total:8561.46387, BCE:-20.96509, KLD:2860.80981,Test: total:33879.49609, BCE:-21.12053, KLD:11300.20410
Epoch    47: reducing learning rate of group 0 to 4.0000e-05.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 12690, epoch 47.0)
score:  36.085
score:  32.34
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 12690, epoch 47.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [47.0], Train: total:8567.15527, BCE:-21.09334, KLD:2862.75024,Test: total:33896.13672, BCE:-21.25489, KLD:11305.79883
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 12960, epoch 48.0)
score:  36.085
score:  32.48
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 12960, epoch 48.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [48.0], Train: total:8549.80078, BCE:-21.03535, KLD:2856.94580,Test: total:33823.98828, BCE:-21.19726, KLD:11281.72754
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 13230, epoch 49.0)
score:  35.77166666666667
score:  32.31
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 13230, epoch 49.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [49.0], Train: total:8557.13477, BCE:-21.07002, KLD:2859.40015,Test: total:33854.73828, BCE:-21.22791, KLD:11291.98828
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 13500, epoch 50.0)
score:  35.9
score:  32.21
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 13500, epoch 50.0)
EarlyStopping counter: 8 out of 25
[Save Checkpoint] epoch: [50.0], Train: total:8544.24902, BCE:-21.12693, KLD:2855.12354,Test: total:33807.61719, BCE:-21.30100, KLD:11276.30664
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 13770, epoch 51.0)
score:  35.873333333333335
score:  32.59
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 13770, epoch 51.0)
EarlyStopping counter: 9 out of 25
[Save Checkpoint] epoch: [51.0], Train: total:8536.30957, BCE:-21.22965, KLD:2852.51172,Test: total:33773.98047, BCE:-21.39927, KLD:11265.12695
Epoch    52: reducing learning rate of group 0 to 8.0000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 14040, epoch 52.0)
score:  35.65833333333333
score:  31.7
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 14040, epoch 52.0)
EarlyStopping counter: 10 out of 25
[Save Checkpoint] epoch: [52.0], Train: total:8534.56738, BCE:-21.15793, KLD:2851.90869,Test: total:33766.07422, BCE:-21.30756, KLD:11262.46094
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 14310, epoch 53.0)
score:  35.65
score:  31.57
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 14310, epoch 53.0)
EarlyStopping counter: 11 out of 25
[Save Checkpoint] epoch: [53.0], Train: total:8521.42188, BCE:-21.16576, KLD:2847.52905,Test: total:33710.57031, BCE:-21.33237, KLD:11243.96777
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 14580, epoch 54.0)
score:  35.81666666666667
score:  31.98
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 14580, epoch 54.0)
EarlyStopping counter: 12 out of 25
[Save Checkpoint] epoch: [54.0], Train: total:8511.48340, BCE:-21.17474, KLD:2844.21948,Test: total:33670.14453, BCE:-21.31925, KLD:11230.48730
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 14850, epoch 55.0)
score:  35.74333333333333
score:  32.05
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 14850, epoch 55.0)
[Save Checkpoint] epoch: [55.0], Train: total:8534.87207, BCE:-21.19190, KLD:2852.02197,Test: total:33763.65625, BCE:-21.36421, KLD:11261.67480
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 15120, epoch 56.0)
score:  35.74166666666667
score:  31.41
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 15120, epoch 56.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [56.0], Train: total:8534.86230, BCE:-21.18463, KLD:2852.01514,Test: total:33763.30078, BCE:-21.33918, KLD:11261.54590
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 15390, epoch 57.0)
score:  35.711666666666666
score:  31.73
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 15390, epoch 57.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [57.0], Train: total:8528.27930, BCE:-21.17763, KLD:2849.81763,Test: total:33736.66797, BCE:-21.33064, KLD:11252.66699
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 15660, epoch 58.0)
score:  35.505
score:  32.0
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 15660, epoch 58.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [58.0], Train: total:8529.63086, BCE:-21.19341, KLD:2850.27368,Test: total:33742.78516, BCE:-21.32822, KLD:11254.70410
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 15930, epoch 59.0)
score:  35.63
score:  31.89
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 15930, epoch 59.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [59.0], Train: total:8532.79785, BCE:-21.18486, KLD:2851.32617,Test: total:33753.59766, BCE:-21.31805, KLD:11258.30566
Epoch    60: reducing learning rate of group 0 to 1.6000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 16200, epoch 60.0)
score:  35.785
score:  31.58
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 16200, epoch 60.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [60.0], Train: total:8510.61230, BCE:-21.18098, KLD:2843.93018,Test: total:33664.69531, BCE:-21.33789, KLD:11228.67871
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 16470, epoch 61.0)
score:  35.70166666666667
score:  32.22
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 16470, epoch 61.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [61.0], Train: total:8529.77930, BCE:-21.22343, KLD:2850.33472,Test: total:33742.34375, BCE:-21.37961, KLD:11254.57520
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 16740, epoch 62.0)
score:  35.88333333333333
score:  32.36
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 16740, epoch 62.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [62.0], Train: total:8530.05957, BCE:-21.22690, KLD:2850.42749,Test: total:33743.42578, BCE:-21.38750, KLD:11254.93750
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 17010, epoch 63.0)
score:  35.641666666666666
score:  31.72
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 17010, epoch 63.0)
EarlyStopping counter: 8 out of 25
[Save Checkpoint] epoch: [63.0], Train: total:8527.00879, BCE:-21.22112, KLD:2849.41187,Test: total:33731.73047, BCE:-21.40629, KLD:11251.04785
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 17280, epoch 64.0)
score:  35.721666666666664
score:  31.41
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 17280, epoch 64.0)
[Save Checkpoint] epoch: [64.0], Train: total:8529.42383, BCE:-21.24384, KLD:2850.22217,Test: total:33741.08594, BCE:-21.38693, KLD:11254.15723
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 17550, epoch 65.0)
score:  35.54666666666667
score:  32.21
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 17550, epoch 65.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [65.0], Train: total:8534.13086, BCE:-21.23591, KLD:2851.78882,Test: total:33758.99609, BCE:-21.40656, KLD:11260.13281
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 17820, epoch 66.0)
score:  35.61333333333334
score:  31.93
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 17820, epoch 66.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [66.0], Train: total:8532.19043, BCE:-21.25548, KLD:2851.14868,Test: total:33751.87109, BCE:-21.38933, KLD:11257.75488
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 18090, epoch 67.0)
score:  35.645
score:  31.99
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 18090, epoch 67.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [67.0], Train: total:8535.48828, BCE:-21.23212, KLD:2852.24121,Test: total:33764.00000, BCE:-21.37047, KLD:11261.79004
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 18360, epoch 68.0)
score:  35.51
score:  32.18
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 18360, epoch 68.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [68.0], Train: total:8531.71387, BCE:-21.22841, KLD:2850.98218,Test: total:33750.08594, BCE:-21.40162, KLD:11257.16309
Epoch    69: reducing learning rate of group 0 to 1.0000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 18630, epoch 69.0)
score:  35.71
score:  31.94
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 18630, epoch 69.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [69.0], Train: total:8536.65918, BCE:-21.23063, KLD:2852.63062,Test: total:33768.06250, BCE:-21.41854, KLD:11263.16211
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 18900, epoch 70.0)
score:  35.693333333333335
score:  31.77
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 18900, epoch 70.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [70.0], Train: total:8536.35547, BCE:-21.24953, KLD:2852.53491,Test: total:33767.44922, BCE:-21.37085, KLD:11262.94238
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 19170, epoch 71.0)
score:  35.79333333333334
score:  32.25
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 19170, epoch 71.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [71.0], Train: total:8536.34180, BCE:-21.24298, KLD:2852.52710,Test: total:33767.78906, BCE:-21.38121, KLD:11263.05762
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 19440, epoch 72.0)
score:  35.77
score:  31.97
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 19440, epoch 72.0)
[Save Checkpoint] epoch: [72.0], Train: total:8536.38965, BCE:-21.24360, KLD:2852.54443,Test: total:33767.16016, BCE:-21.40590, KLD:11262.85449
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 19710, epoch 73.0)
score:  35.721666666666664
score:  31.68
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 19710, epoch 73.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [73.0], Train: total:8532.53613, BCE:-21.26123, KLD:2851.26782,Test: total:33752.66016, BCE:-21.40253, KLD:11258.02051
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 19980, epoch 74.0)
score:  35.575
score:  31.73
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 19980, epoch 74.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [74.0], Train: total:8535.43457, BCE:-21.24928, KLD:2852.22852,Test: total:33763.95703, BCE:-21.37224, KLD:11261.77637
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 20250, epoch 75.0)
score:  35.82
score:  31.81
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 20250, epoch 75.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [75.0], Train: total:8535.12109, BCE:-21.25678, KLD:2852.12524,Test: total:33763.10547, BCE:-21.42101, KLD:11261.50781
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 20520, epoch 76.0)
score:  35.76833333333333
score:  32.13
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 20520, epoch 76.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [76.0], Train: total:8536.88672, BCE:-21.24534, KLD:2852.71118,Test: total:33769.65234, BCE:-21.38713, KLD:11263.67871
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 20790, epoch 77.0)
score:  35.66166666666667
score:  32.38
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 20790, epoch 77.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [77.0], Train: total:8539.20996, BCE:-21.25477, KLD:2853.48779,Test: total:33779.25391, BCE:-21.40766, KLD:11266.88770
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 21060, epoch 78.0)
score:  35.60333333333333
score:  32.02
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 21060, epoch 78.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [78.0], Train: total:8538.02637, BCE:-21.25542, KLD:2853.09424,Test: total:33774.11719, BCE:-21.42922, KLD:11265.18164
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 21330, epoch 79.0)
score:  35.458333333333336
score:  31.56
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 21330, epoch 79.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [79.0], Train: total:8533.06348, BCE:-21.25521, KLD:2851.44019,Test: total:33754.22266, BCE:-21.39953, KLD:11258.54199
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 21600, epoch 80.0)
score:  35.413333333333334
score:  32.07
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 21600, epoch 80.0)
EarlyStopping counter: 8 out of 25
[Save Checkpoint] epoch: [80.0], Train: total:8533.15625, BCE:-21.23857, KLD:2851.46558,Test: total:33754.50391, BCE:-21.38875, KLD:11258.63086
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 21870, epoch 81.0)
score:  35.535
score:  31.55
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 21870, epoch 81.0)
EarlyStopping counter: 9 out of 25
[Save Checkpoint] epoch: [81.0], Train: total:8539.18066, BCE:-21.23196, KLD:2853.47192,Test: total:33778.62109, BCE:-21.42174, KLD:11266.68066
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 22140, epoch 82.0)
score:  35.73833333333334
score:  31.9
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 22140, epoch 82.0)
EarlyStopping counter: 10 out of 25
[Save Checkpoint] epoch: [82.0], Train: total:8538.89941, BCE:-21.23612, KLD:2853.37793,Test: total:33777.09375, BCE:-21.37544, KLD:11266.15625
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 22410, epoch 83.0)
score:  35.5
score:  32.27
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 22410, epoch 83.0)
EarlyStopping counter: 11 out of 25
[Save Checkpoint] epoch: [83.0], Train: total:8540.53418, BCE:-21.24740, KLD:2853.92700,Test: total:33783.93750, BCE:-21.41902, KLD:11268.45410
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 22680, epoch 84.0)
score:  35.73833333333334
score:  31.57
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 22680, epoch 84.0)
[Save Checkpoint] epoch: [84.0], Train: total:8534.79297, BCE:-21.25469, KLD:2852.01660,Test: total:33761.76172, BCE:-21.39071, KLD:11261.05078
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 22950, epoch 85.0)
score:  35.72666666666667
score:  31.96
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 22950, epoch 85.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [85.0], Train: total:8537.06152, BCE:-21.23936, KLD:2852.76782,Test: total:33770.65234, BCE:-21.39977, KLD:11264.01758
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 23220, epoch 86.0)
score:  35.855
score:  31.76
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 23220, epoch 86.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [86.0], Train: total:8544.87207, BCE:-21.25261, KLD:2855.37476,Test: total:33801.83984, BCE:-21.39099, KLD:11274.41113
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 23490, epoch 87.0)
score:  35.63
score:  31.92
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 23490, epoch 87.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [87.0], Train: total:8541.24512, BCE:-21.24018, KLD:2854.16113,Test: total:33787.54297, BCE:-21.40864, KLD:11269.65137
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 23760, epoch 88.0)
score:  35.67333333333333
score:  31.51
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 23760, epoch 88.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [88.0], Train: total:8542.71387, BCE:-21.23549, KLD:2854.65063,Test: total:33793.10938, BCE:-21.37131, KLD:11271.49316
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 24030, epoch 89.0)
score:  35.651666666666664
score:  31.65
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 24030, epoch 89.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [89.0], Train: total:8541.22461, BCE:-21.23117, KLD:2854.15234,Test: total:33786.46484, BCE:-21.39085, KLD:11269.28418
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 24300, epoch 90.0)
score:  35.53333333333333
score:  31.75
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 24300, epoch 90.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [90.0], Train: total:8538.00391, BCE:-21.23470, KLD:2853.08032,Test: total:33774.43359, BCE:-21.39215, KLD:11265.27539
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 24570, epoch 91.0)
score:  35.75833333333333
score:  31.36
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 24570, epoch 91.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [91.0], Train: total:8540.76074, BCE:-21.24564, KLD:2854.00171,Test: total:33785.30859, BCE:-21.40417, KLD:11268.90527
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 24840, epoch 92.0)
score:  35.6
score:  31.72
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 24840, epoch 92.0)
EarlyStopping counter: 8 out of 25
[Save Checkpoint] epoch: [92.0], Train: total:8538.25293, BCE:-21.24073, KLD:2853.16504,Test: total:33775.20703, BCE:-21.41939, KLD:11265.54199
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 25110, epoch 93.0)
score:  35.568333333333335
score:  31.88
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 25110, epoch 93.0)
EarlyStopping counter: 9 out of 25
[Save Checkpoint] epoch: [93.0], Train: total:8542.75684, BCE:-21.23499, KLD:2854.66553,Test: total:33793.35547, BCE:-21.38992, KLD:11271.58203
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 25380, epoch 94.0)
score:  35.75333333333333
score:  31.82
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 25380, epoch 94.0)
EarlyStopping counter: 10 out of 25
[Save Checkpoint] epoch: [94.0], Train: total:8542.89648, BCE:-21.25347, KLD:2854.71729,Test: total:33793.91406, BCE:-21.41344, KLD:11271.77539
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 25650, epoch 95.0)
score:  35.696666666666665
score:  31.29
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 25650, epoch 95.0)
EarlyStopping counter: 11 out of 25
[Save Checkpoint] epoch: [95.0], Train: total:8540.25781, BCE:-21.24156, KLD:2853.83301,Test: total:33783.94141, BCE:-21.37652, KLD:11268.43945
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 25920, epoch 96.0)
score:  35.625
score:  31.82
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 25920, epoch 96.0)
EarlyStopping counter: 12 out of 25
[Save Checkpoint] epoch: [96.0], Train: total:8538.29785, BCE:-21.25815, KLD:2853.18433,Test: total:33775.30859, BCE:-21.38804, KLD:11265.56738
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 26190, epoch 97.0)
score:  35.625
score:  31.96
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 26190, epoch 97.0)
EarlyStopping counter: 13 out of 25
[Save Checkpoint] epoch: [97.0], Train: total:8536.97070, BCE:-21.24632, KLD:2852.74023,Test: total:33770.62109, BCE:-21.39805, KLD:11264.00586
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 26460, epoch 98.0)
score:  35.56333333333333
score:  31.39
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 26460, epoch 98.0)
EarlyStopping counter: 14 out of 25
[Save Checkpoint] epoch: [98.0], Train: total:8534.66699, BCE:-21.23602, KLD:2851.96924,Test: total:33761.69531, BCE:-21.41659, KLD:11261.03613
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 26730, epoch 99.0)
score:  35.755
score:  31.47
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 26730, epoch 99.0)
EarlyStopping counter: 15 out of 25
[Save Checkpoint] epoch: [99.0], Train: total:8530.96777, BCE:-21.25449, KLD:2850.74194,Test: total:33747.83203, BCE:-21.42051, KLD:11256.41895
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 27000, epoch 100.0)
score:  35.638333333333335
score:  31.48
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_4_beta/last' (iter 27000, epoch 100.0)
EarlyStopping counter: 16 out of 25
[Save Checkpoint] epoch: [100.0], Train: total:8531.06348, BCE:-21.26669, KLD:2850.77588,Test: total:33748.15625, BCE:-21.40189, KLD:11256.51855
[Training Finished]
All done !
