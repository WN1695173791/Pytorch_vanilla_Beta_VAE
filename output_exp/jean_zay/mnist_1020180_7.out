7
--gpu_devices 0 --max_iter 100 --batch_size 250 --use_scheduler True --lr 1e-3 --GMP True --z_struct_size 15 --z_var_size 10 --is_VAE True --is_encoder_struct False --lambda_BCE 1 --beta 1 --lambda_recons 1 --lambda_EV_class 1 --big_kernel_size 8 --two_conv_layer True --three_conv_layer True --kernel_size_1 4 --kernel_size_2 4 --kernel_size_3 4 --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 64 --hidden_filters_layer2 64 --hidden_filters_layer3 64 --dataset_balanced True --binary_z True --binary_first_conv False --binary_second_conv False --binary_third_conv True --use_small_lr_encoder_var False --encoder_var_name None --encoder_struct_name mnist_ES_binary_15 --freeze_Encoder True --EV_classifier True --freeze_Encoder True --grad_inv True --exp_name mnist_VAE_s15_v10_class_inv_grad_5
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, ES_reconstruction=False, EV_classifier=True, GMP=True, Hmg_dst_loss=False, IPC=False, L1_norm_act=False, L1_norm_weights=False, L2_dst_loss=False, L3_without_random=False, LOG_DIR='logs', PT_model=False, PT_model_EV_classifier=False, adapt_lr=False, add_classification_layer=True, add_dl_class=False, add_linear_after_GMP=True, add_z_struct_bottleneck=False, alpha=32, batch_size=250, beta=1.0, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=8, bin_after_GMP=False, binary_chain=False, binary_first_conv=False, binary_second_conv=False, binary_third_conv=True, binary_z=True, both_decoders_freeze=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, contrastive_loss=False, cuda=True, dataset='mnist', dataset_balanced=True, decoder_first_dense=36, decoder_kernel_size_1=4, decoder_kernel_size_2=3, decoder_kernel_size_3=4, decoder_n_filter_1=64, decoder_n_filter_2=64, decoder_n_filter_3=64, decoder_stride_1=2, decoder_stride_2=2, decoder_stride_3=1, diff_var=False, display_step=10000, dset_dir='data', encoder_struct_name='mnist_ES_binary_15', encoder_var_name='None', exp_name='mnist_VAE_s15_v10_class_inv_grad_5', freeze_Encoder=True, gamma=1000, gpu_devices=[0], grad_inv=True, hidden_dim=20, hidden_filters_layer1=64, hidden_filters_layer2=64, hidden_filters_layer3=64, image_size=64, intra_class_variance_loss=False, is_C=True, is_E1=False, is_VAE=True, is_VAE_var=False, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=False, is_default_model=False, is_encoder_struct=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, kernel_size_1=4, kernel_size_2=4, kernel_size_3=4, lambda_BCE=1.0, lambda_EV_class=1.0, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_L2_dst=1, lambda_VAE=1, lambda_class=1, lambda_contrastive_loss=1, lambda_distance_mean=1, lambda_hmg_dst=1, lambda_intra_class_var=1, lambda_partial_class=1, lambda_ratio_reg=1, lambda_recon_wt_rand=1, lambda_recons=1.0, lambda_uniq_code_dst=1, lambda_var_distance=1, lambda_var_inter=1, lambda_var_intra=1, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', loss='Proxy_Anchor', loss_distance_mean=False, loss_min_distance_cl=False, lr=0.001, max_epoch_use_uniq_code_target=5, max_iter=100.0, model='CNN', mrg=0.1, nb_epochs_train_only_zvar=0, num_workers=2, old_weighted=False, optimizer='adamw', other_architecture=False, other_ratio=False, random_percentage=0.2, random_seed=10, randomness=True, ratio_reg=False, remark='', save_step=10000, second_layer_C=False, seed=1, stride_size=1, sz_embedding=5, three_conv_layer=True, train=True, train_var_struct_alternatively=False, two_conv_layer=True, two_encoder=False, uniq_code_dst_loss=False, use_VAE=False, use_decoder=False, use_early_stopping=True, use_scheduler=True, use_small_lr_encoder_var=False, use_structural_encoder=False, value_target_distance_mean=1, var_hidden_dim=256, var_hidden_filters_1=32, var_hidden_filters_2=32, var_hidden_filters_3=32, var_kernel_size_1=3, var_kernel_size_2=3, var_kernel_size_3=3, var_second_cnn_block=True, var_stride_size_1=1, var_stride_size_2=1, var_stride_size_3=1, var_third_cnn_block=False, var_three_conv_layer=False, warm=1, without_acc=False, z_struct_size=15, z_var_size=10, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
[Using Seed: 10]
Balanced dataset loaded
VAE doesn't exist but encoder struct yes ! load struct encoder weighs !
=> loaded checkpoint 'checkpoints_CNN/mnist_ES_binary_15/last (iter 22410)'
Weighs loaded for struct encoder !
use 1 gpu who named: Tesla V100-SXM2-32GB
VAE(
  (encoder_struct): Sequential(
    (0): Conv2d(1, 64, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(64, 64, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(64, 15, kernel_size=(4, 4), stride=(1, 1))
    (7): BatchNorm2d(15, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): AdaptiveMaxPool2d(output_size=(1, 1))
    (10): View()
    (11): DeterministicBinaryActivation(
      (act): Hardsigmoid(
        (act): Hardtanh(min_val=-1.0, max_val=1.0)
      )
    )
  )
  (decoder): Sequential(
    (0): Linear(in_features=25, out_features=1600, bias=True)
    (1): ReLU(inplace=True)
    (2): View()
    (3): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (4): ReLU(inplace=True)
    (5): ConvTranspose2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (6): ReLU(inplace=True)
    (7): ConvTranspose2d(64, 32, kernel_size=(3, 3), stride=(1, 1))
    (8): ReLU(inplace=True)
    (9): ConvTranspose2d(32, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (10): ReLU(inplace=True)
    (11): ConvTranspose2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (12): ReLU(inplace=True)
    (13): ConvTranspose2d(32, 1, kernel_size=(3, 3), stride=(1, 1))
    (14): Sigmoid()
  )
  (encoder_var): Sequential(
    (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1))
    (4): ReLU(inplace=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Conv2d(32, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (7): ReLU(inplace=True)
    (8): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (9): Dropout(p=0.4, inplace=False)
    (10): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1))
    (11): ReLU(inplace=True)
    (12): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (13): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (14): ReLU(inplace=True)
    (15): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Conv2d(64, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (17): ReLU(inplace=True)
    (18): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (19): Dropout(p=0.4, inplace=False)
    (20): View()
    (21): Linear(in_features=1600, out_features=20, bias=True)
  )
  (var_classifier): Sequential(
    (0): RevGrad()
    (1): Linear(in_features=10, out_features=10, bias=True)
  )
)
The number of parameters of model is 499760
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 270, epoch 1.0)
score:  37.94
score:  35.81
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 270, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train: total:5191.07910, BCE:-16.76735, KLD:5207.84521,Test: total:20799.36133, BCE:-16.85348, KLD:20816.21484
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 540, epoch 2.0)
score:  49.745
score:  45.59
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 540, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train: total:4897.20801, BCE:-17.26866, KLD:4914.47656,Test: total:19605.29883, BCE:-17.33500, KLD:19622.63477
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 810, epoch 3.0)
score:  59.56
score:  54.06
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 810, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train: total:4958.88477, BCE:-16.81738, KLD:4975.70215,Test: total:19866.31836, BCE:-16.88206, KLD:19883.20117
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 1080, epoch 4.0)
score:  68.69666666666667
score:  62.16
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 1080, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train: total:4927.15527, BCE:-16.61815, KLD:4943.77344,Test: total:19698.76367, BCE:-16.65877, KLD:19715.42578
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 1350, epoch 5.0)
score:  73.06833333333333
score:  66.32
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 1350, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train: total:4961.66943, BCE:-16.10340, KLD:4977.77197,Test: total:19826.45312, BCE:-16.17831, KLD:19842.63281
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 1620, epoch 6.0)
score:  75.40666666666667
score:  68.29
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 1620, epoch 6.0)
[Save Checkpoint] epoch: [6.0], Train: total:5103.92676, BCE:-14.34803, KLD:5118.27686,Test: total:20367.17773, BCE:-14.41098, KLD:20381.59180
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 1890, epoch 7.0)
score:  77.00666666666666
score:  70.05
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 1890, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train: total:5021.35742, BCE:-14.13846, KLD:5035.49561,Test: total:20042.24609, BCE:-14.22215, KLD:20056.46875
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 2160, epoch 8.0)
score:  78.26
score:  71.2
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 2160, epoch 8.0)
[Save Checkpoint] epoch: [8.0], Train: total:5038.66455, BCE:-14.47550, KLD:5053.13916,Test: total:20106.97266, BCE:-14.58011, KLD:20121.55273
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 2430, epoch 9.0)
score:  78.79833333333333
score:  71.91
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 2430, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train: total:5126.82861, BCE:-14.42324, KLD:5141.25244,Test: total:20462.39258, BCE:-14.55461, KLD:20476.94727
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 2700, epoch 10.0)
score:  79.01166666666667
score:  71.68
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 2700, epoch 10.0)
[Save Checkpoint] epoch: [10.0], Train: total:5179.19629, BCE:-14.98837, KLD:5194.18701,Test: total:20666.38086, BCE:-15.13159, KLD:20681.51367
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 2970, epoch 11.0)
score:  79.585
score:  71.57
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 2970, epoch 11.0)
[Save Checkpoint] epoch: [11.0], Train: total:5094.31982, BCE:-15.13397, KLD:5109.45166,Test: total:20301.46289, BCE:-15.29403, KLD:20316.75781
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 3240, epoch 12.0)
score:  79.53333333333333
score:  72.43
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 3240, epoch 12.0)
[Save Checkpoint] epoch: [12.0], Train: total:5082.79346, BCE:-15.24806, KLD:5098.04346,Test: total:20276.12305, BCE:-15.44970, KLD:20291.57227
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 3510, epoch 13.0)
score:  79.63666666666667
score:  72.26
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 3510, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train: total:5052.62842, BCE:-15.28826, KLD:5067.91943,Test: total:20101.09766, BCE:-15.48222, KLD:20116.58008
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 3780, epoch 14.0)
score:  79.89833333333333
score:  72.36
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 3780, epoch 14.0)
[Save Checkpoint] epoch: [14.0], Train: total:5045.12842, BCE:-14.37411, KLD:5059.50586,Test: total:20107.89258, BCE:-14.58162, KLD:20122.47461
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 4050, epoch 15.0)
score:  79.74166666666666
score:  72.28
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 4050, epoch 15.0)
[Save Checkpoint] epoch: [15.0], Train: total:5048.04834, BCE:-14.58083, KLD:5062.62842,Test: total:20093.63086, BCE:-14.77794, KLD:20108.41406
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 4320, epoch 16.0)
score:  79.54166666666667
score:  72.15
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 4320, epoch 16.0)
[Save Checkpoint] epoch: [16.0], Train: total:5096.13477, BCE:-15.45189, KLD:5111.58545,Test: total:20282.53320, BCE:-15.71957, KLD:20298.25195
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 4590, epoch 17.0)
score:  79.395
score:  72.33
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 4590, epoch 17.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [17.0], Train: total:5017.44434, BCE:-15.04340, KLD:5032.48535,Test: total:19968.36523, BCE:-15.30586, KLD:19983.67383
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 4860, epoch 18.0)
score:  79.40333333333334
score:  71.9
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 4860, epoch 18.0)
[Save Checkpoint] epoch: [18.0], Train: total:5024.74219, BCE:-15.76635, KLD:5040.51172,Test: total:20005.33008, BCE:-16.05005, KLD:20021.37891
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 5130, epoch 19.0)
score:  79.30833333333334
score:  71.73
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 5130, epoch 19.0)
[Save Checkpoint] epoch: [19.0], Train: total:5001.17920, BCE:-16.10222, KLD:5017.28125,Test: total:19907.16211, BCE:-16.40964, KLD:19923.57227
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 5400, epoch 20.0)
score:  78.83333333333333
score:  71.46
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 5400, epoch 20.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [20.0], Train: total:5005.55859, BCE:-16.19378, KLD:5021.75342,Test: total:19922.68555, BCE:-16.47356, KLD:19939.16016
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 5670, epoch 21.0)
score:  78.51166666666667
score:  71.01
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 5670, epoch 21.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [21.0], Train: total:5044.77686, BCE:-16.56287, KLD:5061.33984,Test: total:20067.44531, BCE:-16.84107, KLD:20084.28711
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 5940, epoch 22.0)
score:  78.47833333333334
score:  71.18
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 5940, epoch 22.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [22.0], Train: total:5081.97607, BCE:-16.88076, KLD:5098.85742,Test: total:20216.86523, BCE:-17.15877, KLD:20234.02148
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 6210, epoch 23.0)
score:  78.39666666666666
score:  70.94
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 6210, epoch 23.0)
[Save Checkpoint] epoch: [23.0], Train: total:4988.66211, BCE:-17.30368, KLD:5005.96387,Test: total:19846.23242, BCE:-17.61396, KLD:19863.84375
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 6480, epoch 24.0)
score:  78.45833333333333
score:  70.79
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 6480, epoch 24.0)
[Save Checkpoint] epoch: [24.0], Train: total:4981.58301, BCE:-17.66141, KLD:4999.24805,Test: total:19823.99023, BCE:-17.95840, KLD:19841.94922
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 6750, epoch 25.0)
score:  77.705
score:  70.31
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 6750, epoch 25.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [25.0], Train: total:4991.79785, BCE:-18.10471, KLD:5009.90381,Test: total:19863.91211, BCE:-18.40375, KLD:19882.31641
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 7020, epoch 26.0)
score:  77.92166666666667
score:  70.21
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 7020, epoch 26.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [26.0], Train: total:4963.40625, BCE:-18.85058, KLD:4982.25635,Test: total:19737.16406, BCE:-19.18989, KLD:19756.35352
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 7290, epoch 27.0)
score:  77.76666666666667
score:  70.18
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 7290, epoch 27.0)
[Save Checkpoint] epoch: [27.0], Train: total:5062.87207, BCE:-18.67268, KLD:5081.54297,Test: total:20122.80469, BCE:-18.98668, KLD:20141.78906
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 7560, epoch 28.0)
score:  77.82666666666667
score:  70.38
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 7560, epoch 28.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [28.0], Train: total:4972.98145, BCE:-19.25421, KLD:4992.23438,Test: total:19764.39648, BCE:-19.59746, KLD:19783.99414
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 7830, epoch 29.0)
score:  77.38666666666667
score:  69.92
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 7830, epoch 29.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [29.0], Train: total:5006.02295, BCE:-19.39567, KLD:5025.41943,Test: total:19895.02930, BCE:-19.71673, KLD:19914.74805
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 8100, epoch 30.0)
score:  76.96
score:  69.86
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 8100, epoch 30.0)
[Save Checkpoint] epoch: [30.0], Train: total:4996.10352, BCE:-20.13682, KLD:5016.24170,Test: total:19882.50781, BCE:-20.45470, KLD:19902.96094
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 8370, epoch 31.0)
score:  76.97333333333333
score:  69.78
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 8370, epoch 31.0)
[Save Checkpoint] epoch: [31.0], Train: total:4982.54980, BCE:-20.37938, KLD:5002.92871,Test: total:19824.12891, BCE:-20.68020, KLD:19844.81055
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 8640, epoch 32.0)
score:  76.83833333333334
score:  69.36
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 8640, epoch 32.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [32.0], Train: total:4944.57910, BCE:-20.45483, KLD:4965.03516,Test: total:19643.80273, BCE:-20.74754, KLD:19664.55078
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 8910, epoch 33.0)
score:  76.715
score:  69.18
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 8910, epoch 33.0)
[Save Checkpoint] epoch: [33.0], Train: total:5023.71973, BCE:-21.25788, KLD:5044.97949,Test: total:19966.08008, BCE:-21.53097, KLD:19987.61328
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 9180, epoch 34.0)
score:  76.55833333333334
score:  69.14
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 9180, epoch 34.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [34.0], Train: total:4952.80615, BCE:-21.20025, KLD:4974.00684,Test: total:19695.50000, BCE:-21.47353, KLD:19716.97461
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 9450, epoch 35.0)
score:  76.23666666666666
score:  68.59
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 9450, epoch 35.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [35.0], Train: total:4922.12549, BCE:-21.40549, KLD:4943.53174,Test: total:19568.52148, BCE:-21.71303, KLD:19590.23242
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 9720, epoch 36.0)
score:  75.815
score:  68.26
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 9720, epoch 36.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [36.0], Train: total:4988.24365, BCE:-21.94395, KLD:5010.18506,Test: total:19824.45312, BCE:-22.22359, KLD:19846.67773
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 9990, epoch 37.0)
score:  75.72666666666667
score:  68.61
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 9990, epoch 37.0)
[Save Checkpoint] epoch: [37.0], Train: total:4989.18018, BCE:-21.86756, KLD:5011.04834,Test: total:19832.29492, BCE:-22.12163, KLD:19854.41797
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 10260, epoch 38.0)
score:  75.13333333333334
score:  68.02
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 10260, epoch 38.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [38.0], Train: total:5000.31396, BCE:-21.95805, KLD:5022.26904,Test: total:19865.85742, BCE:-22.23490, KLD:19888.09180
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 10530, epoch 39.0)
score:  75.41166666666666
score:  68.39
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 10530, epoch 39.0)
[Save Checkpoint] epoch: [39.0], Train: total:4958.89111, BCE:-21.94221, KLD:4980.83252,Test: total:19690.03711, BCE:-22.19894, KLD:19712.23438
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 10800, epoch 40.0)
score:  75.095
score:  68.19
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 10800, epoch 40.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [40.0], Train: total:4967.56543, BCE:-22.41569, KLD:4989.98145,Test: total:19742.27734, BCE:-22.67551, KLD:19764.95117
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 11070, epoch 41.0)
score:  75.39666666666666
score:  68.09
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 11070, epoch 41.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [41.0], Train: total:5053.67676, BCE:-22.41265, KLD:5076.08838,Test: total:20077.31836, BCE:-22.64465, KLD:20099.96094
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 11340, epoch 42.0)
score:  74.84666666666666
score:  67.59
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 11340, epoch 42.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [42.0], Train: total:4929.52637, BCE:-22.76200, KLD:4952.28857,Test: total:19583.60742, BCE:-23.01023, KLD:19606.61523
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 11610, epoch 43.0)
score:  74.92833333333333
score:  67.77
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 11610, epoch 43.0)
[Save Checkpoint] epoch: [43.0], Train: total:4997.39648, BCE:-22.96557, KLD:5020.36133,Test: total:19854.08398, BCE:-23.21918, KLD:19877.30273
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 11880, epoch 44.0)
score:  74.33
score:  67.43
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 11880, epoch 44.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [44.0], Train: total:4965.50586, BCE:-23.09546, KLD:4988.60303,Test: total:19727.11523, BCE:-23.31492, KLD:19750.42969
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 12150, epoch 45.0)
score:  74.255
score:  67.28
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 12150, epoch 45.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [45.0], Train: total:4928.67285, BCE:-23.21222, KLD:4951.88574,Test: total:19579.29492, BCE:-23.44699, KLD:19602.74023
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 12420, epoch 46.0)
score:  74.10166666666667
score:  66.98
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 12420, epoch 46.0)
[Save Checkpoint] epoch: [46.0], Train: total:5017.77393, BCE:-23.47138, KLD:5041.24365,Test: total:19942.44141, BCE:-23.70612, KLD:19966.14844
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 12690, epoch 47.0)
score:  73.605
score:  66.76
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 12690, epoch 47.0)
[Save Checkpoint] epoch: [47.0], Train: total:4936.14893, BCE:-23.39816, KLD:4959.54736,Test: total:19602.03711, BCE:-23.63805, KLD:19625.67773
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 12960, epoch 48.0)
score:  73.625
score:  66.49
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 12960, epoch 48.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [48.0], Train: total:4956.37695, BCE:-23.40206, KLD:4979.77637,Test: total:19694.11133, BCE:-23.65102, KLD:19717.76367
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 13230, epoch 49.0)
score:  73.75666666666666
score:  66.73
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 13230, epoch 49.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [49.0], Train: total:4941.72803, BCE:-23.93408, KLD:4965.66260,Test: total:19627.43555, BCE:-24.16841, KLD:19651.60742
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 13500, epoch 50.0)
score:  73.61666666666666
score:  66.48
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 13500, epoch 50.0)
[Save Checkpoint] epoch: [50.0], Train: total:4949.07568, BCE:-24.09887, KLD:4973.18066,Test: total:19665.32812, BCE:-24.34258, KLD:19689.66992
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 13770, epoch 51.0)
score:  73.485
score:  66.46
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 13770, epoch 51.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [51.0], Train: total:4926.92529, BCE:-24.07127, KLD:4950.99756,Test: total:19566.08984, BCE:-24.28903, KLD:19590.38086
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 14040, epoch 52.0)
score:  73.05833333333334
score:  66.12
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 14040, epoch 52.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [52.0], Train: total:4948.24316, BCE:-24.01102, KLD:4972.25439,Test: total:19657.10547, BCE:-24.21998, KLD:19681.32422
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 14310, epoch 53.0)
score:  72.76333333333334
score:  65.62
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 14310, epoch 53.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [53.0], Train: total:4908.33643, BCE:-23.99251, KLD:4932.32959,Test: total:19496.14453, BCE:-24.18350, KLD:19520.32617
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 14580, epoch 54.0)
score:  72.53
score:  65.92
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 14580, epoch 54.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [54.0], Train: total:4954.56543, BCE:-24.06355, KLD:4978.62939,Test: total:19687.16992, BCE:-24.27770, KLD:19711.45117
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 14850, epoch 55.0)
score:  72.80333333333333
score:  66.18
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 14850, epoch 55.0)
[Save Checkpoint] epoch: [55.0], Train: total:4945.47461, BCE:-24.18007, KLD:4969.65869,Test: total:19653.10156, BCE:-24.35746, KLD:19677.46289
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 15120, epoch 56.0)
score:  72.455
score:  65.63
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 15120, epoch 56.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [56.0], Train: total:4872.06445, BCE:-24.23427, KLD:4896.29980,Test: total:19356.83203, BCE:-24.43284, KLD:19381.26562
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 15390, epoch 57.0)
score:  72.19
score:  65.78
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 15390, epoch 57.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [57.0], Train: total:4944.89014, BCE:-24.32363, KLD:4969.21338,Test: total:19652.40430, BCE:-24.53546, KLD:19676.93945
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 15660, epoch 58.0)
score:  71.945
score:  65.35
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 15660, epoch 58.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [58.0], Train: total:4898.88037, BCE:-24.47112, KLD:4923.35303,Test: total:19474.29492, BCE:-24.65255, KLD:19498.94727
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 15930, epoch 59.0)
score:  72.16
score:  65.72
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 15930, epoch 59.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [59.0], Train: total:4930.31934, BCE:-24.65084, KLD:4954.97168,Test: total:19582.42773, BCE:-24.81971, KLD:19607.24805
Epoch    60: reducing learning rate of group 0 to 2.0000e-04.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 16200, epoch 60.0)
score:  71.51166666666667
score:  64.62
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 16200, epoch 60.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [60.0], Train: total:4885.42969, BCE:-25.11621, KLD:4910.54932,Test: total:19404.28125, BCE:-25.26472, KLD:19429.54688
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 16470, epoch 61.0)
score:  71.46666666666667
score:  64.73
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 16470, epoch 61.0)
[Save Checkpoint] epoch: [61.0], Train: total:4906.53809, BCE:-24.86281, KLD:4931.40039,Test: total:19489.46680, BCE:-25.04279, KLD:19514.50977
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 16740, epoch 62.0)
score:  71.475
score:  64.83
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 16740, epoch 62.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [62.0], Train: total:4891.37939, BCE:-24.90887, KLD:4916.28809,Test: total:19430.02930, BCE:-25.10038, KLD:19455.12891
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 17010, epoch 63.0)
score:  71.33666666666667
score:  64.6
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 17010, epoch 63.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [63.0], Train: total:4907.41797, BCE:-24.88715, KLD:4932.30615,Test: total:19489.28516, BCE:-25.06812, KLD:19514.35352
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 17280, epoch 64.0)
score:  71.37
score:  64.78
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 17280, epoch 64.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [64.0], Train: total:4897.63086, BCE:-24.86608, KLD:4922.49561,Test: total:19449.01953, BCE:-25.02876, KLD:19474.04688
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 17550, epoch 65.0)
score:  71.6
score:  65.02
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 17550, epoch 65.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [65.0], Train: total:4909.85254, BCE:-24.96872, KLD:4934.82178,Test: total:19502.64062, BCE:-25.15247, KLD:19527.79492
Epoch    66: reducing learning rate of group 0 to 4.0000e-05.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 17820, epoch 66.0)
score:  71.23666666666666
score:  64.9
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 17820, epoch 66.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [66.0], Train: total:4888.37646, BCE:-24.89777, KLD:4913.27295,Test: total:19414.21289, BCE:-25.08105, KLD:19439.29492
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 18090, epoch 67.0)
score:  71.10666666666667
score:  64.72
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 18090, epoch 67.0)
[Save Checkpoint] epoch: [67.0], Train: total:4893.33594, BCE:-24.96706, KLD:4918.30273,Test: total:19435.43555, BCE:-25.14999, KLD:19460.58594
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 18360, epoch 68.0)
score:  71.13333333333334
score:  64.67
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 18360, epoch 68.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [68.0], Train: total:4889.29785, BCE:-25.05384, KLD:4914.35205,Test: total:19420.29102, BCE:-25.24082, KLD:19445.53125
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 18630, epoch 69.0)
score:  71.18666666666667
score:  64.75
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 18630, epoch 69.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [69.0], Train: total:4907.39551, BCE:-25.06108, KLD:4932.45557,Test: total:19489.17578, BCE:-25.26610, KLD:19514.43945
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 18900, epoch 70.0)
score:  71.26833333333333
score:  64.2
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 18900, epoch 70.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [70.0], Train: total:4892.51123, BCE:-25.20089, KLD:4917.71387,Test: total:19431.86523, BCE:-25.37140, KLD:19457.23438
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 19170, epoch 71.0)
score:  71.265
score:  64.91
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 19170, epoch 71.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [71.0], Train: total:4899.39551, BCE:-25.14171, KLD:4924.53906,Test: total:19459.93164, BCE:-25.33383, KLD:19485.26562
Epoch    72: reducing learning rate of group 0 to 8.0000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 19440, epoch 72.0)
score:  71.14666666666666
score:  64.51
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 19440, epoch 72.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [72.0], Train: total:4901.29980, BCE:-25.14039, KLD:4926.44141,Test: total:19466.26367, BCE:-25.34952, KLD:19491.60938
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 19710, epoch 73.0)
score:  71.17333333333333
score:  64.29
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 19710, epoch 73.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [73.0], Train: total:4887.14404, BCE:-25.12192, KLD:4912.26660,Test: total:19410.86719, BCE:-25.32718, KLD:19436.19336
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 19980, epoch 74.0)
score:  71.11666666666666
score:  64.56
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 19980, epoch 74.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [74.0], Train: total:4892.24414, BCE:-25.15326, KLD:4917.39453,Test: total:19430.89844, BCE:-25.31571, KLD:19456.21094
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 20250, epoch 75.0)
score:  71.27166666666666
score:  64.82
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 20250, epoch 75.0)
EarlyStopping counter: 8 out of 25
[Save Checkpoint] epoch: [75.0], Train: total:4889.87207, BCE:-25.16672, KLD:4915.04150,Test: total:19421.54297, BCE:-25.34511, KLD:19446.88867
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 20520, epoch 76.0)
score:  70.99166666666666
score:  64.53
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 20520, epoch 76.0)
EarlyStopping counter: 9 out of 25
[Save Checkpoint] epoch: [76.0], Train: total:4892.07178, BCE:-25.17189, KLD:4917.24316,Test: total:19429.95703, BCE:-25.34681, KLD:19455.30273
Epoch    77: reducing learning rate of group 0 to 1.6000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 20790, epoch 77.0)
score:  71.075
score:  64.34
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 20790, epoch 77.0)
EarlyStopping counter: 10 out of 25
[Save Checkpoint] epoch: [77.0], Train: total:4892.89746, BCE:-25.16623, KLD:4918.06348,Test: total:19433.31445, BCE:-25.35721, KLD:19458.67188
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 21060, epoch 78.0)
score:  71.23166666666667
score:  64.65
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 21060, epoch 78.0)
EarlyStopping counter: 11 out of 25
[Save Checkpoint] epoch: [78.0], Train: total:4895.94775, BCE:-25.21160, KLD:4921.15869,Test: total:19445.74805, BCE:-25.38456, KLD:19471.13281
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 21330, epoch 79.0)
score:  71.275
score:  64.59
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 21330, epoch 79.0)
EarlyStopping counter: 12 out of 25
[Save Checkpoint] epoch: [79.0], Train: total:4897.06543, BCE:-25.21062, KLD:4922.27637,Test: total:19450.33398, BCE:-25.40935, KLD:19475.74219
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 21600, epoch 80.0)
score:  71.15666666666667
score:  64.11
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 21600, epoch 80.0)
EarlyStopping counter: 13 out of 25
[Save Checkpoint] epoch: [80.0], Train: total:4894.98633, BCE:-25.20402, KLD:4920.19141,Test: total:19441.99805, BCE:-25.38431, KLD:19467.38086
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 21870, epoch 81.0)
score:  71.08833333333334
score:  64.27
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 21870, epoch 81.0)
EarlyStopping counter: 14 out of 25
[Save Checkpoint] epoch: [81.0], Train: total:4895.75879, BCE:-25.22173, KLD:4920.97998,Test: total:19445.21680, BCE:-25.39170, KLD:19470.60938
Epoch    82: reducing learning rate of group 0 to 1.0000e-06.
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 22140, epoch 82.0)
score:  71.31833333333333
score:  63.99
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 22140, epoch 82.0)
EarlyStopping counter: 15 out of 25
[Save Checkpoint] epoch: [82.0], Train: total:4895.30518, BCE:-25.21083, KLD:4920.51514,Test: total:19443.59961, BCE:-25.39076, KLD:19468.98828
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 22410, epoch 83.0)
score:  71.15666666666667
score:  64.45
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 22410, epoch 83.0)
EarlyStopping counter: 16 out of 25
[Save Checkpoint] epoch: [83.0], Train: total:4894.67041, BCE:-25.22087, KLD:4919.89355,Test: total:19441.11523, BCE:-25.40691, KLD:19466.52148
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 22680, epoch 84.0)
score:  71.15
score:  64.52
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 22680, epoch 84.0)
[Save Checkpoint] epoch: [84.0], Train: total:4893.66748, BCE:-25.23269, KLD:4918.89941,Test: total:19437.37500, BCE:-25.39891, KLD:19462.77148
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 22950, epoch 85.0)
score:  71.215
score:  64.33
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 22950, epoch 85.0)
EarlyStopping counter: 1 out of 25
[Save Checkpoint] epoch: [85.0], Train: total:4894.37842, BCE:-25.22942, KLD:4919.60742,Test: total:19440.04492, BCE:-25.42251, KLD:19465.46875
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 23220, epoch 86.0)
score:  71.03833333333333
score:  64.27
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 23220, epoch 86.0)
EarlyStopping counter: 2 out of 25
[Save Checkpoint] epoch: [86.0], Train: total:4896.51807, BCE:-25.23022, KLD:4921.74756,Test: total:19448.38086, BCE:-25.39905, KLD:19473.77930
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 23490, epoch 87.0)
score:  71.14666666666666
score:  64.78
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 23490, epoch 87.0)
EarlyStopping counter: 3 out of 25
[Save Checkpoint] epoch: [87.0], Train: total:4895.35303, BCE:-25.22622, KLD:4920.58105,Test: total:19443.80469, BCE:-25.40990, KLD:19469.21289
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 23760, epoch 88.0)
score:  71.20833333333333
score:  64.61
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 23760, epoch 88.0)
EarlyStopping counter: 4 out of 25
[Save Checkpoint] epoch: [88.0], Train: total:4895.85352, BCE:-25.23054, KLD:4921.08496,Test: total:19445.67578, BCE:-25.41052, KLD:19471.08398
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 24030, epoch 89.0)
score:  71.24
score:  64.09
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 24030, epoch 89.0)
EarlyStopping counter: 5 out of 25
[Save Checkpoint] epoch: [89.0], Train: total:4896.24463, BCE:-25.24159, KLD:4921.48828,Test: total:19447.48242, BCE:-25.41501, KLD:19472.89648
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 24300, epoch 90.0)
score:  71.15333333333334
score:  64.79
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 24300, epoch 90.0)
EarlyStopping counter: 6 out of 25
[Save Checkpoint] epoch: [90.0], Train: total:4895.47266, BCE:-25.22951, KLD:4920.70117,Test: total:19444.37891, BCE:-25.41434, KLD:19469.79492
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 24570, epoch 91.0)
score:  71.19
score:  64.45
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 24570, epoch 91.0)
EarlyStopping counter: 7 out of 25
[Save Checkpoint] epoch: [91.0], Train: total:4893.84229, BCE:-25.23386, KLD:4919.07861,Test: total:19438.16992, BCE:-25.41396, KLD:19463.58398
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 24840, epoch 92.0)
score:  71.35
score:  64.47
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 24840, epoch 92.0)
EarlyStopping counter: 8 out of 25
[Save Checkpoint] epoch: [92.0], Train: total:4894.26221, BCE:-25.23218, KLD:4919.49609,Test: total:19439.79297, BCE:-25.42211, KLD:19465.21484
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 25110, epoch 93.0)
score:  71.22833333333334
score:  64.96
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 25110, epoch 93.0)
EarlyStopping counter: 9 out of 25
[Save Checkpoint] epoch: [93.0], Train: total:4896.36621, BCE:-25.23343, KLD:4921.59814,Test: total:19447.99219, BCE:-25.41449, KLD:19473.40625
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 25380, epoch 94.0)
score:  71.05833333333334
score:  64.67
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 25380, epoch 94.0)
EarlyStopping counter: 10 out of 25
[Save Checkpoint] epoch: [94.0], Train: total:4895.74512, BCE:-25.23319, KLD:4920.97803,Test: total:19445.54297, BCE:-25.40753, KLD:19470.95117
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 25650, epoch 95.0)
score:  71.01333333333334
score:  64.26
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 25650, epoch 95.0)
EarlyStopping counter: 11 out of 25
[Save Checkpoint] epoch: [95.0], Train: total:4894.37061, BCE:-25.23321, KLD:4919.60303,Test: total:19440.31250, BCE:-25.40289, KLD:19465.71484
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 25920, epoch 96.0)
score:  71.10333333333334
score:  64.79
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 25920, epoch 96.0)
EarlyStopping counter: 12 out of 25
[Save Checkpoint] epoch: [96.0], Train: total:4896.72852, BCE:-25.23719, KLD:4921.96680,Test: total:19449.55859, BCE:-25.42463, KLD:19474.98242
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 26190, epoch 97.0)
score:  71.05666666666667
score:  64.61
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 26190, epoch 97.0)
EarlyStopping counter: 13 out of 25
[Save Checkpoint] epoch: [97.0], Train: total:4894.84326, BCE:-25.24331, KLD:4920.08691,Test: total:19442.29883, BCE:-25.42641, KLD:19467.72461
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 26460, epoch 98.0)
score:  71.15833333333333
score:  64.28
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 26460, epoch 98.0)
EarlyStopping counter: 14 out of 25
[Save Checkpoint] epoch: [98.0], Train: total:4895.08447, BCE:-25.22897, KLD:4920.31201,Test: total:19443.03711, BCE:-25.42875, KLD:19468.46289
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 26730, epoch 99.0)
score:  71.15
score:  64.63
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 26730, epoch 99.0)
EarlyStopping counter: 15 out of 25
[Save Checkpoint] epoch: [99.0], Train: total:4894.63672, BCE:-25.23872, KLD:4919.87842,Test: total:19441.26172, BCE:-25.41524, KLD:19466.67969
=> saved checkpoint 'checkpoints_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 27000, epoch 100.0)
score:  71.20333333333333
score:  64.44
=> saved checkpoint 'checkpoint_scores_CNN/mnist_VAE_s15_v10_class_inv_grad_5/last' (iter 27000, epoch 100.0)
EarlyStopping counter: 16 out of 25
[Save Checkpoint] epoch: [100.0], Train: total:4894.94727, BCE:-25.23505, KLD:4920.18359,Test: total:19442.50586, BCE:-25.42850, KLD:19467.93164
[Training Finished]
All done !
