12
--dataset mnist --model CNN --gpu_devices 0 1 --max_iter 100 --batch_size 128 --ckpt_dir checkpoints_CNN --ckpt_dir_scores checkpoint_scores_CNN --use_scheduler True --GMP True --lr 1e-3 --z_struct_size 20 --add_classification_layer True --classif_layer_size 30 --is_default_model False --is_custom_model False --is_custom_model_BK True --big_kernel_size 8 --two_conv_layer True --three_conv_layer False --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 32 --hidden_filters_layer2 32 --hidden_filters_layer3 32 --ratio_reg True --lambda_ratio_reg 0.01 --lambda_class 1 --exp_name CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, GMP=True, L1_norm_act=False, L1_norm_weights=False, L3_without_random=False, adapt_lr=False, add_classification_layer=True, add_linear_after_GMP=True, add_z_struct_bottleneck=False, batch_size=128, beta=1, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=[8], binary_z=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, cuda=True, dataset='mnist', display_step=10000, dset_dir='data', exp_name='CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3', gamma=1000, gpu_devices=[0, 1], hidden_filters_layer1=32, hidden_filters_layer2=32, hidden_filters_layer3=32, image_size=64, is_C=True, is_E1=False, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=True, is_default_model=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_VAE=1, lambda_class=1.0, lambda_partial_class=1, lambda_ratio_reg=0.01, lambda_recon_wt_rand=1, lambda_recons=1, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', lr=0.001, max_iter=100.0, model='CNN', num_workers=2, old_weighted=False, other_ratio=False, random_percentage=0.2, ratio_reg=True, save_step=10000, second_layer_C=False, seed=1, stride_size=1, three_conv_layer=False, train=True, two_conv_layer=True, two_encoder=False, use_early_stopping=False, use_scheduler=True, z_struct_size=20, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
Custom_CNN_BK(
  (net): Sequential(
    (0): Conv2d(1, 32, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(32, 32, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): AdaptiveMaxPool2d(output_size=(1, 1))
    (7): View()
    (8): Linear(in_features=32, out_features=20, bias=True)
    (9): BatchNorm1d(20, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (10): ReLU(inplace=True)
    (11): Dropout(p=0.4, inplace=False)
    (12): Linear(in_features=20, out_features=30, bias=True)
    (13): BatchNorm1d(30, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU(inplace=True)
    (15): Dropout(p=0.4, inplace=False)
    (16): Linear(in_features=30, out_features=10, bias=True)
    (17): Softmax(dim=None)
  )
)
The number of parameters of model is 20324
use 1 gpu who named: Tesla V100-SXM2-32GB
=> loaded sample_scores and losses
=> no checkpoint found at 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last'
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 469, epoch 1.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 469, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train score:68.86000, Test score:68.70000, train loss:-0.67695, test loss:-0.67485, ratio_train_loss:0.41579,ratio_test_loss:0.40124, total_loss_train:-0.26116,total_loss_test:-0.27360, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 938, epoch 2.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 938, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train score:95.54500, Test score:95.77000, train loss:-0.92550, test loss:-0.92815, ratio_train_loss:0.28070,ratio_test_loss:0.27329, total_loss_train:-0.64479,total_loss_test:-0.65487, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 1407, epoch 3.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 1407, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train score:96.78000, Test score:96.89000, train loss:-0.96204, test loss:-0.96343, ratio_train_loss:0.25173,ratio_test_loss:0.24124, total_loss_train:-0.71032,total_loss_test:-0.72219, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 1876, epoch 4.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 1876, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train score:97.30667, Test score:97.44000, train loss:-0.96946, test loss:-0.97118, ratio_train_loss:0.23274,ratio_test_loss:0.22463, total_loss_train:-0.73672,total_loss_test:-0.74656, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 2345, epoch 5.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 2345, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train score:97.53667, Test score:97.65000, train loss:-0.97309, test loss:-0.97436, ratio_train_loss:0.22682,ratio_test_loss:0.22125, total_loss_train:-0.74627,total_loss_test:-0.75311, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 2814, epoch 6.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 2814, epoch 6.0)
[Save Checkpoint] epoch: [6.0], Train score:96.83667, Test score:96.86000, train loss:-0.96637, test loss:-0.96680, ratio_train_loss:0.22284,ratio_test_loss:0.21770, total_loss_train:-0.74353,total_loss_test:-0.74910, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 3283, epoch 7.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 3283, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train score:97.70333, Test score:97.70000, train loss:-0.97547, test loss:-0.97604, ratio_train_loss:0.20906,ratio_test_loss:0.20115, total_loss_train:-0.76642,total_loss_test:-0.77489, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 3752, epoch 8.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 3752, epoch 8.0)
[Save Checkpoint] epoch: [8.0], Train score:97.96500, Test score:97.88000, train loss:-0.97843, test loss:-0.97775, ratio_train_loss:0.20731,ratio_test_loss:0.20173, total_loss_train:-0.77112,total_loss_test:-0.77603, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 4221, epoch 9.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 4221, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train score:97.97000, Test score:98.09000, train loss:-0.97858, test loss:-0.97985, ratio_train_loss:0.20713,ratio_test_loss:0.20055, total_loss_train:-0.77144,total_loss_test:-0.77930, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 4690, epoch 10.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 4690, epoch 10.0)
[Save Checkpoint] epoch: [10.0], Train score:97.91000, Test score:97.85000, train loss:-0.97833, test loss:-0.97787, ratio_train_loss:0.19799,ratio_test_loss:0.19276, total_loss_train:-0.78035,total_loss_test:-0.78511, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 5159, epoch 11.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 5159, epoch 11.0)
[Save Checkpoint] epoch: [11.0], Train score:98.12167, Test score:97.90000, train loss:-0.98013, test loss:-0.97847, ratio_train_loss:0.21672,ratio_test_loss:0.21459, total_loss_train:-0.76341,total_loss_test:-0.76388, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 5628, epoch 12.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 5628, epoch 12.0)
[Save Checkpoint] epoch: [12.0], Train score:97.97500, Test score:97.93000, train loss:-0.97899, test loss:-0.97875, ratio_train_loss:0.20200,ratio_test_loss:0.20040, total_loss_train:-0.77699,total_loss_test:-0.77835, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 6097, epoch 13.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 6097, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train score:97.90500, Test score:97.79000, train loss:-0.97832, test loss:-0.97712, ratio_train_loss:0.19784,ratio_test_loss:0.19471, total_loss_train:-0.78048,total_loss_test:-0.78241, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 6566, epoch 14.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 6566, epoch 14.0)
[Save Checkpoint] epoch: [14.0], Train score:98.27000, Test score:98.07000, train loss:-0.98202, test loss:-0.98016, ratio_train_loss:0.18944,ratio_test_loss:0.18420, total_loss_train:-0.79258,total_loss_test:-0.79596, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 7035, epoch 15.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 7035, epoch 15.0)
[Save Checkpoint] epoch: [15.0], Train score:98.17500, Test score:98.16000, train loss:-0.98123, test loss:-0.98136, ratio_train_loss:0.19771,ratio_test_loss:0.19389, total_loss_train:-0.78352,total_loss_test:-0.78747, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 7504, epoch 16.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 7504, epoch 16.0)
[Save Checkpoint] epoch: [16.0], Train score:98.43167, Test score:98.27000, train loss:-0.98381, test loss:-0.98214, ratio_train_loss:0.18611,ratio_test_loss:0.18263, total_loss_train:-0.79770,total_loss_test:-0.79950, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 7973, epoch 17.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 7973, epoch 17.0)
[Save Checkpoint] epoch: [17.0], Train score:98.28333, Test score:98.22000, train loss:-0.98222, test loss:-0.98184, ratio_train_loss:0.18650,ratio_test_loss:0.18246, total_loss_train:-0.79572,total_loss_test:-0.79938, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 8442, epoch 18.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 8442, epoch 18.0)
[Save Checkpoint] epoch: [18.0], Train score:98.13333, Test score:97.85000, train loss:-0.98099, test loss:-0.97846, ratio_train_loss:0.18524,ratio_test_loss:0.18398, total_loss_train:-0.79575,total_loss_test:-0.79448, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 8911, epoch 19.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 8911, epoch 19.0)
[Save Checkpoint] epoch: [19.0], Train score:98.35667, Test score:98.17000, train loss:-0.98319, test loss:-0.98144, ratio_train_loss:0.19145,ratio_test_loss:0.18912, total_loss_train:-0.79174,total_loss_test:-0.79232, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 9380, epoch 20.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 9380, epoch 20.0)
[Save Checkpoint] epoch: [20.0], Train score:98.33500, Test score:98.24000, train loss:-0.98301, test loss:-0.98210, ratio_train_loss:0.18227,ratio_test_loss:0.17838, total_loss_train:-0.80075,total_loss_test:-0.80372, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 9849, epoch 21.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 9849, epoch 21.0)
[Save Checkpoint] epoch: [21.0], Train score:98.23000, Test score:98.13000, train loss:-0.98206, test loss:-0.98058, ratio_train_loss:0.18839,ratio_test_loss:0.18613, total_loss_train:-0.79367,total_loss_test:-0.79445, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 10318, epoch 22.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 10318, epoch 22.0)
[Save Checkpoint] epoch: [22.0], Train score:98.31000, Test score:98.27000, train loss:-0.98282, test loss:-0.98210, ratio_train_loss:0.18532,ratio_test_loss:0.18326, total_loss_train:-0.79749,total_loss_test:-0.79884, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 10787, epoch 23.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 10787, epoch 23.0)
[Save Checkpoint] epoch: [23.0], Train score:98.40500, Test score:98.27000, train loss:-0.98365, test loss:-0.98225, ratio_train_loss:0.18615,ratio_test_loss:0.18462, total_loss_train:-0.79750,total_loss_test:-0.79763, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 11256, epoch 24.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 11256, epoch 24.0)
[Save Checkpoint] epoch: [24.0], Train score:98.40667, Test score:98.33000, train loss:-0.98359, test loss:-0.98296, ratio_train_loss:0.18454,ratio_test_loss:0.18232, total_loss_train:-0.79905,total_loss_test:-0.80065, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 11725, epoch 25.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 11725, epoch 25.0)
[Save Checkpoint] epoch: [25.0], Train score:98.17000, Test score:98.10000, train loss:-0.98135, test loss:-0.98088, ratio_train_loss:0.19189,ratio_test_loss:0.18869, total_loss_train:-0.78946,total_loss_test:-0.79219, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 12194, epoch 26.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 12194, epoch 26.0)
[Save Checkpoint] epoch: [26.0], Train score:98.24333, Test score:97.86000, train loss:-0.98195, test loss:-0.97863, ratio_train_loss:0.18946,ratio_test_loss:0.18808, total_loss_train:-0.79249,total_loss_test:-0.79055, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 12663, epoch 27.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 12663, epoch 27.0)
[Save Checkpoint] epoch: [27.0], Train score:98.40833, Test score:98.33000, train loss:-0.98385, test loss:-0.98302, ratio_train_loss:0.17924,ratio_test_loss:0.17716, total_loss_train:-0.80461,total_loss_test:-0.80585, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 13132, epoch 28.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 13132, epoch 28.0)
[Save Checkpoint] epoch: [28.0], Train score:98.44333, Test score:98.22000, train loss:-0.98433, test loss:-0.98231, ratio_train_loss:0.18419,ratio_test_loss:0.18193, total_loss_train:-0.80014,total_loss_test:-0.80038, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 13601, epoch 29.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 13601, epoch 29.0)
[Save Checkpoint] epoch: [29.0], Train score:98.52000, Test score:98.25000, train loss:-0.98488, test loss:-0.98288, ratio_train_loss:0.18114,ratio_test_loss:0.18005, total_loss_train:-0.80374,total_loss_test:-0.80284, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 14070, epoch 30.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 14070, epoch 30.0)
[Save Checkpoint] epoch: [30.0], Train score:98.55833, Test score:98.23000, train loss:-0.98526, test loss:-0.98204, ratio_train_loss:0.18145,ratio_test_loss:0.18194, total_loss_train:-0.80381,total_loss_test:-0.80009, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 14539, epoch 31.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 14539, epoch 31.0)
[Save Checkpoint] epoch: [31.0], Train score:98.42500, Test score:98.03000, train loss:-0.98381, test loss:-0.98059, ratio_train_loss:0.18365,ratio_test_loss:0.18366, total_loss_train:-0.80016,total_loss_test:-0.79693, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 15008, epoch 32.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 15008, epoch 32.0)
[Save Checkpoint] epoch: [32.0], Train score:98.41333, Test score:98.27000, train loss:-0.98374, test loss:-0.98261, ratio_train_loss:0.17699,ratio_test_loss:0.17504, total_loss_train:-0.80676,total_loss_test:-0.80757, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 15477, epoch 33.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 15477, epoch 33.0)
[Save Checkpoint] epoch: [33.0], Train score:98.54000, Test score:98.32000, train loss:-0.98538, test loss:-0.98332, ratio_train_loss:0.18104,ratio_test_loss:0.18110, total_loss_train:-0.80434,total_loss_test:-0.80222, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 15946, epoch 34.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 15946, epoch 34.0)
[Save Checkpoint] epoch: [34.0], Train score:98.55500, Test score:98.46000, train loss:-0.98537, test loss:-0.98473, ratio_train_loss:0.17839,ratio_test_loss:0.17764, total_loss_train:-0.80697,total_loss_test:-0.80708, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 16415, epoch 35.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 16415, epoch 35.0)
[Save Checkpoint] epoch: [35.0], Train score:98.56500, Test score:98.33000, train loss:-0.98537, test loss:-0.98350, ratio_train_loss:0.18882,ratio_test_loss:0.18812, total_loss_train:-0.79654,total_loss_test:-0.79538, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 16884, epoch 36.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 16884, epoch 36.0)
[Save Checkpoint] epoch: [36.0], Train score:98.63833, Test score:98.27000, train loss:-0.98608, test loss:-0.98248, ratio_train_loss:0.17633,ratio_test_loss:0.17608, total_loss_train:-0.80975,total_loss_test:-0.80640, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 17353, epoch 37.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 17353, epoch 37.0)
[Save Checkpoint] epoch: [37.0], Train score:98.55667, Test score:98.46000, train loss:-0.98535, test loss:-0.98418, ratio_train_loss:0.18092,ratio_test_loss:0.18028, total_loss_train:-0.80444,total_loss_test:-0.80390, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 17822, epoch 38.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 17822, epoch 38.0)
[Save Checkpoint] epoch: [38.0], Train score:98.65000, Test score:98.49000, train loss:-0.98618, test loss:-0.98441, ratio_train_loss:0.17418,ratio_test_loss:0.17210, total_loss_train:-0.81200,total_loss_test:-0.81231, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 18291, epoch 39.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 18291, epoch 39.0)
[Save Checkpoint] epoch: [39.0], Train score:98.63667, Test score:98.44000, train loss:-0.98604, test loss:-0.98404, ratio_train_loss:0.18015,ratio_test_loss:0.18021, total_loss_train:-0.80590,total_loss_test:-0.80382, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 18760, epoch 40.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 18760, epoch 40.0)
[Save Checkpoint] epoch: [40.0], Train score:98.70667, Test score:98.49000, train loss:-0.98688, test loss:-0.98491, ratio_train_loss:0.17952,ratio_test_loss:0.17851, total_loss_train:-0.80736,total_loss_test:-0.80639, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 19229, epoch 41.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 19229, epoch 41.0)
[Save Checkpoint] epoch: [41.0], Train score:98.59833, Test score:98.36000, train loss:-0.98583, test loss:-0.98356, ratio_train_loss:0.18241,ratio_test_loss:0.18117, total_loss_train:-0.80341,total_loss_test:-0.80239, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 19698, epoch 42.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 19698, epoch 42.0)
[Save Checkpoint] epoch: [42.0], Train score:98.65333, Test score:98.34000, train loss:-0.98637, test loss:-0.98340, ratio_train_loss:0.17478,ratio_test_loss:0.17541, total_loss_train:-0.81159,total_loss_test:-0.80799, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 20167, epoch 43.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 20167, epoch 43.0)
[Save Checkpoint] epoch: [43.0], Train score:98.61333, Test score:98.24000, train loss:-0.98583, test loss:-0.98213, ratio_train_loss:0.18255,ratio_test_loss:0.18295, total_loss_train:-0.80328,total_loss_test:-0.79919, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 20636, epoch 44.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 20636, epoch 44.0)
[Save Checkpoint] epoch: [44.0], Train score:98.55500, Test score:98.31000, train loss:-0.98527, test loss:-0.98294, ratio_train_loss:0.18519,ratio_test_loss:0.18367, total_loss_train:-0.80008,total_loss_test:-0.79926, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 21105, epoch 45.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 21105, epoch 45.0)
[Save Checkpoint] epoch: [45.0], Train score:98.37833, Test score:98.03000, train loss:-0.98362, test loss:-0.98029, ratio_train_loss:0.18004,ratio_test_loss:0.17896, total_loss_train:-0.80358,total_loss_test:-0.80134, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 21574, epoch 46.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 21574, epoch 46.0)
[Save Checkpoint] epoch: [46.0], Train score:98.70167, Test score:98.33000, train loss:-0.98687, test loss:-0.98311, ratio_train_loss:0.18452,ratio_test_loss:0.18392, total_loss_train:-0.80235,total_loss_test:-0.79919, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 22043, epoch 47.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 22043, epoch 47.0)
[Save Checkpoint] epoch: [47.0], Train score:98.67333, Test score:98.50000, train loss:-0.98650, test loss:-0.98451, ratio_train_loss:0.17454,ratio_test_loss:0.17374, total_loss_train:-0.81196,total_loss_test:-0.81077, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 22512, epoch 48.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 22512, epoch 48.0)
[Save Checkpoint] epoch: [48.0], Train score:98.65167, Test score:98.34000, train loss:-0.98635, test loss:-0.98337, ratio_train_loss:0.17692,ratio_test_loss:0.17819, total_loss_train:-0.80943,total_loss_test:-0.80518, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 22981, epoch 49.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 22981, epoch 49.0)
[Save Checkpoint] epoch: [49.0], Train score:98.76500, Test score:98.45000, train loss:-0.98737, test loss:-0.98412, ratio_train_loss:0.18009,ratio_test_loss:0.18015, total_loss_train:-0.80728,total_loss_test:-0.80396, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 23450, epoch 50.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 23450, epoch 50.0)
[Save Checkpoint] epoch: [50.0], Train score:98.65333, Test score:98.26000, train loss:-0.98640, test loss:-0.98260, ratio_train_loss:0.17325,ratio_test_loss:0.17371, total_loss_train:-0.81315,total_loss_test:-0.80889, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 23919, epoch 51.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 23919, epoch 51.0)
[Save Checkpoint] epoch: [51.0], Train score:98.65167, Test score:98.41000, train loss:-0.98638, test loss:-0.98400, ratio_train_loss:0.17044,ratio_test_loss:0.16993, total_loss_train:-0.81594,total_loss_test:-0.81406, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 24388, epoch 52.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 24388, epoch 52.0)
[Save Checkpoint] epoch: [52.0], Train score:98.65000, Test score:98.31000, train loss:-0.98630, test loss:-0.98343, ratio_train_loss:0.17483,ratio_test_loss:0.17458, total_loss_train:-0.81146,total_loss_test:-0.80885, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 24857, epoch 53.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 24857, epoch 53.0)
[Save Checkpoint] epoch: [53.0], Train score:98.67333, Test score:98.59000, train loss:-0.98660, test loss:-0.98552, ratio_train_loss:0.17332,ratio_test_loss:0.17138, total_loss_train:-0.81328,total_loss_test:-0.81414, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 25326, epoch 54.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 25326, epoch 54.0)
[Save Checkpoint] epoch: [54.0], Train score:98.67833, Test score:98.54000, train loss:-0.98654, test loss:-0.98533, ratio_train_loss:0.17290,ratio_test_loss:0.17125, total_loss_train:-0.81365,total_loss_test:-0.81409, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 25795, epoch 55.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 25795, epoch 55.0)
[Save Checkpoint] epoch: [55.0], Train score:98.76667, Test score:98.44000, train loss:-0.98742, test loss:-0.98455, ratio_train_loss:0.16909,ratio_test_loss:0.16927, total_loss_train:-0.81833,total_loss_test:-0.81528, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 26264, epoch 56.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 26264, epoch 56.0)
[Save Checkpoint] epoch: [56.0], Train score:98.64500, Test score:98.20000, train loss:-0.98641, test loss:-0.98208, ratio_train_loss:0.17594,ratio_test_loss:0.17388, total_loss_train:-0.81047,total_loss_test:-0.80820, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 26733, epoch 57.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 26733, epoch 57.0)
[Save Checkpoint] epoch: [57.0], Train score:98.63500, Test score:98.23000, train loss:-0.98619, test loss:-0.98237, ratio_train_loss:0.18088,ratio_test_loss:0.17946, total_loss_train:-0.80531,total_loss_test:-0.80290, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 27202, epoch 58.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 27202, epoch 58.0)
[Save Checkpoint] epoch: [58.0], Train score:98.65833, Test score:98.28000, train loss:-0.98649, test loss:-0.98285, ratio_train_loss:0.17583,ratio_test_loss:0.17581, total_loss_train:-0.81066,total_loss_test:-0.80705, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 27671, epoch 59.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 27671, epoch 59.0)
[Save Checkpoint] epoch: [59.0], Train score:98.64000, Test score:98.48000, train loss:-0.98618, test loss:-0.98471, ratio_train_loss:0.16941,ratio_test_loss:0.16721, total_loss_train:-0.81677,total_loss_test:-0.81750, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 28140, epoch 60.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 28140, epoch 60.0)
[Save Checkpoint] epoch: [60.0], Train score:98.73667, Test score:98.49000, train loss:-0.98725, test loss:-0.98474, ratio_train_loss:0.17425,ratio_test_loss:0.17406, total_loss_train:-0.81300,total_loss_test:-0.81068, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 28609, epoch 61.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 28609, epoch 61.0)
[Save Checkpoint] epoch: [61.0], Train score:98.58500, Test score:98.14000, train loss:-0.98572, test loss:-0.98160, ratio_train_loss:0.17375,ratio_test_loss:0.17421, total_loss_train:-0.81197,total_loss_test:-0.80739, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 29078, epoch 62.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 29078, epoch 62.0)
[Save Checkpoint] epoch: [62.0], Train score:98.75333, Test score:98.37000, train loss:-0.98744, test loss:-0.98369, ratio_train_loss:0.17148,ratio_test_loss:0.17189, total_loss_train:-0.81596,total_loss_test:-0.81180, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 29547, epoch 63.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 29547, epoch 63.0)
[Save Checkpoint] epoch: [63.0], Train score:98.82000, Test score:98.35000, train loss:-0.98801, test loss:-0.98336, ratio_train_loss:0.16928,ratio_test_loss:0.17137, total_loss_train:-0.81873,total_loss_test:-0.81199, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 30016, epoch 64.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 30016, epoch 64.0)
[Save Checkpoint] epoch: [64.0], Train score:98.74000, Test score:98.32000, train loss:-0.98714, test loss:-0.98296, ratio_train_loss:0.16709,ratio_test_loss:0.16701, total_loss_train:-0.82004,total_loss_test:-0.81595, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 30485, epoch 65.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 30485, epoch 65.0)
[Save Checkpoint] epoch: [65.0], Train score:98.82333, Test score:98.34000, train loss:-0.98797, test loss:-0.98357, ratio_train_loss:0.16780,ratio_test_loss:0.16736, total_loss_train:-0.82017,total_loss_test:-0.81621, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 30954, epoch 66.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 30954, epoch 66.0)
[Save Checkpoint] epoch: [66.0], Train score:98.83500, Test score:98.50000, train loss:-0.98815, test loss:-0.98470, ratio_train_loss:0.16701,ratio_test_loss:0.16834, total_loss_train:-0.82114,total_loss_test:-0.81636, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 31423, epoch 67.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 31423, epoch 67.0)
[Save Checkpoint] epoch: [67.0], Train score:98.65833, Test score:98.32000, train loss:-0.98651, test loss:-0.98339, ratio_train_loss:0.17190,ratio_test_loss:0.17353, total_loss_train:-0.81461,total_loss_test:-0.80986, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 31892, epoch 68.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 31892, epoch 68.0)
[Save Checkpoint] epoch: [68.0], Train score:98.76833, Test score:98.46000, train loss:-0.98745, test loss:-0.98431, ratio_train_loss:0.17414,ratio_test_loss:0.17510, total_loss_train:-0.81332,total_loss_test:-0.80921, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 32361, epoch 69.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 32361, epoch 69.0)
[Save Checkpoint] epoch: [69.0], Train score:98.71500, Test score:98.13000, train loss:-0.98702, test loss:-0.98160, ratio_train_loss:0.16203,ratio_test_loss:0.16391, total_loss_train:-0.82499,total_loss_test:-0.81769, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 32830, epoch 70.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 32830, epoch 70.0)
[Save Checkpoint] epoch: [70.0], Train score:98.78500, Test score:98.49000, train loss:-0.98783, test loss:-0.98474, ratio_train_loss:0.16939,ratio_test_loss:0.16975, total_loss_train:-0.81844,total_loss_test:-0.81498, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 33299, epoch 71.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 33299, epoch 71.0)
[Save Checkpoint] epoch: [71.0], Train score:98.78000, Test score:98.54000, train loss:-0.98783, test loss:-0.98533, ratio_train_loss:0.17709,ratio_test_loss:0.17664, total_loss_train:-0.81074,total_loss_test:-0.80869, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 33768, epoch 72.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 33768, epoch 72.0)
[Save Checkpoint] epoch: [72.0], Train score:98.78000, Test score:98.35000, train loss:-0.98766, test loss:-0.98395, ratio_train_loss:0.17253,ratio_test_loss:0.17157, total_loss_train:-0.81513,total_loss_test:-0.81237, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 34237, epoch 73.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 34237, epoch 73.0)
[Save Checkpoint] epoch: [73.0], Train score:98.77500, Test score:98.36000, train loss:-0.98764, test loss:-0.98391, ratio_train_loss:0.16455,ratio_test_loss:0.16479, total_loss_train:-0.82309,total_loss_test:-0.81913, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 34706, epoch 74.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 34706, epoch 74.0)
[Save Checkpoint] epoch: [74.0], Train score:98.71833, Test score:98.43000, train loss:-0.98712, test loss:-0.98403, ratio_train_loss:0.16432,ratio_test_loss:0.16368, total_loss_train:-0.82280,total_loss_test:-0.82034, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 35175, epoch 75.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 35175, epoch 75.0)
[Save Checkpoint] epoch: [75.0], Train score:98.75500, Test score:98.30000, train loss:-0.98729, test loss:-0.98306, ratio_train_loss:0.17361,ratio_test_loss:0.17332, total_loss_train:-0.81368,total_loss_test:-0.80975, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 35644, epoch 76.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 35644, epoch 76.0)
[Save Checkpoint] epoch: [76.0], Train score:98.78000, Test score:98.59000, train loss:-0.98769, test loss:-0.98544, ratio_train_loss:0.17571,ratio_test_loss:0.17524, total_loss_train:-0.81197,total_loss_test:-0.81020, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 36113, epoch 77.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 36113, epoch 77.0)
[Save Checkpoint] epoch: [77.0], Train score:98.72333, Test score:98.35000, train loss:-0.98705, test loss:-0.98381, ratio_train_loss:0.17397,ratio_test_loss:0.17393, total_loss_train:-0.81308,total_loss_test:-0.80988, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 36582, epoch 78.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 36582, epoch 78.0)
[Save Checkpoint] epoch: [78.0], Train score:98.83500, Test score:98.37000, train loss:-0.98825, test loss:-0.98378, ratio_train_loss:0.17369,ratio_test_loss:0.17386, total_loss_train:-0.81457,total_loss_test:-0.80992, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 37051, epoch 79.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 37051, epoch 79.0)
[Save Checkpoint] epoch: [79.0], Train score:98.80667, Test score:98.35000, train loss:-0.98798, test loss:-0.98360, ratio_train_loss:0.16614,ratio_test_loss:0.16784, total_loss_train:-0.82184,total_loss_test:-0.81575, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 37520, epoch 80.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 37520, epoch 80.0)
[Save Checkpoint] epoch: [80.0], Train score:98.79167, Test score:98.44000, train loss:-0.98791, test loss:-0.98429, ratio_train_loss:0.16552,ratio_test_loss:0.16827, total_loss_train:-0.82240,total_loss_test:-0.81602, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 37989, epoch 81.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 37989, epoch 81.0)
[Save Checkpoint] epoch: [81.0], Train score:98.82833, Test score:98.52000, train loss:-0.98823, test loss:-0.98529, ratio_train_loss:0.17814,ratio_test_loss:0.17943, total_loss_train:-0.81009,total_loss_test:-0.80586, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 38458, epoch 82.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 38458, epoch 82.0)
[Save Checkpoint] epoch: [82.0], Train score:98.60000, Test score:98.22000, train loss:-0.98580, test loss:-0.98217, ratio_train_loss:0.17178,ratio_test_loss:0.17173, total_loss_train:-0.81401,total_loss_test:-0.81044, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 38927, epoch 83.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 38927, epoch 83.0)
[Save Checkpoint] epoch: [83.0], Train score:98.80000, Test score:98.36000, train loss:-0.98788, test loss:-0.98347, ratio_train_loss:0.16798,ratio_test_loss:0.16928, total_loss_train:-0.81990,total_loss_test:-0.81419, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 39396, epoch 84.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 39396, epoch 84.0)
[Save Checkpoint] epoch: [84.0], Train score:98.72000, Test score:98.41000, train loss:-0.98714, test loss:-0.98361, ratio_train_loss:0.17487,ratio_test_loss:0.17586, total_loss_train:-0.81227,total_loss_test:-0.80775, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 39865, epoch 85.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 39865, epoch 85.0)
[Save Checkpoint] epoch: [85.0], Train score:98.80000, Test score:98.41000, train loss:-0.98791, test loss:-0.98408, ratio_train_loss:0.16401,ratio_test_loss:0.16409, total_loss_train:-0.82391,total_loss_test:-0.82000, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 40334, epoch 86.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 40334, epoch 86.0)
[Save Checkpoint] epoch: [86.0], Train score:98.92000, Test score:98.44000, train loss:-0.98904, test loss:-0.98431, ratio_train_loss:0.16576,ratio_test_loss:0.16548, total_loss_train:-0.82327,total_loss_test:-0.81883, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 40803, epoch 87.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 40803, epoch 87.0)
[Save Checkpoint] epoch: [87.0], Train score:98.84500, Test score:98.33000, train loss:-0.98836, test loss:-0.98370, ratio_train_loss:0.16384,ratio_test_loss:0.16461, total_loss_train:-0.82452,total_loss_test:-0.81909, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 41272, epoch 88.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 41272, epoch 88.0)
[Save Checkpoint] epoch: [88.0], Train score:98.84333, Test score:98.35000, train loss:-0.98827, test loss:-0.98357, ratio_train_loss:0.16251,ratio_test_loss:0.16375, total_loss_train:-0.82575,total_loss_test:-0.81982, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 41741, epoch 89.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 41741, epoch 89.0)
[Save Checkpoint] epoch: [89.0], Train score:98.71167, Test score:98.26000, train loss:-0.98691, test loss:-0.98245, ratio_train_loss:0.17775,ratio_test_loss:0.17791, total_loss_train:-0.80916,total_loss_test:-0.80453, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 42210, epoch 90.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 42210, epoch 90.0)
[Save Checkpoint] epoch: [90.0], Train score:98.80333, Test score:98.37000, train loss:-0.98794, test loss:-0.98373, ratio_train_loss:0.16760,ratio_test_loss:0.16905, total_loss_train:-0.82034,total_loss_test:-0.81468, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 42679, epoch 91.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 42679, epoch 91.0)
[Save Checkpoint] epoch: [91.0], Train score:98.86500, Test score:98.48000, train loss:-0.98850, test loss:-0.98482, ratio_train_loss:0.16516,ratio_test_loss:0.16757, total_loss_train:-0.82334,total_loss_test:-0.81725, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 43148, epoch 92.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 43148, epoch 92.0)
[Save Checkpoint] epoch: [92.0], Train score:98.88500, Test score:98.49000, train loss:-0.98868, test loss:-0.98468, ratio_train_loss:0.16405,ratio_test_loss:0.16415, total_loss_train:-0.82463,total_loss_test:-0.82052, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 43617, epoch 93.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 43617, epoch 93.0)
[Save Checkpoint] epoch: [93.0], Train score:98.71167, Test score:98.25000, train loss:-0.98719, test loss:-0.98278, ratio_train_loss:0.17449,ratio_test_loss:0.17537, total_loss_train:-0.81270,total_loss_test:-0.80741, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 44086, epoch 94.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 44086, epoch 94.0)
[Save Checkpoint] epoch: [94.0], Train score:98.79000, Test score:98.40000, train loss:-0.98773, test loss:-0.98396, ratio_train_loss:0.17159,ratio_test_loss:0.17316, total_loss_train:-0.81614,total_loss_test:-0.81080, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 44555, epoch 95.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 44555, epoch 95.0)
[Save Checkpoint] epoch: [95.0], Train score:98.75333, Test score:98.31000, train loss:-0.98742, test loss:-0.98296, ratio_train_loss:0.16583,ratio_test_loss:0.16693, total_loss_train:-0.82159,total_loss_test:-0.81603, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 45024, epoch 96.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 45024, epoch 96.0)
[Save Checkpoint] epoch: [96.0], Train score:98.79667, Test score:98.19000, train loss:-0.98789, test loss:-0.98214, ratio_train_loss:0.16048,ratio_test_loss:0.16197, total_loss_train:-0.82741,total_loss_test:-0.82018, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 45493, epoch 97.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 45493, epoch 97.0)
[Save Checkpoint] epoch: [97.0], Train score:98.83667, Test score:98.34000, train loss:-0.98818, test loss:-0.98336, ratio_train_loss:0.16628,ratio_test_loss:0.16740, total_loss_train:-0.82190,total_loss_test:-0.81596, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 45962, epoch 98.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 45962, epoch 98.0)
[Save Checkpoint] epoch: [98.0], Train score:98.87667, Test score:98.15000, train loss:-0.98849, test loss:-0.98176, ratio_train_loss:0.16503,ratio_test_loss:0.16754, total_loss_train:-0.82346,total_loss_test:-0.81422, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 46431, epoch 99.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 46431, epoch 99.0)
[Save Checkpoint] epoch: [99.0], Train score:98.92000, Test score:98.49000, train loss:-0.98903, test loss:-0.98461, ratio_train_loss:0.16607,ratio_test_loss:0.16881, total_loss_train:-0.82296,total_loss_test:-0.81580, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 46900, epoch 100.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_3/last' (iter 46900, epoch 100.0)
[Save Checkpoint] epoch: [100.0], Train score:98.74000, Test score:98.08000, train loss:-0.98733, test loss:-0.98100, ratio_train_loss:0.17295,ratio_test_loss:0.17670, total_loss_train:-0.81437,total_loss_test:-0.80430, 
[Training Finished]
All Done!
