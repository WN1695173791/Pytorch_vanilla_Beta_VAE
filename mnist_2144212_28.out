28
--dataset mnist --model CNN --gpu_devices 0 1 --max_iter 100 --batch_size 512 --ckpt_dir checkpoints_CNN --ckpt_dir_scores checkpoint_scores_CNN --use_scheduler True --GMP True --lr 1e-3 --z_struct_size 20 --add_classification_layer True --classif_layer_size 30 --is_default_model False --is_custom_model False --is_custom_model_BK True --big_kernel_size 8 --two_conv_layer True --three_conv_layer False --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 32 --hidden_filters_layer2 32 --hidden_filters_layer3 32 --ratio_reg True --lambda_ratio_reg 0.01 --lambda_class 1 --exp_name CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, GMP=True, L1_norm_act=False, L1_norm_weights=False, L3_without_random=False, adapt_lr=False, add_classification_layer=True, add_linear_after_GMP=True, add_z_struct_bottleneck=False, batch_size=512, beta=1, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=[8], binary_z=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, cuda=True, dataset='mnist', display_step=10000, dset_dir='data', exp_name='CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3', gamma=1000, gpu_devices=[0, 1], hidden_filters_layer1=32, hidden_filters_layer2=32, hidden_filters_layer3=32, image_size=64, is_C=True, is_E1=False, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=True, is_default_model=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_VAE=1, lambda_class=1.0, lambda_partial_class=1, lambda_ratio_reg=0.01, lambda_recon_wt_rand=1, lambda_recons=1, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', lr=0.001, max_iter=100.0, model='CNN', num_workers=2, old_weighted=False, other_ratio=False, random_percentage=0.2, ratio_reg=True, save_step=10000, second_layer_C=False, seed=1, stride_size=1, three_conv_layer=False, train=True, two_conv_layer=True, two_encoder=False, use_early_stopping=False, use_scheduler=True, z_struct_size=20, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
Custom_CNN_BK(
  (net): Sequential(
    (0): Conv2d(1, 32, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(32, 32, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): AdaptiveMaxPool2d(output_size=(1, 1))
    (7): View()
    (8): Linear(in_features=32, out_features=20, bias=True)
    (9): BatchNorm1d(20, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (10): ReLU(inplace=True)
    (11): Dropout(p=0.4, inplace=False)
    (12): Linear(in_features=20, out_features=30, bias=True)
    (13): BatchNorm1d(30, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU(inplace=True)
    (15): Dropout(p=0.4, inplace=False)
    (16): Linear(in_features=30, out_features=10, bias=True)
    (17): Softmax(dim=None)
  )
)
The number of parameters of model is 20324
use 1 gpu who named: Tesla V100-SXM2-32GB
=> loaded sample_scores and losses
=> no checkpoint found at 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last'
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 118, epoch 1.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 118, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train score:59.06333, Test score:59.01000, train loss:-0.56272, test loss:-0.56174, ratio_train_loss:0.53585,ratio_test_loss:0.51172, total_loss_train:-0.02688,total_loss_test:-0.05002, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 236, epoch 2.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 236, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train score:61.11333, Test score:60.63000, train loss:-0.61397, test loss:-0.61193, ratio_train_loss:0.40728,ratio_test_loss:0.39548, total_loss_train:-0.20669,total_loss_test:-0.21645, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 354, epoch 3.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 354, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train score:76.94000, Test score:76.98000, train loss:-0.73262, test loss:-0.73118, ratio_train_loss:0.36837,ratio_test_loss:0.36063, total_loss_train:-0.36425,total_loss_test:-0.37055, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 472, epoch 4.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 472, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train score:77.98333, Test score:77.79000, train loss:-0.77284, test loss:-0.77148, ratio_train_loss:0.31911,ratio_test_loss:0.31101, total_loss_train:-0.45373,total_loss_test:-0.46047, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 590, epoch 5.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 590, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train score:94.49667, Test score:94.66000, train loss:-0.89601, test loss:-0.89564, ratio_train_loss:0.29303,ratio_test_loss:0.28470, total_loss_train:-0.60298,total_loss_test:-0.61094, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 708, epoch 6.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 708, epoch 6.0)
[Save Checkpoint] epoch: [6.0], Train score:96.45333, Test score:96.63000, train loss:-0.95171, test loss:-0.95340, ratio_train_loss:0.28115,ratio_test_loss:0.27260, total_loss_train:-0.67057,total_loss_test:-0.68080, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 826, epoch 7.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 826, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train score:97.35167, Test score:97.25000, train loss:-0.96670, test loss:-0.96646, ratio_train_loss:0.25619,ratio_test_loss:0.25053, total_loss_train:-0.71052,total_loss_test:-0.71593, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 944, epoch 8.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 944, epoch 8.0)
[Save Checkpoint] epoch: [8.0], Train score:97.32000, Test score:97.30000, train loss:-0.96815, test loss:-0.96825, ratio_train_loss:0.25212,ratio_test_loss:0.24442, total_loss_train:-0.71603,total_loss_test:-0.72383, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1062, epoch 9.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1062, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train score:97.60833, Test score:97.68000, train loss:-0.97273, test loss:-0.97321, ratio_train_loss:0.23884,ratio_test_loss:0.23290, total_loss_train:-0.73389,total_loss_test:-0.74030, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1180, epoch 10.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1180, epoch 10.0)
[Save Checkpoint] epoch: [10.0], Train score:97.62333, Test score:97.67000, train loss:-0.97335, test loss:-0.97311, ratio_train_loss:0.23283,ratio_test_loss:0.22766, total_loss_train:-0.74052,total_loss_test:-0.74545, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1298, epoch 11.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1298, epoch 11.0)
[Save Checkpoint] epoch: [11.0], Train score:97.53167, Test score:97.56000, train loss:-0.97229, test loss:-0.97220, ratio_train_loss:0.22767,ratio_test_loss:0.22239, total_loss_train:-0.74463,total_loss_test:-0.74980, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1416, epoch 12.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1416, epoch 12.0)
[Save Checkpoint] epoch: [12.0], Train score:97.62167, Test score:97.42000, train loss:-0.97386, test loss:-0.97148, ratio_train_loss:0.23410,ratio_test_loss:0.23152, total_loss_train:-0.73976,total_loss_test:-0.73996, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1534, epoch 13.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1534, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train score:98.01333, Test score:98.07000, train loss:-0.97841, test loss:-0.97808, ratio_train_loss:0.21683,ratio_test_loss:0.21514, total_loss_train:-0.76158,total_loss_test:-0.76294, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1652, epoch 14.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1652, epoch 14.0)
[Save Checkpoint] epoch: [14.0], Train score:98.02667, Test score:98.05000, train loss:-0.97864, test loss:-0.97813, ratio_train_loss:0.20886,ratio_test_loss:0.20542, total_loss_train:-0.76978,total_loss_test:-0.77271, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1770, epoch 15.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1770, epoch 15.0)
[Save Checkpoint] epoch: [15.0], Train score:98.21000, Test score:98.06000, train loss:-0.98054, test loss:-0.97867, ratio_train_loss:0.22043,ratio_test_loss:0.21723, total_loss_train:-0.76010,total_loss_test:-0.76144, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1888, epoch 16.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 1888, epoch 16.0)
[Save Checkpoint] epoch: [16.0], Train score:98.20167, Test score:98.06000, train loss:-0.98047, test loss:-0.97873, ratio_train_loss:0.21474,ratio_test_loss:0.21233, total_loss_train:-0.76574,total_loss_test:-0.76640, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2006, epoch 17.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2006, epoch 17.0)
[Save Checkpoint] epoch: [17.0], Train score:98.02833, Test score:97.87000, train loss:-0.97885, test loss:-0.97743, ratio_train_loss:0.21740,ratio_test_loss:0.21448, total_loss_train:-0.76145,total_loss_test:-0.76295, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2124, epoch 18.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2124, epoch 18.0)
[Save Checkpoint] epoch: [18.0], Train score:98.03000, Test score:97.78000, train loss:-0.97887, test loss:-0.97645, ratio_train_loss:0.21205,ratio_test_loss:0.20891, total_loss_train:-0.76683,total_loss_test:-0.76753, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2242, epoch 19.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2242, epoch 19.0)
[Save Checkpoint] epoch: [19.0], Train score:98.23500, Test score:98.06000, train loss:-0.98121, test loss:-0.97977, ratio_train_loss:0.19354,ratio_test_loss:0.19090, total_loss_train:-0.78767,total_loss_test:-0.78887, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2360, epoch 20.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2360, epoch 20.0)
[Save Checkpoint] epoch: [20.0], Train score:98.20167, Test score:98.26000, train loss:-0.98095, test loss:-0.98091, ratio_train_loss:0.20307,ratio_test_loss:0.20069, total_loss_train:-0.77788,total_loss_test:-0.78022, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2478, epoch 21.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2478, epoch 21.0)
[Save Checkpoint] epoch: [21.0], Train score:98.22500, Test score:98.13000, train loss:-0.98088, test loss:-0.97962, ratio_train_loss:0.20418,ratio_test_loss:0.20275, total_loss_train:-0.77670,total_loss_test:-0.77687, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2596, epoch 22.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2596, epoch 22.0)
[Save Checkpoint] epoch: [22.0], Train score:98.18000, Test score:98.18000, train loss:-0.98029, test loss:-0.98044, ratio_train_loss:0.19652,ratio_test_loss:0.19503, total_loss_train:-0.78378,total_loss_test:-0.78541, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2714, epoch 23.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2714, epoch 23.0)
[Save Checkpoint] epoch: [23.0], Train score:98.30167, Test score:98.21000, train loss:-0.98220, test loss:-0.98057, ratio_train_loss:0.20151,ratio_test_loss:0.20136, total_loss_train:-0.78069,total_loss_test:-0.77920, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2832, epoch 24.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2832, epoch 24.0)
[Save Checkpoint] epoch: [24.0], Train score:98.35333, Test score:98.33000, train loss:-0.98252, test loss:-0.98245, ratio_train_loss:0.20157,ratio_test_loss:0.20021, total_loss_train:-0.78094,total_loss_test:-0.78223, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2950, epoch 25.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 2950, epoch 25.0)
[Save Checkpoint] epoch: [25.0], Train score:98.35667, Test score:98.19000, train loss:-0.98278, test loss:-0.98066, ratio_train_loss:0.20387,ratio_test_loss:0.20373, total_loss_train:-0.77890,total_loss_test:-0.77693, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3068, epoch 26.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3068, epoch 26.0)
[Save Checkpoint] epoch: [26.0], Train score:98.38000, Test score:98.14000, train loss:-0.98302, test loss:-0.98060, ratio_train_loss:0.19861,ratio_test_loss:0.19799, total_loss_train:-0.78441,total_loss_test:-0.78261, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3186, epoch 27.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3186, epoch 27.0)
[Save Checkpoint] epoch: [27.0], Train score:98.32500, Test score:98.21000, train loss:-0.98247, test loss:-0.98120, ratio_train_loss:0.19141,ratio_test_loss:0.18900, total_loss_train:-0.79106,total_loss_test:-0.79220, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3304, epoch 28.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3304, epoch 28.0)
[Save Checkpoint] epoch: [28.0], Train score:98.35500, Test score:98.32000, train loss:-0.98275, test loss:-0.98187, ratio_train_loss:0.19776,ratio_test_loss:0.19657, total_loss_train:-0.78499,total_loss_test:-0.78530, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3422, epoch 29.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3422, epoch 29.0)
[Save Checkpoint] epoch: [29.0], Train score:98.58667, Test score:98.32000, train loss:-0.98507, test loss:-0.98270, ratio_train_loss:0.19110,ratio_test_loss:0.19055, total_loss_train:-0.79396,total_loss_test:-0.79215, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3540, epoch 30.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3540, epoch 30.0)
[Save Checkpoint] epoch: [30.0], Train score:98.53000, Test score:98.34000, train loss:-0.98460, test loss:-0.98220, ratio_train_loss:0.18605,ratio_test_loss:0.18584, total_loss_train:-0.79855,total_loss_test:-0.79636, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3658, epoch 31.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3658, epoch 31.0)
[Save Checkpoint] epoch: [31.0], Train score:98.56333, Test score:98.29000, train loss:-0.98521, test loss:-0.98272, ratio_train_loss:0.19380,ratio_test_loss:0.19322, total_loss_train:-0.79141,total_loss_test:-0.78950, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3776, epoch 32.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3776, epoch 32.0)
[Save Checkpoint] epoch: [32.0], Train score:98.59167, Test score:98.48000, train loss:-0.98485, test loss:-0.98372, ratio_train_loss:0.18728,ratio_test_loss:0.18687, total_loss_train:-0.79757,total_loss_test:-0.79686, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3894, epoch 33.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 3894, epoch 33.0)
[Save Checkpoint] epoch: [33.0], Train score:98.41000, Test score:98.30000, train loss:-0.98351, test loss:-0.98205, ratio_train_loss:0.19308,ratio_test_loss:0.19337, total_loss_train:-0.79043,total_loss_test:-0.78867, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4012, epoch 34.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4012, epoch 34.0)
[Save Checkpoint] epoch: [34.0], Train score:98.14667, Test score:98.03000, train loss:-0.98095, test loss:-0.97948, ratio_train_loss:0.20173,ratio_test_loss:0.20244, total_loss_train:-0.77922,total_loss_test:-0.77704, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4130, epoch 35.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4130, epoch 35.0)
[Save Checkpoint] epoch: [35.0], Train score:98.57000, Test score:98.41000, train loss:-0.98484, test loss:-0.98303, ratio_train_loss:0.19082,ratio_test_loss:0.19204, total_loss_train:-0.79402,total_loss_test:-0.79099, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4248, epoch 36.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4248, epoch 36.0)
[Save Checkpoint] epoch: [36.0], Train score:98.52333, Test score:98.51000, train loss:-0.98477, test loss:-0.98412, ratio_train_loss:0.18750,ratio_test_loss:0.18679, total_loss_train:-0.79727,total_loss_test:-0.79732, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4366, epoch 37.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4366, epoch 37.0)
[Save Checkpoint] epoch: [37.0], Train score:98.63333, Test score:98.33000, train loss:-0.98584, test loss:-0.98291, ratio_train_loss:0.19169,ratio_test_loss:0.19445, total_loss_train:-0.79415,total_loss_test:-0.78846, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4484, epoch 38.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4484, epoch 38.0)
[Save Checkpoint] epoch: [38.0], Train score:98.57500, Test score:98.36000, train loss:-0.98537, test loss:-0.98248, ratio_train_loss:0.18921,ratio_test_loss:0.19132, total_loss_train:-0.79616,total_loss_test:-0.79116, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4602, epoch 39.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4602, epoch 39.0)
[Save Checkpoint] epoch: [39.0], Train score:98.60833, Test score:98.33000, train loss:-0.98554, test loss:-0.98270, ratio_train_loss:0.18779,ratio_test_loss:0.18789, total_loss_train:-0.79775,total_loss_test:-0.79481, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4720, epoch 40.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4720, epoch 40.0)
[Save Checkpoint] epoch: [40.0], Train score:98.71000, Test score:98.31000, train loss:-0.98654, test loss:-0.98224, ratio_train_loss:0.18810,ratio_test_loss:0.18932, total_loss_train:-0.79845,total_loss_test:-0.79292, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4838, epoch 41.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4838, epoch 41.0)
[Save Checkpoint] epoch: [41.0], Train score:98.68833, Test score:98.51000, train loss:-0.98665, test loss:-0.98414, ratio_train_loss:0.19235,ratio_test_loss:0.19350, total_loss_train:-0.79429,total_loss_test:-0.79064, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4956, epoch 42.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 4956, epoch 42.0)
[Save Checkpoint] epoch: [42.0], Train score:98.66000, Test score:98.22000, train loss:-0.98608, test loss:-0.98225, ratio_train_loss:0.18215,ratio_test_loss:0.18376, total_loss_train:-0.80393,total_loss_test:-0.79848, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5074, epoch 43.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5074, epoch 43.0)
[Save Checkpoint] epoch: [43.0], Train score:98.62833, Test score:98.29000, train loss:-0.98559, test loss:-0.98221, ratio_train_loss:0.19458,ratio_test_loss:0.19720, total_loss_train:-0.79101,total_loss_test:-0.78501, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5192, epoch 44.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5192, epoch 44.0)
[Save Checkpoint] epoch: [44.0], Train score:98.60333, Test score:98.36000, train loss:-0.98550, test loss:-0.98290, ratio_train_loss:0.18623,ratio_test_loss:0.18754, total_loss_train:-0.79927,total_loss_test:-0.79536, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5310, epoch 45.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5310, epoch 45.0)
[Save Checkpoint] epoch: [45.0], Train score:98.75667, Test score:98.31000, train loss:-0.98695, test loss:-0.98266, ratio_train_loss:0.18669,ratio_test_loss:0.18772, total_loss_train:-0.80027,total_loss_test:-0.79494, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5428, epoch 46.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5428, epoch 46.0)
[Save Checkpoint] epoch: [46.0], Train score:98.76833, Test score:98.46000, train loss:-0.98744, test loss:-0.98409, ratio_train_loss:0.18089,ratio_test_loss:0.18206, total_loss_train:-0.80655,total_loss_test:-0.80203, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5546, epoch 47.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5546, epoch 47.0)
[Save Checkpoint] epoch: [47.0], Train score:98.81667, Test score:98.54000, train loss:-0.98794, test loss:-0.98525, ratio_train_loss:0.18271,ratio_test_loss:0.18392, total_loss_train:-0.80523,total_loss_test:-0.80133, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5664, epoch 48.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5664, epoch 48.0)
[Save Checkpoint] epoch: [48.0], Train score:98.61500, Test score:98.15000, train loss:-0.98583, test loss:-0.98149, ratio_train_loss:0.18112,ratio_test_loss:0.18240, total_loss_train:-0.80471,total_loss_test:-0.79909, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5782, epoch 49.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5782, epoch 49.0)
[Save Checkpoint] epoch: [49.0], Train score:98.70000, Test score:98.44000, train loss:-0.98658, test loss:-0.98387, ratio_train_loss:0.18361,ratio_test_loss:0.18426, total_loss_train:-0.80297,total_loss_test:-0.79961, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5900, epoch 50.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 5900, epoch 50.0)
[Save Checkpoint] epoch: [50.0], Train score:98.72333, Test score:98.28000, train loss:-0.98664, test loss:-0.98223, ratio_train_loss:0.18522,ratio_test_loss:0.18684, total_loss_train:-0.80141,total_loss_test:-0.79539, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6018, epoch 51.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6018, epoch 51.0)
[Save Checkpoint] epoch: [51.0], Train score:98.57333, Test score:98.06000, train loss:-0.98528, test loss:-0.98031, ratio_train_loss:0.19464,ratio_test_loss:0.19527, total_loss_train:-0.79064,total_loss_test:-0.78504, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6136, epoch 52.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6136, epoch 52.0)
[Save Checkpoint] epoch: [52.0], Train score:98.54167, Test score:98.22000, train loss:-0.98498, test loss:-0.98204, ratio_train_loss:0.19264,ratio_test_loss:0.19283, total_loss_train:-0.79234,total_loss_test:-0.78921, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6254, epoch 53.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6254, epoch 53.0)
[Save Checkpoint] epoch: [53.0], Train score:98.66000, Test score:98.34000, train loss:-0.98636, test loss:-0.98311, ratio_train_loss:0.18880,ratio_test_loss:0.18827, total_loss_train:-0.79756,total_loss_test:-0.79485, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6372, epoch 54.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6372, epoch 54.0)
[Save Checkpoint] epoch: [54.0], Train score:98.79667, Test score:98.54000, train loss:-0.98763, test loss:-0.98424, ratio_train_loss:0.18013,ratio_test_loss:0.18187, total_loss_train:-0.80749,total_loss_test:-0.80238, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6490, epoch 55.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6490, epoch 55.0)
[Save Checkpoint] epoch: [55.0], Train score:98.67500, Test score:98.54000, train loss:-0.98635, test loss:-0.98497, ratio_train_loss:0.18300,ratio_test_loss:0.18332, total_loss_train:-0.80335,total_loss_test:-0.80165, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6608, epoch 56.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6608, epoch 56.0)
[Save Checkpoint] epoch: [56.0], Train score:98.56667, Test score:98.21000, train loss:-0.98542, test loss:-0.98181, ratio_train_loss:0.18608,ratio_test_loss:0.18595, total_loss_train:-0.79934,total_loss_test:-0.79586, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6726, epoch 57.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6726, epoch 57.0)
[Save Checkpoint] epoch: [57.0], Train score:98.81167, Test score:98.55000, train loss:-0.98764, test loss:-0.98549, ratio_train_loss:0.18112,ratio_test_loss:0.18082, total_loss_train:-0.80652,total_loss_test:-0.80466, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6844, epoch 58.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6844, epoch 58.0)
[Save Checkpoint] epoch: [58.0], Train score:98.84333, Test score:98.63000, train loss:-0.98823, test loss:-0.98579, ratio_train_loss:0.18345,ratio_test_loss:0.18457, total_loss_train:-0.80479,total_loss_test:-0.80122, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6962, epoch 59.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 6962, epoch 59.0)
[Save Checkpoint] epoch: [59.0], Train score:98.61167, Test score:98.28000, train loss:-0.98589, test loss:-0.98220, ratio_train_loss:0.19079,ratio_test_loss:0.19114, total_loss_train:-0.79510,total_loss_test:-0.79105, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7080, epoch 60.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7080, epoch 60.0)
[Save Checkpoint] epoch: [60.0], Train score:98.57833, Test score:98.27000, train loss:-0.98559, test loss:-0.98215, ratio_train_loss:0.17956,ratio_test_loss:0.18107, total_loss_train:-0.80603,total_loss_test:-0.80107, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7198, epoch 61.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7198, epoch 61.0)
[Save Checkpoint] epoch: [61.0], Train score:98.16833, Test score:97.82000, train loss:-0.98141, test loss:-0.97804, ratio_train_loss:0.18747,ratio_test_loss:0.18826, total_loss_train:-0.79395,total_loss_test:-0.78978, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7316, epoch 62.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7316, epoch 62.0)
[Save Checkpoint] epoch: [62.0], Train score:98.63667, Test score:98.24000, train loss:-0.98605, test loss:-0.98238, ratio_train_loss:0.17859,ratio_test_loss:0.17984, total_loss_train:-0.80746,total_loss_test:-0.80254, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7434, epoch 63.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7434, epoch 63.0)
[Save Checkpoint] epoch: [63.0], Train score:98.70167, Test score:98.28000, train loss:-0.98644, test loss:-0.98249, ratio_train_loss:0.18236,ratio_test_loss:0.18337, total_loss_train:-0.80408,total_loss_test:-0.79912, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7552, epoch 64.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7552, epoch 64.0)
[Save Checkpoint] epoch: [64.0], Train score:98.84167, Test score:98.52000, train loss:-0.98787, test loss:-0.98479, ratio_train_loss:0.18341,ratio_test_loss:0.18515, total_loss_train:-0.80446,total_loss_test:-0.79964, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7670, epoch 65.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7670, epoch 65.0)
[Save Checkpoint] epoch: [65.0], Train score:98.85667, Test score:98.37000, train loss:-0.98821, test loss:-0.98339, ratio_train_loss:0.17614,ratio_test_loss:0.17786, total_loss_train:-0.81208,total_loss_test:-0.80554, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7788, epoch 66.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7788, epoch 66.0)
[Save Checkpoint] epoch: [66.0], Train score:98.96333, Test score:98.66000, train loss:-0.98934, test loss:-0.98613, ratio_train_loss:0.18132,ratio_test_loss:0.18348, total_loss_train:-0.80802,total_loss_test:-0.80265, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7906, epoch 67.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 7906, epoch 67.0)
[Save Checkpoint] epoch: [67.0], Train score:98.90667, Test score:98.53000, train loss:-0.98882, test loss:-0.98482, ratio_train_loss:0.17782,ratio_test_loss:0.17968, total_loss_train:-0.81100,total_loss_test:-0.80514, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8024, epoch 68.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8024, epoch 68.0)
[Save Checkpoint] epoch: [68.0], Train score:98.77667, Test score:98.41000, train loss:-0.98750, test loss:-0.98355, ratio_train_loss:0.18371,ratio_test_loss:0.18503, total_loss_train:-0.80378,total_loss_test:-0.79852, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8142, epoch 69.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8142, epoch 69.0)
[Save Checkpoint] epoch: [69.0], Train score:98.81500, Test score:98.66000, train loss:-0.98805, test loss:-0.98604, ratio_train_loss:0.17590,ratio_test_loss:0.17636, total_loss_train:-0.81215,total_loss_test:-0.80969, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8260, epoch 70.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8260, epoch 70.0)
[Save Checkpoint] epoch: [70.0], Train score:98.78333, Test score:98.53000, train loss:-0.98773, test loss:-0.98476, ratio_train_loss:0.17895,ratio_test_loss:0.17944, total_loss_train:-0.80878,total_loss_test:-0.80532, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8378, epoch 71.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8378, epoch 71.0)
[Save Checkpoint] epoch: [71.0], Train score:98.82667, Test score:98.47000, train loss:-0.98812, test loss:-0.98476, ratio_train_loss:0.17774,ratio_test_loss:0.17946, total_loss_train:-0.81038,total_loss_test:-0.80530, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8496, epoch 72.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8496, epoch 72.0)
[Save Checkpoint] epoch: [72.0], Train score:98.85667, Test score:98.52000, train loss:-0.98837, test loss:-0.98484, ratio_train_loss:0.19169,ratio_test_loss:0.19119, total_loss_train:-0.79668,total_loss_test:-0.79365, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8614, epoch 73.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8614, epoch 73.0)
[Save Checkpoint] epoch: [73.0], Train score:98.93500, Test score:98.51000, train loss:-0.98902, test loss:-0.98482, ratio_train_loss:0.17522,ratio_test_loss:0.17857, total_loss_train:-0.81380,total_loss_test:-0.80625, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8732, epoch 74.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8732, epoch 74.0)
[Save Checkpoint] epoch: [74.0], Train score:98.97833, Test score:98.68000, train loss:-0.98974, test loss:-0.98646, ratio_train_loss:0.17558,ratio_test_loss:0.17721, total_loss_train:-0.81416,total_loss_test:-0.80925, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8850, epoch 75.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8850, epoch 75.0)
[Save Checkpoint] epoch: [75.0], Train score:98.89667, Test score:98.53000, train loss:-0.98886, test loss:-0.98535, ratio_train_loss:0.17414,ratio_test_loss:0.17683, total_loss_train:-0.81472,total_loss_test:-0.80853, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8968, epoch 76.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 8968, epoch 76.0)
[Save Checkpoint] epoch: [76.0], Train score:98.69000, Test score:98.16000, train loss:-0.98642, test loss:-0.98179, ratio_train_loss:0.17698,ratio_test_loss:0.17866, total_loss_train:-0.80945,total_loss_test:-0.80313, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9086, epoch 77.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9086, epoch 77.0)
[Save Checkpoint] epoch: [77.0], Train score:98.68333, Test score:98.22000, train loss:-0.98629, test loss:-0.98221, ratio_train_loss:0.18220,ratio_test_loss:0.18423, total_loss_train:-0.80409,total_loss_test:-0.79798, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9204, epoch 78.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9204, epoch 78.0)
[Save Checkpoint] epoch: [78.0], Train score:99.00833, Test score:98.67000, train loss:-0.98989, test loss:-0.98646, ratio_train_loss:0.17589,ratio_test_loss:0.17787, total_loss_train:-0.81400,total_loss_test:-0.80859, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9322, epoch 79.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9322, epoch 79.0)
[Save Checkpoint] epoch: [79.0], Train score:98.94500, Test score:98.69000, train loss:-0.98939, test loss:-0.98649, ratio_train_loss:0.17898,ratio_test_loss:0.17900, total_loss_train:-0.81040,total_loss_test:-0.80750, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9440, epoch 80.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9440, epoch 80.0)
[Save Checkpoint] epoch: [80.0], Train score:98.85333, Test score:98.56000, train loss:-0.98839, test loss:-0.98555, ratio_train_loss:0.17106,ratio_test_loss:0.17191, total_loss_train:-0.81733,total_loss_test:-0.81364, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9558, epoch 81.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9558, epoch 81.0)
[Save Checkpoint] epoch: [81.0], Train score:98.90333, Test score:98.44000, train loss:-0.98870, test loss:-0.98452, ratio_train_loss:0.17651,ratio_test_loss:0.17861, total_loss_train:-0.81219,total_loss_test:-0.80591, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9676, epoch 82.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9676, epoch 82.0)
[Save Checkpoint] epoch: [82.0], Train score:98.92167, Test score:98.50000, train loss:-0.98904, test loss:-0.98500, ratio_train_loss:0.18154,ratio_test_loss:0.18389, total_loss_train:-0.80750,total_loss_test:-0.80111, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9794, epoch 83.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9794, epoch 83.0)
[Save Checkpoint] epoch: [83.0], Train score:98.84833, Test score:98.53000, train loss:-0.98826, test loss:-0.98508, ratio_train_loss:0.17294,ratio_test_loss:0.17440, total_loss_train:-0.81532,total_loss_test:-0.81068, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9912, epoch 84.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 9912, epoch 84.0)
[Save Checkpoint] epoch: [84.0], Train score:98.93833, Test score:98.63000, train loss:-0.98940, test loss:-0.98611, ratio_train_loss:0.18199,ratio_test_loss:0.18460, total_loss_train:-0.80741,total_loss_test:-0.80150, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10030, epoch 85.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10030, epoch 85.0)
[Save Checkpoint] epoch: [85.0], Train score:98.96167, Test score:98.58000, train loss:-0.98923, test loss:-0.98519, ratio_train_loss:0.18256,ratio_test_loss:0.18525, total_loss_train:-0.80666,total_loss_test:-0.79994, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10148, epoch 86.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10148, epoch 86.0)
[Save Checkpoint] epoch: [86.0], Train score:98.96667, Test score:98.47000, train loss:-0.98940, test loss:-0.98445, ratio_train_loss:0.17178,ratio_test_loss:0.17420, total_loss_train:-0.81762,total_loss_test:-0.81024, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10266, epoch 87.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10266, epoch 87.0)
[Save Checkpoint] epoch: [87.0], Train score:98.87333, Test score:98.45000, train loss:-0.98872, test loss:-0.98440, ratio_train_loss:0.17834,ratio_test_loss:0.17931, total_loss_train:-0.81038,total_loss_test:-0.80508, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10384, epoch 88.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10384, epoch 88.0)
[Save Checkpoint] epoch: [88.0], Train score:99.02500, Test score:98.57000, train loss:-0.99004, test loss:-0.98541, ratio_train_loss:0.18254,ratio_test_loss:0.18524, total_loss_train:-0.80750,total_loss_test:-0.80017, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10502, epoch 89.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10502, epoch 89.0)
[Save Checkpoint] epoch: [89.0], Train score:98.87500, Test score:98.31000, train loss:-0.98871, test loss:-0.98313, ratio_train_loss:0.17793,ratio_test_loss:0.18108, total_loss_train:-0.81078,total_loss_test:-0.80205, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10620, epoch 90.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10620, epoch 90.0)
[Save Checkpoint] epoch: [90.0], Train score:98.98167, Test score:98.47000, train loss:-0.98976, test loss:-0.98468, ratio_train_loss:0.17701,ratio_test_loss:0.17937, total_loss_train:-0.81274,total_loss_test:-0.80531, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10738, epoch 91.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10738, epoch 91.0)
[Save Checkpoint] epoch: [91.0], Train score:98.96000, Test score:98.24000, train loss:-0.98938, test loss:-0.98245, ratio_train_loss:0.17190,ratio_test_loss:0.17388, total_loss_train:-0.81748,total_loss_test:-0.80857, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10856, epoch 92.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10856, epoch 92.0)
[Save Checkpoint] epoch: [92.0], Train score:98.74333, Test score:98.20000, train loss:-0.98709, test loss:-0.98128, ratio_train_loss:0.16597,ratio_test_loss:0.16860, total_loss_train:-0.82112,total_loss_test:-0.81268, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10974, epoch 93.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 10974, epoch 93.0)
[Save Checkpoint] epoch: [93.0], Train score:99.11000, Test score:98.74000, train loss:-0.99089, test loss:-0.98723, ratio_train_loss:0.17388,ratio_test_loss:0.17590, total_loss_train:-0.81701,total_loss_test:-0.81132, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 11092, epoch 94.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 11092, epoch 94.0)
[Save Checkpoint] epoch: [94.0], Train score:99.04833, Test score:98.50000, train loss:-0.99036, test loss:-0.98509, ratio_train_loss:0.17363,ratio_test_loss:0.17580, total_loss_train:-0.81673,total_loss_test:-0.80929, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 11210, epoch 95.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 11210, epoch 95.0)
[Save Checkpoint] epoch: [95.0], Train score:98.92167, Test score:98.37000, train loss:-0.98902, test loss:-0.98329, ratio_train_loss:0.17553,ratio_test_loss:0.17823, total_loss_train:-0.81349,total_loss_test:-0.80507, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 11328, epoch 96.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 11328, epoch 96.0)
[Save Checkpoint] epoch: [96.0], Train score:99.05500, Test score:98.70000, train loss:-0.99046, test loss:-0.98637, ratio_train_loss:0.16706,ratio_test_loss:0.16968, total_loss_train:-0.82339,total_loss_test:-0.81669, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 11446, epoch 97.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 11446, epoch 97.0)
[Save Checkpoint] epoch: [97.0], Train score:99.01667, Test score:98.53000, train loss:-0.99012, test loss:-0.98535, ratio_train_loss:0.17322,ratio_test_loss:0.17680, total_loss_train:-0.81690,total_loss_test:-0.80855, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 11564, epoch 98.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 11564, epoch 98.0)
[Save Checkpoint] epoch: [98.0], Train score:98.97000, Test score:98.44000, train loss:-0.98954, test loss:-0.98435, ratio_train_loss:0.18271,ratio_test_loss:0.18469, total_loss_train:-0.80683,total_loss_test:-0.79966, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 11682, epoch 99.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 11682, epoch 99.0)
[Save Checkpoint] epoch: [99.0], Train score:98.95667, Test score:98.48000, train loss:-0.98951, test loss:-0.98463, ratio_train_loss:0.17688,ratio_test_loss:0.18077, total_loss_train:-0.81263,total_loss_test:-0.80386, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 11800, epoch 100.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_3/last' (iter 11800, epoch 100.0)
[Save Checkpoint] epoch: [100.0], Train score:99.04500, Test score:98.51000, train loss:-0.99014, test loss:-0.98464, ratio_train_loss:0.17366,ratio_test_loss:0.17600, total_loss_train:-0.81648,total_loss_test:-0.80865, 
[Training Finished]
All Done!
