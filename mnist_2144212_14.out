14
--dataset mnist --model CNN --gpu_devices 0 1 --max_iter 100 --batch_size 128 --ckpt_dir checkpoints_CNN --ckpt_dir_scores checkpoint_scores_CNN --use_scheduler True --GMP True --lr 1e-3 --z_struct_size 20 --add_classification_layer True --classif_layer_size 30 --is_default_model False --is_custom_model False --is_custom_model_BK True --big_kernel_size 8 --two_conv_layer True --three_conv_layer False --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 32 --hidden_filters_layer2 32 --hidden_filters_layer3 32 --ratio_reg True --lambda_ratio_reg 0.0001 --lambda_class 1 --exp_name CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, GMP=True, L1_norm_act=False, L1_norm_weights=False, L3_without_random=False, adapt_lr=False, add_classification_layer=True, add_linear_after_GMP=True, add_z_struct_bottleneck=False, batch_size=128, beta=1, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=[8], binary_z=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, cuda=True, dataset='mnist', display_step=10000, dset_dir='data', exp_name='CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5', gamma=1000, gpu_devices=[0, 1], hidden_filters_layer1=32, hidden_filters_layer2=32, hidden_filters_layer3=32, image_size=64, is_C=True, is_E1=False, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=True, is_default_model=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_VAE=1, lambda_class=1.0, lambda_partial_class=1, lambda_ratio_reg=0.0001, lambda_recon_wt_rand=1, lambda_recons=1, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', lr=0.001, max_iter=100.0, model='CNN', num_workers=2, old_weighted=False, other_ratio=False, random_percentage=0.2, ratio_reg=True, save_step=10000, second_layer_C=False, seed=1, stride_size=1, three_conv_layer=False, train=True, two_conv_layer=True, two_encoder=False, use_early_stopping=False, use_scheduler=True, z_struct_size=20, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
Custom_CNN_BK(
  (net): Sequential(
    (0): Conv2d(1, 32, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(32, 32, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): AdaptiveMaxPool2d(output_size=(1, 1))
    (7): View()
    (8): Linear(in_features=32, out_features=20, bias=True)
    (9): BatchNorm1d(20, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (10): ReLU(inplace=True)
    (11): Dropout(p=0.4, inplace=False)
    (12): Linear(in_features=20, out_features=30, bias=True)
    (13): BatchNorm1d(30, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU(inplace=True)
    (15): Dropout(p=0.4, inplace=False)
    (16): Linear(in_features=30, out_features=10, bias=True)
    (17): Softmax(dim=None)
  )
)
The number of parameters of model is 20324
use 1 gpu who named: Tesla V100-SXM2-32GB
=> loaded sample_scores and losses
=> no checkpoint found at 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last'
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 469, epoch 1.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 469, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train score:69.28333, Test score:68.80000, train loss:-0.67795, test loss:-0.67465, ratio_train_loss:0.38709,ratio_test_loss:0.37711, total_loss_train:-0.29087,total_loss_test:-0.29754, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 938, epoch 2.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 938, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train score:95.53167, Test score:95.67000, train loss:-0.92589, test loss:-0.92783, ratio_train_loss:0.27748,ratio_test_loss:0.26855, total_loss_train:-0.64841,total_loss_test:-0.65928, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 1407, epoch 3.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 1407, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train score:96.70667, Test score:96.68000, train loss:-0.96072, test loss:-0.96148, ratio_train_loss:0.25619,ratio_test_loss:0.24715, total_loss_train:-0.70453,total_loss_test:-0.71433, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 1876, epoch 4.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 1876, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train score:97.38167, Test score:97.25000, train loss:-0.97041, test loss:-0.97034, ratio_train_loss:0.23855,ratio_test_loss:0.23320, total_loss_train:-0.73186,total_loss_test:-0.73714, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 2345, epoch 5.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 2345, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train score:97.44167, Test score:97.41000, train loss:-0.97208, test loss:-0.97196, ratio_train_loss:0.22847,ratio_test_loss:0.22378, total_loss_train:-0.74361,total_loss_test:-0.74818, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 2814, epoch 6.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 2814, epoch 6.0)
[Save Checkpoint] epoch: [6.0], Train score:97.63500, Test score:97.62000, train loss:-0.97487, test loss:-0.97495, ratio_train_loss:0.22234,ratio_test_loss:0.21438, total_loss_train:-0.75252,total_loss_test:-0.76057, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 3283, epoch 7.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 3283, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train score:97.59167, Test score:97.55000, train loss:-0.97418, test loss:-0.97370, ratio_train_loss:0.23062,ratio_test_loss:0.22645, total_loss_train:-0.74356,total_loss_test:-0.74725, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 3752, epoch 8.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 3752, epoch 8.0)
[Save Checkpoint] epoch: [8.0], Train score:97.93500, Test score:97.85000, train loss:-0.97800, test loss:-0.97748, ratio_train_loss:0.20391,ratio_test_loss:0.19895, total_loss_train:-0.77409,total_loss_test:-0.77854, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 4221, epoch 9.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 4221, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train score:97.81000, Test score:97.63000, train loss:-0.97705, test loss:-0.97559, ratio_train_loss:0.20893,ratio_test_loss:0.20577, total_loss_train:-0.76812,total_loss_test:-0.76982, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 4690, epoch 10.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 4690, epoch 10.0)
[Save Checkpoint] epoch: [10.0], Train score:97.75667, Test score:97.58000, train loss:-0.97656, test loss:-0.97509, ratio_train_loss:0.21099,ratio_test_loss:0.20653, total_loss_train:-0.76557,total_loss_test:-0.76856, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 5159, epoch 11.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 5159, epoch 11.0)
[Save Checkpoint] epoch: [11.0], Train score:98.03167, Test score:97.91000, train loss:-0.97934, test loss:-0.97796, ratio_train_loss:0.20361,ratio_test_loss:0.20048, total_loss_train:-0.77573,total_loss_test:-0.77748, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 5628, epoch 12.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 5628, epoch 12.0)
[Save Checkpoint] epoch: [12.0], Train score:98.21167, Test score:98.07000, train loss:-0.98144, test loss:-0.98049, ratio_train_loss:0.19771,ratio_test_loss:0.19339, total_loss_train:-0.78374,total_loss_test:-0.78710, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 6097, epoch 13.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 6097, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train score:97.98667, Test score:97.96000, train loss:-0.97931, test loss:-0.97929, ratio_train_loss:0.20496,ratio_test_loss:0.20144, total_loss_train:-0.77435,total_loss_test:-0.77785, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 6566, epoch 14.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 6566, epoch 14.0)
[Save Checkpoint] epoch: [14.0], Train score:98.26333, Test score:97.96000, train loss:-0.98193, test loss:-0.97926, ratio_train_loss:0.19846,ratio_test_loss:0.19538, total_loss_train:-0.78347,total_loss_test:-0.78388, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 7035, epoch 15.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 7035, epoch 15.0)
[Save Checkpoint] epoch: [15.0], Train score:98.05167, Test score:97.89000, train loss:-0.97997, test loss:-0.97859, ratio_train_loss:0.18708,ratio_test_loss:0.18499, total_loss_train:-0.79289,total_loss_test:-0.79360, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 7504, epoch 16.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 7504, epoch 16.0)
[Save Checkpoint] epoch: [16.0], Train score:98.17667, Test score:97.83000, train loss:-0.98135, test loss:-0.97829, ratio_train_loss:0.20293,ratio_test_loss:0.20179, total_loss_train:-0.77842,total_loss_test:-0.77649, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 7973, epoch 17.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 7973, epoch 17.0)
[Save Checkpoint] epoch: [17.0], Train score:98.20667, Test score:98.23000, train loss:-0.98158, test loss:-0.98202, ratio_train_loss:0.19518,ratio_test_loss:0.19265, total_loss_train:-0.78640,total_loss_test:-0.78937, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 8442, epoch 18.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 8442, epoch 18.0)
[Save Checkpoint] epoch: [18.0], Train score:98.29167, Test score:98.17000, train loss:-0.98241, test loss:-0.98078, ratio_train_loss:0.18785,ratio_test_loss:0.18509, total_loss_train:-0.79455,total_loss_test:-0.79569, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 8911, epoch 19.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 8911, epoch 19.0)
[Save Checkpoint] epoch: [19.0], Train score:98.30000, Test score:98.20000, train loss:-0.98248, test loss:-0.98176, ratio_train_loss:0.19221,ratio_test_loss:0.18858, total_loss_train:-0.79028,total_loss_test:-0.79317, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 9380, epoch 20.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 9380, epoch 20.0)
[Save Checkpoint] epoch: [20.0], Train score:98.33167, Test score:98.25000, train loss:-0.98303, test loss:-0.98267, ratio_train_loss:0.19356,ratio_test_loss:0.18967, total_loss_train:-0.78947,total_loss_test:-0.79300, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 9849, epoch 21.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 9849, epoch 21.0)
[Save Checkpoint] epoch: [21.0], Train score:98.43167, Test score:98.39000, train loss:-0.98401, test loss:-0.98382, ratio_train_loss:0.18739,ratio_test_loss:0.18260, total_loss_train:-0.79662,total_loss_test:-0.80122, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 10318, epoch 22.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 10318, epoch 22.0)
[Save Checkpoint] epoch: [22.0], Train score:98.20500, Test score:98.15000, train loss:-0.98172, test loss:-0.98157, ratio_train_loss:0.19509,ratio_test_loss:0.19053, total_loss_train:-0.78663,total_loss_test:-0.79104, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 10787, epoch 23.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 10787, epoch 23.0)
[Save Checkpoint] epoch: [23.0], Train score:98.30833, Test score:98.19000, train loss:-0.98269, test loss:-0.98172, ratio_train_loss:0.17851,ratio_test_loss:0.17509, total_loss_train:-0.80417,total_loss_test:-0.80664, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 11256, epoch 24.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 11256, epoch 24.0)
[Save Checkpoint] epoch: [24.0], Train score:98.35167, Test score:98.20000, train loss:-0.98313, test loss:-0.98209, ratio_train_loss:0.19030,ratio_test_loss:0.18641, total_loss_train:-0.79283,total_loss_test:-0.79568, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 11725, epoch 25.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 11725, epoch 25.0)
[Save Checkpoint] epoch: [25.0], Train score:98.52500, Test score:98.42000, train loss:-0.98487, test loss:-0.98407, ratio_train_loss:0.18777,ratio_test_loss:0.18491, total_loss_train:-0.79710,total_loss_test:-0.79916, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 12194, epoch 26.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 12194, epoch 26.0)
[Save Checkpoint] epoch: [26.0], Train score:98.51000, Test score:98.37000, train loss:-0.98482, test loss:-0.98365, ratio_train_loss:0.18900,ratio_test_loss:0.18758, total_loss_train:-0.79582,total_loss_test:-0.79607, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 12663, epoch 27.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 12663, epoch 27.0)
[Save Checkpoint] epoch: [27.0], Train score:98.45833, Test score:98.47000, train loss:-0.98435, test loss:-0.98437, ratio_train_loss:0.18929,ratio_test_loss:0.18537, total_loss_train:-0.79505,total_loss_test:-0.79900, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 13132, epoch 28.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 13132, epoch 28.0)
[Save Checkpoint] epoch: [28.0], Train score:98.40500, Test score:98.24000, train loss:-0.98373, test loss:-0.98254, ratio_train_loss:0.19137,ratio_test_loss:0.18829, total_loss_train:-0.79236,total_loss_test:-0.79425, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 13601, epoch 29.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 13601, epoch 29.0)
[Save Checkpoint] epoch: [29.0], Train score:98.17167, Test score:97.87000, train loss:-0.98139, test loss:-0.97897, ratio_train_loss:0.19503,ratio_test_loss:0.19158, total_loss_train:-0.78636,total_loss_test:-0.78739, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 14070, epoch 30.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 14070, epoch 30.0)
[Save Checkpoint] epoch: [30.0], Train score:98.44333, Test score:98.37000, train loss:-0.98418, test loss:-0.98344, ratio_train_loss:0.18203,ratio_test_loss:0.17757, total_loss_train:-0.80214,total_loss_test:-0.80586, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 14539, epoch 31.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 14539, epoch 31.0)
[Save Checkpoint] epoch: [31.0], Train score:98.33000, Test score:98.21000, train loss:-0.98302, test loss:-0.98220, ratio_train_loss:0.18819,ratio_test_loss:0.18513, total_loss_train:-0.79482,total_loss_test:-0.79708, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 15008, epoch 32.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 15008, epoch 32.0)
[Save Checkpoint] epoch: [32.0], Train score:98.44500, Test score:98.43000, train loss:-0.98402, test loss:-0.98421, ratio_train_loss:0.18419,ratio_test_loss:0.18010, total_loss_train:-0.79983,total_loss_test:-0.80411, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 15477, epoch 33.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 15477, epoch 33.0)
[Save Checkpoint] epoch: [33.0], Train score:98.57167, Test score:98.39000, train loss:-0.98551, test loss:-0.98386, ratio_train_loss:0.18504,ratio_test_loss:0.18303, total_loss_train:-0.80047,total_loss_test:-0.80083, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 15946, epoch 34.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 15946, epoch 34.0)
[Save Checkpoint] epoch: [34.0], Train score:98.44333, Test score:98.20000, train loss:-0.98433, test loss:-0.98204, ratio_train_loss:0.19282,ratio_test_loss:0.19054, total_loss_train:-0.79151,total_loss_test:-0.79150, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 16415, epoch 35.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 16415, epoch 35.0)
[Save Checkpoint] epoch: [35.0], Train score:98.47000, Test score:98.18000, train loss:-0.98447, test loss:-0.98165, ratio_train_loss:0.17478,ratio_test_loss:0.17226, total_loss_train:-0.80969,total_loss_test:-0.80939, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 16884, epoch 36.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 16884, epoch 36.0)
[Save Checkpoint] epoch: [36.0], Train score:98.47833, Test score:98.24000, train loss:-0.98463, test loss:-0.98244, ratio_train_loss:0.18596,ratio_test_loss:0.18286, total_loss_train:-0.79867,total_loss_test:-0.79958, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 17353, epoch 37.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 17353, epoch 37.0)
[Save Checkpoint] epoch: [37.0], Train score:98.49833, Test score:98.49000, train loss:-0.98484, test loss:-0.98461, ratio_train_loss:0.18017,ratio_test_loss:0.17727, total_loss_train:-0.80466,total_loss_test:-0.80735, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 17822, epoch 38.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 17822, epoch 38.0)
[Save Checkpoint] epoch: [38.0], Train score:98.56167, Test score:98.39000, train loss:-0.98534, test loss:-0.98383, ratio_train_loss:0.18211,ratio_test_loss:0.18031, total_loss_train:-0.80324,total_loss_test:-0.80352, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 18291, epoch 39.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 18291, epoch 39.0)
[Save Checkpoint] epoch: [39.0], Train score:98.53500, Test score:98.32000, train loss:-0.98501, test loss:-0.98322, ratio_train_loss:0.17950,ratio_test_loss:0.17772, total_loss_train:-0.80551,total_loss_test:-0.80550, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 18760, epoch 40.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 18760, epoch 40.0)
[Save Checkpoint] epoch: [40.0], Train score:98.45167, Test score:98.31000, train loss:-0.98437, test loss:-0.98283, ratio_train_loss:0.18341,ratio_test_loss:0.18197, total_loss_train:-0.80095,total_loss_test:-0.80086, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 19229, epoch 41.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 19229, epoch 41.0)
[Save Checkpoint] epoch: [41.0], Train score:98.55333, Test score:98.28000, train loss:-0.98542, test loss:-0.98290, ratio_train_loss:0.17863,ratio_test_loss:0.17644, total_loss_train:-0.80679,total_loss_test:-0.80645, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 19698, epoch 42.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 19698, epoch 42.0)
[Save Checkpoint] epoch: [42.0], Train score:98.60667, Test score:98.38000, train loss:-0.98598, test loss:-0.98375, ratio_train_loss:0.18985,ratio_test_loss:0.18629, total_loss_train:-0.79612,total_loss_test:-0.79746, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 20167, epoch 43.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 20167, epoch 43.0)
[Save Checkpoint] epoch: [43.0], Train score:98.44500, Test score:98.11000, train loss:-0.98414, test loss:-0.98137, ratio_train_loss:0.18351,ratio_test_loss:0.18073, total_loss_train:-0.80063,total_loss_test:-0.80064, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 20636, epoch 44.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 20636, epoch 44.0)
[Save Checkpoint] epoch: [44.0], Train score:98.58833, Test score:98.31000, train loss:-0.98552, test loss:-0.98286, ratio_train_loss:0.18182,ratio_test_loss:0.18063, total_loss_train:-0.80371,total_loss_test:-0.80223, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 21105, epoch 45.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 21105, epoch 45.0)
[Save Checkpoint] epoch: [45.0], Train score:98.09333, Test score:97.84000, train loss:-0.98069, test loss:-0.97875, ratio_train_loss:0.18053,ratio_test_loss:0.18026, total_loss_train:-0.80016,total_loss_test:-0.79849, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 21574, epoch 46.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 21574, epoch 46.0)
[Save Checkpoint] epoch: [46.0], Train score:98.54667, Test score:98.21000, train loss:-0.98521, test loss:-0.98230, ratio_train_loss:0.17837,ratio_test_loss:0.17743, total_loss_train:-0.80684,total_loss_test:-0.80487, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 22043, epoch 47.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 22043, epoch 47.0)
[Save Checkpoint] epoch: [47.0], Train score:98.57833, Test score:98.31000, train loss:-0.98564, test loss:-0.98347, ratio_train_loss:0.17573,ratio_test_loss:0.17308, total_loss_train:-0.80991,total_loss_test:-0.81039, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 22512, epoch 48.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 22512, epoch 48.0)
[Save Checkpoint] epoch: [48.0], Train score:98.59167, Test score:98.24000, train loss:-0.98586, test loss:-0.98263, ratio_train_loss:0.18226,ratio_test_loss:0.18062, total_loss_train:-0.80360,total_loss_test:-0.80202, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 22981, epoch 49.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 22981, epoch 49.0)
[Save Checkpoint] epoch: [49.0], Train score:98.70667, Test score:98.62000, train loss:-0.98681, test loss:-0.98608, ratio_train_loss:0.17970,ratio_test_loss:0.17689, total_loss_train:-0.80712,total_loss_test:-0.80920, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 23450, epoch 50.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 23450, epoch 50.0)
[Save Checkpoint] epoch: [50.0], Train score:98.60333, Test score:98.29000, train loss:-0.98578, test loss:-0.98283, ratio_train_loss:0.17711,ratio_test_loss:0.17601, total_loss_train:-0.80867,total_loss_test:-0.80682, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 23919, epoch 51.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 23919, epoch 51.0)
[Save Checkpoint] epoch: [51.0], Train score:98.70500, Test score:98.42000, train loss:-0.98696, test loss:-0.98367, ratio_train_loss:0.17517,ratio_test_loss:0.17407, total_loss_train:-0.81179,total_loss_test:-0.80960, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 24388, epoch 52.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 24388, epoch 52.0)
[Save Checkpoint] epoch: [52.0], Train score:98.50333, Test score:98.18000, train loss:-0.98498, test loss:-0.98180, ratio_train_loss:0.18007,ratio_test_loss:0.17967, total_loss_train:-0.80491,total_loss_test:-0.80213, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 24857, epoch 53.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 24857, epoch 53.0)
[Save Checkpoint] epoch: [53.0], Train score:98.55833, Test score:98.37000, train loss:-0.98541, test loss:-0.98386, ratio_train_loss:0.19224,ratio_test_loss:0.18985, total_loss_train:-0.79317,total_loss_test:-0.79401, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 25326, epoch 54.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 25326, epoch 54.0)
[Save Checkpoint] epoch: [54.0], Train score:98.61333, Test score:98.35000, train loss:-0.98594, test loss:-0.98356, ratio_train_loss:0.18215,ratio_test_loss:0.18123, total_loss_train:-0.80379,total_loss_test:-0.80234, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 25795, epoch 55.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 25795, epoch 55.0)
[Save Checkpoint] epoch: [55.0], Train score:98.68333, Test score:98.29000, train loss:-0.98671, test loss:-0.98331, ratio_train_loss:0.18362,ratio_test_loss:0.18255, total_loss_train:-0.80309,total_loss_test:-0.80076, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 26264, epoch 56.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 26264, epoch 56.0)
[Save Checkpoint] epoch: [56.0], Train score:98.52333, Test score:98.22000, train loss:-0.98496, test loss:-0.98213, ratio_train_loss:0.17408,ratio_test_loss:0.17486, total_loss_train:-0.81088,total_loss_test:-0.80727, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 26733, epoch 57.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 26733, epoch 57.0)
[Save Checkpoint] epoch: [57.0], Train score:98.72833, Test score:98.56000, train loss:-0.98708, test loss:-0.98522, ratio_train_loss:0.18532,ratio_test_loss:0.18626, total_loss_train:-0.80177,total_loss_test:-0.79896, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 27202, epoch 58.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 27202, epoch 58.0)
[Save Checkpoint] epoch: [58.0], Train score:98.77333, Test score:98.51000, train loss:-0.98760, test loss:-0.98535, ratio_train_loss:0.17955,ratio_test_loss:0.17739, total_loss_train:-0.80805,total_loss_test:-0.80796, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 27671, epoch 59.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 27671, epoch 59.0)
[Save Checkpoint] epoch: [59.0], Train score:98.73167, Test score:98.44000, train loss:-0.98715, test loss:-0.98424, ratio_train_loss:0.17318,ratio_test_loss:0.17290, total_loss_train:-0.81397,total_loss_test:-0.81134, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 28140, epoch 60.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 28140, epoch 60.0)
[Save Checkpoint] epoch: [60.0], Train score:98.73167, Test score:98.47000, train loss:-0.98707, test loss:-0.98455, ratio_train_loss:0.17602,ratio_test_loss:0.17463, total_loss_train:-0.81105,total_loss_test:-0.80992, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 28609, epoch 61.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 28609, epoch 61.0)
[Save Checkpoint] epoch: [61.0], Train score:98.74667, Test score:98.53000, train loss:-0.98733, test loss:-0.98520, ratio_train_loss:0.18060,ratio_test_loss:0.17820, total_loss_train:-0.80673,total_loss_test:-0.80700, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 29078, epoch 62.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 29078, epoch 62.0)
[Save Checkpoint] epoch: [62.0], Train score:98.76000, Test score:98.47000, train loss:-0.98745, test loss:-0.98498, ratio_train_loss:0.16638,ratio_test_loss:0.16493, total_loss_train:-0.82108,total_loss_test:-0.82005, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 29547, epoch 63.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 29547, epoch 63.0)
[Save Checkpoint] epoch: [63.0], Train score:98.70333, Test score:98.47000, train loss:-0.98670, test loss:-0.98455, ratio_train_loss:0.17630,ratio_test_loss:0.17696, total_loss_train:-0.81040,total_loss_test:-0.80759, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 30016, epoch 64.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 30016, epoch 64.0)
[Save Checkpoint] epoch: [64.0], Train score:98.72333, Test score:98.36000, train loss:-0.98708, test loss:-0.98364, ratio_train_loss:0.17129,ratio_test_loss:0.17123, total_loss_train:-0.81579,total_loss_test:-0.81242, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 30485, epoch 65.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 30485, epoch 65.0)
[Save Checkpoint] epoch: [65.0], Train score:98.69833, Test score:98.45000, train loss:-0.98674, test loss:-0.98434, ratio_train_loss:0.17607,ratio_test_loss:0.17547, total_loss_train:-0.81068,total_loss_test:-0.80887, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 30954, epoch 66.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 30954, epoch 66.0)
[Save Checkpoint] epoch: [66.0], Train score:98.67667, Test score:98.23000, train loss:-0.98646, test loss:-0.98223, ratio_train_loss:0.17888,ratio_test_loss:0.18029, total_loss_train:-0.80758,total_loss_test:-0.80194, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 31423, epoch 67.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 31423, epoch 67.0)
[Save Checkpoint] epoch: [67.0], Train score:98.60000, Test score:98.39000, train loss:-0.98585, test loss:-0.98373, ratio_train_loss:0.17314,ratio_test_loss:0.17385, total_loss_train:-0.81271,total_loss_test:-0.80989, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 31892, epoch 68.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 31892, epoch 68.0)
[Save Checkpoint] epoch: [68.0], Train score:98.64333, Test score:98.48000, train loss:-0.98630, test loss:-0.98450, ratio_train_loss:0.17990,ratio_test_loss:0.17891, total_loss_train:-0.80640,total_loss_test:-0.80559, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 32361, epoch 69.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 32361, epoch 69.0)
[Save Checkpoint] epoch: [69.0], Train score:98.69500, Test score:98.29000, train loss:-0.98676, test loss:-0.98268, ratio_train_loss:0.17289,ratio_test_loss:0.17502, total_loss_train:-0.81387,total_loss_test:-0.80765, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 32830, epoch 70.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 32830, epoch 70.0)
[Save Checkpoint] epoch: [70.0], Train score:98.74333, Test score:98.21000, train loss:-0.98725, test loss:-0.98182, ratio_train_loss:0.17273,ratio_test_loss:0.17399, total_loss_train:-0.81452,total_loss_test:-0.80783, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 33299, epoch 71.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 33299, epoch 71.0)
[Save Checkpoint] epoch: [71.0], Train score:98.66833, Test score:98.23000, train loss:-0.98652, test loss:-0.98228, ratio_train_loss:0.17621,ratio_test_loss:0.17741, total_loss_train:-0.81031,total_loss_test:-0.80487, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 33768, epoch 72.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 33768, epoch 72.0)
[Save Checkpoint] epoch: [72.0], Train score:98.78667, Test score:98.45000, train loss:-0.98759, test loss:-0.98435, ratio_train_loss:0.17013,ratio_test_loss:0.17033, total_loss_train:-0.81746,total_loss_test:-0.81401, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 34237, epoch 73.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 34237, epoch 73.0)
[Save Checkpoint] epoch: [73.0], Train score:98.70667, Test score:98.46000, train loss:-0.98688, test loss:-0.98442, ratio_train_loss:0.18450,ratio_test_loss:0.18559, total_loss_train:-0.80238,total_loss_test:-0.79883, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 34706, epoch 74.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 34706, epoch 74.0)
[Save Checkpoint] epoch: [74.0], Train score:98.81167, Test score:98.30000, train loss:-0.98802, test loss:-0.98329, ratio_train_loss:0.17201,ratio_test_loss:0.17257, total_loss_train:-0.81602,total_loss_test:-0.81072, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 35175, epoch 75.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 35175, epoch 75.0)
[Save Checkpoint] epoch: [75.0], Train score:98.77500, Test score:98.31000, train loss:-0.98762, test loss:-0.98328, ratio_train_loss:0.17316,ratio_test_loss:0.17307, total_loss_train:-0.81446,total_loss_test:-0.81021, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 35644, epoch 76.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 35644, epoch 76.0)
[Save Checkpoint] epoch: [76.0], Train score:98.73000, Test score:98.37000, train loss:-0.98722, test loss:-0.98386, ratio_train_loss:0.17241,ratio_test_loss:0.17182, total_loss_train:-0.81481,total_loss_test:-0.81203, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 36113, epoch 77.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 36113, epoch 77.0)
[Save Checkpoint] epoch: [77.0], Train score:98.59167, Test score:98.08000, train loss:-0.98580, test loss:-0.98099, ratio_train_loss:0.17864,ratio_test_loss:0.17885, total_loss_train:-0.80716,total_loss_test:-0.80214, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 36582, epoch 78.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 36582, epoch 78.0)
[Save Checkpoint] epoch: [78.0], Train score:98.67333, Test score:98.31000, train loss:-0.98656, test loss:-0.98318, ratio_train_loss:0.17248,ratio_test_loss:0.17228, total_loss_train:-0.81408,total_loss_test:-0.81090, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 37051, epoch 79.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 37051, epoch 79.0)
[Save Checkpoint] epoch: [79.0], Train score:98.68833, Test score:98.20000, train loss:-0.98680, test loss:-0.98225, ratio_train_loss:0.17720,ratio_test_loss:0.17845, total_loss_train:-0.80960,total_loss_test:-0.80380, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 37520, epoch 80.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 37520, epoch 80.0)
[Save Checkpoint] epoch: [80.0], Train score:98.60500, Test score:98.22000, train loss:-0.98580, test loss:-0.98207, ratio_train_loss:0.18269,ratio_test_loss:0.18391, total_loss_train:-0.80310,total_loss_test:-0.79815, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 37989, epoch 81.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 37989, epoch 81.0)
[Save Checkpoint] epoch: [81.0], Train score:98.70833, Test score:98.47000, train loss:-0.98702, test loss:-0.98483, ratio_train_loss:0.17457,ratio_test_loss:0.17387, total_loss_train:-0.81245,total_loss_test:-0.81096, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 38458, epoch 82.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 38458, epoch 82.0)
[Save Checkpoint] epoch: [82.0], Train score:98.69000, Test score:98.26000, train loss:-0.98678, test loss:-0.98278, ratio_train_loss:0.18340,ratio_test_loss:0.18357, total_loss_train:-0.80338,total_loss_test:-0.79921, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 38927, epoch 83.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 38927, epoch 83.0)
[Save Checkpoint] epoch: [83.0], Train score:98.83333, Test score:98.43000, train loss:-0.98823, test loss:-0.98468, ratio_train_loss:0.17298,ratio_test_loss:0.17295, total_loss_train:-0.81525,total_loss_test:-0.81173, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 39396, epoch 84.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 39396, epoch 84.0)
[Save Checkpoint] epoch: [84.0], Train score:98.67833, Test score:98.39000, train loss:-0.98654, test loss:-0.98383, ratio_train_loss:0.17821,ratio_test_loss:0.17727, total_loss_train:-0.80833,total_loss_test:-0.80655, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 39865, epoch 85.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 39865, epoch 85.0)
[Save Checkpoint] epoch: [85.0], Train score:98.83333, Test score:98.36000, train loss:-0.98823, test loss:-0.98367, ratio_train_loss:0.17102,ratio_test_loss:0.17118, total_loss_train:-0.81721,total_loss_test:-0.81249, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 40334, epoch 86.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 40334, epoch 86.0)
[Save Checkpoint] epoch: [86.0], Train score:98.78167, Test score:98.50000, train loss:-0.98766, test loss:-0.98457, ratio_train_loss:0.17493,ratio_test_loss:0.17617, total_loss_train:-0.81273,total_loss_test:-0.80840, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 40803, epoch 87.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 40803, epoch 87.0)
[Save Checkpoint] epoch: [87.0], Train score:98.43333, Test score:98.07000, train loss:-0.98406, test loss:-0.98088, ratio_train_loss:0.17547,ratio_test_loss:0.17471, total_loss_train:-0.80860,total_loss_test:-0.80617, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 41272, epoch 88.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 41272, epoch 88.0)
[Save Checkpoint] epoch: [88.0], Train score:98.71500, Test score:98.34000, train loss:-0.98697, test loss:-0.98343, ratio_train_loss:0.17068,ratio_test_loss:0.16913, total_loss_train:-0.81629,total_loss_test:-0.81430, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 41741, epoch 89.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 41741, epoch 89.0)
[Save Checkpoint] epoch: [89.0], Train score:98.78833, Test score:98.54000, train loss:-0.98780, test loss:-0.98507, ratio_train_loss:0.17150,ratio_test_loss:0.17182, total_loss_train:-0.81630,total_loss_test:-0.81325, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 42210, epoch 90.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 42210, epoch 90.0)
[Save Checkpoint] epoch: [90.0], Train score:98.79500, Test score:98.37000, train loss:-0.98773, test loss:-0.98387, ratio_train_loss:0.17002,ratio_test_loss:0.16923, total_loss_train:-0.81771,total_loss_test:-0.81464, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 42679, epoch 91.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 42679, epoch 91.0)
[Save Checkpoint] epoch: [91.0], Train score:98.71500, Test score:98.17000, train loss:-0.98689, test loss:-0.98203, ratio_train_loss:0.17659,ratio_test_loss:0.17567, total_loss_train:-0.81031,total_loss_test:-0.80636, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 43148, epoch 92.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 43148, epoch 92.0)
[Save Checkpoint] epoch: [92.0], Train score:98.62667, Test score:98.27000, train loss:-0.98612, test loss:-0.98287, ratio_train_loss:0.17357,ratio_test_loss:0.17363, total_loss_train:-0.81254,total_loss_test:-0.80924, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 43617, epoch 93.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 43617, epoch 93.0)
[Save Checkpoint] epoch: [93.0], Train score:98.90833, Test score:98.37000, train loss:-0.98888, test loss:-0.98390, ratio_train_loss:0.16842,ratio_test_loss:0.16966, total_loss_train:-0.82046,total_loss_test:-0.81424, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 44086, epoch 94.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 44086, epoch 94.0)
[Save Checkpoint] epoch: [94.0], Train score:98.81000, Test score:98.39000, train loss:-0.98811, test loss:-0.98391, ratio_train_loss:0.16628,ratio_test_loss:0.16733, total_loss_train:-0.82183,total_loss_test:-0.81657, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 44555, epoch 95.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 44555, epoch 95.0)
[Save Checkpoint] epoch: [95.0], Train score:98.87167, Test score:98.40000, train loss:-0.98861, test loss:-0.98421, ratio_train_loss:0.17469,ratio_test_loss:0.17598, total_loss_train:-0.81392,total_loss_test:-0.80823, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 45024, epoch 96.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 45024, epoch 96.0)
[Save Checkpoint] epoch: [96.0], Train score:98.78667, Test score:98.29000, train loss:-0.98794, test loss:-0.98296, ratio_train_loss:0.16809,ratio_test_loss:0.16992, total_loss_train:-0.81986,total_loss_test:-0.81304, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 45493, epoch 97.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 45493, epoch 97.0)
[Save Checkpoint] epoch: [97.0], Train score:98.80500, Test score:98.47000, train loss:-0.98812, test loss:-0.98497, ratio_train_loss:0.16933,ratio_test_loss:0.17072, total_loss_train:-0.81879,total_loss_test:-0.81426, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 45962, epoch 98.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 45962, epoch 98.0)
[Save Checkpoint] epoch: [98.0], Train score:98.89667, Test score:98.51000, train loss:-0.98864, test loss:-0.98524, ratio_train_loss:0.17478,ratio_test_loss:0.17474, total_loss_train:-0.81386,total_loss_test:-0.81050, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 46431, epoch 99.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 46431, epoch 99.0)
[Save Checkpoint] epoch: [99.0], Train score:98.79833, Test score:98.33000, train loss:-0.98790, test loss:-0.98347, ratio_train_loss:0.16771,ratio_test_loss:0.16804, total_loss_train:-0.82020,total_loss_test:-0.81543, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 46900, epoch 100.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_128_5/last' (iter 46900, epoch 100.0)
[Save Checkpoint] epoch: [100.0], Train score:98.88000, Test score:98.39000, train loss:-0.98868, test loss:-0.98416, ratio_train_loss:0.17154,ratio_test_loss:0.17137, total_loss_train:-0.81714,total_loss_test:-0.81279, 
[Training Finished]
All Done!
