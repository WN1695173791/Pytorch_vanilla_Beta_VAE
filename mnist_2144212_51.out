51
--dataset mnist --model CNN --gpu_devices 0 1 --max_iter 100 --batch_size 512 --ckpt_dir checkpoints_CNN --ckpt_dir_scores checkpoint_scores_CNN --use_scheduler True --GMP True --lr 1e-3 --z_struct_size 20 --add_classification_layer True --classif_layer_size 30 --is_default_model False --is_custom_model False --is_custom_model_BK True --big_kernel_size 8 --two_conv_layer True --three_conv_layer False --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 32 --hidden_filters_layer2 32 --hidden_filters_layer3 32 --ratio_reg True --lambda_ratio_reg 0.1 --lambda_class 1 --other_ratio True --exp_name CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, GMP=True, L1_norm_act=False, L1_norm_weights=False, L3_without_random=False, adapt_lr=False, add_classification_layer=True, add_linear_after_GMP=True, add_z_struct_bottleneck=False, batch_size=512, beta=1, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=[8], binary_z=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, cuda=True, dataset='mnist', display_step=10000, dset_dir='data', exp_name='CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2', gamma=1000, gpu_devices=[0, 1], hidden_filters_layer1=32, hidden_filters_layer2=32, hidden_filters_layer3=32, image_size=64, is_C=True, is_E1=False, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=True, is_default_model=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_VAE=1, lambda_class=1.0, lambda_partial_class=1, lambda_ratio_reg=0.1, lambda_recon_wt_rand=1, lambda_recons=1, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', lr=0.001, max_iter=100.0, model='CNN', num_workers=2, old_weighted=False, other_ratio=True, random_percentage=0.2, ratio_reg=True, save_step=10000, second_layer_C=False, seed=1, stride_size=1, three_conv_layer=False, train=True, two_conv_layer=True, two_encoder=False, use_early_stopping=False, use_scheduler=True, z_struct_size=20, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
Custom_CNN_BK(
  (net): Sequential(
    (0): Conv2d(1, 32, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(32, 32, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): AdaptiveMaxPool2d(output_size=(1, 1))
    (7): View()
    (8): Linear(in_features=32, out_features=20, bias=True)
    (9): BatchNorm1d(20, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (10): ReLU(inplace=True)
    (11): Dropout(p=0.4, inplace=False)
    (12): Linear(in_features=20, out_features=30, bias=True)
    (13): BatchNorm1d(30, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU(inplace=True)
    (15): Dropout(p=0.4, inplace=False)
    (16): Linear(in_features=30, out_features=10, bias=True)
    (17): Softmax(dim=None)
  )
)
The number of parameters of model is 20324
use 1 gpu who named: Tesla V100-SXM2-32GB
=> loaded sample_scores and losses
=> no checkpoint found at 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last'
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 118, epoch 1.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 118, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train score:59.60667, Test score:59.44000, train loss:-0.56709, test loss:-0.56424, ratio_train_loss:2.10547,ratio_test_loss:0.51171, total_loss_train:1.53838,total_loss_test:-0.05253, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 236, epoch 2.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 236, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train score:60.18167, Test score:59.85000, train loss:-0.61013, test loss:-0.60722, ratio_train_loss:2.62131,ratio_test_loss:0.39424, total_loss_train:2.01118,total_loss_test:-0.21298, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 354, epoch 3.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 354, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train score:76.43333, Test score:76.50000, train loss:-0.72110, test loss:-0.71703, ratio_train_loss:2.88309,ratio_test_loss:0.36093, total_loss_train:2.16199,total_loss_test:-0.35610, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 472, epoch 4.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 472, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train score:78.08333, Test score:77.92000, train loss:-0.77193, test loss:-0.77056, ratio_train_loss:3.15462,ratio_test_loss:0.32050, total_loss_train:2.38269,total_loss_test:-0.45006, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 590, epoch 5.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 590, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train score:90.08667, Test score:90.12000, train loss:-0.86244, test loss:-0.86214, ratio_train_loss:3.71962,ratio_test_loss:0.27444, total_loss_train:2.85718,total_loss_test:-0.58770, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 708, epoch 6.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 708, epoch 6.0)
[Save Checkpoint] epoch: [6.0], Train score:96.16167, Test score:96.36000, train loss:-0.94694, test loss:-0.95098, ratio_train_loss:3.91142,ratio_test_loss:0.26454, total_loss_train:2.96448,total_loss_test:-0.68644, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 826, epoch 7.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 826, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train score:96.77500, Test score:96.90000, train loss:-0.95955, test loss:-0.96080, ratio_train_loss:4.01404,ratio_test_loss:0.25599, total_loss_train:3.05449,total_loss_test:-0.70481, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 944, epoch 8.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 944, epoch 8.0)
[Save Checkpoint] epoch: [8.0], Train score:97.22833, Test score:97.58000, train loss:-0.96717, test loss:-0.96977, ratio_train_loss:4.33822,ratio_test_loss:0.23307, total_loss_train:3.37106,total_loss_test:-0.73670, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1062, epoch 9.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1062, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train score:97.56000, Test score:97.72000, train loss:-0.97152, test loss:-0.97370, ratio_train_loss:4.58974,ratio_test_loss:0.22387, total_loss_train:3.61821,total_loss_test:-0.74984, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1180, epoch 10.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1180, epoch 10.0)
[Save Checkpoint] epoch: [10.0], Train score:97.68000, Test score:97.64000, train loss:-0.97357, test loss:-0.97362, ratio_train_loss:4.71822,ratio_test_loss:0.21930, total_loss_train:3.74465,total_loss_test:-0.75432, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1298, epoch 11.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1298, epoch 11.0)
[Save Checkpoint] epoch: [11.0], Train score:97.41500, Test score:97.49000, train loss:-0.97118, test loss:-0.97176, ratio_train_loss:4.70016,ratio_test_loss:0.21599, total_loss_train:3.72898,total_loss_test:-0.75577, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1416, epoch 12.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1416, epoch 12.0)
[Save Checkpoint] epoch: [12.0], Train score:97.62833, Test score:97.40000, train loss:-0.97351, test loss:-0.97186, ratio_train_loss:4.72014,ratio_test_loss:0.21520, total_loss_train:3.74662,total_loss_test:-0.75667, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1534, epoch 13.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1534, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train score:98.08333, Test score:98.05000, train loss:-0.97889, test loss:-0.97838, ratio_train_loss:4.89817,ratio_test_loss:0.20699, total_loss_train:3.91928,total_loss_test:-0.77139, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1652, epoch 14.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1652, epoch 14.0)
[Save Checkpoint] epoch: [14.0], Train score:98.06167, Test score:98.06000, train loss:-0.97881, test loss:-0.97915, ratio_train_loss:5.12391,ratio_test_loss:0.20001, total_loss_train:4.14509,total_loss_test:-0.77915, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1770, epoch 15.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1770, epoch 15.0)
[Save Checkpoint] epoch: [15.0], Train score:98.13000, Test score:97.89000, train loss:-0.97974, test loss:-0.97720, ratio_train_loss:4.93961,ratio_test_loss:0.20981, total_loss_train:3.95986,total_loss_test:-0.76739, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1888, epoch 16.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 1888, epoch 16.0)
[Save Checkpoint] epoch: [16.0], Train score:98.17667, Test score:98.08000, train loss:-0.98036, test loss:-0.97924, ratio_train_loss:5.01833,ratio_test_loss:0.20380, total_loss_train:4.03797,total_loss_test:-0.77544, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2006, epoch 17.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2006, epoch 17.0)
[Save Checkpoint] epoch: [17.0], Train score:98.20000, Test score:98.20000, train loss:-0.98079, test loss:-0.98041, ratio_train_loss:5.20128,ratio_test_loss:0.19831, total_loss_train:4.22049,total_loss_test:-0.78209, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2124, epoch 18.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2124, epoch 18.0)
[Save Checkpoint] epoch: [18.0], Train score:98.18167, Test score:98.06000, train loss:-0.98068, test loss:-0.97959, ratio_train_loss:5.28439,ratio_test_loss:0.19482, total_loss_train:4.30371,total_loss_test:-0.78477, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2242, epoch 19.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2242, epoch 19.0)
[Save Checkpoint] epoch: [19.0], Train score:98.34333, Test score:98.24000, train loss:-0.98232, test loss:-0.98154, ratio_train_loss:5.11208,ratio_test_loss:0.20034, total_loss_train:4.12976,total_loss_test:-0.78120, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2360, epoch 20.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2360, epoch 20.0)
[Save Checkpoint] epoch: [20.0], Train score:98.28500, Test score:98.05000, train loss:-0.98192, test loss:-0.97984, ratio_train_loss:5.08286,ratio_test_loss:0.20096, total_loss_train:4.10094,total_loss_test:-0.77888, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2478, epoch 21.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2478, epoch 21.0)
[Save Checkpoint] epoch: [21.0], Train score:98.34667, Test score:98.10000, train loss:-0.98221, test loss:-0.98048, ratio_train_loss:5.21006,ratio_test_loss:0.19753, total_loss_train:4.22786,total_loss_test:-0.78296, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2596, epoch 22.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2596, epoch 22.0)
[Save Checkpoint] epoch: [22.0], Train score:98.39667, Test score:98.28000, train loss:-0.98271, test loss:-0.98219, ratio_train_loss:5.22597,ratio_test_loss:0.19662, total_loss_train:4.24326,total_loss_test:-0.78557, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2714, epoch 23.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2714, epoch 23.0)
[Save Checkpoint] epoch: [23.0], Train score:98.42833, Test score:98.27000, train loss:-0.98352, test loss:-0.98186, ratio_train_loss:5.13771,ratio_test_loss:0.20026, total_loss_train:4.15419,total_loss_test:-0.78160, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2832, epoch 24.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2832, epoch 24.0)
[Save Checkpoint] epoch: [24.0], Train score:98.52500, Test score:98.51000, train loss:-0.98461, test loss:-0.98362, ratio_train_loss:5.53917,ratio_test_loss:0.18714, total_loss_train:4.55456,total_loss_test:-0.79649, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2950, epoch 25.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 2950, epoch 25.0)
[Save Checkpoint] epoch: [25.0], Train score:98.60167, Test score:98.31000, train loss:-0.98522, test loss:-0.98235, ratio_train_loss:5.39926,ratio_test_loss:0.19145, total_loss_train:4.41404,total_loss_test:-0.79090, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3068, epoch 26.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3068, epoch 26.0)
[Save Checkpoint] epoch: [26.0], Train score:98.50500, Test score:98.34000, train loss:-0.98428, test loss:-0.98239, ratio_train_loss:5.43808,ratio_test_loss:0.18865, total_loss_train:4.45380,total_loss_test:-0.79374, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3186, epoch 27.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3186, epoch 27.0)
[Save Checkpoint] epoch: [27.0], Train score:98.38833, Test score:98.13000, train loss:-0.98317, test loss:-0.98075, ratio_train_loss:5.46562,ratio_test_loss:0.18770, total_loss_train:4.48245,total_loss_test:-0.79305, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3304, epoch 28.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3304, epoch 28.0)
[Save Checkpoint] epoch: [28.0], Train score:98.42833, Test score:98.29000, train loss:-0.98336, test loss:-0.98180, ratio_train_loss:5.52059,ratio_test_loss:0.18886, total_loss_train:4.53723,total_loss_test:-0.79294, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3422, epoch 29.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3422, epoch 29.0)
[Save Checkpoint] epoch: [29.0], Train score:98.61667, Test score:98.38000, train loss:-0.98565, test loss:-0.98323, ratio_train_loss:5.48620,ratio_test_loss:0.18940, total_loss_train:4.50055,total_loss_test:-0.79383, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3540, epoch 30.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3540, epoch 30.0)
[Save Checkpoint] epoch: [30.0], Train score:98.53333, Test score:98.52000, train loss:-0.98476, test loss:-0.98410, ratio_train_loss:5.54010,ratio_test_loss:0.18845, total_loss_train:4.55534,total_loss_test:-0.79566, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3658, epoch 31.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3658, epoch 31.0)
[Save Checkpoint] epoch: [31.0], Train score:98.49000, Test score:98.36000, train loss:-0.98437, test loss:-0.98245, ratio_train_loss:5.61093,ratio_test_loss:0.18497, total_loss_train:4.62656,total_loss_test:-0.79748, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3776, epoch 32.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3776, epoch 32.0)
[Save Checkpoint] epoch: [32.0], Train score:98.67833, Test score:98.45000, train loss:-0.98592, test loss:-0.98408, ratio_train_loss:5.35588,ratio_test_loss:0.19239, total_loss_train:4.36996,total_loss_test:-0.79169, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3894, epoch 33.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 3894, epoch 33.0)
[Save Checkpoint] epoch: [33.0], Train score:98.49000, Test score:98.35000, train loss:-0.98440, test loss:-0.98296, ratio_train_loss:5.50576,ratio_test_loss:0.18648, total_loss_train:4.52135,total_loss_test:-0.79648, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4012, epoch 34.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4012, epoch 34.0)
[Save Checkpoint] epoch: [34.0], Train score:98.46333, Test score:98.12000, train loss:-0.98399, test loss:-0.98056, ratio_train_loss:5.25948,ratio_test_loss:0.19299, total_loss_train:4.27550,total_loss_test:-0.78758, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4130, epoch 35.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4130, epoch 35.0)
[Save Checkpoint] epoch: [35.0], Train score:98.67167, Test score:98.46000, train loss:-0.98614, test loss:-0.98392, ratio_train_loss:5.38500,ratio_test_loss:0.19207, total_loss_train:4.39886,total_loss_test:-0.79185, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4248, epoch 36.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4248, epoch 36.0)
[Save Checkpoint] epoch: [36.0], Train score:98.53500, Test score:98.27000, train loss:-0.98498, test loss:-0.98233, ratio_train_loss:5.24704,ratio_test_loss:0.19610, total_loss_train:4.26207,total_loss_test:-0.78623, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4366, epoch 37.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4366, epoch 37.0)
[Save Checkpoint] epoch: [37.0], Train score:98.52500, Test score:98.43000, train loss:-0.98471, test loss:-0.98376, ratio_train_loss:5.41014,ratio_test_loss:0.19080, total_loss_train:4.42543,total_loss_test:-0.79296, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4484, epoch 38.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4484, epoch 38.0)
[Save Checkpoint] epoch: [38.0], Train score:98.69167, Test score:98.57000, train loss:-0.98656, test loss:-0.98521, ratio_train_loss:5.38436,ratio_test_loss:0.19094, total_loss_train:4.39779,total_loss_test:-0.79427, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4602, epoch 39.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4602, epoch 39.0)
[Save Checkpoint] epoch: [39.0], Train score:98.66167, Test score:98.29000, train loss:-0.98609, test loss:-0.98233, ratio_train_loss:5.48573,ratio_test_loss:0.18955, total_loss_train:4.49964,total_loss_test:-0.79278, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4720, epoch 40.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4720, epoch 40.0)
[Save Checkpoint] epoch: [40.0], Train score:98.73000, Test score:98.40000, train loss:-0.98695, test loss:-0.98384, ratio_train_loss:5.37953,ratio_test_loss:0.19326, total_loss_train:4.39258,total_loss_test:-0.79058, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4838, epoch 41.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4838, epoch 41.0)
[Save Checkpoint] epoch: [41.0], Train score:98.73833, Test score:98.43000, train loss:-0.98706, test loss:-0.98442, ratio_train_loss:5.57145,ratio_test_loss:0.18625, total_loss_train:4.58439,total_loss_test:-0.79818, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4956, epoch 42.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 4956, epoch 42.0)
[Save Checkpoint] epoch: [42.0], Train score:98.60333, Test score:98.55000, train loss:-0.98568, test loss:-0.98501, ratio_train_loss:5.54300,ratio_test_loss:0.19063, total_loss_train:4.55732,total_loss_test:-0.79438, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5074, epoch 43.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5074, epoch 43.0)
[Save Checkpoint] epoch: [43.0], Train score:98.67667, Test score:98.30000, train loss:-0.98647, test loss:-0.98260, ratio_train_loss:5.35954,ratio_test_loss:0.19324, total_loss_train:4.37306,total_loss_test:-0.78936, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5192, epoch 44.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5192, epoch 44.0)
[Save Checkpoint] epoch: [44.0], Train score:98.53833, Test score:98.26000, train loss:-0.98482, test loss:-0.98193, ratio_train_loss:5.53985,ratio_test_loss:0.18505, total_loss_train:4.55504,total_loss_test:-0.79689, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5310, epoch 45.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5310, epoch 45.0)
[Save Checkpoint] epoch: [45.0], Train score:98.79667, Test score:98.40000, train loss:-0.98745, test loss:-0.98388, ratio_train_loss:5.90524,ratio_test_loss:0.17466, total_loss_train:4.91780,total_loss_test:-0.80921, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5428, epoch 46.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5428, epoch 46.0)
[Save Checkpoint] epoch: [46.0], Train score:98.66833, Test score:98.48000, train loss:-0.98643, test loss:-0.98430, ratio_train_loss:5.67294,ratio_test_loss:0.18332, total_loss_train:4.68651,total_loss_test:-0.80098, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5546, epoch 47.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5546, epoch 47.0)
[Save Checkpoint] epoch: [47.0], Train score:98.74167, Test score:98.62000, train loss:-0.98725, test loss:-0.98549, ratio_train_loss:5.72198,ratio_test_loss:0.18090, total_loss_train:4.73473,total_loss_test:-0.80459, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5664, epoch 48.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5664, epoch 48.0)
[Save Checkpoint] epoch: [48.0], Train score:98.76333, Test score:98.49000, train loss:-0.98711, test loss:-0.98471, ratio_train_loss:5.46315,ratio_test_loss:0.18783, total_loss_train:4.47603,total_loss_test:-0.79687, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5782, epoch 49.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5782, epoch 49.0)
[Save Checkpoint] epoch: [49.0], Train score:98.73167, Test score:98.43000, train loss:-0.98699, test loss:-0.98333, ratio_train_loss:5.74642,ratio_test_loss:0.18105, total_loss_train:4.75943,total_loss_test:-0.80228, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5900, epoch 50.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 5900, epoch 50.0)
[Save Checkpoint] epoch: [50.0], Train score:98.78500, Test score:98.61000, train loss:-0.98752, test loss:-0.98565, ratio_train_loss:5.71039,ratio_test_loss:0.18463, total_loss_train:4.72287,total_loss_test:-0.80101, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6018, epoch 51.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6018, epoch 51.0)
[Save Checkpoint] epoch: [51.0], Train score:98.80667, Test score:98.49000, train loss:-0.98777, test loss:-0.98453, ratio_train_loss:5.49763,ratio_test_loss:0.19111, total_loss_train:4.50987,total_loss_test:-0.79343, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6136, epoch 52.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6136, epoch 52.0)
[Save Checkpoint] epoch: [52.0], Train score:98.63000, Test score:98.32000, train loss:-0.98610, test loss:-0.98279, ratio_train_loss:5.47035,ratio_test_loss:0.19132, total_loss_train:4.48425,total_loss_test:-0.79147, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6254, epoch 53.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6254, epoch 53.0)
[Save Checkpoint] epoch: [53.0], Train score:98.74167, Test score:98.49000, train loss:-0.98709, test loss:-0.98455, ratio_train_loss:5.65120,ratio_test_loss:0.18282, total_loss_train:4.66411,total_loss_test:-0.80172, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6372, epoch 54.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6372, epoch 54.0)
[Save Checkpoint] epoch: [54.0], Train score:98.88333, Test score:98.58000, train loss:-0.98863, test loss:-0.98504, ratio_train_loss:5.61553,ratio_test_loss:0.18464, total_loss_train:4.62690,total_loss_test:-0.80040, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6490, epoch 55.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6490, epoch 55.0)
[Save Checkpoint] epoch: [55.0], Train score:98.85833, Test score:98.48000, train loss:-0.98834, test loss:-0.98412, ratio_train_loss:5.65889,ratio_test_loss:0.18486, total_loss_train:4.67055,total_loss_test:-0.79926, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6608, epoch 56.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6608, epoch 56.0)
[Save Checkpoint] epoch: [56.0], Train score:98.82833, Test score:98.46000, train loss:-0.98806, test loss:-0.98470, ratio_train_loss:5.60537,ratio_test_loss:0.18891, total_loss_train:4.61731,total_loss_test:-0.79579, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6726, epoch 57.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6726, epoch 57.0)
[Save Checkpoint] epoch: [57.0], Train score:98.78833, Test score:98.36000, train loss:-0.98746, test loss:-0.98355, ratio_train_loss:5.59236,ratio_test_loss:0.18391, total_loss_train:4.60490,total_loss_test:-0.79964, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6844, epoch 58.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6844, epoch 58.0)
[Save Checkpoint] epoch: [58.0], Train score:98.90167, Test score:98.57000, train loss:-0.98880, test loss:-0.98507, ratio_train_loss:5.79097,ratio_test_loss:0.18322, total_loss_train:4.80217,total_loss_test:-0.80185, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6962, epoch 59.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 6962, epoch 59.0)
[Save Checkpoint] epoch: [59.0], Train score:98.67833, Test score:98.46000, train loss:-0.98661, test loss:-0.98434, ratio_train_loss:5.62442,ratio_test_loss:0.18200, total_loss_train:4.63781,total_loss_test:-0.80233, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7080, epoch 60.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7080, epoch 60.0)
[Save Checkpoint] epoch: [60.0], Train score:98.95000, Test score:98.57000, train loss:-0.98923, test loss:-0.98538, ratio_train_loss:5.42830,ratio_test_loss:0.19270, total_loss_train:4.43907,total_loss_test:-0.79268, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7198, epoch 61.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7198, epoch 61.0)
[Save Checkpoint] epoch: [61.0], Train score:98.81833, Test score:98.31000, train loss:-0.98793, test loss:-0.98329, ratio_train_loss:5.78332,ratio_test_loss:0.18428, total_loss_train:4.79538,total_loss_test:-0.79901, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7316, epoch 62.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7316, epoch 62.0)
[Save Checkpoint] epoch: [62.0], Train score:98.79167, Test score:98.40000, train loss:-0.98772, test loss:-0.98334, ratio_train_loss:5.63795,ratio_test_loss:0.18511, total_loss_train:4.65023,total_loss_test:-0.79823, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7434, epoch 63.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7434, epoch 63.0)
[Save Checkpoint] epoch: [63.0], Train score:98.57167, Test score:98.38000, train loss:-0.98532, test loss:-0.98335, ratio_train_loss:5.60594,ratio_test_loss:0.18226, total_loss_train:4.62062,total_loss_test:-0.80109, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7552, epoch 64.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7552, epoch 64.0)
[Save Checkpoint] epoch: [64.0], Train score:98.98833, Test score:98.48000, train loss:-0.98973, test loss:-0.98448, ratio_train_loss:5.92423,ratio_test_loss:0.17663, total_loss_train:4.93450,total_loss_test:-0.80785, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7670, epoch 65.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7670, epoch 65.0)
[Save Checkpoint] epoch: [65.0], Train score:98.92333, Test score:98.58000, train loss:-0.98889, test loss:-0.98547, ratio_train_loss:6.01677,ratio_test_loss:0.17281, total_loss_train:5.02788,total_loss_test:-0.81265, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7788, epoch 66.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7788, epoch 66.0)
[Save Checkpoint] epoch: [66.0], Train score:98.93833, Test score:98.52000, train loss:-0.98931, test loss:-0.98491, ratio_train_loss:5.76128,ratio_test_loss:0.18003, total_loss_train:4.77197,total_loss_test:-0.80488, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7906, epoch 67.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 7906, epoch 67.0)
[Save Checkpoint] epoch: [67.0], Train score:98.96167, Test score:98.41000, train loss:-0.98930, test loss:-0.98383, ratio_train_loss:5.81587,ratio_test_loss:0.17934, total_loss_train:4.82657,total_loss_test:-0.80449, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8024, epoch 68.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8024, epoch 68.0)
[Save Checkpoint] epoch: [68.0], Train score:98.91167, Test score:98.38000, train loss:-0.98900, test loss:-0.98394, ratio_train_loss:5.73029,ratio_test_loss:0.17994, total_loss_train:4.74129,total_loss_test:-0.80400, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8142, epoch 69.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8142, epoch 69.0)
[Save Checkpoint] epoch: [69.0], Train score:98.81167, Test score:98.49000, train loss:-0.98775, test loss:-0.98396, ratio_train_loss:5.69929,ratio_test_loss:0.18193, total_loss_train:4.71154,total_loss_test:-0.80203, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8260, epoch 70.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8260, epoch 70.0)
[Save Checkpoint] epoch: [70.0], Train score:98.86500, Test score:98.59000, train loss:-0.98854, test loss:-0.98573, ratio_train_loss:5.65828,ratio_test_loss:0.18268, total_loss_train:4.66974,total_loss_test:-0.80305, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8378, epoch 71.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8378, epoch 71.0)
[Save Checkpoint] epoch: [71.0], Train score:98.83667, Test score:98.51000, train loss:-0.98816, test loss:-0.98472, ratio_train_loss:5.65342,ratio_test_loss:0.18219, total_loss_train:4.66525,total_loss_test:-0.80253, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8496, epoch 72.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8496, epoch 72.0)
[Save Checkpoint] epoch: [72.0], Train score:98.87000, Test score:98.65000, train loss:-0.98851, test loss:-0.98594, ratio_train_loss:5.94562,ratio_test_loss:0.17492, total_loss_train:4.95711,total_loss_test:-0.81102, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8614, epoch 73.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8614, epoch 73.0)
[Save Checkpoint] epoch: [73.0], Train score:98.78167, Test score:98.31000, train loss:-0.98763, test loss:-0.98258, ratio_train_loss:6.07851,ratio_test_loss:0.17237, total_loss_train:5.09088,total_loss_test:-0.81021, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8732, epoch 74.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8732, epoch 74.0)
[Save Checkpoint] epoch: [74.0], Train score:99.01333, Test score:98.65000, train loss:-0.98982, test loss:-0.98640, ratio_train_loss:5.97819,ratio_test_loss:0.17329, total_loss_train:4.98837,total_loss_test:-0.81311, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8850, epoch 75.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8850, epoch 75.0)
[Save Checkpoint] epoch: [75.0], Train score:98.88000, Test score:98.26000, train loss:-0.98853, test loss:-0.98218, ratio_train_loss:5.72781,ratio_test_loss:0.18230, total_loss_train:4.73928,total_loss_test:-0.79988, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8968, epoch 76.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 8968, epoch 76.0)
[Save Checkpoint] epoch: [76.0], Train score:98.92833, Test score:98.59000, train loss:-0.98905, test loss:-0.98525, ratio_train_loss:5.58914,ratio_test_loss:0.18742, total_loss_train:4.60010,total_loss_test:-0.79783, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9086, epoch 77.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9086, epoch 77.0)
[Save Checkpoint] epoch: [77.0], Train score:98.96500, Test score:98.42000, train loss:-0.98941, test loss:-0.98451, ratio_train_loss:5.98171,ratio_test_loss:0.17362, total_loss_train:4.99230,total_loss_test:-0.81089, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9204, epoch 78.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9204, epoch 78.0)
[Save Checkpoint] epoch: [78.0], Train score:99.00333, Test score:98.62000, train loss:-0.98977, test loss:-0.98577, ratio_train_loss:5.84517,ratio_test_loss:0.17799, total_loss_train:4.85539,total_loss_test:-0.80779, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9322, epoch 79.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9322, epoch 79.0)
[Save Checkpoint] epoch: [79.0], Train score:98.86333, Test score:98.37000, train loss:-0.98845, test loss:-0.98343, ratio_train_loss:5.80547,ratio_test_loss:0.17882, total_loss_train:4.81702,total_loss_test:-0.80461, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9440, epoch 80.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9440, epoch 80.0)
[Save Checkpoint] epoch: [80.0], Train score:98.86833, Test score:98.35000, train loss:-0.98851, test loss:-0.98325, ratio_train_loss:5.57244,ratio_test_loss:0.18868, total_loss_train:4.58394,total_loss_test:-0.79457, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9558, epoch 81.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9558, epoch 81.0)
[Save Checkpoint] epoch: [81.0], Train score:99.01333, Test score:98.60000, train loss:-0.98992, test loss:-0.98577, ratio_train_loss:6.00397,ratio_test_loss:0.17496, total_loss_train:5.01405,total_loss_test:-0.81081, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9676, epoch 82.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9676, epoch 82.0)
[Save Checkpoint] epoch: [82.0], Train score:98.91167, Test score:98.62000, train loss:-0.98885, test loss:-0.98577, ratio_train_loss:5.66259,ratio_test_loss:0.18472, total_loss_train:4.67375,total_loss_test:-0.80105, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9794, epoch 83.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9794, epoch 83.0)
[Save Checkpoint] epoch: [83.0], Train score:98.65500, Test score:98.29000, train loss:-0.98617, test loss:-0.98273, ratio_train_loss:5.73311,ratio_test_loss:0.18204, total_loss_train:4.74694,total_loss_test:-0.80069, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9912, epoch 84.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 9912, epoch 84.0)
[Save Checkpoint] epoch: [84.0], Train score:98.96667, Test score:98.46000, train loss:-0.98951, test loss:-0.98429, ratio_train_loss:5.88898,ratio_test_loss:0.18057, total_loss_train:4.89947,total_loss_test:-0.80372, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10030, epoch 85.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10030, epoch 85.0)
[Save Checkpoint] epoch: [85.0], Train score:98.96333, Test score:98.52000, train loss:-0.98927, test loss:-0.98474, ratio_train_loss:5.88186,ratio_test_loss:0.17909, total_loss_train:4.89259,total_loss_test:-0.80565, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10148, epoch 86.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10148, epoch 86.0)
[Save Checkpoint] epoch: [86.0], Train score:98.85833, Test score:98.47000, train loss:-0.98824, test loss:-0.98422, ratio_train_loss:5.84320,ratio_test_loss:0.17983, total_loss_train:4.85496,total_loss_test:-0.80438, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10266, epoch 87.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10266, epoch 87.0)
[Save Checkpoint] epoch: [87.0], Train score:98.89333, Test score:98.40000, train loss:-0.98876, test loss:-0.98390, ratio_train_loss:6.03065,ratio_test_loss:0.17369, total_loss_train:5.04189,total_loss_test:-0.81021, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10384, epoch 88.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10384, epoch 88.0)
[Save Checkpoint] epoch: [88.0], Train score:99.00500, Test score:98.65000, train loss:-0.98993, test loss:-0.98654, ratio_train_loss:6.03428,ratio_test_loss:0.17127, total_loss_train:5.04435,total_loss_test:-0.81527, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10502, epoch 89.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10502, epoch 89.0)
[Save Checkpoint] epoch: [89.0], Train score:98.95667, Test score:98.49000, train loss:-0.98939, test loss:-0.98492, ratio_train_loss:5.86544,ratio_test_loss:0.17786, total_loss_train:4.87605,total_loss_test:-0.80706, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10620, epoch 90.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10620, epoch 90.0)
[Save Checkpoint] epoch: [90.0], Train score:98.98167, Test score:98.50000, train loss:-0.98956, test loss:-0.98475, ratio_train_loss:5.93934,ratio_test_loss:0.17252, total_loss_train:4.94978,total_loss_test:-0.81222, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10738, epoch 91.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10738, epoch 91.0)
[Save Checkpoint] epoch: [91.0], Train score:99.06500, Test score:98.61000, train loss:-0.99034, test loss:-0.98597, ratio_train_loss:5.77801,ratio_test_loss:0.17999, total_loss_train:4.78767,total_loss_test:-0.80599, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10856, epoch 92.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10856, epoch 92.0)
[Save Checkpoint] epoch: [92.0], Train score:98.99333, Test score:98.44000, train loss:-0.98953, test loss:-0.98438, ratio_train_loss:5.92232,ratio_test_loss:0.17449, total_loss_train:4.93279,total_loss_test:-0.80989, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10974, epoch 93.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 10974, epoch 93.0)
[Save Checkpoint] epoch: [93.0], Train score:99.06500, Test score:98.59000, train loss:-0.99056, test loss:-0.98552, ratio_train_loss:6.17931,ratio_test_loss:0.16794, total_loss_train:5.18876,total_loss_test:-0.81758, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 11092, epoch 94.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 11092, epoch 94.0)
[Save Checkpoint] epoch: [94.0], Train score:98.99667, Test score:98.52000, train loss:-0.98972, test loss:-0.98502, ratio_train_loss:6.00871,ratio_test_loss:0.17085, total_loss_train:5.01899,total_loss_test:-0.81417, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 11210, epoch 95.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 11210, epoch 95.0)
[Save Checkpoint] epoch: [95.0], Train score:98.92667, Test score:98.43000, train loss:-0.98912, test loss:-0.98414, ratio_train_loss:6.00468,ratio_test_loss:0.17334, total_loss_train:5.01556,total_loss_test:-0.81080, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 11328, epoch 96.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 11328, epoch 96.0)
[Save Checkpoint] epoch: [96.0], Train score:99.01500, Test score:98.59000, train loss:-0.98997, test loss:-0.98558, ratio_train_loss:6.26487,ratio_test_loss:0.16435, total_loss_train:5.27489,total_loss_test:-0.82123, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 11446, epoch 97.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 11446, epoch 97.0)
[Save Checkpoint] epoch: [97.0], Train score:98.99500, Test score:98.52000, train loss:-0.98976, test loss:-0.98510, ratio_train_loss:6.15971,ratio_test_loss:0.16868, total_loss_train:5.16995,total_loss_test:-0.81642, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 11564, epoch 98.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 11564, epoch 98.0)
[Save Checkpoint] epoch: [98.0], Train score:98.98833, Test score:98.48000, train loss:-0.98971, test loss:-0.98480, ratio_train_loss:5.99256,ratio_test_loss:0.17304, total_loss_train:5.00285,total_loss_test:-0.81177, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 11682, epoch 99.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 11682, epoch 99.0)
[Save Checkpoint] epoch: [99.0], Train score:99.05833, Test score:98.51000, train loss:-0.99035, test loss:-0.98479, ratio_train_loss:6.04320,ratio_test_loss:0.17081, total_loss_train:5.05285,total_loss_test:-0.81399, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 11800, epoch 100.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_other_ratio_bs_512_2/last' (iter 11800, epoch 100.0)
[Save Checkpoint] epoch: [100.0], Train score:99.02333, Test score:98.62000, train loss:-0.99017, test loss:-0.98608, ratio_train_loss:6.22637,ratio_test_loss:0.16831, total_loss_train:5.23619,total_loss_test:-0.81777, 
[Training Finished]
All Done!
