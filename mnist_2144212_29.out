29
--dataset mnist --model CNN --gpu_devices 0 1 --max_iter 100 --batch_size 512 --ckpt_dir checkpoints_CNN --ckpt_dir_scores checkpoint_scores_CNN --use_scheduler True --GMP True --lr 1e-3 --z_struct_size 20 --add_classification_layer True --classif_layer_size 30 --is_default_model False --is_custom_model False --is_custom_model_BK True --big_kernel_size 8 --two_conv_layer True --three_conv_layer False --BK_in_first_layer True --BK_in_second_layer False --BK_in_third_layer False --stride_size 1 --hidden_filters_layer1 32 --hidden_filters_layer2 32 --hidden_filters_layer3 32 --ratio_reg True --lambda_ratio_reg 0.001 --lambda_class 1 --exp_name CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4
Namespace(BK_in_first_layer=True, BK_in_second_layer=False, BK_in_third_layer=False, BN=False, C_max=25, C_stop_iter=100000.0, E1_AE=False, E1_VAE=False, E1_conv=False, E1_dense=False, E1_second_conv=False, E1_second_conv_adapt=False, GMP=True, L1_norm_act=False, L1_norm_weights=False, L3_without_random=False, adapt_lr=False, add_classification_layer=True, add_linear_after_GMP=True, add_z_struct_bottleneck=False, batch_size=512, beta=1, beta1=0.9, beta2=0.999, big_kernel=False, big_kernel_size=[8], binary_z=False, ckpt_dir='checkpoints_CNN', ckpt_dir_scores='checkpoint_scores_CNN', classif_layer_size=30, cuda=True, dataset='mnist', display_step=10000, dset_dir='data', exp_name='CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4', gamma=1000, gpu_devices=[0, 1], hidden_filters_layer1=32, hidden_filters_layer2=32, hidden_filters_layer3=32, image_size=64, is_C=True, is_E1=False, is_binary_structural_latent=False, is_custom_model=False, is_custom_model_BK=True, is_default_model=False, is_noise_stats=False, is_partial_rand_class=False, is_perturbed_score=False, is_zvar_sim_loss=False, just_train=False, kernel_size=4, lambda_Kl_struct=1, lambda_Kl_var=1, lambda_L1=0.01, lambda_VAE=1, lambda_class=1.0, lambda_partial_class=1, lambda_ratio_reg=0.001, lambda_recon_wt_rand=1, lambda_recons=1, lambda_zvar_sim=1, latent_spec_cont=None, latent_spec_cont_class=None, latent_spec_cont_var=None, latent_spec_disc=None, latent_spec_disc_class=None, latent_spec_disc_var=None, log_level='info', lr=0.001, max_iter=100.0, model='CNN', num_workers=2, old_weighted=False, other_ratio=False, random_percentage=0.2, ratio_reg=True, save_step=10000, second_layer_C=False, seed=1, stride_size=1, three_conv_layer=False, train=True, two_conv_layer=True, two_encoder=False, use_early_stopping=False, use_scheduler=True, z_struct_size=20, zeros_W_Classif=False, zvar_sim_change_zvar=False, zvar_sim_loss_for_all_model=False, zvar_sim_loss_only_for_encoder=False, zvar_sim_normal=False, zvar_sim_var_rand=False)
CUDA Visible devices !
Custom_CNN_BK(
  (net): Sequential(
    (0): Conv2d(1, 32, kernel_size=(8, 8), stride=(1, 1))
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(32, 32, kernel_size=(4, 4), stride=(1, 1))
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): AdaptiveMaxPool2d(output_size=(1, 1))
    (7): View()
    (8): Linear(in_features=32, out_features=20, bias=True)
    (9): BatchNorm1d(20, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (10): ReLU(inplace=True)
    (11): Dropout(p=0.4, inplace=False)
    (12): Linear(in_features=20, out_features=30, bias=True)
    (13): BatchNorm1d(30, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU(inplace=True)
    (15): Dropout(p=0.4, inplace=False)
    (16): Linear(in_features=30, out_features=10, bias=True)
    (17): Softmax(dim=None)
  )
)
The number of parameters of model is 20324
use 1 gpu who named: Tesla V100-SXM2-32GB
=> loaded sample_scores and losses
=> no checkpoint found at 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last'
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 118, epoch 1.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 118, epoch 1.0)
[Save Checkpoint] epoch: [1.0], Train score:59.38667, Test score:59.18000, train loss:-0.56774, test loss:-0.56484, ratio_train_loss:0.52565,ratio_test_loss:0.50777, total_loss_train:-0.04209,total_loss_test:-0.05707, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 236, epoch 2.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 236, epoch 2.0)
[Save Checkpoint] epoch: [2.0], Train score:60.79333, Test score:60.41000, train loss:-0.61276, test loss:-0.60966, ratio_train_loss:0.39453,ratio_test_loss:0.38353, total_loss_train:-0.21823,total_loss_test:-0.22612, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 354, epoch 3.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 354, epoch 3.0)
[Save Checkpoint] epoch: [3.0], Train score:76.28167, Test score:76.07000, train loss:-0.71713, test loss:-0.71382, ratio_train_loss:0.38493,ratio_test_loss:0.37503, total_loss_train:-0.33219,total_loss_test:-0.33879, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 472, epoch 4.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 472, epoch 4.0)
[Save Checkpoint] epoch: [4.0], Train score:77.28500, Test score:76.85000, train loss:-0.76181, test loss:-0.75858, ratio_train_loss:0.33658,ratio_test_loss:0.32773, total_loss_train:-0.42523,total_loss_test:-0.43085, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 590, epoch 5.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 590, epoch 5.0)
[Save Checkpoint] epoch: [5.0], Train score:82.33833, Test score:82.22000, train loss:-0.81402, test loss:-0.81353, ratio_train_loss:0.28612,ratio_test_loss:0.27485, total_loss_train:-0.52790,total_loss_test:-0.53868, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 708, epoch 6.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 708, epoch 6.0)
[Save Checkpoint] epoch: [6.0], Train score:96.45000, Test score:96.33000, train loss:-0.94628, test loss:-0.94689, ratio_train_loss:0.26934,ratio_test_loss:0.26153, total_loss_train:-0.67694,total_loss_test:-0.68536, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 826, epoch 7.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 826, epoch 7.0)
[Save Checkpoint] epoch: [7.0], Train score:96.63833, Test score:96.63000, train loss:-0.95850, test loss:-0.95837, ratio_train_loss:0.26093,ratio_test_loss:0.25647, total_loss_train:-0.69756,total_loss_test:-0.70190, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 944, epoch 8.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 944, epoch 8.0)
[Save Checkpoint] epoch: [8.0], Train score:97.02500, Test score:97.16000, train loss:-0.96473, test loss:-0.96485, ratio_train_loss:0.24574,ratio_test_loss:0.23856, total_loss_train:-0.71899,total_loss_test:-0.72630, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1062, epoch 9.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1062, epoch 9.0)
[Save Checkpoint] epoch: [9.0], Train score:97.74000, Test score:97.67000, train loss:-0.97376, test loss:-0.97287, ratio_train_loss:0.23232,ratio_test_loss:0.22783, total_loss_train:-0.74144,total_loss_test:-0.74504, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1180, epoch 10.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1180, epoch 10.0)
[Save Checkpoint] epoch: [10.0], Train score:97.83333, Test score:97.65000, train loss:-0.97556, test loss:-0.97421, ratio_train_loss:0.22234,ratio_test_loss:0.21749, total_loss_train:-0.75322,total_loss_test:-0.75672, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1298, epoch 11.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1298, epoch 11.0)
[Save Checkpoint] epoch: [11.0], Train score:97.77500, Test score:97.63000, train loss:-0.97510, test loss:-0.97402, ratio_train_loss:0.22029,ratio_test_loss:0.21510, total_loss_train:-0.75481,total_loss_test:-0.75892, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1416, epoch 12.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1416, epoch 12.0)
[Save Checkpoint] epoch: [12.0], Train score:97.68167, Test score:97.79000, train loss:-0.97458, test loss:-0.97539, ratio_train_loss:0.20997,ratio_test_loss:0.20400, total_loss_train:-0.76461,total_loss_test:-0.77139, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1534, epoch 13.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1534, epoch 13.0)
[Save Checkpoint] epoch: [13.0], Train score:97.98000, Test score:97.90000, train loss:-0.97799, test loss:-0.97742, ratio_train_loss:0.21343,ratio_test_loss:0.20895, total_loss_train:-0.76456,total_loss_test:-0.76847, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1652, epoch 14.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1652, epoch 14.0)
[Save Checkpoint] epoch: [14.0], Train score:98.03333, Test score:98.13000, train loss:-0.97871, test loss:-0.97915, ratio_train_loss:0.21618,ratio_test_loss:0.21136, total_loss_train:-0.76253,total_loss_test:-0.76779, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1770, epoch 15.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1770, epoch 15.0)
[Save Checkpoint] epoch: [15.0], Train score:97.93833, Test score:98.05000, train loss:-0.97787, test loss:-0.97847, ratio_train_loss:0.21433,ratio_test_loss:0.20960, total_loss_train:-0.76354,total_loss_test:-0.76887, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1888, epoch 16.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 1888, epoch 16.0)
[Save Checkpoint] epoch: [16.0], Train score:98.19000, Test score:98.16000, train loss:-0.98046, test loss:-0.98010, ratio_train_loss:0.20470,ratio_test_loss:0.20188, total_loss_train:-0.77576,total_loss_test:-0.77822, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2006, epoch 17.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2006, epoch 17.0)
[Save Checkpoint] epoch: [17.0], Train score:98.13833, Test score:98.25000, train loss:-0.98048, test loss:-0.98057, ratio_train_loss:0.20914,ratio_test_loss:0.20515, total_loss_train:-0.77135,total_loss_test:-0.77542, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2124, epoch 18.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2124, epoch 18.0)
[Save Checkpoint] epoch: [18.0], Train score:98.23667, Test score:98.28000, train loss:-0.98107, test loss:-0.98098, ratio_train_loss:0.19933,ratio_test_loss:0.19543, total_loss_train:-0.78174,total_loss_test:-0.78556, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2242, epoch 19.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2242, epoch 19.0)
[Save Checkpoint] epoch: [19.0], Train score:98.35667, Test score:98.25000, train loss:-0.98259, test loss:-0.98137, ratio_train_loss:0.21073,ratio_test_loss:0.20764, total_loss_train:-0.77186,total_loss_test:-0.77373, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2360, epoch 20.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2360, epoch 20.0)
[Save Checkpoint] epoch: [20.0], Train score:98.29333, Test score:98.28000, train loss:-0.98214, test loss:-0.98204, ratio_train_loss:0.21715,ratio_test_loss:0.21179, total_loss_train:-0.76499,total_loss_test:-0.77025, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2478, epoch 21.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2478, epoch 21.0)
[Save Checkpoint] epoch: [21.0], Train score:98.41500, Test score:98.14000, train loss:-0.98297, test loss:-0.98046, ratio_train_loss:0.19946,ratio_test_loss:0.19688, total_loss_train:-0.78352,total_loss_test:-0.78358, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2596, epoch 22.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2596, epoch 22.0)
[Save Checkpoint] epoch: [22.0], Train score:98.25167, Test score:98.41000, train loss:-0.98186, test loss:-0.98277, ratio_train_loss:0.19336,ratio_test_loss:0.19100, total_loss_train:-0.78850,total_loss_test:-0.79177, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2714, epoch 23.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2714, epoch 23.0)
[Save Checkpoint] epoch: [23.0], Train score:98.43333, Test score:98.21000, train loss:-0.98355, test loss:-0.98123, ratio_train_loss:0.20077,ratio_test_loss:0.19838, total_loss_train:-0.78279,total_loss_test:-0.78285, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2832, epoch 24.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2832, epoch 24.0)
[Save Checkpoint] epoch: [24.0], Train score:98.22333, Test score:98.11000, train loss:-0.98147, test loss:-0.97978, ratio_train_loss:0.19604,ratio_test_loss:0.19334, total_loss_train:-0.78542,total_loss_test:-0.78644, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2950, epoch 25.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 2950, epoch 25.0)
[Save Checkpoint] epoch: [25.0], Train score:98.39833, Test score:98.26000, train loss:-0.98331, test loss:-0.98142, ratio_train_loss:0.18986,ratio_test_loss:0.18793, total_loss_train:-0.79345,total_loss_test:-0.79349, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3068, epoch 26.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3068, epoch 26.0)
[Save Checkpoint] epoch: [26.0], Train score:98.59833, Test score:98.48000, train loss:-0.98532, test loss:-0.98406, ratio_train_loss:0.19450,ratio_test_loss:0.19052, total_loss_train:-0.79082,total_loss_test:-0.79354, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3186, epoch 27.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3186, epoch 27.0)
[Save Checkpoint] epoch: [27.0], Train score:98.25667, Test score:98.18000, train loss:-0.98161, test loss:-0.98072, ratio_train_loss:0.19310,ratio_test_loss:0.19028, total_loss_train:-0.78851,total_loss_test:-0.79044, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3304, epoch 28.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3304, epoch 28.0)
[Save Checkpoint] epoch: [28.0], Train score:98.58667, Test score:98.30000, train loss:-0.98506, test loss:-0.98242, ratio_train_loss:0.19821,ratio_test_loss:0.19642, total_loss_train:-0.78685,total_loss_test:-0.78601, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3422, epoch 29.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3422, epoch 29.0)
[Save Checkpoint] epoch: [29.0], Train score:98.41167, Test score:98.30000, train loss:-0.98366, test loss:-0.98243, ratio_train_loss:0.19328,ratio_test_loss:0.19271, total_loss_train:-0.79038,total_loss_test:-0.78972, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3540, epoch 30.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3540, epoch 30.0)
[Save Checkpoint] epoch: [30.0], Train score:98.54667, Test score:98.46000, train loss:-0.98501, test loss:-0.98323, ratio_train_loss:0.19270,ratio_test_loss:0.19173, total_loss_train:-0.79231,total_loss_test:-0.79150, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3658, epoch 31.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3658, epoch 31.0)
[Save Checkpoint] epoch: [31.0], Train score:98.52167, Test score:98.43000, train loss:-0.98493, test loss:-0.98333, ratio_train_loss:0.19433,ratio_test_loss:0.19177, total_loss_train:-0.79060,total_loss_test:-0.79156, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3776, epoch 32.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3776, epoch 32.0)
[Save Checkpoint] epoch: [32.0], Train score:98.57167, Test score:98.44000, train loss:-0.98488, test loss:-0.98372, ratio_train_loss:0.19346,ratio_test_loss:0.18968, total_loss_train:-0.79142,total_loss_test:-0.79404, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3894, epoch 33.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 3894, epoch 33.0)
[Save Checkpoint] epoch: [33.0], Train score:98.63333, Test score:98.43000, train loss:-0.98591, test loss:-0.98339, ratio_train_loss:0.18908,ratio_test_loss:0.18829, total_loss_train:-0.79683,total_loss_test:-0.79510, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4012, epoch 34.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4012, epoch 34.0)
[Save Checkpoint] epoch: [34.0], Train score:98.46667, Test score:98.26000, train loss:-0.98416, test loss:-0.98236, ratio_train_loss:0.19765,ratio_test_loss:0.19462, total_loss_train:-0.78651,total_loss_test:-0.78774, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4130, epoch 35.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4130, epoch 35.0)
[Save Checkpoint] epoch: [35.0], Train score:98.49500, Test score:98.41000, train loss:-0.98459, test loss:-0.98363, ratio_train_loss:0.19535,ratio_test_loss:0.19390, total_loss_train:-0.78924,total_loss_test:-0.78972, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4248, epoch 36.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4248, epoch 36.0)
[Save Checkpoint] epoch: [36.0], Train score:98.47667, Test score:98.31000, train loss:-0.98448, test loss:-0.98283, ratio_train_loss:0.20161,ratio_test_loss:0.20130, total_loss_train:-0.78287,total_loss_test:-0.78152, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4366, epoch 37.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4366, epoch 37.0)
[Save Checkpoint] epoch: [37.0], Train score:98.63333, Test score:98.27000, train loss:-0.98577, test loss:-0.98249, ratio_train_loss:0.18609,ratio_test_loss:0.18526, total_loss_train:-0.79968,total_loss_test:-0.79722, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4484, epoch 38.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4484, epoch 38.0)
[Save Checkpoint] epoch: [38.0], Train score:98.64000, Test score:98.47000, train loss:-0.98616, test loss:-0.98430, ratio_train_loss:0.18536,ratio_test_loss:0.18394, total_loss_train:-0.80079,total_loss_test:-0.80036, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4602, epoch 39.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4602, epoch 39.0)
[Save Checkpoint] epoch: [39.0], Train score:98.47000, Test score:98.45000, train loss:-0.98395, test loss:-0.98392, ratio_train_loss:0.19171,ratio_test_loss:0.19010, total_loss_train:-0.79224,total_loss_test:-0.79383, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4720, epoch 40.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4720, epoch 40.0)
[Save Checkpoint] epoch: [40.0], Train score:98.68833, Test score:98.49000, train loss:-0.98668, test loss:-0.98458, ratio_train_loss:0.18618,ratio_test_loss:0.18670, total_loss_train:-0.80050,total_loss_test:-0.79788, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4838, epoch 41.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4838, epoch 41.0)
[Save Checkpoint] epoch: [41.0], Train score:98.67167, Test score:98.57000, train loss:-0.98655, test loss:-0.98513, ratio_train_loss:0.17909,ratio_test_loss:0.17672, total_loss_train:-0.80746,total_loss_test:-0.80841, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4956, epoch 42.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 4956, epoch 42.0)
[Save Checkpoint] epoch: [42.0], Train score:98.66500, Test score:98.49000, train loss:-0.98659, test loss:-0.98442, ratio_train_loss:0.18247,ratio_test_loss:0.18159, total_loss_train:-0.80413,total_loss_test:-0.80283, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5074, epoch 43.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5074, epoch 43.0)
[Save Checkpoint] epoch: [43.0], Train score:98.60167, Test score:98.32000, train loss:-0.98556, test loss:-0.98324, ratio_train_loss:0.18535,ratio_test_loss:0.18527, total_loss_train:-0.80022,total_loss_test:-0.79797, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5192, epoch 44.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5192, epoch 44.0)
[Save Checkpoint] epoch: [44.0], Train score:98.76167, Test score:98.51000, train loss:-0.98726, test loss:-0.98477, ratio_train_loss:0.18630,ratio_test_loss:0.18471, total_loss_train:-0.80097,total_loss_test:-0.80006, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5310, epoch 45.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5310, epoch 45.0)
[Save Checkpoint] epoch: [45.0], Train score:98.59167, Test score:98.23000, train loss:-0.98532, test loss:-0.98216, ratio_train_loss:0.18957,ratio_test_loss:0.18808, total_loss_train:-0.79576,total_loss_test:-0.79408, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5428, epoch 46.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5428, epoch 46.0)
[Save Checkpoint] epoch: [46.0], Train score:98.68000, Test score:98.41000, train loss:-0.98648, test loss:-0.98395, ratio_train_loss:0.18356,ratio_test_loss:0.18377, total_loss_train:-0.80292,total_loss_test:-0.80018, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5546, epoch 47.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5546, epoch 47.0)
[Save Checkpoint] epoch: [47.0], Train score:98.62833, Test score:98.57000, train loss:-0.98589, test loss:-0.98484, ratio_train_loss:0.19437,ratio_test_loss:0.19252, total_loss_train:-0.79151,total_loss_test:-0.79232, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5664, epoch 48.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5664, epoch 48.0)
[Save Checkpoint] epoch: [48.0], Train score:98.63667, Test score:98.56000, train loss:-0.98604, test loss:-0.98494, ratio_train_loss:0.18914,ratio_test_loss:0.18673, total_loss_train:-0.79690,total_loss_test:-0.79821, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5782, epoch 49.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5782, epoch 49.0)
[Save Checkpoint] epoch: [49.0], Train score:98.73333, Test score:98.47000, train loss:-0.98716, test loss:-0.98446, ratio_train_loss:0.17855,ratio_test_loss:0.17825, total_loss_train:-0.80861,total_loss_test:-0.80621, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5900, epoch 50.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 5900, epoch 50.0)
[Save Checkpoint] epoch: [50.0], Train score:98.71667, Test score:98.48000, train loss:-0.98677, test loss:-0.98442, ratio_train_loss:0.18144,ratio_test_loss:0.18101, total_loss_train:-0.80533,total_loss_test:-0.80342, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6018, epoch 51.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6018, epoch 51.0)
[Save Checkpoint] epoch: [51.0], Train score:98.73500, Test score:98.48000, train loss:-0.98726, test loss:-0.98448, ratio_train_loss:0.17954,ratio_test_loss:0.17620, total_loss_train:-0.80772,total_loss_test:-0.80828, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6136, epoch 52.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6136, epoch 52.0)
[Save Checkpoint] epoch: [52.0], Train score:98.80667, Test score:98.65000, train loss:-0.98791, test loss:-0.98628, ratio_train_loss:0.18851,ratio_test_loss:0.18701, total_loss_train:-0.79940,total_loss_test:-0.79926, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6254, epoch 53.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6254, epoch 53.0)
[Save Checkpoint] epoch: [53.0], Train score:98.76833, Test score:98.46000, train loss:-0.98733, test loss:-0.98414, ratio_train_loss:0.18085,ratio_test_loss:0.18031, total_loss_train:-0.80648,total_loss_test:-0.80383, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6372, epoch 54.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6372, epoch 54.0)
[Save Checkpoint] epoch: [54.0], Train score:98.74333, Test score:98.28000, train loss:-0.98724, test loss:-0.98261, ratio_train_loss:0.18342,ratio_test_loss:0.18388, total_loss_train:-0.80382,total_loss_test:-0.79873, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6490, epoch 55.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6490, epoch 55.0)
[Save Checkpoint] epoch: [55.0], Train score:98.79833, Test score:98.68000, train loss:-0.98774, test loss:-0.98605, ratio_train_loss:0.18110,ratio_test_loss:0.18131, total_loss_train:-0.80664,total_loss_test:-0.80474, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6608, epoch 56.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6608, epoch 56.0)
[Save Checkpoint] epoch: [56.0], Train score:98.83833, Test score:98.49000, train loss:-0.98822, test loss:-0.98461, ratio_train_loss:0.17770,ratio_test_loss:0.17710, total_loss_train:-0.81052,total_loss_test:-0.80751, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6726, epoch 57.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6726, epoch 57.0)
[Save Checkpoint] epoch: [57.0], Train score:98.93500, Test score:98.77000, train loss:-0.98914, test loss:-0.98700, ratio_train_loss:0.17656,ratio_test_loss:0.17645, total_loss_train:-0.81259,total_loss_test:-0.81055, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6844, epoch 58.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6844, epoch 58.0)
[Save Checkpoint] epoch: [58.0], Train score:98.67667, Test score:98.27000, train loss:-0.98653, test loss:-0.98241, ratio_train_loss:0.17800,ratio_test_loss:0.17737, total_loss_train:-0.80854,total_loss_test:-0.80504, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6962, epoch 59.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 6962, epoch 59.0)
[Save Checkpoint] epoch: [59.0], Train score:98.86833, Test score:98.55000, train loss:-0.98825, test loss:-0.98495, ratio_train_loss:0.17987,ratio_test_loss:0.17843, total_loss_train:-0.80838,total_loss_test:-0.80652, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7080, epoch 60.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7080, epoch 60.0)
[Save Checkpoint] epoch: [60.0], Train score:98.80833, Test score:98.27000, train loss:-0.98775, test loss:-0.98212, ratio_train_loss:0.18273,ratio_test_loss:0.18215, total_loss_train:-0.80502,total_loss_test:-0.79997, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7198, epoch 61.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7198, epoch 61.0)
[Save Checkpoint] epoch: [61.0], Train score:98.83000, Test score:98.49000, train loss:-0.98821, test loss:-0.98511, ratio_train_loss:0.18223,ratio_test_loss:0.18036, total_loss_train:-0.80599,total_loss_test:-0.80475, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7316, epoch 62.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7316, epoch 62.0)
[Save Checkpoint] epoch: [62.0], Train score:98.74167, Test score:98.25000, train loss:-0.98703, test loss:-0.98275, ratio_train_loss:0.17796,ratio_test_loss:0.17837, total_loss_train:-0.80908,total_loss_test:-0.80438, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7434, epoch 63.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7434, epoch 63.0)
[Save Checkpoint] epoch: [63.0], Train score:98.78000, Test score:98.51000, train loss:-0.98752, test loss:-0.98470, ratio_train_loss:0.18471,ratio_test_loss:0.18427, total_loss_train:-0.80282,total_loss_test:-0.80043, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7552, epoch 64.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7552, epoch 64.0)
[Save Checkpoint] epoch: [64.0], Train score:98.55333, Test score:98.19000, train loss:-0.98522, test loss:-0.98148, ratio_train_loss:0.19456,ratio_test_loss:0.19441, total_loss_train:-0.79066,total_loss_test:-0.78707, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7670, epoch 65.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7670, epoch 65.0)
[Save Checkpoint] epoch: [65.0], Train score:98.86000, Test score:98.51000, train loss:-0.98833, test loss:-0.98487, ratio_train_loss:0.18317,ratio_test_loss:0.18001, total_loss_train:-0.80516,total_loss_test:-0.80486, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7788, epoch 66.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7788, epoch 66.0)
[Save Checkpoint] epoch: [66.0], Train score:98.89000, Test score:98.47000, train loss:-0.98861, test loss:-0.98451, ratio_train_loss:0.17905,ratio_test_loss:0.17772, total_loss_train:-0.80956,total_loss_test:-0.80678, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7906, epoch 67.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 7906, epoch 67.0)
[Save Checkpoint] epoch: [67.0], Train score:98.95667, Test score:98.64000, train loss:-0.98938, test loss:-0.98629, ratio_train_loss:0.17408,ratio_test_loss:0.17356, total_loss_train:-0.81531,total_loss_test:-0.81273, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8024, epoch 68.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8024, epoch 68.0)
[Save Checkpoint] epoch: [68.0], Train score:98.92500, Test score:98.53000, train loss:-0.98918, test loss:-0.98502, ratio_train_loss:0.17806,ratio_test_loss:0.17819, total_loss_train:-0.81113,total_loss_test:-0.80683, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8142, epoch 69.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8142, epoch 69.0)
[Save Checkpoint] epoch: [69.0], Train score:98.76667, Test score:98.46000, train loss:-0.98724, test loss:-0.98422, ratio_train_loss:0.17891,ratio_test_loss:0.17823, total_loss_train:-0.80834,total_loss_test:-0.80599, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8260, epoch 70.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8260, epoch 70.0)
[Save Checkpoint] epoch: [70.0], Train score:98.84667, Test score:98.32000, train loss:-0.98815, test loss:-0.98293, ratio_train_loss:0.18200,ratio_test_loss:0.18313, total_loss_train:-0.80615,total_loss_test:-0.79980, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8378, epoch 71.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8378, epoch 71.0)
[Save Checkpoint] epoch: [71.0], Train score:98.93000, Test score:98.50000, train loss:-0.98906, test loss:-0.98478, ratio_train_loss:0.17204,ratio_test_loss:0.17272, total_loss_train:-0.81702,total_loss_test:-0.81205, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8496, epoch 72.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8496, epoch 72.0)
[Save Checkpoint] epoch: [72.0], Train score:98.70333, Test score:98.28000, train loss:-0.98673, test loss:-0.98236, ratio_train_loss:0.18727,ratio_test_loss:0.18593, total_loss_train:-0.79945,total_loss_test:-0.79643, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8614, epoch 73.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8614, epoch 73.0)
[Save Checkpoint] epoch: [73.0], Train score:98.94333, Test score:98.58000, train loss:-0.98923, test loss:-0.98529, ratio_train_loss:0.17094,ratio_test_loss:0.17098, total_loss_train:-0.81828,total_loss_test:-0.81431, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8732, epoch 74.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8732, epoch 74.0)
[Save Checkpoint] epoch: [74.0], Train score:98.94667, Test score:98.62000, train loss:-0.98946, test loss:-0.98542, ratio_train_loss:0.17714,ratio_test_loss:0.17763, total_loss_train:-0.81232,total_loss_test:-0.80778, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8850, epoch 75.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8850, epoch 75.0)
[Save Checkpoint] epoch: [75.0], Train score:98.98500, Test score:98.60000, train loss:-0.98968, test loss:-0.98604, ratio_train_loss:0.17998,ratio_test_loss:0.18001, total_loss_train:-0.80970,total_loss_test:-0.80603, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8968, epoch 76.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 8968, epoch 76.0)
[Save Checkpoint] epoch: [76.0], Train score:98.93500, Test score:98.62000, train loss:-0.98918, test loss:-0.98590, ratio_train_loss:0.17793,ratio_test_loss:0.17914, total_loss_train:-0.81125,total_loss_test:-0.80677, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9086, epoch 77.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9086, epoch 77.0)
[Save Checkpoint] epoch: [77.0], Train score:98.97000, Test score:98.54000, train loss:-0.98949, test loss:-0.98560, ratio_train_loss:0.17626,ratio_test_loss:0.17789, total_loss_train:-0.81323,total_loss_test:-0.80770, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9204, epoch 78.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9204, epoch 78.0)
[Save Checkpoint] epoch: [78.0], Train score:98.96333, Test score:98.52000, train loss:-0.98933, test loss:-0.98460, ratio_train_loss:0.18215,ratio_test_loss:0.18195, total_loss_train:-0.80718,total_loss_test:-0.80265, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9322, epoch 79.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9322, epoch 79.0)
[Save Checkpoint] epoch: [79.0], Train score:98.96333, Test score:98.52000, train loss:-0.98943, test loss:-0.98522, ratio_train_loss:0.18008,ratio_test_loss:0.17907, total_loss_train:-0.80935,total_loss_test:-0.80614, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9440, epoch 80.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9440, epoch 80.0)
[Save Checkpoint] epoch: [80.0], Train score:98.87333, Test score:98.44000, train loss:-0.98876, test loss:-0.98449, ratio_train_loss:0.18047,ratio_test_loss:0.18074, total_loss_train:-0.80829,total_loss_test:-0.80374, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9558, epoch 81.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9558, epoch 81.0)
[Save Checkpoint] epoch: [81.0], Train score:98.88000, Test score:98.33000, train loss:-0.98856, test loss:-0.98324, ratio_train_loss:0.18102,ratio_test_loss:0.18111, total_loss_train:-0.80755,total_loss_test:-0.80213, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9676, epoch 82.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9676, epoch 82.0)
[Save Checkpoint] epoch: [82.0], Train score:98.96167, Test score:98.42000, train loss:-0.98962, test loss:-0.98389, ratio_train_loss:0.16721,ratio_test_loss:0.16646, total_loss_train:-0.82241,total_loss_test:-0.81743, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9794, epoch 83.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9794, epoch 83.0)
[Save Checkpoint] epoch: [83.0], Train score:98.90000, Test score:98.43000, train loss:-0.98883, test loss:-0.98446, ratio_train_loss:0.18113,ratio_test_loss:0.18268, total_loss_train:-0.80769,total_loss_test:-0.80179, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9912, epoch 84.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 9912, epoch 84.0)
[Save Checkpoint] epoch: [84.0], Train score:98.99167, Test score:98.58000, train loss:-0.98980, test loss:-0.98576, ratio_train_loss:0.17234,ratio_test_loss:0.17364, total_loss_train:-0.81746,total_loss_test:-0.81212, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10030, epoch 85.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10030, epoch 85.0)
[Save Checkpoint] epoch: [85.0], Train score:98.94833, Test score:98.65000, train loss:-0.98920, test loss:-0.98633, ratio_train_loss:0.17524,ratio_test_loss:0.17605, total_loss_train:-0.81396,total_loss_test:-0.81028, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10148, epoch 86.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10148, epoch 86.0)
[Save Checkpoint] epoch: [86.0], Train score:99.02167, Test score:98.61000, train loss:-0.99006, test loss:-0.98605, ratio_train_loss:0.17356,ratio_test_loss:0.17400, total_loss_train:-0.81650,total_loss_test:-0.81205, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10266, epoch 87.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10266, epoch 87.0)
[Save Checkpoint] epoch: [87.0], Train score:98.78667, Test score:98.38000, train loss:-0.98773, test loss:-0.98318, ratio_train_loss:0.18458,ratio_test_loss:0.18409, total_loss_train:-0.80316,total_loss_test:-0.79909, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10384, epoch 88.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10384, epoch 88.0)
[Save Checkpoint] epoch: [88.0], Train score:98.99167, Test score:98.52000, train loss:-0.98987, test loss:-0.98498, ratio_train_loss:0.17374,ratio_test_loss:0.17321, total_loss_train:-0.81613,total_loss_test:-0.81177, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10502, epoch 89.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10502, epoch 89.0)
[Save Checkpoint] epoch: [89.0], Train score:98.97667, Test score:98.58000, train loss:-0.98970, test loss:-0.98561, ratio_train_loss:0.17230,ratio_test_loss:0.17146, total_loss_train:-0.81740,total_loss_test:-0.81415, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10620, epoch 90.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10620, epoch 90.0)
[Save Checkpoint] epoch: [90.0], Train score:99.00333, Test score:98.65000, train loss:-0.98982, test loss:-0.98652, ratio_train_loss:0.16957,ratio_test_loss:0.17064, total_loss_train:-0.82026,total_loss_test:-0.81589, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10738, epoch 91.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10738, epoch 91.0)
[Save Checkpoint] epoch: [91.0], Train score:98.97667, Test score:98.43000, train loss:-0.98948, test loss:-0.98413, ratio_train_loss:0.17921,ratio_test_loss:0.18077, total_loss_train:-0.81027,total_loss_test:-0.80336, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10856, epoch 92.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10856, epoch 92.0)
[Save Checkpoint] epoch: [92.0], Train score:98.98000, Test score:98.69000, train loss:-0.98968, test loss:-0.98629, ratio_train_loss:0.17268,ratio_test_loss:0.17186, total_loss_train:-0.81700,total_loss_test:-0.81443, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10974, epoch 93.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 10974, epoch 93.0)
[Save Checkpoint] epoch: [93.0], Train score:98.99000, Test score:98.49000, train loss:-0.98965, test loss:-0.98503, ratio_train_loss:0.17859,ratio_test_loss:0.17950, total_loss_train:-0.81105,total_loss_test:-0.80554, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 11092, epoch 94.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 11092, epoch 94.0)
[Save Checkpoint] epoch: [94.0], Train score:99.06833, Test score:98.56000, train loss:-0.99063, test loss:-0.98539, ratio_train_loss:0.17453,ratio_test_loss:0.17454, total_loss_train:-0.81610,total_loss_test:-0.81085, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 11210, epoch 95.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 11210, epoch 95.0)
[Save Checkpoint] epoch: [95.0], Train score:99.04167, Test score:98.70000, train loss:-0.99026, test loss:-0.98675, ratio_train_loss:0.17175,ratio_test_loss:0.17277, total_loss_train:-0.81851,total_loss_test:-0.81398, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 11328, epoch 96.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 11328, epoch 96.0)
[Save Checkpoint] epoch: [96.0], Train score:98.95500, Test score:98.51000, train loss:-0.98919, test loss:-0.98504, ratio_train_loss:0.17093,ratio_test_loss:0.17373, total_loss_train:-0.81825,total_loss_test:-0.81131, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 11446, epoch 97.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 11446, epoch 97.0)
[Save Checkpoint] epoch: [97.0], Train score:99.10500, Test score:98.71000, train loss:-0.99095, test loss:-0.98700, ratio_train_loss:0.17658,ratio_test_loss:0.17856, total_loss_train:-0.81437,total_loss_test:-0.80844, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 11564, epoch 98.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 11564, epoch 98.0)
[Save Checkpoint] epoch: [98.0], Train score:98.94833, Test score:98.50000, train loss:-0.98943, test loss:-0.98499, ratio_train_loss:0.17016,ratio_test_loss:0.17084, total_loss_train:-0.81927,total_loss_test:-0.81415, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 11682, epoch 99.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 11682, epoch 99.0)
[Save Checkpoint] epoch: [99.0], Train score:99.01167, Test score:98.58000, train loss:-0.98992, test loss:-0.98547, ratio_train_loss:0.17524,ratio_test_loss:0.17673, total_loss_train:-0.81468,total_loss_test:-0.80874, 
=> saved checkpoint 'checkpoints_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 11800, epoch 100.0)
=> saved checkpoint 'checkpoint_scores_CNN/CNN_mnist_custom_BK_2layer_bk1_20_ratio_bs_512_4/last' (iter 11800, epoch 100.0)
[Save Checkpoint] epoch: [100.0], Train score:99.05500, Test score:98.67000, train loss:-0.99048, test loss:-0.98662, ratio_train_loss:0.17898,ratio_test_loss:0.18042, total_loss_train:-0.81150,total_loss_test:-0.80620, 
[Training Finished]
All Done!
